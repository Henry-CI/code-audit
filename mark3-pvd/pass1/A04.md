# Pass 1 — A04 Security Audit
**Auditor:** A04
**Date:** 2026-02-28
**Branch:** master (confirmed)
**Files reviewed:**
- `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h`
- `/c/Projects/cig-audit/repos/mark3-pvd/app/crctable.cpp`
- `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.h`
- `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp`

---

## Reading Evidence

### File: `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h`

**Class name and base classes:** None — this is a pure header file (no class). Contains a namespace `CIGCONF` with enums and structs.

**Public methods:** None (no class).

**Signals and slots:** None.

**`#include` directives:**
- Line 4: `#include <QtGlobal>`
- Line 5: `#include <QByteArray>`
- Line 6: `#include <QString>`

**`Q_OBJECT` macro:** Not present.

**Constants and `#define`s:**
- Line 8: `#define LFF_VERSION 5`
- Line 9: `#define SFF_VERSION 2`
- Line 10: `#define UFF_VERSION 2`
- Line 11: `#define ENG_VERSION "J"`
- Line 12: `#define F_BUILD 6`
- Line 13: `#define C_BUILD 5`
- Line 15: `#define BROADCASTMSG_TEXT_LEN 100`
- Line 17: `#define GMTP_ID_LEN 33`
- Line 18: `#define GMTP_SERVER_CNT 3`
- Line 19: `#define SERVER_ADDR_LEN 33`
- Line 20: `#define MODEM_DIAL_NUMBER_LEN 9`
- Line 21: `#define MODEM_APN_LEN 33`
- Line 22: `#define MODEM_APN_USER_LEN 33`
- Line 23: `#define MODEM_ICCID_LEN 32`
- Line 24: `#define MODEM_APN_PASSWORD_LEN 66`
- Line 26: `#define MAX_POLY_POINTS (6)`
- Line 27: `#define MAX_POLY (4)`
- Line 29: `#define CHECKLIST_TIME_SLOTS 4`
- Line 30: `#define CHECKLIST_MAX_IDX 32`
- Line 31: `#define CHECKLIST_QUESTION_LEN 50`
- Line 32: `#define CHECKLIST_ITEM_SIZE (5 + CHECKLIST_QUESTION_LEN)`
- Line 33: `#define CHECKLIST_QUESTION_LEN_100 100`
- Line 34: `#define CHECKLIST_ITEM_SIZE_100 (7 + CHECKLIST_QUESTION_LEN_100)`
- Line 36: `#define DRIVER_MAX_ID_IDX 3000`
- Line 37: `#define MASTER_MAX_ID_IDX 1024`
- Line 38: `#define SUPER_MAX_ID_IDX 100`
- Line 39: `#define TECH_MAX_ID_IDX 1000`
- Line 42: `#define CAN_MAX_HW_PGN 5`
- Line 43: `#define CAN_MAX_PGN_IDX 10`
- Line 44: `#define CAN_MAX_SPN_IDX 20`
- Line 45: `#define CAN_MAX_LINK_IDX 8`
- Line 46: `#define CAN_MAX_ATT_IDX 15`
- Line 47: `#define CAN_ATT_NAME_LEN 10`
- Line 48: `#define CAN_MSG_TYPE 0x02`
- Line 49: `#define CAN_MSG_DLC 0x8`
- Line 50: `#define CAN_SIG_STATUS 0x01`
- Line 53: `#define ON_DEMAND_DURATION (24*60*60)`
- Line 56: `#define WIFI_MAX_NETWORKS 10`
- Line 57: `#define WIFI_CONF_FILE "/etc/wpa_supplicant.conf"`
- Line 64: `#define FILE_DRIVER_IDS "/home/dlist.txt"`
- Line 65: `#define FILE_MASTER_IDS "/home/mlist.txt"`
- Line 66: `#define FILE_SUPER_IDS "/home/slist.txt"`
- Line 67: `#define FILE_TECH_IDS "/home/tlist.txt"`
- Line 68: `#define FILE_CHECKLIST "/home/PREOP.TXT"`
- Line 69: `#define FILE_CHECKLIST_100 "/home/PREOP100.TXT"`
- Line 70: `#define FILE_FLEETMS_FW "/mnt/sd/FleetIQ360App"`
- Line 71: `#define FILE_FLEETMS_FW_RD "/mnt/ramdisk/FleetIQ360App"`
- Line 72: `#define FILE_LOGIN_SCREEN "/home/login.png"`
- Line 73: `#define FILE_LOGIN_SCREEN_RD "/mnt/ramdisk/login.png"`
- Line 74: `#define FILE_ONCEPERDAY_PREOP_IDS "/home/opdPreopDlist.txt"`
- Line 76: `#define DIR_GMTP_MSG "/mnt/sd"`
- Line 81: `#define SHOW_ALL_MASTER_MENU 255`

**Enums (in namespace `CIGCONF`):**
- `MasterMenuOptions` (line 83): `UnlockVehicle=1`, `NormalDriverAccess=2`, `ActivateVOR=4`, `MaintenanceMode=8`, `DefaultMasterMenu=7`, `UnassignedMasterMenu=255`
- `PowerState` (line 86): `NormalPowerState`, `PreDimState`, `DimState`, `SleepActiveState`, `SleepState`, `PowerOffState`
- `ConfigErrorCode` (line 88): `NoConfigError`, `ConfigCrcError`, `ConfigAddressError`, `ConfigSizeError`, `ConfigSectorError`
- `FtpErrorCode` (line 90): `NoFtpError`, `FtpGenericError`, `FtpServerError`, `FtpIncompleteFileError`, `FtpSaveFileError`, `FtpNoFileError`, `FtpOSError`, `FtpParamError`, `FtpCorruptFileError`, `FtpRetryExceedError`
- `LeaderCmdType` (line 93): `QueryCmd`, `RemoteSetCmd`, `LocalSetCmd`
- `UnlockReasonScreen` (line 95): `Disabled`, `EnabledOptional`, `EnabledMandatory`
- `RealImpact` (line 97): `Unconfirmed`, `No`, `Yes`
- `DigitalInputMode` (line 99): `Default`, `Overload`, `Battery`, `SeenSafety`
- `LeaderCmd` (lines 101–126): extensive command set including `CMD_DEBUG`, `CMD_DBGPWR`, `CMD_DBGBLE`, `CMD_DBGRAM`, `CMD_UNKNOWN=0xff`, etc.
- `GmtpMessage` (lines 128–133)
- `CheckReason` (line 135), `CheckResponses` (line 136), `ChecklistType` (line 137)
- `OnDemandCmdType` (line 139), `OnDemandCmdSrc` (line 140)
- `MaintLockedCode` (lines 142–148): includes `MaintIdle=0xea`, `MaintCriticalQuestion=0xfb`, `MaintRedImpact=0xfd`, `MaintSurveyTimeout=0xfe`
- `ShowTimeFormat` (lines 150–154)
- `BleExpansionDI`, `BleExpansionRelay`, `BleExpansionConnectionStatus` (lines 156–158)
- `CanProtocol` (line 160): `LindeNormal`, `J1939`, `LindeExtended`, `BydCan`, `Linde1202`
- `CanAttributeType` (lines 162–169)
- `WifiPosSource` (line 171)
- `CameraMode` (line 173)

**Structs (in namespace `CIGCONF`):**
- `CanMsgLink` (line 175): `quint16 spnIndex`, `quint8 pos`
- `CanMsgPara` (line 180): `quint32 identifier`, `quint8 type`, `quint8 dlc`, `quint8 sigNum`, `CanMsgLink sigList[CAN_MAX_LINK_IDX]`
- `CanSigPara` (line 188): `quint8 status`, `quint8 width`, `qint32 addr32`, `void *unused2`
- `CigCanConfig` (line 195): `quint8 processType`, `quint8 txEnable`, nested `busInfo` struct, union containing `CanSignalInfo` with `canMsg[CAN_MAX_PGN_IDX]`, `canSig[CAN_MAX_SPN_IDX]`, `spnInfo[CAN_MAX_SPN_IDX]`, `canAtt[CAN_MAX_ATT_IDX]`, `pgnRequestTicks[CAN_MAX_PGN_IDX]`
- `BroadcastMessage` (line 245): `quint32 id`, `QByteArray text`, `quint8 type`, `quint8 res`, `quint32 timeout`
- `WifiNetwork` (line 254): `QByteArray ssid`, `QByteArray pw`
- `PreopDriverId` (line 260): `quint64 id`, `quint32 lastPreopTimestamp`
- `DriverId` (line 265): `quint64 id`, `QString name`
- `MasterId` (line 270): `quint64 id`, `quint8 option`, `QString name`
- `gpsPosStruct` (line 276): `qint32 latitude`, `qint32 longitude`
- `polygonStruct` (line 281): `quint8 nPoints`, `gpsPosStruct polyVertices[MAX_POLY_POINTS]`
- `position` (line 287): `double lat`, `double lon`, `double latrad`, `double lonrad`
- `AccessPoint` (line 295): `QByteArray mac`, `double rssi`, `quint32 lastSeen`, `QByteArray ssid`, `quint32 channel`
- `CheckResponse` (line 304): `quint32 id`, `quint16 type`, `quint16 response`, `QString text`

**Member variables:** None (no class).

---

### File: `/c/Projects/cig-audit/repos/mark3-pvd/app/crctable.cpp`

**Class name and base classes:** None — standalone translation unit, no class.

**Public methods:** None.

**Signals and slots:** None.

**`#include` directives:**
- Line 1: `#include <QtGlobal>`

**`Q_OBJECT` macro:** Not present.

**Constants and `#define`s:** None.

**Declarations and definitions:**
- Line 3: `extern const quint32 crc32Table[];` (forward declaration)
- Line 4: `extern const quint16 crc16Table[];` (forward declaration)
- Line 6: `const quint32 crc32Table[256]` — 256-entry CRC32 lookup table
- Line 41: `const quint16 crc16Table[16]` — 16-entry CRC16 lookup table

**Member variables:** None (no class).

---

### File: `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.h`

**Class name and base classes:** `DriverList` — no base class (not a QObject).

**`#include` directives:**
- Line 4: `#include <QtGlobal>`
- Line 5: `#include <QList>`
- Line 6: `#include "app/cigconfigs.h"`
- Line 7: `#include <QDebug>`

**`Q_OBJECT` macro:** Not present.

**Public methods (with line numbers):**
- Line 12: `DriverList()`
- Line 14: `void readDriverIds()`
- Line 15: `void readMasterIds()`
- Line 16: `void readSuperIds()`
- Line 17: `void readTechIds()`
- Line 18: `void saveDriverIds()`
- Line 19: `void saveMasterIds()`
- Line 20: `void saveSuperIds()`
- Line 21: `void saveTechIds()`
- Line 22: `void readPreopDriverIds()`
- Line 23: `void savePreopDriverIds()`
- Line 25: `QList<CIGCONF::DriverId> driverIds() const`
- Line 26: `QList<CIGCONF::MasterId> masterIds() const`
- Line 27: `QList<quint64> superIds() const`
- Line 28: `QList<CIGCONF::DriverId> techIds() const`
- Line 29: `QList<CIGCONF::PreopDriverId> preopDriverIds() const`
- Line 31: `CIGCONF::DriverId driverId(int index) const`
- Line 32: `CIGCONF::MasterId masterId(int index) const`
- Line 33: `CIGCONF::MasterId masterIdById(quint64 id) const`
- Line 34: `quint64 superId(int index) const`
- Line 35: `CIGCONF::DriverId techId(int index) const`
- Line 37: `bool setDriverId(int index, quint64 id, QString name)`
- Line 38: `bool setMasterId(int index, quint64 id, quint8 option, QString name)`
- Line 39: `bool setSuperId(int index, quint64 id)`
- Line 40: `bool setTechId(int index, quint64 id, QString name)`
- Lines 42–48: `bool containsDriverId(quint64 id) const` (inline)
- Lines 50–62: `bool containsMasterId(quint64 id, quint8 permissions) const` (inline)
- Lines 63–68: `bool containsSuperId(quint64 id) const` (inline)
- Lines 69–75: `bool containsTechId(quint64 id) const` (inline)
- Line 77: `bool addDriverId(quint64 id, QString name)`
- Line 78: `bool addSuperId(quint64 id)`
- Line 79: `bool addTechId(quint64 id, QString name)`
- Line 80: `bool addPreopDriverId(quint64 id, quint32 timestamp)`
- Line 82: `bool removeDriverId(quint64 id)`
- Line 83: `bool removeMasterId(quint64 id)`
- Line 84: `bool removeSuperId(quint64 id)`
- Line 85: `bool removeTechId(quint64 id)`
- Line 87: `void clearDriverIds()`
- Line 88: `void clearMasterIds()`
- Line 89: `void clearSuperIds()`
- Line 90: `void clearTechIds()`
- Line 91: `void clearPreopDriverIds()`
- Line 93: `quint32 driverChecksum() const`
- Line 94: `quint32 masterChecksum() const`
- Line 95: `quint32 superChecksum() const`
- Line 96: `quint32 techChecksum() const`
- Line 98: `bool superIsEmpty()`
- Line 100: `int getMasterIdIndex(quint64 id)`
- Line 101: `int getDriverIdIndex(quint64 id)`
- Line 102: `int getTechIdIndex(quint64 id)`
- Line 103: `int getPreopDriverIdIndex(quint64 id)`
- Line 104: `CIGCONF::PreopDriverId getPreopDriverId(quint64 id)`

**Signals and slots:** None.

**Member variables (private):**
- Line 108: `QList<CIGCONF::DriverId> m_driverIds`
- Line 109: `QList<CIGCONF::MasterId> m_masterIds`
- Line 110: `QList<quint64> m_superIds`
- Line 111: `QList<CIGCONF::DriverId> m_techIds`
- Line 112: `QList<CIGCONF::PreopDriverId> m_preopDriverIds`
- Line 113: `bool m_driverIdsDirty`
- Line 114: `bool m_masterIdsDirty`
- Line 115: `bool m_superIdsDirty`
- Line 116: `bool m_techIdsDirty`
- Line 117: `bool m_preopDriverDirty`

---

### File: `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp`

**Class name and base classes:** Implementation of `DriverList` (see above).

**`#include` directives:**
- Line 1: `#include "driverlist.h"`
- Line 2: `#include "app/cigconfigs.h"`
- Line 3: `#include <QFile>`
- Line 4: `#include <QSaveFile>`
- Line 5: `#include <QDateTime>`
- Line 6: `#include "app/globalconfigs.h"`

**`Q_OBJECT` macro:** Not present.

**Constants and `#define`s:** None in this file.

**Member variables:** As declared in `driverlist.h`.

---

## Security Review

### 1. Memory Safety

**A04-1** · MEDIUM · Memory Safety
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h:193`
**Description:** The struct `CanSigPara` contains a member `void *unused2` described in a comment as "set to nullptr". Storing a raw `void*` in a persistent data structure (used inside the union of `CigCanConfig`) creates a use-after-free and dangling-pointer risk if this pointer is ever assigned a non-null value by future code or through memory corruption of the adjacent fields. Because `CigCanConfig` is a plain struct likely serialised to/from non-volatile storage or transmitted over a communications channel, a corrupted value in this field could produce an exploitable pointer dereference when the struct is later read back.

**A04-2** · LOW · Memory Safety
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp:267–283`
**Description:** `setDriverId` accepts an `int index` parameter and checks `index >= DRIVER_MAX_ID_IDX` (3000) before expanding `m_driverIds` up to that index. If a caller provides `index = 2999` and `m_driverIds` is currently empty, the loop `for (int i = m_driverIds.size(); i <= index; ++i) m_driverIds << d;` will append 3000 entries unconditionally, allocating a `QList` of up to 3000 `DriverId` objects. An equivalent pattern exists for `setMasterId` (up to 1024), `setSuperId` (up to 100), and `setTechId` (up to 1000). If the `index` parameter is received from an attacker-controlled command (e.g., a `CMD_IDBATCH` GMTP command), this constitutes a denial-of-service through large memory allocation on a constrained embedded device.

**A04-3** · LOW · Memory Safety
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp:430–443`
**Description:** `getPreopDriverIdIndex` contains a spurious local function declaration at line 433: `CIGCONF::PreopDriverId getPreopDriverId(quint64 id);`. This is a forward declaration inside function body scope, which in C++ declares a local function (not the member method). This is a code defect — the declared local function shadows the class member and is never called. While not directly a security vulnerability, it demonstrates that dead/unreachable code paths exist in the authentication logic for once-per-day preop checking, which could mask logic errors in future modifications.

**Unsafe C string functions (strcpy, strcat, sprintf, gets):** None found in these files.

**Raw `new` without RAII:** None found in these files.

**`memcpy`/`memmove` without size check:** None found in these files.

### 2. Communication Security

**A04-4** · MEDIUM · Communication Security
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h:57`
**Description:** `#define WIFI_CONF_FILE "/etc/wpa_supplicant.conf"` hardcodes the path to the WPA supplicant configuration file. This file typically contains plaintext Wi-Fi pre-shared keys (PSKs) or WPA enterprise credentials. The firmware directly references this path for reading and/or writing Wi-Fi credentials. On a Linux-based embedded device where `/etc/wpa_supplicant.conf` is world-readable, Wi-Fi passwords stored in this file are accessible to any process running on the device. There is no evidence of file permission enforcement or encryption of credentials at rest.

**A04-5** · INFO · Communication Security
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h:19–24`
**Description:** Length constants are defined for server addresses (`SERVER_ADDR_LEN 33`), modem APN credentials (`MODEM_APN_LEN 33`, `MODEM_APN_USER_LEN 33`, `MODEM_APN_PASSWORD_LEN 66`), and modem dial number (`MODEM_DIAL_NUMBER_LEN 9`). No actual server addresses or credentials are hardcoded in this header. The APN password field comment notes "must >= 64 (WPA key max length)", which suggests these credential fields are populated at runtime (provisioned). No hardcoded credentials were found in this file.

**Hardcoded server addresses, API keys, or encryption keys:** None found in these four files.

**Hardcoded encryption keys or IVs:** None found in these four files.

### 3. Input Handling

**A04-6** · MEDIUM · Input Handling
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp:22–42`
**Description:** `readDriverIds()` calls `file.readAll()` on `FILE_DRIVER_IDS` (`/home/dlist.txt`) with no limit on file size. On an embedded device with limited RAM, a file that has been tampered with (e.g., replaced via FTP as noted in the comment at `cigconfigs.h:61`) containing many megabytes of data would cause the entire file to be read into a single `QByteArray` in memory, potentially exhausting heap. The same pattern exists in `readMasterIds()` (line 71), `readSuperIds()` (line 126), `readTechIds()` (line 161), and `readPreopDriverIds()` (line 211). The comment in `cigconfigs.h` explicitly acknowledges these files may be updated by FTP, meaning attacker-controlled content is a realistic threat model.

**A04-7** · LOW · Input Handling
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp:86–87`
**Description:** In `readMasterIds()`, `m.option` is parsed with `toUInt()` at line 86, which returns a `uint` (32-bit on all Qt platforms). This value is then stored in `MasterId::option`, which is typed `quint8`. An attacker who controls the master ID file content (e.g., via FTP replacement) could supply a value greater than 255. Qt's `QByteArray::toUInt()` will parse it successfully without error, and the implicit narrowing conversion from `uint` to `quint8` will silently truncate the value. Because `option` is a permission bitmask used in `containsMasterId()` for access-control decisions (line 55 of `driverlist.h`), a truncated permission value could allow a master ID to bypass permission checks that rely on specific bitmask bits being set.

**A04-8** · LOW · Input Handling
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp:37`
**Description:** When parsing driver names from the ID file, the name field is taken directly from the file with `QString(args.at(1))` (no trimming or length limiting). While Qt strings do not overflow in the C sense, names of arbitrary length are stored in `DriverId::name` and `MasterId::name`. If these strings are later rendered to a fixed-size display buffer or transmitted in a bounded message field sized against `BROADCASTMSG_TEXT_LEN` (100) or similar constants, the unconstrained input from file could produce truncation or incorrect display behaviour. The same pattern appears in `readTechIds()` (line 176) and `readMasterIds()` (line 89).

**Format string vulnerabilities:** None found — no `printf(var)` or `qDebug(var)` patterns observed.

**Deserialization of untrusted binary data:** Not present in these files; parsing is text-based with Qt conversion functions.

### 4. Build Security

Build Security: no issues found. (Source files only — no `.pro` file in scope for this assignment. No compiler flags to evaluate here.)

### 5. Device and Firmware

**A04-9** · MEDIUM · Device and Firmware
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h:64–74`
**Description:** All ID list files and checklist files are stored under `/home/` (e.g., `FILE_DRIVER_IDS "/home/dlist.txt"`, `FILE_MASTER_IDS "/home/mlist.txt"`, `FILE_SUPER_IDS "/home/slist.txt"`, `FILE_TECH_IDS "/home/tlist.txt"`, `FILE_CHECKLIST "/home/PREOP.TXT"`, `FILE_ONCEPERDAY_PREOP_IDS "/home/opdPreopDlist.txt"`). The comment at lines 61–63 explicitly states these files may be updated by FTP. Driver and master ID lists are security-critical: they control who can unlock the vehicle and who has master/supervisor access. Storing authentication data in FTP-writable plaintext files on the device filesystem, with no integrity protection (no HMAC, no signature), means that any party with FTP access to the device can add arbitrary driver or master IDs, effectively granting themselves vehicle access. The XOR-based checksum returned by `driverChecksum()` / `masterChecksum()` is not a cryptographic integrity mechanism and can be trivially forged.

**A04-10** · LOW · Device and Firmware
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h:116–118`
**Description:** The `LeaderCmd` enum includes `CMD_DEBUG`, `CMD_DBGPWR` (with comment "AT^DBGPWR=1/0 for power on/off debug usage"), `CMD_DBGBLE` (with comment "AT^DBGBLE=1/0 for bluetooth debug usage"), and `CMD_DBGRAM`. These are named debug commands that appear to be part of the production command set (they are defined alongside all other production commands with no conditional compilation guard). Debug commands that can affect power state or Bluetooth in production firmware are a firmware security concern: if accessible via the communications channel, they expand the attack surface unnecessarily.

**A04-11** · INFO · Device and Firmware
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/cigconfigs.h:83–84`
**Description:** The `MasterMenuOptions` enum uses `UnassignedMasterMenu=255` as the default/unassigned sentinel value, which is the same as `SHOW_ALL_MASTER_MENU 255` defined at line 81. In `masterIdById()` (driverlist.cpp line 650), when a master ID has option `UnassignedMasterMenu`, it is promoted to `DefaultMasterMenu=7`. This default-promotion logic means a freshly provisioned or file-corrupted master ID with no explicit option value (255 = all bits set in a `quint8`) is automatically granted menu options 1+2+4 (UnlockVehicle, NormalDriverAccess, ActivateVOR). This is a design-level access-control concern: the unassigned sentinel value coincides with the maximum-privilege value, so any default or corrupted record silently receives substantial permissions.

**Firmware signing keys committed to repo:** None found in these files.

**Device certificates or credential files:** None found in these files.

### 6. Qt-Specific Security

**A04-12** · LOW · Qt-Specific Security
**File:** `/c/Projects/cig-audit/repos/mark3-pvd/app/driverlist.cpp:244–264`
**Description:** `savePreopDriverIds()` uses a plain `QFile` opened with `QIODevice::WriteOnly | QIODevice::Text` rather than `QSaveFile`. All other save methods in this class correctly use `QSaveFile` (which writes to a temporary file and atomically commits on success), protecting against partial writes if the device loses power mid-write. `savePreopDriverIds()` writes directly to `FILE_ONCEPERDAY_PREOP_IDS` (`/home/opdPreopDlist.txt`). A power loss during this write would corrupt the once-per-day pre-operation check record file, potentially causing all drivers to be re-prompted for the checklist or — depending on error handling — allowing drivers who have already completed the pre-op check to bypass it after reboot.

**`QProcess` usage:** None found in these files.

**`QSettings` usage:** None found in these files.

**`QSslSocket` / TLS configuration:** None found in these files.

---

## Summary of Findings

| ID | Severity | Category | File |
|----|----------|----------|------|
| A04-1 | MEDIUM | Memory Safety | `cigconfigs.h:193` |
| A04-2 | LOW | Memory Safety | `driverlist.cpp:267` |
| A04-3 | LOW | Memory Safety | `driverlist.cpp:430` |
| A04-4 | MEDIUM | Communication Security | `cigconfigs.h:57` |
| A04-5 | INFO | Communication Security | `cigconfigs.h:19–24` |
| A04-6 | MEDIUM | Input Handling | `driverlist.cpp:22` |
| A04-7 | LOW | Input Handling | `driverlist.cpp:86` |
| A04-8 | LOW | Input Handling | `driverlist.cpp:37` |
| A04-9 | MEDIUM | Device and Firmware | `cigconfigs.h:64–74` |
| A04-10 | LOW | Device and Firmware | `cigconfigs.h:116–118` |
| A04-11 | INFO | Device and Firmware | `cigconfigs.h:83–84` |
| A04-12 | LOW | Qt-Specific Security | `driverlist.cpp:244` |
