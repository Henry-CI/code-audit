# Pass 1 Audit — A01
**Auditor:** A01
**Date:** 2026-02-28
**Branch:** master (confirmed via `git rev-parse --abbrev-ref HEAD`)
**Repo:** /c/Projects/cig-audit/repos/mark3-pvd

---

## File Inventory Note

`bitbucket-pipelines.yml` does not exist in this repository. The Bitbucket Pipelines subsection of the Communication Security checklist cannot be evaluated from a pipeline file. This absence is recorded here as required.

---

## Reading Evidence

### /c/Projects/cig-audit/repos/mark3-pvd/.gitignore

Rules and patterns (every line):

| Line | Pattern | Effect |
|------|---------|--------|
| 1 | `Makefile` | Ignores any file named `Makefile` |
| 2 | `FleetFocus` | Ignores the compiled binary named `FleetFocus` |
| 3 | `.*` | Ignores all dot-files (hidden files) |
| 4 | *(blank)* | — |
| 5 | `/tmp` | Ignores the `/tmp` directory at repo root |
| 6 | *(blank)* | — |
| 7 | `!.gitignore` | Exception: explicitly un-ignores `.gitignore` itself |
| 8 | `*.bak` | Ignores all `.bak` backup files |

---

### /c/Projects/cig-audit/repos/mark3-pvd/netcfg.json

Every key-value pair:

| Key | Value |
|-----|-------|
| `password` | `P@ssMK3!` |
| `ssid` | `cigSecureConnect` |

This file contains a Wi-Fi SSID and a plaintext Wi-Fi password committed directly to version control.

---

### /c/Projects/cig-audit/repos/mark3-pvd/run_tests

Every command and its purpose:

| Command / Element | Purpose |
|-------------------|---------|
| `#!/bin/sh` | Shebang — executes script with `/bin/sh` |
| `./FleetFocus` | Launches the compiled `FleetFocus` test binary from the current working directory |
| `\| awk '...'` | Pipes all output from `FleetFocus` into `awk` for colour-coded filtering |
| `/PASS/ {print "\033[32m" $0 "\033[0m"}` | Lines matching `PASS` are printed in green |
| `/FAIL/ {print "\033[31m" $0 "\033[0m"}` | Lines matching `FAIL` are printed in red |
| `/DEBUG/ {print $0}` | Lines matching `DEBUG` are printed as-is (comment notes yellow colouring from handler) |
| `/WARN/ {print $0}` | Lines matching `WARN` are printed as-is (comment notes magenta colouring from handler) |
| `!/PASS\|FAIL\|DEBUG\|WARN/ {print $0}` | All other lines are printed unchanged |

The script exists to run the test binary and produce human-readable, colour-coded pass/fail output. It does not perform any network operations, write to files, or handle user input.

---

## Security Review

### 1. Memory Safety

The three assigned files (`.gitignore`, `netcfg.json`, `run_tests`) contain no C++ source code. There are no buffer operations, pointer operations, string function calls, or memory allocations to evaluate in these files.

Memory Safety: no issues found.

---

### 2. Communication Security

**Bitbucket Pipelines:** `bitbucket-pipelines.yml` does not exist in this repository. No pipeline credentials or secret handling can be evaluated from that file.

The `netcfg.json` file contains a hardcoded Wi-Fi password committed to version control. See finding A01-1.

---

### 3. Input Handling

The `run_tests` script passes the raw output stream of `FleetFocus` through `awk` pattern matching. The `awk` script does not accept any external user input; it only reads from the binary's stdout. No injection vectors are present in the script itself.

The `netcfg.json` file is a static configuration file with two string fields. No parsing logic is visible in the assigned files.

Input Handling: no issues found in assigned files.

---

### 4. Build Security

The `.gitignore` file excludes the compiled binary `FleetFocus` and `Makefile` from version control, which is expected practice. No `.pro` file was assigned; compiler security flags cannot be assessed from these three files.

Build Security: no issues found in assigned files.

---

### 5. Device and Firmware

The `netcfg.json` file contains a provisioning-class credential (Wi-Fi password) committed directly to the repository. See finding A01-1. No `.pem`, `.crt`, `.key`, or `.p12` files were found among the assigned files.

The `.gitignore` rule `.*` suppresses all hidden files from version control. This means any sensitive hidden files (e.g., `.env`, `.npmrc`, SSH keys dropped into the repo root) would be silently excluded rather than explicitly blocked, which is a weak form of credential hygiene — the exclusion relies on the file being hidden rather than on explicit denial of known secret file patterns.

---

### 6. Qt-Specific Security

The assigned files contain no Qt source code, no `QProcess`, `QSettings`, `QSslSocket`, or QML usage.

Qt-Specific Security: no issues found in assigned files.

---

## Findings

**A01-1** · HIGH · Communication Security — Hardcoded Credential in Version Control
**File:** `netcfg.json:2`
**Description:** The file `netcfg.json` is committed to the repository and contains a plaintext Wi-Fi password (`P@ssMK3!`) and SSID (`cigSecureConnect`). Any person with read access to the repository (including all historical clones) has permanent access to this credential. On an embedded proximity-detection device this Wi-Fi credential is likely a production network password; exposure allows an attacker to join the device network, intercept or inject proximity events, and potentially pivot to other devices on the same segment. The credential cannot be rotated without a code change and another commit. The file should be removed from version control, added to `.gitignore`, and the password rotated immediately. Credentials should be injected at provisioning time or read from a secrets management system, not stored in the repository.

**A01-2** · LOW · Build Security — Weak .gitignore Credential Hygiene
**File:** `.gitignore:3`
**Description:** The rule `.*` excludes all dot-files from version control. While this prevents accidental commit of many hidden files, it relies on sensitive files being named with a leading dot rather than on explicit deny-listing of known secret file patterns (e.g., `*.pem`, `*.key`, `*.p12`, `.env`, `credentials.json`). If a developer places a credential file in the repo root with a non-hidden name (as already happened with `netcfg.json`), this rule provides no protection. The `.gitignore` should be augmented with explicit patterns for known credential and key file types to provide defence-in-depth.

**A01-3** · INFO · Communication Security — bitbucket-pipelines.yml Absent
**File:** *(file does not exist)*
**Description:** `bitbucket-pipelines.yml` is not present in this repository. It is not possible to verify whether CI/CD pipeline secrets (firmware signing keys, deployment credentials, device registration keys) are stored as Bitbucket repository variables rather than hardcoded in the pipeline definition. If a CI/CD pipeline exists for this project using an external configuration or a different CI system, that configuration should be reviewed separately.
