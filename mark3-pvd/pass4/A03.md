# Pass 4 Agent A03 — Code Quality

**Audit run:** 2026-02-28-01
**Branch:** master
**Files reviewed:**
- `app/backgroundworker.h`
- `app/backgroundworker.cpp`
- `app/checklist.h`
- `app/checklist.cpp`

---

## 1. Reading Evidence

### `app/backgroundworker.h`

**Classes defined:**

- `OtaWorker` (line 38) — QObject subclass responsible for OTA firmware decompression.
- `BackgroundWorker` (line 62) — QObject subclass; central coordinator for all background hardware and network operations.

**Types / enums defined:**

| Name | Kind | Location |
|------|------|----------|
| `OtaWorker::QuitMode` | — | (not here; see BackgroundWorker) |
| `BackgroundWorker::QuitMode` | enum | line 66 — values: `QuitReboot`, `QuitPowerOff`, `QuitApp` |
| `BackgroundWorker::EthernetInterface` | enum (private) | line 100 — values: `EthModem`, `EthWifi` |

**`OtaWorker` methods (with line numbers):**

| Method | Line |
|--------|------|
| `OtaWorker(QObject *parent = nullptr)` (constructor) | 42 |
| `unpack()` | 43 |

**`OtaWorker` member variables:**

| Name | Type | Line |
|------|------|------|
| `m_isRunning` | `QAtomicInteger<quint32>` (public) | 45 |
| `m_mutex` | `QMutex` (private) | 58 |

**`BackgroundWorker` methods (all, with line numbers):**

| Method | Visibility | Line |
|--------|------------|------|
| `BackgroundWorker(QObject *parent = nullptr)` (constructor) | public | 68 |
| `setUI(Dialog *ui)` | public | 69 |
| `networkStatus()` | public inline | 70 |
| `initHash()` | private | 102 |
| `ignitionStateChanged(bool on)` | private | 103 |
| `parseLeaderCmd(const QByteArray &ba, bool local)` | private | 104 |
| `dispatchLeaderCmd(CIGCONF::LeaderCmdType type, const QByteArray &header, const QByteArray &content)` | private | 105 |
| `sendGmtpMessage(CIGCONF::GmtpMessage msg, const QByteArray &ba = QByteArray())` | private | 106 |
| `powerTimerEvent()` | private | 107 |
| `onTimerEvent()` | private | 108 |
| `changePowerState()` | private | 109 |
| `updateFile(const QString &file)` | private | 110 |
| `updateSelf(bool wait = false)` | private | 111 |
| `updateFromRamdisk()` | private | 112 |
| `timeChanged()` | private | 113 |
| `quit(const QuitMode qm)` | private | 114 |
| `quitWaitForAcks(const QuitMode qm)` | private | 115 |
| `printDateBatt()` | private | 116 |
| `getKernelBuildDate()` | private | 117 |
| `convert2UTC(QString tzone, quint64 time)` | private | 118 |
| `pointInPolygon(int polyCorners, CIGCONF::position me, CIGCONF::position *points)` | private | 119 |
| `degrees2radians(double degrees)` | private | 120 |
| `testGeofence(qint32 lat, qint32 lon)` | private | 121 |
| `checkAppCrash()` | private | 122 |
| `checkSdSpace()` | private | 123 |
| `checkFotaFail()` | private | 124 |
| `dataTest()` | private | 126 |
| `ethernetStateChanged(EthernetInterface interface, bool state)` | private | 128 |
| `sendGmtpWifiPos()` | private | 129 |
| `onAllAcksSent()` | private | 131 |
| `handleModemConnection()` | private | 132 |
| `handleNtpSynchronization(EthernetInterface interface, bool newState, bool &reconnect)` | private | 133 |
| `handleWiFiConnection()` | private | 134 |
| `monitTimer()` | private | 136 |
| `initialiseCanbus1()` | private | 138 |
| `initialiseCanbus2()` | private | 139 |

**`BackgroundWorker` signals (line numbers):**

| Signal | Line |
|--------|------|
| `powerStateChanged(CIGCONF::PowerState state)` | 80 |
| `reboot()` | 81 |
| `lockScreen(CIGCONF::MaintLockedCode code, bool remote)` | 82 |
| `ambertImpactScreen()` | 83 |
| `cardAuthorised(bool yes, quint64 id)` | 84 |
| `updateStatusInfo(...)` | 85 |
| `cmdMsgReceived(CIGCONF::BroadcastMessage m)` | 86 |
| `onDemandStarted(...)` | 87 |
| `onDemandExtended(...)` | 88 |
| `onDemandEnded(...)` | 89 |
| `sigLanguageChanged()` | 90 |
| `cmdLogin(quint64 id)` | 91 |
| `unpackOta()` | 92 |
| `cameraSettingsUpdated()` | 93 |

---

### `app/backgroundworker.cpp`

**Free functions defined:**

| Function | Line |
|----------|------|
| `streamUncompress(QByteArray &chunk, z_stream &strm, bool &finished)` | 49 |
| `crc16(quint16& state, const QByteArray &chunk)` | 130 |

**Method definitions (with line numbers in .cpp):**

| Method | Line |
|--------|------|
| `OtaWorker::OtaWorker(QObject *parent)` | 144 |
| `OtaWorker::unpack()` | 146 |
| `BackgroundWorker::BackgroundWorker(QObject *parent)` | 264 |
| `BackgroundWorker::initHash()` | 341 |
| `BackgroundWorker::parseLeaderCmd(const QByteArray &ba, bool local)` | 442 |
| `BackgroundWorker::dispatchLeaderCmd(LeaderCmdType type, const QByteArray &header, const QByteArray &content)` | 512 |
| `BackgroundWorker::sendGmtpMessage(GmtpMessage msg, const QByteArray &extra)` | 2128 |
| `BackgroundWorker::degrees2radians(double degrees)` | 2446 |
| `BackgroundWorker::pointInPolygon(int polyCorners, CIGCONF::position me, CIGCONF::position *points)` | 2450 |
| `BackgroundWorker::testGeofence(qint32 lat, qint32 lon)` | 2470 |
| `BackgroundWorker::setUI(Dialog *ui)` | 2533 |
| `BackgroundWorker::ignitionStateChanged(bool on)` | 2575 |
| `BackgroundWorker::powerTimerEvent()` | 2604 |
| `BackgroundWorker::changePowerState()` | 2645 |
| `BackgroundWorker::onTimerEvent()` | 2913 |
| `BackgroundWorker::updateFile(const QString &file)` | 2920 |
| `BackgroundWorker::updateSelf(bool wait)` | 2943 |
| `BackgroundWorker::updateFromRamdisk()` | 2960 |
| `BackgroundWorker::timeChanged()` | 2969 |
| `BackgroundWorker::quitWaitForAcks(const QuitMode qm)` | 2977 |
| `BackgroundWorker::onAllAcksSent()` | 2990 |
| `BackgroundWorker::quit(const QuitMode qm)` | 2998 |
| `BackgroundWorker::printDateBatt()` | 3040 |
| `BackgroundWorker::convert2UTC(QString tzone, quint64 time)` | 3060 |
| `BackgroundWorker::getKernelBuildDate()` | 3070 |
| `BackgroundWorker::dataTest()` | 3111 |
| `BackgroundWorker::ethernetStateChanged(EthernetInterface interface, bool state)` | 3121 |
| `BackgroundWorker::handleModemConnection()` | 3158 |
| `BackgroundWorker::handleWiFiConnection()` | 3168 |
| `BackgroundWorker::handleNtpSynchronization(EthernetInterface interface, bool newState, bool &reconnect)` | 3173 |
| `BackgroundWorker::sendGmtpWifiPos()` | 3193 |
| `BackgroundWorker::checkAppCrash()` | 3243 |
| `BackgroundWorker::checkSdSpace()` | 3261 |
| `BackgroundWorker::monitTimer()` | 3300 |
| `BackgroundWorker::checkFotaFail()` | 3316 |
| `BackgroundWorker::initialiseCanbus1()` | 3351 |
| `BackgroundWorker::initialiseCanbus2()` | 3372 |

---

### `app/checklist.h`

**Class defined:** `Checklist` (line 6)

**Nested types:**

| Name | Kind | Location |
|------|------|----------|
| `Checklist::CheckItem` | struct (with anonymous union) | lines 9–21 |

`CheckItem` fields:
- Anonymous union containing:
  - Anonymous struct with bitfields: `quint32 qId : 31`, `quint32 doNotRandomize : 1`
  - `quint32 questionId`
- `CIGCONF::ChecklistType type`
- `quint8 questionLen`
- `char question[CHECKLIST_QUESTION_LEN_100+1]`

**`Checklist` methods:**

| Method | Visibility | Line |
|--------|------------|------|
| `Checklist()` (constructor) | public | 23 |
| `isValidCheckItem(const CheckItem &item)` (static inline) | public | 25 |
| `readChecklist()` | public | 27 |
| `saveChecklist()` | public | 30 |
| `clear()` | public | 31 |
| `shuffleChecklist()` | public | 32 |
| `checkItem(int index, bool query = false) const` | public | 34 |
| `setCheckItem(int index, const CheckItem &item)` | public | 35 |
| `checksum() const` | public | 36 |
| `readChecklist50()` | private | 39 |
| `readChecklist100()` | private | 40 |
| `copyAllRandomPreop(CheckItem *randomPreop)` | private | 41 |

**`Checklist` member variables:**

| Name | Type | Line |
|------|------|------|
| `m_checkItems[CHECKLIST_MAX_IDX]` | `CheckItem` | 43 |
| `m_checkItems_shuffled[CHECKLIST_MAX_IDX]` | `CheckItem` | 44 |
| `m_dirty` | `bool` | 45 |
| `m_isShuffled` | `bool` | 46 |

---

### `app/checklist.cpp`

**Method definitions:**

| Method | Line |
|--------|------|
| `Checklist::Checklist()` | 9 |
| `Checklist::readChecklist()` | 13 |
| `Checklist::readChecklist50()` | 22 |
| `Checklist::readChecklist100()` | 65 |
| `Checklist::saveChecklist()` | 139 |
| `Checklist::clear()` | 172 |
| `Checklist::setCheckItem(int index, const CheckItem &item)` | 178 |
| `Checklist::checksum() const` | 188 |
| `Checklist::shuffleChecklist()` | 198 |
| `Checklist::copyAllRandomPreop(CheckItem *randomPreop)` | 227 |
| `Checklist::checkItem(int index, bool query) const` | 238 |

---

## 2. Findings

---

**A03-1** · HIGH · `streamUncompress` uses a `static` local variable for cross-call state

**Description:** `streamUncompress` (backgroundworker.cpp line 58) uses `static bool headerSkipped = false;` to track whether the Qt qCompress 4-byte header has been skipped. Because it is a static local, the variable is shared across all call sites and all threads. If `OtaWorker::unpack()` were ever invoked concurrently on two threads, or if the function is called from a second context before a previous decompress cycle fully resets the flag, the header-skip logic would misbehave and corrupt the output. Even in the single-call path the flag is reset in multiple `return` paths but never inside a destructor or RAII guard, so any future early-return code path risks leaving it in the wrong state. The correct approach is to pass this flag as part of the `z_stream` wrapper or as an explicit parameter, not as a hidden static.

**Fix:** Remove the `static` qualifier and pass `headerSkipped` as a plain local that is passed by reference alongside `z_stream`, or embed it in a small context struct. Alternatively, since Qt's own 4-byte header is only ever prepended to the first chunk, unconditionally strip it before the first `inflateInit` call in `OtaWorker::unpack()` and remove the flag entirely.

---

**A03-2** · HIGH · Dead function `dataTest()` is production-compiled and self-schedules

**Description:** `BackgroundWorker::dataTest()` (backgroundworker.cpp lines 3111–3119) sends arbitrary incrementing GMTP messages over the production connection and reschedules itself indefinitely via `QTimer::singleShot`. Its only call site is a commented-out line at line 2796 (`//QTimer::singleShot(1000, [this](){dataTest();});`). The function itself is not guarded by `#ifdef`, so it is compiled into the release binary, is reachable via the call at line 3118 (self-recursion through singleShot), and is exposed to any code that might accidentally uncomment line 2796. A self-scheduling debug function that transmits data over the modem link must not exist in production code.

**Fix:** Delete `dataTest()` from both the header declaration (backgroundworker.h line 126) and the implementation, and remove the commented-out call site at line 2796.

---

**A03-3** · HIGH · Unreachable `break` after `return true` in multiple `dispatchLeaderCmd` cases

**Description:** Several `switch` cases in `dispatchLeaderCmd` contain `return true;` followed immediately by `break;` on the next line (backgroundworker.cpp lines 1876–1877 for `CMD_OPRNDM`, lines 1887–1888 for `CMD_SHOWNAMES`). The `break` statements are unreachable dead code. This pattern indicates the cases were likely refactored from fall-through to early-return form without cleaning up. While not a runtime bug in these two cases, it is misleading to future maintainers and may mask accidental omission of `return` in other nearby cases.

**Fix:** Remove the unreachable `break;` statements at lines 1877 and 1888.

---

**A03-4** · MEDIUM · Qt deprecated API: `QNetworkConfigurationManager` and `QRegExp`

**Description:** Two Qt 5 APIs that are deprecated in Qt 5.15 and removed in Qt 6 are used:
1. `QNetworkConfigurationManager` is `#include`d in backgroundworker.h (line 7) and `QNetworkConfiguration` is included in backgroundworker.cpp (line 31). Neither class is referenced anywhere in the visible code of these two files; the includes appear to be dead. Both classes are fully removed in Qt 6.
2. `QRegExp` is used in `getKernelBuildDate()` at backgroundworker.cpp line 3090. `QRegExp` is deprecated since Qt 5.0 in favour of `QRegularExpression` and removed in Qt 6.

**Fix:**
1. Remove the `#include <QNetworkConfigurationManager>` from backgroundworker.h and `#include <QNetworkConfiguration>` from backgroundworker.cpp if they are genuinely unused; otherwise replace with `QNetworkInformation` (Qt 6) or a platform-specific alternative.
2. Replace `QRegExp rx(...)` with `QRegularExpression rx(...)` and update the match call accordingly.

---

**A03-5** · MEDIUM · Large commented-out code blocks throughout both files

**Description:** Significant sections of live-logic code have been commented out rather than removed, creating noise and risk of accidental reactivation:

- backgroundworker.h lines 141 (`//EM070::BleCentral *m_bleCentral;`) and 151 (`//BleExpansion *m_bleExpansion;`) — member declarations commented out; corresponding allocation code in the `.cpp` is also commented.
- backgroundworker.cpp lines 264–265, 274 — BLE member initialiser lines commented out in the constructor.
- backgroundworker.cpp lines 2680–2697 — entire `BleCentral`/`BleExpansion` initialisation block (17 lines) commented out inside `changePowerState()`.
- backgroundworker.cpp lines 2854–2856 — BleExpansion disable block commented out.
- backgroundworker.cpp lines 2971–2972 — `m_bleExpansion->setCurrentTime` call commented out in `timeChanged()`.
- backgroundworker.cpp lines 3003–3005 — `m_bleExpansion->setEnabled(false)` commented out in `quit()`.
- backgroundworker.cpp line 2796 — `QTimer::singleShot(1000, [this](){dataTest();});` commented-out debug launch.
- backgroundworker.cpp line 2881 — `QProcess::startDetached("/etc/pvd/mobile -p")` commented out.
- backgroundworker.cpp lines 723–724, 738–740 — double-commented relay-query branches (`//if (!m_bleExpansion)` then `if (!m_canExpansion)`) in `CMD_RLY1` and `CMD_RLY2`.
- backgroundworker.cpp lines 1165–1167, 1191–1193 — BLE shock threshold and period setters commented out.
- backgroundworker.cpp lines 2139, 2147–2148, 2150–2153 — commented `m_bleExpansion` calls inside `GMTP_AUTH_SHOCK` handling.
- backgroundworker.cpp lines 2660, 2665 — commented brightness and log calls.
- backgroundworker.cpp line 2727 — commented gmtpHotStartReconnect connect.
- checklist.h line 28 — declaration `//void saveChecklist50();` commented out.
- checklist.cpp lines 109–137 — entire `saveChecklist50()` implementation (29 lines) commented out.

**Fix:** Remove all commented-out code blocks. If the BLE expansion path is intentionally disabled pending hardware availability, use a `#ifdef HAVE_BLE_EXPANSION` guard or delete the code with a note in git commit history. Commented-out production code should not reside in the main branch.

---

**A03-6** · MEDIUM · `m_isShuffled` member is declared but never written or read

**Description:** `Checklist::m_isShuffled` is declared as a private `bool` in checklist.h (line 46) and is initialised to nothing (not listed in the constructor initialiser list — meaning it defaults to an indeterminate value since no `= false` initialiser is present in the in-class declaration). The variable is never read or written anywhere in checklist.cpp. It appears to be a leftover from an earlier design that checked whether `shuffleChecklist()` had been called.

**Fix:** Either remove `m_isShuffled` entirely or initialise it in the constructor (`m_isShuffled(false)`) and use it as a guard inside `checkItem()` to avoid returning shuffled data before `shuffleChecklist()` has been called. As currently written, `checkItem()` defers the shuffle decision to `gCfg->preopRandom()` which is a valid alternative, making the member entirely redundant.

---

**A03-7** · MEDIUM · `Checklist` constructor does not initialise `m_isShuffled` or the array members

**Description:** The `Checklist` constructor (checklist.cpp line 9) initialises only `m_dirty(false)`. The member `m_isShuffled` (bool) receives no initialisation and contains indeterminate data until written. The two `CheckItem` arrays `m_checkItems` and `m_checkItems_shuffled` are not initialised in the constructor either; they are zeroed lazily inside `readChecklist50()` and `readChecklist100()`. If `checkItem()` or `checksum()` is called before `readChecklist()`, they operate on uninitialised memory.

**Fix:** Add a `memset` of both arrays and initialise `m_isShuffled` in the constructor body, e.g.:
```cpp
Checklist::Checklist() : m_dirty(false), m_isShuffled(false)
{
    memset(m_checkItems, 0, sizeof(m_checkItems));
    memset(m_checkItems_shuffled, 0, sizeof(m_checkItems_shuffled));
}
```

---

**A03-8** · MEDIUM · `shuffleChecklist()` rotate boundary is off by one

**Description:** `Checklist::shuffleChecklist()` at checklist.cpp line 219 calls:
```cpp
std::rotate(&randomPreop[0], &randomPreop[rotateNum], &randomPreop[numberOfRandomPreop-1]);
```
The `end` iterator passed to `std::rotate` is `&randomPreop[numberOfRandomPreop-1]`, which points to the last element rather than one-past-the-end. This means the final element in the `randomPreop` array is never rotated — it stays fixed regardless of `rotateNum`. The correct end iterator is `&randomPreop[numberOfRandomPreop]`. This is a subtle off-by-one that produces a non-uniform rotation of the checklist questions.

**Fix:** Change the call to:
```cpp
std::rotate(&randomPreop[0], &randomPreop[rotateNum], &randomPreop[numberOfRandomPreop]);
```

---

**A03-9** · MEDIUM · `convert2UTC` has dead code and is effectively a stub

**Description:** `BackgroundWorker::convert2UTC` (backgroundworker.cpp lines 3060–3068) handles only the `"PDT"` timezone and falls through to `return time` for all others. A `//TODO: add other kernel build timezone here.` comment sits below an unreachable `else` branch. The only consumer is `getKernelBuildDate()`. In practice the function adds 7 hours only if the kernel was built in Pacific Daylight Time, producing a wrong UTC conversion for any other kernel build timezone (e.g., PST, EST, UTC). The `else` clause at line 3065 is always reached when the timezone is not PDT, making the `if/else` structure misleading.

**Fix:** Either expand the timezone table to cover all expected cases, or — preferably — parse the kernel build date with `QDateTime::fromString` using an explicit Qt timezone offset rather than a string abbreviation lookup. Remove the dead comment.

---

**A03-10** · MEDIUM · `CMD_RLY1` and `CMD_RLY2` contain unreachable `QueryCmd` response branches

**Description:** In `dispatchLeaderCmd`, both `CMD_RLY1` (lines 719–734) and `CMD_RLY2` (lines 736–750) first check `if (type == QueryCmd) return false;` at the top of each case, then unconditionally fall through to a second `if (type == QueryCmd)` block that formats and returns a response. The second `QueryCmd` check can never be reached because execution already returned false at the first check. This appears to be leftover code from a previous design that allowed querying the relay state.

**Fix:** Remove the dead `if (type == QueryCmd)` response blocks (lines 727–729 and 743–745) from both relay cases, or remove the early `return false` if querying is intentionally desired.

---

**A03-11** · LOW · Mixed type conventions: `uint8_t` used alongside `quint8` in `checklist.cpp`

**Description:** `Checklist::copyAllRandomPreop` (checklist.cpp line 229) uses the C stdint type `uint8_t` for `tempCtr` while all other integer variables throughout both checklist files use Qt's `quint8`, `quint16`, `quint32` types. This minor inconsistency suggests the function was added by a different author or copied from non-Qt code without normalisation.

**Fix:** Replace `uint8_t tempCtr = 0;` with `quint8 tempCtr = 0;` to maintain consistent Qt-style typing throughout the file.

---

**A03-12** · LOW · `query == true` comparison style inconsistency in `checkItem()`

**Description:** `Checklist::checkItem()` (checklist.cpp line 239) compares `if (query == true)` rather than the idiomatic `if (query)`. Every other boolean check throughout both files uses the idiomatic form. The `== true` comparison triggers a compiler warning with `-Wbool-compare` on some toolchains.

**Fix:** Change `if (query == true)` to `if (query)`.

---

**A03-13** · LOW · `convert2UTC` takes `QString` by value instead of const reference

**Description:** `BackgroundWorker::convert2UTC(QString tzone, quint64 time)` (backgroundworker.h line 118, backgroundworker.cpp line 3060) passes the timezone string by value. Since the string is not modified inside the function, passing by `const QString &` avoids an unnecessary heap allocation for the implicit copy.

**Fix:** Change the signature to `quint64 convert2UTC(const QString &tzone, quint64 time)`.

---

**A03-14** · LOW · Indentation inconsistency in `backgroundworker.cpp`

**Description:** Several locations mix tab and space indentation:
- Lines 1837–1838 (`case CMD_LANG:` block closing) use a tab character where the rest of the file uses 4-space indentation.
- Lines 2835 (`//PwmBacklight::setBrightness(10);`) uses a tab.
- `testGeofence()` body (lines 2472–2530) uses 12-space leading indentation rather than the 4-space baseline used everywhere else, with inconsistent intermediate levels.

These inconsistencies suggest the code was pasted from different sources without reformatting.

**Fix:** Run the file through the project's code formatter (clang-format or Qt Creator's auto-format) to normalise all indentation to 4 spaces.

---

**A03-15** · LOW · `OtaWorker::m_isRunning` is a `public` data member

**Description:** `OtaWorker::m_isRunning` (backgroundworker.h line 45) is declared `public` with the `m_` prefix that signals it should be a private member. It is accessed directly from `BackgroundWorker::updateSelf()` (backgroundworker.cpp line 2954) with `m_otaWorker->m_isRunning`, bypassing encapsulation. While the `m_` prefix convention for private members is used consistently everywhere else in the header, this member is intentionally (or accidentally) made public.

**Fix:** Either make `m_isRunning` private and add a public accessor method `bool isRunning() const { return m_isRunning; }`, or — if direct atomic access from the owning class is the intent — document the design decision explicitly.

---

**A03-16** · LOW · `handleNtpSynchronization` always aborts NTP regardless of interface direction

**Description:** `BackgroundWorker::handleNtpSynchronization()` (backgroundworker.cpp lines 3173–3191) contains:
```cpp
if (!newState || interface == EthWifi || interface == EthModem) {
    m_ntpSync->abortConnection();
}
```
Since `interface` can only ever be `EthModem` or `EthWifi`, the condition `interface == EthWifi || interface == EthModem` is always true; this means `m_ntpSync->abortConnection()` is called unconditionally on every invocation regardless of `newState`. The `!newState` sub-condition is therefore dead. This appears to be a logic error introduced when the function was refactored out of `ethernetStateChanged`.

**Fix:** Clarify the intent. If NTP should be aborted only when network goes down, change the condition to `if (!newState)`. If NTP should be restarted on every interface change (the behaviour below), the abort is correct but the comment and condition should be simplified to remove the confusing dead sub-clause.

---

## 3. Summary Table

| ID | Severity | Title |
|----|----------|-------|
| A03-1 | HIGH | `streamUncompress` uses shared `static` variable for cross-call state |
| A03-2 | HIGH | Dead debug function `dataTest()` compiled into production binary |
| A03-3 | HIGH | Unreachable `break` after `return true` in `dispatchLeaderCmd` |
| A03-4 | MEDIUM | Qt deprecated API: `QNetworkConfigurationManager` and `QRegExp` |
| A03-5 | MEDIUM | Large commented-out code blocks throughout both files |
| A03-6 | MEDIUM | `m_isShuffled` declared but never written or read |
| A03-7 | MEDIUM | `Checklist` constructor leaves `m_isShuffled` and array members uninitialised |
| A03-8 | MEDIUM | `shuffleChecklist()` rotate end-iterator is off by one |
| A03-9 | MEDIUM | `convert2UTC` is a stub with dead code and a misleading `else` branch |
| A03-10 | MEDIUM | Unreachable `QueryCmd` response branches in `CMD_RLY1` and `CMD_RLY2` |
| A03-11 | LOW | Mixed type conventions: `uint8_t` used alongside `quint8` in checklist.cpp |
| A03-12 | LOW | `query == true` comparison style inconsistency in `checkItem()` |
| A03-13 | LOW | `convert2UTC` takes `QString` by value instead of const reference |
| A03-14 | LOW | Indentation inconsistency (mixed tabs/spaces) in backgroundworker.cpp |
| A03-15 | LOW | `OtaWorker::m_isRunning` is a `public` data member with `m_` prefix |
| A03-16 | LOW | `handleNtpSynchronization` condition always aborts NTP; `!newState` sub-clause is dead |
