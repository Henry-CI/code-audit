# Pass 3 Agent A05 — Documentation

**Audit run:** 2026-02-28-01
**Branch:** master
**Assigned files:**
- `app/globalconfigs.h` (866 lines)
- `app/globalconfigs.cpp` (819 lines)
- `app/globalconfigsfilemanager.h` — **FILE NOT FOUND** (does not exist in repository)
- `app/globalconfigsfilemanager.cpp` — **FILE NOT FOUND** (does not exist in repository)

---

## 1. Reading Evidence

### 1.1 `app/globalconfigs.h` / `app/globalconfigs.cpp`

#### Class

| Class | Base | Line |
|-------|------|------|
| `GlobalConfigs` | `QObject` | 15 |

#### Macro / Global Accessor

| Name | Line | Description |
|------|------|-------------|
| `gCfg` | 13 | Macro expanding to `GlobalConfigs::instance()` |

#### Public Methods (header line numbers)

| Method | Line | Notes |
|--------|------|-------|
| `GlobalConfigs(QObject *parent = nullptr)` | 20 | Constructor |
| `static GlobalConfigs *instance()` | 21 | Singleton accessor |
| `static quint32 crc32(const void *buf, int len)` | 22 | CRC-32 utility |
| `void readConfigs()` | 24 | Loads all config sub-systems |
| `void saveConfigs()` | 25 | Saves all config sub-systems |
| `void saveOpdDriverList()` | 26 | Saves once-per-day preop driver list |
| `void resetConfigs(bool resetAll = false)` | 27 | Resets config to defaults |
| `quint32 keepAliveTime() const` | 30 | Getter |
| `bool setKeepAliveTime(quint32 time)` | 31 | Setter — validates 0 < time <= 60000 |
| `quint32 shutdownTime() const` | 40 | Getter |
| `bool setShutdownTime(quint32 time)` | 41 | Setter — validates 0 < time <= 255 |
| `QByteArray gmtpId() const` | 50 | Getter |
| `bool setGmtpId(const QByteArray &id)` | 51 | Setter — validates non-empty, size < GMTP_ID_LEN |
| `CIGCONF::MaintLockedCode maintCode() const` | 60 | Getter |
| `quint64 maintDriverId() const` | 61 | Getter |
| `quint32 maintTimestamp() const` | 62 | Getter |
| `bool setMaintCode(CIGCONF::MaintLockedCode code)` | 64 | Setter — validates code whitelist; blocks overwrite of non-zero code |
| `quint64 unlockId() const` | 81 | Getter |
| `bool setUnlockId(quint64 id)` | 82 | Setter — always returns true |
| `QByteArray dialNumber() const` | 87 | Getter |
| `bool setDialNumber(const QByteArray &number)` | 88 | Setter — validates size < MODEM_DIAL_NUMBER_LEN |
| `QByteArray apn() const` | 97 | Getter |
| `bool setApn(const QByteArray &apn)` | 98 | Setter |
| `QByteArray apnUser() const` | 107 | Getter |
| `bool setApnUser(const QByteArray &user)` | 108 | Setter |
| `QByteArray apnPassword() const` | 117 | Getter |
| `bool setApnPassword(const QByteArray &password)` | 118 | Setter |
| `QByteArray gmtpServerAddress(int index) const` | 127 | Getter — no bounds check on read |
| `bool setGmtpServerAddress(int index, const QByteArray &addr)` | 128 | Setter — validates index, addr size |
| `quint16 gmtpServerPort(int index) const` | 137 | Getter — no bounds check on read |
| `bool setGmtpServerPort(int index, quint16 port)` | 138 | Setter — validates index, port != 0 |
| `quint64 expansionModMac() const` | 147 | Getter |
| `bool setExpansionModMac(quint64 mac)` | 148 | Setter — validates mac != 0 |
| `void resetSimCardID()` | 157 | Clears SIM ICCID buffer |
| `QByteArray getSimCardID() const` | 158 | Getter |
| `bool setSimCardID(const QByteArray &iccid)` | 159 | Setter — validates size < MODEM_ICCID_LEN |
| `QList<CIGCONF::DriverId> driverIds() const` | 168 | Getter |
| `QList<CIGCONF::MasterId> masterIds() const` | 169 | Getter |
| `QList<quint64> superIds() const` | 170 | Getter |
| `QList<CIGCONF::DriverId> techIds() const` | 171 | Getter |
| `QList<CIGCONF::PreopDriverId> preopDriverIds() const` | 172 | Getter |
| `CIGCONF::DriverId driverId(int index) const` | 174 | Getter by index |
| `CIGCONF::MasterId masterId(int index) const` | 175 | Getter by index |
| `CIGCONF::MasterId masterIdById(quint64 id) const` | 176 | Getter by ID |
| `quint64 superId(int index) const` | 177 | Getter by index |
| `CIGCONF::DriverId techId(int index) const` | 178 | Getter by index |
| `bool setDriverId(int index, quint64 id, QString name)` | 180 | Setter — delegates to DriverList |
| `bool setMasterId(int index, quint64 id, quint8 option, QString name)` | 181 | Setter |
| `bool setSuperId(int index, quint64 id)` | 182 | Setter — emits superListChanged |
| `bool setTechId(int index, quint64 id, QString name)` | 183 | Setter |
| `bool containsDriverId(quint64 id) const` | 185 | Lookup |
| `bool containsMasterId(quint64 id, quint8 permissions=0) const` | 186 | Lookup |
| `bool containsSuperId(quint64 id) const` | 187 | Lookup |
| `bool containsTechId(quint64 id) const` | 188 | Lookup |
| `bool addDriverId(quint64 id, QString name)` | 190 | Add to driver list |
| `bool addSuperId(quint64 id)` | 191 | Add to super list — emits superListChanged |
| `bool addTechId(quint64 id, QString name)` | 192 | Add to tech list |
| `bool addPreopDriverId(quint64 id, quint32 timestamp)` | 193 | Add preop driver |
| `bool removeDriverId(quint64 id)` | 195 | Remove from driver list |
| `bool removeMasterId(quint64 id)` | 196 | Remove from master list |
| `bool removeSuperId(quint64 id)` | 197 | Remove — emits superListChanged |
| `bool removeTechId(quint64 id)` | 198 | Remove from tech list |
| `void clearDriverIds()` | 200 | Clear driver list |
| `void clearMasterIds()` | 201 | Clear master list |
| `void clearSuperIds()` | 202 | Clear super list — emits superListChanged |
| `void clearTechIds()` | 203 | Clear tech list |
| `void clearPreopDriverIds()` | 204 | Clear preop driver list |
| `int getMasterIdIndex(quint64 id)` | 206 | Index lookup |
| `int getDriverIdIndex(quint64 id)` | 207 | Index lookup |
| `int getTechIdIndex(quint64 id)` | 208 | Index lookup |
| `int getPreopDriverIdIndex(quint64 id)` | 209 | Index lookup |
| `CIGCONF::PreopDriverId getPreopDriverId(quint64 id)` | 210 | Lookup by ID |
| `bool preopOncePerDayEn() const` | 212 | Getter |
| `bool setPreopOncePerDayEn(bool en)` | 213 | Setter — emits preopOncePerDayStatusChanged |
| `QString getDriverName(quint64 id)` | 220 | Returns name from any driver list |
| `bool superIsEmpty()` | 233 | Returns whether super list is empty |
| `quint8 digitalInputMode1() const` | 235 | Getter |
| `quint8 digitalInputMode2() const` | 236 | Getter |
| `quint8 digitalInputMode3() const` | 237 | Getter |
| `quint8 digitalInputMode4() const` | 238 | Getter |
| `void setDigInputMode(...)` | 240 | Setter for all 4 digital input modes |
| `quint32 seenDebounceTime() const` | 248 | Getter |
| `quint32 seenHoldTime() const` | 249 | Getter |
| `bool setSeenParam(quint32 debounce, quint32 hTime)` | 250 | Setter |
| `quint8 convorStatus() const` | 257 | Getter |
| `quint64 convorId() const` | 258 | Getter |
| `bool setConvor(quint8 convor, quint64 id)` | 259 | Setter — emits convorStatusChanged; side-effect: clears last check timestamp |
| `quint8 fullLockoutEnable() const` | 270 | Getter |
| `bool setFullLockoutEnable(quint8 lockOutEnable)` | 271 | Setter |
| `quint32 fullLockoutTimeout() const` | 277 | Getter |
| `bool setFullLockoutTimeout(quint32 lockOutTimeout)` | 278 | Setter |
| `quint8 unlkScr() const` | 284 | Getter |
| `bool setUnlkScr(quint8 scr)` | 285 | Setter — validates scr <= EnabledMandatory |
| `quint8 scrSavMode() const` | 294 | Getter |
| `bool setScrSavMode(quint8 mode)` | 295 | Setter — validates mode <= 1 |
| `quint16 checkTimeSlot(int index) const` | 304 | Getter — no bounds check on read |
| `bool setCheckTimeSlot(int index, quint16 hm)` | 305 | Setter |
| `quint16 checklistTimeout() const` | 314 | Getter |
| `bool setChecklistTimeout(quint16 time)` | 315 | Setter — validates time <= 6000 |
| `quint64 lastTimeServerUpdate() const` | 324 | Getter |
| `bool setLastTimeServerUpdate(quint64 ts)` | 325 | Setter |
| `qint64 timeError() const` | 330 | Getter |
| `bool setTimeError(qint64 ts)` | 331 | Setter |
| `quint32 lastPreopOncePerDayTimestamp() const` | 336 | Getter |
| `bool setlastPreopOncePerDayTimestamp(quint32 ts)` | 337 | Setter — persists immediately |
| `quint32 lastCheckTimestamp() const` | 344 | Getter |
| `bool setLastCheckTimestamp(quint32 ts)` | 345 | Setter — persists immediately |
| `quint64 lastCheckDriverId() const` | 352 | Getter |
| `bool setLastCheck(quint64 id, quint32 ts)` | 353 | Setter — updates both timestamp and driver ID, persists |
| `void clearChecklist()` | 361 | Clears checklist |
| `Checklist::CheckItem checkItem(int index, bool query = false)` | 362 | Getter |
| `bool setCheckItem(int index, const Checklist::CheckItem item)` | 363 | Setter |
| `int nextValidCheckItemIndex(int start = 0, bool queryOrigList = false)` | 367 | Returns next valid checklist item index |
| `void shuffleChecklist()` | 374 | Randomizes checklist order |
| `quint8 preopRandom() const` | 375 | Getter |
| `bool setPreopRandom(quint8 isRandom)` | 376 | Setter |
| `quint32 shockThreshold() const` | 382 | Getter |
| `bool setShockThreshold(quint32 data)` | 383 | Setter |
| `quint32 shockRedImpact() const` | 389 | Getter |
| `bool setShockRedImpact(quint32 data)` | 390 | Setter |
| `quint32 shockPeriod() const` | 396 | Getter |
| `bool setShockPeriod(quint32 data)` | 397 | Setter |
| `quint32 shockTimer() const` | 403 | Getter |
| `bool setShockTimer(quint32 data)` | 404 | Setter |
| `qint16 timeZoneInMinutes() const` | 410 | Getter |
| `bool setTimeZoneInMinutes(qint16 zone)` | 411 | Setter — validates -720 <= zone <= 840 |
| `QByteArray timeServerAddress() const` | 419 | Getter |
| `bool setTimeServerAddress(const QByteArray &addr)` | 420 | Setter |
| `quint32 gpsUpdateTime() const` | 429 | Getter |
| `bool setGpsUpdateTime(quint32 time)` | 430 | Setter — validates time != 0 |
| `qint16 gpsDistanceMark() const` | 439 | Getter |
| `bool setGpsDistanceMark(qint16 mark)` | 440 | Setter — validates mark != 0 |
| `quint16 satNum() const` | 449 | Getter |
| `bool setSatNum(quint16 n)` | 450 | Setter — validates 0 < n < 21 |
| `quint16 idleTimeout() const` | 459 | Getter |
| `bool setIdleTimeout(quint16 time)` | 460 | Setter — no validation |
| `quint16 getGmtpWaitTimeout() const` | 466 | Getter |
| `bool setGmtpWaitTimeout(quint16 time)` | 467 | Setter — no validation |
| `bool idleInputPolarity() const` | 473 | Getter |
| `bool setIdleInputPolarity(bool high)` | 474 | Setter |
| `quint8 idleInputSource() const` | 480 | Getter |
| `bool setIdleInputSource(quint8 src)` | 481 | Setter — validates allowed bitmask values |
| `CIGCONF::polygonStruct polygon(int n) const` | 490 | Getter — no bounds check |
| `quint8 polygonNPoints(int n) const` | 492 | Getter — no bounds check |
| `bool setPolygonNPoints(int n, quint8 vect)` | 493 | Setter |
| `quint32 polygonLatitude(int n, int vect) const` | 502 | Getter — no bounds check |
| `bool setPolygonLatitude(int n, int vect, quint32 lat)` | 503 | Setter |
| `quint32 polygonLongitude(int n, int vect) const` | 512 | Getter — no bounds check |
| `bool setPolygonLongitude(int n, int vect, quint32 lon)` | 513 | Setter |
| `quint32 configVersion() const` | 524 | Getter |
| `quint8 backlight() const` | 526 | Getter |
| `quint32 checksum() const` | 527 | Getter |
| `CIGCONF::ConfigErrorCode configErrorCode() const` | 529 | Getter |
| `void readPreopDriverIds()` | 531 | Triggers preop driver list read |
| `void readDriverIds()` | 532 | Triggers driver list read |
| `void readMasterIds()` | 533 | Triggers master list read |
| `void readSuperIds()` | 534 | Triggers super list read — emits superListChanged |
| `void readTechIds()` | 535 | Triggers tech list read |
| `void readChecklist()` | 536 | Triggers checklist read |
| `quint32 driverChecksum() const` | 537 | Getter |
| `quint32 masterChecksum() const` | 538 | Getter |
| `quint32 superChecksum() const` | 539 | Getter |
| `quint32 questionChecksum() const` | 540 | Getter |
| `quint32 timestamp() const` | 542 | Returns current UTC Unix epoch (seconds) |
| `quint32 localTimestamp() const` | 543 | Returns local time Unix epoch (seconds) |
| `QDateTime localTime() const` | 545 | Returns local QDateTime adjusted by timezone |
| `quint64 clockTime() const` | 547 | Returns monotonic clock in ms (ARM only; returns 0 on other platforms) |
| `QString preopCommentString() const` | 557 | Getter |
| `void setPreopCommentString(QString msg)` | 558 | Setter |
| `QString UnlkReasonString() const` | 560 | Getter |
| `void setUnlkReasonString(QString msg)` | 561 | Setter |
| `CIGCONF::RealImpact UnlkOption() const` | 563 | Getter |
| `void setUnlkOption(CIGCONF::RealImpact option)` | 564 | Setter |
| `quint64 currentDriverId() const` | 566 | Getter |
| `void setCurrentDriverId(quint64 id)` | 567 | Setter |
| `quint64 fwVersion()` | 569 | Returns packed firmware version |
| `QString fwVersionString()` | 570 | Returns firmware version as human-readable string |
| `quint32 onDemandStartTime() const` | 573 | Getter |
| `quint32 onDemandEndTime() const` | 574 | Getter |
| `quint64 onDemandSmId() const` | 575 | Getter |
| `void setOnDemand(quint32 start, quint32 end, quint64 id)` | 577 | Setter — persists immediately |
| `void clearOnDemand()` | 583 | Clears on-demand config — persists immediately |
| `bool onDemandActive()` | 585 | Returns true if super list is non-empty |
| `bool onDemandVehicleEnabled()` | 586 | Returns true if on-demand window is active |
| `bool setWifiNetwork(quint32 index, const QByteArray &ssid, const QByteArray &pw)` | 588 | Setter — validates SSID/pw lengths |
| `CIGCONF::WifiNetwork wifiNetwork(quint32 index) const` | 589 | Getter |
| `bool setWifiCountry(const QByteArray &country)` | 591 | Setter — validates 2-char country code |
| `QByteArray wifiCountry() const` | 592 | Getter |
| `void clearWifiConfig()` | 594 | Resets Wi-Fi config to defaults |
| `quint8 wifiPos() const` | 596 | Getter |
| `quint16 wifiPosInterval() const` | 597 | Getter |
| `CIGCONF::WifiPosSource wifiPosSource() const` | 598 | Getter |
| `bool setWifiPos(...)` | 599 | Setter |
| `bool isRs232AccessoryActive()` | 606 | Returns true if RS-232 accessory is in use |
| `qint16 debugMsg() const` | 608 | Getter |
| `void setDebugMsg(qint16 n)` | 609 | Setter |
| `qint16 debugSpn() const` | 611 | Getter |
| `void setDebugSpn(qint16 n)` | 612 | Setter |
| `quint32 geofenceState() const` | 614 | Getter |
| `void setGeofenceState(quint32 state)` | 615 | Setter |
| `quint8 showDriverName() const` | 617 | Getter |
| `bool setShowDriverName(quint8 show)` | 618 | Setter |
| `bool GPSMsgLogEn() const` | 624 | Getter |
| `void setGPSMsgLogEn(bool en)` | 625 | Setter |
| `quint8 showPreopComment() const` | 630 | Getter |
| `void setShowPreopComment(quint8 show)` | 631 | Setter |
| `quint8 amberImpactAlertActive() const` | 636 | Getter |
| `void setAmberImpactAlertActive(quint8 state)` | 637 | Setter |
| `quint8 idleLockout() const` | 642 | Getter |
| `bool setIdleLockout(quint8 en)` | 643 | Setter |
| `quint8 showPreopSummary() const` | 649 | Getter |
| `void setShowPreopSummary(quint8 show)` | 650 | Setter |
| `quint8 unlockMode() const` | 655 | Getter |
| `void setUnlockMode(quint8 mode)` | 656 | Setter — no validation of mode value |
| `quint8 forceChecklist() const` | 661 | Getter |
| `bool setForceChecklist(quint8 force)` | 662 | Setter — persists immediately |
| `quint8 showTime() const` | 669 | Getter |
| `void setShowTime(quint8 format)` | 670 | Setter |
| `quint8 vdiMode() const` | 675 | Getter |
| `void setVdiMode(quint8 mode)` | 676 | Setter |
| `CIGCONF::CameraMode cameraMode() const` | 681 | Getter |
| `void setCameraMode(CIGCONF::CameraMode mode)` | 682 | Setter |
| `quint8 cameraFlip() const` | 687 | Getter |
| `void setCameraFlip(quint8 flip)` | 688 | Setter |
| `QByteArray lastSessionDriver() const` | 693 | Getter |
| `QByteArray lastSessionStart() const` | 694 | Getter |
| `QByteArray lastSessionEnd() const` | 695 | Getter |
| `void setLastSessionDriver(const QByteArray& driver)` | 696 | Setter — marks dynDirty but does not persist immediately |
| `void setLastSessionStart(const QByteArray& start)` | 700 | Setter — marks dynDirty but does not persist immediately |
| `void setLastSessionEnd(const QByteArray& end)` | 704 | Setter — marks dynDirty but does not persist immediately |

#### Signals

| Signal | Line | Description |
|--------|------|-------------|
| `superListChanged(bool empty)` | 710 | Emitted when super (supervisor) driver list changes |
| `convorStatusChanged()` | 711 | Emitted when VOR/convor status changes |
| `preopOncePerDayStatusChanged()` | 712 | Emitted when once-per-day preop enable flag changes |

#### Private Types (inner structs defined in header)

| Type | Line | Description |
|------|------|-------------|
| `ConfigsData` (struct) | 715 | Binary-serialized primary config block with magic code and CRC |
| `ConfigsDataExt` (struct) | 760 | Extension config (unlock screen setting) |
| `OnDemandData` (struct) | 764 | On-demand access window config |
| `ConvorData` (struct) | 780 | VOR/convor status |
| `DigitalInputCfg` (struct) | 788 | 4-channel digital input configuration |
| `FullLockoutData` (struct) | 835 | Full lockout enable + timeout |

#### Enums / Constants (from `app/cigconfigs.h`, consumed throughout)

Key types visible and used in `GlobalConfigs` interface:

| Name | Kind | Relevant values |
|------|------|-----------------|
| `CIGCONF::MaintLockedCode` | enum | `MaintNormal`, `MaintIdle`, `MaintCriticalQuestion`, `MaintRedImpact`, `MaintSurveyTimeout` |
| `CIGCONF::ConfigErrorCode` | enum | `NoConfigError`, `ConfigCrcError`, `ConfigAddressError`, `ConfigSizeError`, `ConfigSectorError` |
| `CIGCONF::RealImpact` | enum | `Unconfirmed`, `No`, `Yes` |
| `CIGCONF::UnlockReasonScreen` | enum | `Disabled`, `EnabledOptional`, `EnabledMandatory` |
| `CIGCONF::CameraMode` | enum | `CameraOff`, `CameraForced`, `CameraOn` |
| `CIGCONF::ShowTimeFormat` | enum | `ShowTimeOff`, `ShowTime12`, `ShowTime24` |
| `CIGCONF::WifiPosSource` | enum | `WifiPosInternal`, `WifiPosXpico240` |
| `CIGCONF::DriverId` | struct | `id`, `name` |
| `CIGCONF::MasterId` | struct | `id`, `option`, `name` |
| `CIGCONF::PreopDriverId` | struct | `id`, `lastPreopTimestamp` |
| `CIGCONF::polygonStruct` | struct | `nPoints`, `polyVertices[]` |
| `CIGCONF::WifiNetwork` | struct | `ssid`, `pw` |
| `GMTP_ID_LEN` | macro constant | 33 |
| `GMTP_SERVER_CNT` | macro constant | 3 |
| `CHECKLIST_TIME_SLOTS` | macro constant | 4 |
| `CHECKLIST_MAX_IDX` | macro constant | 32 |
| `MAX_POLY` | macro constant | 4 |
| `MAX_POLY_POINTS` | macro constant | 6 |
| `WIFI_MAX_NETWORKS` | macro constant | 10 |
| `MODEM_ICCID_LEN` | macro constant | 32 |
| `MODEM_APN_PASSWORD_LEN` | macro constant | 66 |

### 1.2 `app/globalconfigsfilemanager.h` / `app/globalconfigsfilemanager.cpp`

These files were listed as assigned targets but **do not exist** in the repository. A filesystem search (`Glob`) for `**/globalconfigsfilemanager*` returned no results. No findings can be raised for absent files.

---

## 2. Documentation Check Results

No doc comments of any form (`///`, `/** */`, `//`) appear above any public method declaration in `globalconfigs.h`. The only inline comments present are:

- A section boundary comment `// --> AT command` (line 29) and `// <-- AT command` (line 522) that mark a group of AT-configurable setters/getters as a block, but provide no per-method documentation.
- The comment `//MK3-301` (line 156) is a ticket reference, not a doc comment.
- Inline member-variable comments exist inside private structs (`ConfigsData`, etc.) but these are not doc comments on public methods.

With zero doc comments on any public method, all findings below address missing documentation at the appropriate severity level determined by method complexity and safety criticality.

---

## 3. Findings

**A05-1** · HIGH · No documentation on `crc32()` — security-critical integrity function

**Description:** `static quint32 crc32(const void *buf, int len)` (line 22) is used directly in `readConfigs()` and `saveConfigs()` to validate the integrity of the primary binary config block (`fmscfg.dat`). There is no doc comment describing the algorithm used (table-driven CRC-32/ISO-HDLC as confirmed in the implementation), the expected input, the meaning of the return value, or the fact that CRC-32 is a non-cryptographic integrity check. Callers who add future integrity checks may incorrectly assume collision-resistance properties that CRC-32 does not provide.

**Fix:** Add a comment above the declaration documenting: (1) algorithm identity (CRC-32/ISO-HDLC); (2) parameters `buf` (pointer to data) and `len` (byte count); (3) return value (32-bit checksum); (4) a note that this is an integrity check only and is not a cryptographic hash.

---

**A05-2** · HIGH · No documentation on `setMaintCode()` — safety-critical access-control method

**Description:** `bool setMaintCode(CIGCONF::MaintLockedCode code)` (line 64) implements non-trivial business logic that directly controls the maintenance lock state of the vehicle access system: it validates the code against an explicit whitelist, prevents overwriting a non-zero code unless the new code is zero, records the current driver ID and a timestamp, marks the dynamic config dirty, and immediately persists the change. None of this behaviour is described. Developers maintaining the maintenance-lock workflow cannot determine the state-transition rules from the declaration alone.

**Fix:** Add a doc comment above the declaration describing: (1) which codes are valid and why `MaintForceChecklist` or similar hypothetical codes are absent; (2) the one-way state-change rule (`if (m_configs.maint.code && code != 0) return false`); (3) that the change is immediately persisted; (4) what the return value means.

---

**A05-3** · HIGH · No documentation on `resetConfigs()` — data-destructive factory-reset method

**Description:** `void resetConfigs(bool resetAll = false)` (line 27) is a data-destructive operation that zeroes all config structs and restores factory defaults. The `resetAll` parameter controls whether driver lists, super lists, and on-demand/VOR data are also wiped. This distinction is undocumented. Callers cannot determine what `resetAll = false` preserves (APN credentials are preserved; driver lists are not wiped; OD/VOR data are preserved) versus what `resetAll = true` destroys.

**Fix:** Add a doc comment documenting: (1) what is always reset (FMS config block, digital inputs, timers, Wi-Fi, defaults); (2) what `resetAll = true` additionally resets (driver/master/super/tech lists, OD config, VOR config); (3) that APN credentials are intentionally preserved even when `resetAll = false`.

---

**A05-4** · HIGH · No documentation on `readConfigs()` and `saveConfigs()` — primary persistence entry points

**Description:** `void readConfigs()` (line 24) and `void saveConfigs()` (line 25) are the top-level entry points for loading and persisting all device configuration. `readConfigs()` has a non-obvious fallback path: it first tries the INI-format `fms.ini`, and only falls back to the legacy binary `fmscfg.dat` if the INI read fails; it also conditionally shuffles the checklist and loads preop driver IDs based on runtime flags. `saveConfigs()` orchestrates saves across six subsystems. Neither method has any documentation. The dual-format read path is particularly risky because a future developer unaware of the fallback could corrupt or ignore the binary config silently.

**Fix:** Add doc comments for both methods describing the read order, the INI-first/binary-fallback strategy for `readConfigs()`, error outcomes, and the list of subsystems persisted by `saveConfigs()`.

---

**A05-5** · MEDIUM · Inaccurate/misleading name and no documentation on `onDemandActive()`

**Description:** `bool onDemandActive()` (line 585) is documented only by its name, which implies it returns true when an on-demand access window is currently active. However, the implementation returns `!gCfg->superIsEmpty()` — i.e., it returns true whenever the supervisor list is non-empty, regardless of whether the on-demand time window (`startTime` / `endTime`) has expired or even been set. The adjacent `onDemandVehicleEnabled()` (line 586) performs the time-window check. The mismatch between the name and behaviour creates a risk that callers will use the wrong predicate to gate on-demand access decisions.

**Fix:** Add a doc comment making the distinction explicit: "`onDemandActive()` returns true if any supervisor ID is enrolled (super list non-empty). It does NOT check the time window. Use `onDemandVehicleEnabled()` to test whether the on-demand window is currently open." Additionally, consider renaming the method to `hasSupervisors()` in a future refactor.

---

**A05-6** · MEDIUM · No documentation on `setConvor()` — undocumented side-effect clears checklist timestamp

**Description:** `bool setConvor(quint8 convor, quint64 id)` (line 259) has a hidden side-effect: unconditionally calls `gCfg->setLastCheckTimestamp(0)` on every call, even when the convor status has not changed. This causes the last-check timestamp to be cleared and immediately persisted to disk regardless of the new convor value. This side-effect is nowhere documented and is surprising: a setter for VOR status silently resets the checklist timestamp. The method also emits `convorStatusChanged()` only when the status actually changes, creating an asymmetry between the two effects that is undocumented.

**Fix:** Add a doc comment describing: (1) that `convorStatusChanged()` is emitted only on status change; (2) that `lastCheckTimestamp` is unconditionally reset to 0 on every call; (3) the meaning of the `id` parameter (the driver or entity initiating the VOR change).

---

**A05-7** · MEDIUM · No documentation on `setMaintCode()` state-transition guard (duplicate aspect of A05-2, separate concern)

*(Merged into A05-2 above — not repeated as a separate finding.)*

---

**A05-8** · LOW · No documentation on `setWifiNetwork()` — non-trivial validation logic

**Description:** `bool setWifiNetwork(quint32 index, const QByteArray &ssid, const QByteArray &pw)` (line 588) enforces several constraints drawn from WPA2 spec: password must be 8–63 bytes, SSID must be 1–32 bytes, and `index` must be within bounds. None of these constraints are documented on the declaration. A caller setting a Wi-Fi network who receives `false` has no way to determine which constraint failed.

**Fix:** Add a doc comment listing the validation rules and indicating that `false` is returned on any violation.

---

**A05-9** · LOW · No documentation on `clockTime()` — platform-conditional return

**Description:** `quint64 clockTime() const` (line 547) returns the monotonic clock in milliseconds on ARM targets and always returns 0 on all other platforms (the non-ARM branch is an empty `return 0`). This platform dependency is undocumented on the declaration. Code that uses `clockTime()` for elapsed-time calculations on non-ARM builds (e.g., host-side tests or a future Linux port) will silently receive 0.

**Fix:** Add a doc comment noting that the return value is in milliseconds, that it uses `CLOCK_MONOTONIC`, and that it returns 0 on non-ARM platforms.

---

**A05-10** · LOW · No documentation on `nextValidCheckItemIndex()` — non-obvious iteration semantics

**Description:** `int nextValidCheckItemIndex(int start = 0, bool queryOrigList = false)` (line 367) searches for the next index `>= start` in the checklist that passes `Checklist::isValidCheckItem()`. It returns -1 if none is found. The `queryOrigList` parameter controls whether the shuffled or the original list is consulted. Neither the return convention (`-1` on not-found) nor the `queryOrigList` semantics are documented.

**Fix:** Add a doc comment documenting: the search range, the -1 sentinel return, and the meaning of `queryOrigList`.

---

**A05-11** · LOW · No documentation on `setLastCheck()` — dual-field atomic update with immediate persistence

**Description:** `bool setLastCheck(quint64 id, quint32 ts)` (line 353) atomically updates both `lastCheckDriverId` and `lastCheckTimestamp` and immediately persists the dynamic config. Callers who need to update only one field might use the separate `setLastCheckTimestamp()` and be unaware that `setLastCheck()` exists as a combined form. The immediate persistence (vs. deferred dirty flag) is also undocumented.

**Fix:** Add a doc comment noting: (1) that both fields are updated atomically; (2) that the dynamic config is persisted immediately; (3) when to prefer this over calling the individual setters.

---

**A05-12** · LOW · No documentation on `fwVersion()` — opaque bitfield packing

**Description:** `quint64 fwVersion()` (line 569) returns a 64-bit value whose bit layout (`F_BUILD << 56 | C_BUILD << 48 | LFF_VERSION << 32 | SFF_VERSION << 16 | UFF_VERSION`) is entirely undocumented. The complementary `fwVersionString()` exists but it omits `F_BUILD` and `C_BUILD` from its output. A receiver of the `quint64` value must reverse-engineer the packing to decode version components.

**Fix:** Add a doc comment documenting the bit-field layout: bits 63–56 = F_BUILD, bits 55–48 = C_BUILD, bits 47–32 = LFF_VERSION, bits 31–16 = SFF_VERSION, bits 15–0 = UFF_VERSION.

---

**A05-13** · INFO · Missing doc comments on simple getter/setter pairs (bulk)

**Description:** The following groups of public methods have no doc comments, but are simple getters or setters whose names and types are reasonably self-explanatory. Documenting them is desirable but low priority:

- All `keepAliveTime` / `shutdownTime` / `gmtpId` getter/setter pairs (lines 30–58)
- All APN credential getter/setter pairs (lines 97–125)
- All shock-parameter getter/setter pairs (lines 382–408)
- All session-tracking getter/setter pairs (`lastSessionDriver`, `lastSessionStart`, `lastSessionEnd`, lines 693–707)
- All display-mode getter/setter pairs (`showDriverName`, `showPreopComment`, `showPreopSummary`, `showTime`, lines 617–673)
- All driver-list `contains*`, `add*`, `remove*`, `clear*` and `get*Index` wrappers (lines 185–210)

**Fix:** Consider adding brief one-line doc comments, especially for the validation constraints embedded in the setters (e.g., `setShutdownTime` accepts 1–255; `setChecklistTimeout` accepts 0–6000).

---

**A05-14** · INFO · `saveOpdDriverList()` name does not match its documented comment section

**Description:** `void saveOpdDriverList()` (line 26) is grouped with `readConfigs()` / `saveConfigs()` / `resetConfigs()` as a lifecycle method, but it has no comment explaining that "OPD" stands for "Once Per Day" preop, or that it conditionally saves only when `preopOncePerDayEn()` is true. The abbreviation "Opd" is used inconsistently alongside "OncePerDay" in the codebase.

**Fix:** Add a brief comment: "Saves the once-per-day preop driver list if the once-per-day feature is enabled."

---

## 4. Summary Table

| ID | Severity | Title |
|----|----------|-------|
| A05-1 | HIGH | No documentation on `crc32()` — security-critical integrity function |
| A05-2 | HIGH | No documentation on `setMaintCode()` — safety-critical access-control method |
| A05-3 | HIGH | No documentation on `resetConfigs()` — data-destructive factory-reset method |
| A05-4 | HIGH | No documentation on `readConfigs()` / `saveConfigs()` — primary persistence entry points |
| A05-5 | MEDIUM | Inaccurate/misleading semantics and no documentation on `onDemandActive()` |
| A05-6 | MEDIUM | No documentation on `setConvor()` — undocumented side-effect clears checklist timestamp |
| A05-8 | LOW | No documentation on `setWifiNetwork()` — non-trivial validation logic |
| A05-9 | LOW | No documentation on `clockTime()` — platform-conditional return value |
| A05-10 | LOW | No documentation on `nextValidCheckItemIndex()` — non-obvious iteration semantics |
| A05-11 | LOW | No documentation on `setLastCheck()` — dual-field atomic update with immediate persistence |
| A05-12 | LOW | No documentation on `fwVersion()` — opaque bitfield packing |
| A05-13 | INFO | Missing doc comments on simple getter/setter pairs (bulk) |
| A05-14 | INFO | `saveOpdDriverList()` name does not match abbreviated purpose |

**Counts:** 4 HIGH, 2 MEDIUM, 5 LOW, 2 INFO

**Note on assigned files:** `app/globalconfigsfilemanager.h` and `app/globalconfigsfilemanager.cpp` were listed as assigned targets but do not exist in the repository. No findings are raised for absent files.
