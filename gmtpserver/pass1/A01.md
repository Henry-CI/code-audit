# Security Audit Pass 1 — Agent A01
**Repository:** gmtpserver
**Branch:** master (verified)
**Date:** 2026-02-28
**Agent:** A01 — Config, deployment, and project files

---

## Reading Evidence

### C:/Projects/cig-audit/repos/gmtpserver/.gitignore
**Purpose:** Specifies files excluded from git tracking.
**Patterns defined:** `node_modules/`, `dist/`, `*.class`, `*.py[cod]`, `*.log`, `*.jar`, `target/`, `.idea/`, `TEST*.xml`, `.DS_Store`, `Thumbs.db`, `*.app`, `*.exe`, `*.war`, media file extensions.
**Credentials / secrets / IPs present:** None.
**Notable absences:** No exclusions for `*.properties`, `*.xml`, `nbproject/private/`, `.env`, or any credential-bearing config files.

---

### C:/Projects/cig-audit/repos/gmtpserver/build.xml
**Purpose:** NetBeans/Ant primary build file.
**Targets defined:** `-post-jar` (copies JAR + config files to `server/` folder).
**Imports:** `nbproject/build-impl.xml`
**Paths referenced:** `${basedir}/server`, `${dist.dir}`, `${basedir}/installer`, `${basedir}/routes`
**Credentials / secrets / IPs present:** None hardcoded.

---

### C:/Projects/cig-audit/repos/gmtpserver/deniedPrefixes.xml
**Purpose:** Defines routing prefix deny list.
**Elements:** `<denied>`, `<prefix id="0">tms</prefix>`
**Credentials / secrets / IPs present:** None.

---

### C:/Projects/cig-audit/repos/gmtpserver/ftpUsers.properties
**Purpose:** FTP user credential store (referenced in gmtpRouter.xml as `<ftpUserFile>`).
**Content:** Empty (0 bytes).
**Credentials / secrets / IPs present:** File is empty; no credentials visible.

---

### C:/Projects/cig-audit/repos/gmtpserver/gmtpRouter.xml
**Purpose:** Main runtime configuration file for the GMTP server.
**Elements defined:**
- `<port>4687</port>` — main listener port
- `<ioThreads>5</ioThreads>`
- `<maxWorkerThreads>256</maxWorkerThreads>`
- `<routesFolder>./routes</routesFolder>`
- `<deniedPrefixesFile>deniedPrefixes.xml</deniedPrefixesFile>`
- `<connectionPoolSize>100</connectionPoolSize>`
- `<tcpNoDelay>true</tcpNoDelay>`
- `<outgoingDelay>1000</outgoingDelay>`
- `<reloadConfigInterval>30</reloadConfigInterval>`
- `<outgoingInterval>30</outgoingInterval>`
- `<outgoingResendInterval>60</outgoingResendInterval>`
- `<dbHost>127.0.0.1</dbHost>` — primary DB host
- `<dbName>GlobalSettings</dbName>` — primary DB name
- `<dbPort>5432</dbPort>` — primary DB port (PostgreSQL)
- `<dbUser>gmtp</dbUser>` — primary DB username
- `<dbPass>gmtp-postgres</dbPass>` — **HARDCODED PRIMARY DB PASSWORD**
- `<dbHostDefault>127.0.0.1</dbHostDefault>` — default DB host
- `<dbNameDefault>fleetiq360_dup</dbNameDefault>` — default DB name (reveals product name)
- `<dbPortDefault>5432</dbPortDefault>`
- `<dbUserDefault>gmtp</dbUserDefault>` — default DB username
- `<dbPassDefault>gmtp-postgres</dbPassDefault>` — **HARDCODED DEFAULT DB PASSWORD**
- `<telnetPort>9494</telnetPort>` — telnet management port
- `<telnetUser>gmtp</telnetUser>` — **HARDCODED TELNET USERNAME**
- `<telnetPassword>gmtp!telnet</telnetPassword>` — **HARDCODED TELNET PASSWORD**
- `<manageFTP>false</manageFTP>`
- `<ftpServer>127.0.0.1</ftpServer>`
- `<ftpPort>2221</ftpPort>`
- `<ftpUserFile>ftpUsers.properties</ftpUserFile>`
- `<ftpRoot>/home/gmtp/gmtpPublicFtp/</ftpRoot>`
- `<ftpMaxConnection>1000</ftpMaxConnection>`
- `<ftpExternalAddr>203.35.168.201</ftpExternalAddr>` — **PUBLIC IP ADDRESS**
- `<ftpPassivePorts>2222-2229</ftpPassivePorts>`
- `<ftpimagetype>jpg</ftpimagetype>`

**XML malformation:** Line 32 contains a stray `th` outside any element tag: `<tcpNoDelay>true</tcpNoDelay>th`

---

### C:/Projects/cig-audit/repos/gmtpserver/gmtpmina.properties
**Purpose:** IntelliJ IDEA build properties (path variables).
**Properties defined:**
- `path.variable.grails_home=/Users/davec/tools/grails-1.0.4`
- `path.variable.maven_repository=/Users/davec/.m2/repository`
- `jdk.home.1.6=/usr/lib/jvm/java-6-openjdk/`
- `deploy.path=/home/gmtp/GmtpMina`

**Credentials / secrets / IPs present:** Developer home directory paths (`/Users/davec/`). No passwords. JDK 1.6 targeted.

---

### C:/Projects/cig-audit/repos/gmtpserver/gmtpmina.xml
**Purpose:** IntelliJ IDEA Ant build file (alternative to NetBeans build).
**Dependencies listed (with versions):**
- `junit.jar` (version unknown)
- `commons-dbcp-1.3.jar`
- `commons-lang-2.6.jar`
- `commons-logging-1.0.3.jar`
- `commons-pool-1.5.5.jar`
- `javassist-3.11.0.GA.jar`
- `javassist-3.7.ga.jar` (duplicate library, different version)
- `jcl-over-slf4j-1.6.1.jar`
- `jzlib-1.0.7.jar`
- `log4j-1.2.jar` (log4j 1.x — end of life)
- `mina-core-2.0.4.jar`
- `mina-example-2.0.4.jar`
- `mina-filter-compression-2.0.4.jar`
- `mina-integration-beans-2.0.4.jar`
- `mina-integration-jmx-2.0.4.jar`
- `mina-integration-ognl-2.0.4.jar`
- `mina-integration-xbean-2.0.4.jar`
- `mina-statemachine-2.0.4.jar`
- `mina-transport-apr-2.0.4.jar`
- `ognl-3.0.1.jar`
- `postgresql-jdbc3.jar` (version unknown, JDBC3 variant)
- `simple-xml-2.6.1.jar`
- `slf4j-api-1.6.4.jar`
- `slf4j-log4j12.jar` (version unknown)
- `spring-2.5.6.jar`
- `tomcat-apr-5.5.23.jar`
- `xbean-spring-3.7.jar`

**JDK:** Java 1.6 (Mac OS X `JavaVM.framework` paths in classpath — developer machine artifact committed)
**Credentials / secrets / IPs present:** None directly. Developer machine OS paths committed.

---

### C:/Projects/cig-audit/repos/gmtpserver/install.sh (root-level)
**Content:** Empty (0 bytes). No findings.

---

### C:/Projects/cig-audit/repos/gmtpserver/installer/install.sh
**Purpose:** Interactive installation shell script.
**Variables defined:** `serviceName`, `defaultConfig`, `processDir`, `defaultLog`, `defaultApp`, `configPath`, `appPath`, `logPath`, `processPath`, `processUser`, `processGrp`, `javaHome`
**Operations:** Creates directories, copies config files, modifies config via `sed -i`, copies startup script, registers service with `update-rc.d`, starts service.
**Credentials / secrets / IPs present:** None hardcoded.
**Shell variable quoting issues:** Several `mkdir -p ${configPath}/routes`, `touch ${logPath}/gmtp.log`, `cp -v ../server/...` use unquoted variables.

---

### C:/Projects/cig-audit/repos/gmtpserver/log4j.properties
**Purpose:** Log4j logging configuration.
**Properties defined:**
- `log4j.rootLogger=INFO, console, file`
- `log4j.appender.console=org.apache.log4j.ConsoleAppender`
- `log4j.appender.console.layout=org.apache.log4j.PatternLayout`
- `log4j.appender.console.layout.ConversionPattern=%d{dd MMM yyyy HH:mm:ss,SSS} [%t] %5p %c{1}:%L - %m%n`
- `log4j.appender.file=org.apache.log4j.DailyRollingFileAppender`
- `log4j.appender.file.File=log/gmtp.log`
- `log4j.appender.file.threshold=INFO`
- `log4j.appender.file.layout=org.apache.log4j.PatternLayout`
- `log4j.appender.file.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss,SSS} [%t] %5p %c{1}:%L - %m%n`

**Credentials / secrets / IPs present:** None.
**Log4j version:** 1.x (end-of-life) — inferred from `log4j-1.2.jar` dependency.

---

### C:/Projects/cig-audit/repos/gmtpserver/manifest.mf
**Purpose:** Stub manifest (note: lowercase, used by NetBeans build system).
**Content:** `Manifest-Version: 1.0`, comment that Main-Class will be added automatically.
**Credentials / secrets / IPs present:** None.

---

### C:/Projects/cig-audit/repos/gmtpserver/nbproject/configs/test.properties
**Content:** Empty (0 bytes). No findings.

---

### C:/Projects/cig-audit/repos/gmtpserver/nbproject/private/config.properties
**Content:** Empty (0 bytes). No findings.

---

### C:/Projects/cig-audit/repos/gmtpserver/nbproject/private/private.properties
**Purpose:** NetBeans private build properties (machine-specific, should not be committed).
**Properties defined:**
- `compile.on.save=true`
- `do.depend=false`
- `do.jar=true`
- `do.jlink=false`
- `javac.debug=true`
- `javadoc.preview=true`
- `jlink.strip=false`
- `user.properties.file=C:\\Users\\61433\\AppData\\Roaming\\NetBeans\\8.2rc\\build.properties`

**Credentials / secrets / IPs present:** Developer Windows username `61433` embedded in path. No passwords.

---

### C:/Projects/cig-audit/repos/gmtpserver/nbproject/private/private.xml
**Purpose:** NetBeans private project state (editor bookmarks, open files — should not be committed).
**Content:** Editor bookmark pointing to `src/codec/GMTPCodecFactory.java` line 15.
**Credentials / secrets / IPs present:** None.

---

### C:/Projects/cig-audit/repos/gmtpserver/nbproject/private/profiler/configurations.xml
**Purpose:** NetBeans profiler configuration (should not be committed — machine-specific IDE state).
**Content:** Profiler settings only (CPU sampling, memory profiling, thread monitoring parameters).
**Credentials / secrets / IPs present:** None.

---

### C:/Projects/cig-audit/repos/gmtpserver/nbproject/project.properties
**Purpose:** NetBeans project build properties.
**Dependencies referenced (all via `file.reference.*` in `server/lib/`):**
- `commons-dbcp-1.3.jar`
- `commons-lang-2.6.jar`
- `commons-logging-1.0.3.jar`
- `commons-net-3.1.jar`
- `commons-pool-1.5.5.jar`
- `ftplet-api-1.0.6.jar`
- `ftpserver-core-1.0.6.jar`
- `javassist-3.11.0.GA.jar`
- `javassist-3.7.ga.jar` (duplicate)
- `jcl-over-slf4j-1.6.1.jar`
- `junit-4.10.jar`
- `jzlib-1.0.7.jar`
- `log4j-1.2.jar`
- `mina-core-2.0.4.jar`
- `mina-example-2.0.4.jar`
- `mina-filter-compression-2.0.4.jar`
- `mina-integration-beans-2.0.4.jar`
- `mina-integration-jmx-2.0.4.jar`
- `mina-integration-ognl-2.0.4.jar`
- `mina-integration-xbean-2.0.4.jar`
- `mina-statemachine-2.0.4.jar`
- `mina-transport-apr-2.0.4.jar`
- `objectprops.jar` (no version)
- `ognl-3.0.1.jar`
- `postgresql-8.4-703.jdbc3.jar` (duplicate JDBC driver, different version)
- `postgresql-jdbc3.jar`
- `simple-xml-2.6.1.jar`
- `slf4j-api-1.6.4.jar`
- `slf4j-log4j12.jar`
- `spring-2.5.6.jar`
- `tomcat-apr-5.5.23.jar`
- `xbean-spring-3.7.jar`

**Other properties:** `main.class=gmtp.GMTPRouter`, `javac.source=1.8`, `javac.target=1.8`, `run.jvmargs=-DgmtpConfig=.`, `application.vendor=michel`
**Credentials / secrets / IPs present:** None directly. Developer name (`michel`) in `application.vendor`.

---

### C:/Projects/cig-audit/repos/gmtpserver/nbproject/project.xml
**Purpose:** NetBeans project type descriptor.
**Content:** Project name `GmtpMina`, type `org.netbeans.modules.java.j2seproject`, source roots `src.dir`, test roots `test.src.dir`.
**Credentials / secrets / IPs present:** None.

---

### C:/Projects/cig-audit/repos/gmtpserver/routes/all.xml
**Purpose:** Route trigger configuration example.
**Elements:** `<trigger pattern="__EXAMPLE__">/home/michel/test.sh</trigger>`
**Credentials / secrets / IPs present:** Developer home path `/home/michel/test.sh` committed. Pattern is a placeholder (`__EXAMPLE__`), suggesting this is development/test config, not cleared before commit.

---

### C:/Projects/cig-audit/repos/gmtpserver/src/META-INF/MANIFEST.MF
**Purpose:** JAR manifest used at build time.
**Content:** `Manifest-Version: 1.0`, `Class-Path:` listing all lib JARs, `Main-Class: gmtp.GMTPRouter`.
**Libraries listed:** Same set as `nbproject/project.properties`.
**Credentials / secrets / IPs present:** None.

---

### C:/Projects/cig-audit/repos/gmtpserver/startup.sh
**Purpose:** SysV init-style daemon start/stop/restart/status script.
**Variables defined:**
- `JAVA_HOME=/usr/java/latest`
- `gmtpConfig=/etc/gmtp`
- `serviceNameLo="gmtp"`, `serviceName="gmtp"`
- `serviceUser="gmtp"`, `serviceGroup="gmtp"`
- `applDir="/var/lib/$serviceNameLo"`
- `serviceUserHome="/home/$serviceUser"`
- `serviceLogFile="/var/log/$serviceNameLo.log"`
- `maxShutdownTime=15`
- `pidFile="/var/run/$serviceNameLo.pid"`
- `javaCommand="java"`
- `javaExe="$JAVA_HOME/bin/$javaCommand"`
- `javaArgs=" -DgmtpConfig=${gmtpConfig} -jar $applDir/GmtpMina.jar"`

**Credentials / secrets / IPs present:** None hardcoded.
**Shell issues:** Several variables used without quoting (e.g., `touch $filename`, `chgrp $serviceGroup $filename`, `chmod g+w $filename`).

---

## Security Checklist Assessment

### Secrets and Configuration
- **Hardcoded DB passwords:** FOUND — `gmtpRouter.xml` lines 54 and 62.
- **Hardcoded telnet password:** FOUND — `gmtpRouter.xml` line 74.
- **API keys / encryption keys:** Not found.
- **Secrets in environment variables:** Not implemented — all credentials are in plain-text XML committed to git.
- **Gitignore excludes secret files:** FAILED — `*.properties` and `*.xml` config files are NOT excluded. `gmtpRouter.xml` (containing passwords) is tracked by git.
- **Hardcoded IPs:** FOUND — `203.35.168.201` (public IP) in `gmtpRouter.xml` line 94; `127.0.0.1` in multiple places (acceptable for loopback).
- **Hardcoded ports:** `4687`, `9494`, `2221`, `2222–2229` all in `gmtpRouter.xml`.

### Dependencies
- **log4j 1.2.x:** End-of-life, multiple known critical CVEs (CVE-2019-17571, Chainsaw RCE).
- **Spring 2.5.6:** Severely outdated (2008), multiple CVEs.
- **Apache MINA 2.0.4:** Outdated (2011).
- **commons-dbcp 1.3:** Outdated.
- **commons-logging 1.0.3:** Outdated.
- **tomcat-apr 5.5.23:** Outdated (2006), EOL.
- **postgresql JDBC3 driver (8.4-703):** Outdated.
- **ognl 3.0.1:** Outdated, CVE-prone (OGNL injection).
- **javassist 3.7.ga and 3.11.0.GA:** Two conflicting versions in classpath.
- **postgresql-jdbc3.jar (two versions):** `postgresql-jdbc3.jar` and `postgresql-8.4-703.jdbc3.jar` both referenced.
- **mina-integration-jmx-2.0.4.jar:** JMX integration present in classpath (risk: remote management exposure).
- **No dependency management tool (Maven/Gradle):** JARs are vendored into `server/lib/` — no automatic vulnerability alerting.

### Build and Deployment
- **build.xml:** No hardcoded credentials. Clean.
- **startup.sh:** No hardcoded passwords. Some unquoted variables are a minor shell safety concern.
- **installer/install.sh:** No hardcoded passwords. Unquoted variables present.
- **chmod 777:** Not found.
- **Insecure temp file creation:** Not found.
- **Credentials in process arguments:** Not found in shell scripts.

### Logging Configuration
- **log4j version:** 1.x (EOL) — confirmed by `log4j-1.2.jar`.
- **Dangerous appenders (SocketAppender, JMSAppender, SMTPAppender, JMX):** Not configured in `log4j.properties`. Configuration uses only ConsoleAppender and DailyRollingFileAppender — limited risk from the config file itself.
- **log4j 1.x known CVEs:** CVE-2019-17571 (SocketServer remote code execution) is present in log4j 1.x as a class in the JAR even if not configured. The presence of the library is the risk.
- **Logging of sensitive data:** Not directly visible in config; depends on application code.

### FTP and Network Config
- **ftpUsers.properties:** Empty file — no credentials visible but the file being tracked while empty is a concern (it is referenced in config).
- **gmtpRouter.xml:** Contains hardcoded DB credentials and telnet management credentials (detailed above).
- **Telnet management interface:** Enabled (`<telnetPort>9494</telnetPort>`) with hardcoded credentials. Telnet is unencrypted.
- **FTP external IP:** `203.35.168.201` committed to repository.

### nbproject/private files committed to git
- `nbproject/private/private.properties`: Contains developer Windows path with username `61433` and references to NetBeans 8.2rc (pre-release IDE). Should not be committed.
- `nbproject/private/private.xml`: Editor state committed — low severity, no credentials.
- `nbproject/private/profiler/configurations.xml`: IDE profiler state committed — no credentials.

---

## Findings

## A01-1

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpRouter.xml
**Line:** 54
**Severity:** Critical
**Category:** Security > Hardcoded Credentials
**Description:** The primary PostgreSQL database password is hardcoded in plain text in the configuration file, which is tracked by git. Anyone with read access to the repository has the database password.
**Evidence:** `<dbPass>gmtp-postgres</dbPass>`
**Recommendation:** Remove the password from the XML file. Load it at runtime from an environment variable (e.g., `GMTP_DB_PASS`), a secrets manager, or an external secrets file that is excluded from version control via `.gitignore`.

---

## A01-2

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpRouter.xml
**Line:** 62
**Severity:** Critical
**Category:** Security > Hardcoded Credentials
**Description:** The default/fallback PostgreSQL database password is hardcoded in plain text. This is identical to the primary password, meaning both database connections share the same committed credential.
**Evidence:** `<dbPassDefault>gmtp-postgres</dbPassDefault>`
**Recommendation:** Same as A01-1. Externalize the credential; rotate the password immediately since it has been in git history.

---

## A01-3

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpRouter.xml
**Line:** 74
**Severity:** Critical
**Category:** Security > Hardcoded Credentials
**Description:** The telnet management interface password is hardcoded in plain text in a git-tracked file. Telnet is also an unencrypted protocol, meaning the password is transmitted in cleartext over the network during authentication.
**Evidence:** `<telnetPassword>gmtp!telnet</telnetPassword>`
**Recommendation:** Replace the telnet management interface with SSH or a TLS-secured alternative. Remove the hardcoded password and load it from an environment variable or external secrets store. If the telnet interface cannot be replaced immediately, ensure it is bound only to loopback and firewall-restricted.

---

## A01-4

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpRouter.xml
**Line:** 94
**Severity:** Medium
**Category:** Security > Infrastructure Disclosure
**Description:** A public-facing IP address is hardcoded in the configuration file committed to git. This reveals infrastructure topology to anyone with repository access and complicates environment portability.
**Evidence:** `<ftpExternalAddr>203.35.168.201</ftpExternalAddr>`
**Recommendation:** Replace the hardcoded IP with an environment variable or a configuration value loaded from an external non-committed file. Consider using a DNS hostname instead of a raw IP.

---

## A01-5

**File:** C:/Projects/cig-audit/repos/gmtpserver/.gitignore
**Line:** 1 (general file scope)
**Severity:** High
**Category:** Security > Secrets Management
**Description:** The `.gitignore` file does not exclude the configuration files that contain hardcoded credentials (`gmtpRouter.xml`, `*.properties`). As a result, `gmtpRouter.xml` (containing database and telnet passwords) and other sensitive config files are committed to and tracked by git, exposing credentials in the repository history permanently.
**Evidence:** `.gitignore` contains no exclusion patterns for `*.xml` config files, `gmtpRouter.xml`, `ftpUsers.properties`, or `nbproject/private/`.
**Recommendation:** Add the following (or equivalent) entries to `.gitignore`: `gmtpRouter.xml`, `ftpUsers.properties`, `nbproject/private/`. Consider maintaining a `gmtpRouter.xml.example` template without real credentials. Note: adding to `.gitignore` does not remove already-committed secrets from history — a `git filter-repo` purge and credential rotation is required.

---

## A01-6

**File:** C:/Projects/cig-audit/repos/gmtpserver/nbproject/private/private.properties
**Line:** 8
**Severity:** Low
**Category:** Security > Information Disclosure
**Description:** Machine-specific NetBeans IDE private properties file has been committed to git. It contains the developer's Windows username (`61433`) embedded in a file path, and references a pre-release version of NetBeans (8.2rc). These files are intended to be machine-local and should never be committed.
**Evidence:** `user.properties.file=C:\\Users\\61433\\AppData\\Roaming\\NetBeans\\8.2rc\\build.properties`
**Recommendation:** Add `nbproject/private/` to `.gitignore` and remove these files from git tracking with `git rm --cached`. This is a standard NetBeans project convention.

---

## A01-7

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpmina.xml
**Line:** 102
**Severity:** High
**Category:** Security > Vulnerable Dependencies
**Description:** The project uses log4j 1.2.x, which is end-of-life and contains multiple known critical vulnerabilities. Most notably, CVE-2019-17571 allows remote code execution via log4j's SocketServer if instantiated. The JMX appender (also present in 1.x) has known deserialization vulnerabilities. The library version is approximately 15 years old.
**Evidence:** `<pathelement location="${basedir}/dist/lib/log4j-1.2.jar"/>` (also referenced in `nbproject/project.properties` as `file.reference.log4j-1.2.jar=server/lib/log4j-1.2.jar` and in `src/META-INF/MANIFEST.MF`)
**Recommendation:** Migrate to log4j 2.x (version 2.17.1 or later, which addresses Log4Shell CVE-2021-44228 and related CVEs) or replace with Logback/SLF4J. Since the project already uses SLF4J as the API layer, replacing the log4j 1.x backend with Logback requires minimal code changes.

---

## A01-8

**File:** C:/Projects/cig-audit/repos/gmtpserver/nbproject/project.properties
**Line:** 63
**Severity:** High
**Category:** Security > Vulnerable Dependencies
**Description:** Spring Framework 2.5.6 (released 2008) is used. This version is severely out of date and has numerous known CVEs including remote code execution vulnerabilities. It reached end-of-life in December 2011.
**Evidence:** `file.reference.spring-2.5.6.jar=server/lib/spring-2.5.6.jar`
**Recommendation:** Upgrade to a supported Spring Framework version (6.x as of 2026). Note that a major version upgrade will require code changes; assess whether Spring is actually needed for runtime (it appears used via xbean-spring for MINA integration) and consider whether it can be replaced or upgraded alongside MINA.

---

## A01-9

**File:** C:/Projects/cig-audit/repos/gmtpserver/nbproject/project.properties
**Line:** 64
**Severity:** High
**Category:** Security > Vulnerable Dependencies
**Description:** Apache Tomcat APR (Native) version 5.5.23 is included as a library dependency. Tomcat 5.5 reached end-of-life in 2012 and has multiple known CVEs. This is an extremely outdated component.
**Evidence:** `file.reference.tomcat-apr-5.5.23.jar=server/lib/tomcat-apr-5.5.23.jar`
**Recommendation:** Upgrade to a supported Tomcat APR version or remove the dependency if the APR transport mode for MINA is not required.

---

## A01-10

**File:** C:/Projects/cig-audit/repos/gmtpserver/nbproject/project.properties
**Line:** 57
**Severity:** Medium
**Category:** Security > Vulnerable Dependencies
**Description:** OGNL (Object-Graph Navigation Language) version 3.0.1 is included. OGNL has a history of severe remote code execution vulnerabilities (it is the same library exploited in Apache Struts breaches). Version 3.0.1 is from approximately 2011 and has numerous known CVEs.
**Evidence:** `file.reference.ognl-3.0.1.jar=server/lib/ognl-3.0.1.jar` (also in `gmtpmina.xml` line 112 and `MANIFEST.MF`)
**Recommendation:** Upgrade OGNL to the latest version or, preferably, remove it if MINA's OGNL integration (`mina-integration-ognl`) is not used in production. The attack surface introduced by OGNL is significant.

---

## A01-11

**File:** C:/Projects/cig-audit/repos/gmtpserver/nbproject/project.properties
**Lines:** 41, 42 (and gmtpmina.xml lines 98–99)
**Severity:** Medium
**Category:** Security > Vulnerable Dependencies
**Description:** Two different versions of Javassist are present on the classpath simultaneously: `javassist-3.7.ga.jar` and `javassist-3.11.0.GA.jar`. This creates a dependency conflict where class resolution is undefined and could lead to runtime failures or security issues if security-relevant classes differ between versions.
**Evidence:**
```
file.reference.javassist-3.11.0.GA.jar=server/lib/javassist-3.11.0.GA.jar
file.reference.javassist-3.7.ga.jar=server/lib/javassist-3.7.ga.jar
```
**Recommendation:** Remove the older `javassist-3.7.ga.jar` and retain only the newer version. Verify that no component strictly requires the older version.

---

## A01-12

**File:** C:/Projects/cig-audit/repos/gmtpserver/nbproject/project.properties
**Lines:** 58, 59
**Severity:** Medium
**Category:** Security > Vulnerable Dependencies
**Description:** Two different PostgreSQL JDBC drivers are present on the classpath: `postgresql-jdbc3.jar` (unknown version) and `postgresql-8.4-703.jdbc3.jar`. Both use the JDBC 3 interface (for Java 1.4/1.5 compatibility), which predates JDBC 4's security improvements. Having two JDBC drivers of the same database creates an undefined driver resolution situation.
**Evidence:**
```
file.reference.postgresql-8.4-703.jdbc3.jar=server/lib/postgresql-8.4-703.jdbc3.jar
file.reference.postgresql-jdbc3.jar=server/lib/postgresql-jdbc3.jar
```
**Recommendation:** Remove the duplicate; use a single, current PostgreSQL JDBC 4.2+ driver (version 42.x). Upgrade to JDBC 4.x to benefit from modern security features.

---

## A01-13

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpRouter.xml
**Line:** 70
**Severity:** High
**Category:** Security > Insecure Protocol
**Description:** A telnet management interface is configured and enabled. Telnet transmits all data, including credentials, in plaintext over the network. Any network-level observer can capture the telnet username and password. Even though the service appears to bind to localhost, the configuration file itself does not restrict the bind address, and the external IP exposure is unclear.
**Evidence:** `<telnetPort>9494</telnetPort>` / `<telnetUser>gmtp</telnetUser>` / `<telnetPassword>gmtp!telnet</telnetPassword>`
**Recommendation:** Disable the telnet management interface entirely or replace it with an SSH-based management channel. If a local-only management interface is required, ensure it explicitly binds to `127.0.0.1` only and is firewalled from external access.

---

## A01-14

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpmina.xml
**Line:** 107
**Severity:** Medium
**Category:** Security > Attack Surface
**Description:** The MINA JMX integration library (`mina-integration-jmx-2.0.4.jar`) is included in the classpath and deployed. JMX (Java Management Extensions) can expose management endpoints that allow remote monitoring and control of the JVM. If JMX is inadvertently enabled or if the JMX port is accessible, it can be exploited for remote code execution. No JMX authentication configuration was observed.
**Evidence:** `<pathelement location="${basedir}/dist/lib/mina-integration-jmx-2.0.4.jar"/>` (also in `MANIFEST.MF`)
**Recommendation:** If JMX remote management is not required, remove `mina-integration-jmx` from the classpath. If it is needed, ensure JMX is configured with authentication and SSL, and is bound only to localhost or a management-only network interface.

---

## A01-15

**File:** C:/Projects/cig-audit/repos/gmtpserver/installer/install.sh
**Lines:** 30, 52, 54, 70
**Severity:** Low
**Category:** Security > Shell Script Safety
**Description:** Multiple shell variables are used unquoted in the installer script. Unquoted variables in bash are subject to word splitting and pathname expansion. If a path contains spaces or special characters (e.g., if an operator enters a path with spaces at the interactive prompts), commands like `mkdir -p ${configPath}/routes` or `touch ${logPath}/gmtp.log` can fail unpredictably or execute unintended operations.
**Evidence:**
```bash
mkdir -p ${configPath}/routes
cp -rv ../server/lib/* ${appPath}/lib
touch ${logPath}/gmtp.log
mkdir -p ${logPath}
```
**Recommendation:** Quote all variable expansions with double quotes: `mkdir -p "${configPath}/routes"`, `touch "${logPath}/gmtp.log"`, etc.

---

## A01-16

**File:** C:/Projects/cig-audit/repos/gmtpserver/routes/all.xml
**Line:** 2
**Severity:** Low
**Category:** Security > Information Disclosure
**Description:** The routes configuration file contains a developer's home directory path (`/home/michel/test.sh`) as the target of a route trigger. Although the trigger pattern is a placeholder (`__EXAMPLE__`), the script path reveals the developer's username and was committed to the repository. This file appears to be a development artifact that was not cleaned before commit.
**Evidence:** `<trigger pattern="__EXAMPLE__">/home/michel/test.sh</trigger>`
**Recommendation:** Replace developer-specific paths with documented placeholder values (e.g., `/path/to/your/handler.sh`) or a proper example that does not reveal individual developer system paths.

---

## A01-17

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpmina.xml
**Lines:** 62–82
**Severity:** Low
**Category:** Security > Information Disclosure
**Description:** The IntelliJ IDEA build file (`gmtpmina.xml`) contains hardcoded Mac OS X `JavaVM.framework` classpath paths from a specific developer's machine (username `davec` visible in `gmtpmina.properties`). These paths expose the developer's identity and operating system configuration. Additionally, these paths reference Java 1.6 (End of Life since 2013), indicating the project has unresolved build configuration debt.
**Evidence:**
```xml
<include name="../../../../../Frameworks/JavaVM.framework/Versions/1.6.0/Classes/classes.jar"/>
```
`gmtpmina.properties`: `path.variable.grails_home=/Users/davec/tools/grails-1.0.4`
**Recommendation:** Remove developer-specific build files from version control or replace hardcoded paths with portable property references. The `.gitignore` should exclude IDE-generated build files.

---

## A01-18

**File:** C:/Projects/cig-audit/repos/gmtpserver/gmtpRouter.xml
**Line:** 32
**Severity:** Low
**Category:** Security > Configuration Integrity
**Description:** The XML configuration file contains a stray text fragment `th` outside any XML element tag on line 32. While this may not cause a security vulnerability directly, it indicates the configuration file was edited manually and carelessly, which undermines confidence in the integrity of the configuration. Depending on the XML parser used, this could also cause parse errors.
**Evidence:** `<tcpNoDelay>true</tcpNoDelay>th`
**Recommendation:** Remove the stray `th` characters. Validate the XML configuration file with a schema or linter as part of the build or deployment process.

---

## Summary Table

| ID    | Severity | Category                          | File                                      |
|-------|----------|-----------------------------------|-------------------------------------------|
| A01-1 | Critical | Hardcoded Credentials             | gmtpRouter.xml                            |
| A01-2 | Critical | Hardcoded Credentials             | gmtpRouter.xml                            |
| A01-3 | Critical | Hardcoded Credentials             | gmtpRouter.xml                            |
| A01-4 | Medium   | Infrastructure Disclosure         | gmtpRouter.xml                            |
| A01-5 | High     | Secrets Management / .gitignore   | .gitignore                                |
| A01-6 | Low      | Information Disclosure            | nbproject/private/private.properties      |
| A01-7 | High     | Vulnerable Dependencies (log4j)   | gmtpmina.xml / project.properties         |
| A01-8 | High     | Vulnerable Dependencies (Spring)  | nbproject/project.properties              |
| A01-9 | High     | Vulnerable Dependencies (Tomcat)  | nbproject/project.properties              |
| A01-10| Medium   | Vulnerable Dependencies (OGNL)    | nbproject/project.properties              |
| A01-11| Medium   | Duplicate Dependency (Javassist)  | nbproject/project.properties              |
| A01-12| Medium   | Duplicate Dependency (JDBC)       | nbproject/project.properties              |
| A01-13| High     | Insecure Protocol (Telnet)        | gmtpRouter.xml                            |
| A01-14| Medium   | Attack Surface (JMX)              | gmtpmina.xml / MANIFEST.MF                |
| A01-15| Low      | Shell Script Safety               | installer/install.sh                      |
| A01-16| Low      | Information Disclosure            | routes/all.xml                            |
| A01-17| Low      | Information Disclosure            | gmtpmina.xml / gmtpmina.properties        |
| A01-18| Low      | Configuration Integrity           | gmtpRouter.xml                            |
