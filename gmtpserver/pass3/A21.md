# Pass 3: Documentation — A21
**Agent:** A21
**Branch verified:** master (confirmed via .git/HEAD: `ref: refs/heads/master`)
**Files reviewed:**
- src/codec/GMTPCodecFactory.java
- src/codec/GMTPRequestDecoder.java
- src/codec/GMTPResponseEncoder.java

---

## Reading Evidence

### src/codec/GMTPCodecFactory.java

**Class:** `GMTPCodecFactory` (public, implements `ProtocolCodecFactory`)

**Fields / Constants:**
| Name | Type | Line | Visibility |
|---|---|---|---|
| `encoder` | `ProtocolEncoder` | 19 | private |
| `decoder` | `ProtocolDecoder` | 20 | private |

**Constructors / Methods:**
| Name | Line | Visibility | Signature |
|---|---|---|---|
| `GMTPCodecFactory(boolean)` | 22 | public | `GMTPCodecFactory(boolean client)` |
| `GMTPCodecFactory(boolean, HashMap)` | 32 | public | `GMTPCodecFactory(boolean client, HashMap<String, String> routingMap)` |
| `getEncoder` | 42 | public | `ProtocolEncoder getEncoder(IoSession ioSession) throws Exception` |
| `getDecoder` | 46 | public | `ProtocolDecoder getDecoder(IoSession ioSession) throws Exception` |

**Class-level Javadoc:** Present at line 13–16, but contains only an IDE-generated stub (`@author michel`) with no meaningful description of the class purpose.

**Method-level Javadoc:** None present on any constructor or method.

---

### src/codec/GMTPRequestDecoder.java

**Class:** `GMTPRequestDecoder` (public, extends `CumulativeProtocolDecoder`)

**Constants (all private static final short):**
| Name | Value | Line |
|---|---|---|
| `PDU_ID` | 0x0001 | 25 |
| `PDU_DATA` | 0x0002 | 26 |
| `PDU_ID_EXT` | 0x0003 | 27 |
| `PDU_DATA_EXT` | 0x0004 | 28 |
| `PDU_ACK` | 0x0005 | 29 |
| `PDU_ERROR` | 0x0006 | 30 |
| `PDU_CLOSED` | 0x0007 | 32 (`@SuppressWarnings("unused")`) |
| `PDU_PROTO_VER` | 0x0008 | 33 |
| `PDU_BEGIN_TRANSACTION` | 0x0009 | 34 |
| `PDU_END_TRANSACTION` | 0x000A | 35 |
| `PDU_NAK` | 0x000D | 36 |

**Fields:**
| Name | Type | Line | Visibility |
|---|---|---|---|
| `logger` | `Logger` | 37 | private static |
| `routingMap` | `HashMap<String, String>` | 38 | private |

**Constructors / Methods:**
| Name | Line | Visibility | Signature |
|---|---|---|---|
| `GMTPRequestDecoder(HashMap)` | 40 | public | `GMTPRequestDecoder(HashMap<String, String> routingMap)` |
| `GMTPRequestDecoder()` | 44 | public | `GMTPRequestDecoder()` |
| `doDecode` | 48 | protected | `boolean doDecode(IoSession, IoBuffer, ProtocolDecoderOutput) throws Exception` |
| `decodeMessageType` | 111 | private | `Type decodeMessageType(int type)` |

**Class-level Javadoc:** Present at line 19–22, IDE-generated stub only (`@author michel`), no meaningful description.

**Method-level Javadoc:** None present on any constructor or method.

**Note on `doDecode`:** protected visibility — excluded from public API findings per audit scope. **Note on `decodeMessageType`:** private — excluded.

---

### src/codec/GMTPResponseEncoder.java

**Class:** `GMTPResponseEncoder` (package-private — no `public` modifier on class declaration at line 21, extends `ProtocolEncoderAdapter`)

**Constants (all private static final short):**
| Name | Value | Line |
|---|---|---|
| `PDU_ID` | 0x0001 | 23 |
| `PDU_DATA` | 0x0002 | 24 |
| `PDU_ID_EXT` | 0x0003 | 25 |
| `PDU_DATA_EXT` | 0x0004 | 26 |
| `PDU_ACK` | 0x0005 | 27 |
| `PDU_ERROR` | 0x0006 | 28 |
| `PDU_CLOSED` | 0x0007 | 30 (`@SuppressWarnings("unused")`) |
| `PDU_PROTO_VER` | 0x0008 | 31 |
| `PDU_BEGIN_TRANSACTION` | 0x0009 | 32 |
| `PDU_END_TRANSACTION` | 0x000A | 33 |
| `PDU_NAK` | 0x000D | 34 |

**Fields:**
| Name | Type | Line | Visibility |
|---|---|---|---|
| `logger` | `Logger` | 35 | private static |

**Constructors / Methods:**
| Name | Line | Visibility | Signature |
|---|---|---|---|
| `encode` | 37 | public | `void encode(IoSession session, Object message, ProtocolEncoderOutput out) throws Exception` |
| `encodeMessageType` | 60 | private | `int encodeMessageType(Type type)` |

**Class-level Javadoc:** Present at line 17–20, IDE-generated stub only (`@author michel`), no meaningful description.

**Method-level Javadoc:** None present on any method.

**Note on `encodeMessageType`:** private — excluded from findings. The `encode` method is declared `public` and overrides the public API of `ProtocolEncoderAdapter`; it is included in findings despite the enclosing class being package-private.

---

## Findings

## A21-1 — GMTPCodecFactory(boolean): no Javadoc

**Severity:** MEDIUM
**File:** src/codec/GMTPCodecFactory.java:22
**Description:** The public constructor `GMTPCodecFactory(boolean client)` has no Javadoc comment. The parameter `client` controls whether the factory is configured in client mode (both encoder and decoder set to null) or server mode (encoder and decoder instantiated). This behaviour is non-obvious and entirely undocumented. There is no `@param client` tag and no description of the null-assignment side effect.
**Fix:** Add a Javadoc comment explaining that `client=true` produces a factory with null encoder/decoder (client-side use only), while `client=false` instantiates `GMTPResponseEncoder` and `GMTPRequestDecoder`. Include `@param client true for client-side configuration, false for server-side`.

---

## A21-2 — GMTPCodecFactory(boolean, HashMap): no Javadoc

**Severity:** MEDIUM
**File:** src/codec/GMTPCodecFactory.java:32
**Description:** The public constructor `GMTPCodecFactory(boolean client, HashMap<String, String> routingMap)` has no Javadoc comment. Both parameters are undocumented: `client` controls server vs. client mode and `routingMap` is passed to `GMTPRequestDecoder` to influence message routing. Neither `@param` tag is present, and there is no description.
**Fix:** Add a Javadoc comment describing the two-argument overload, with `@param client` and `@param routingMap` tags that explain how the routing map is forwarded to the decoder.

---

## A21-3 — getEncoder: no Javadoc

**Severity:** MEDIUM
**File:** src/codec/GMTPCodecFactory.java:42
**Description:** The public method `getEncoder(IoSession ioSession)` has no Javadoc comment. It is the implementation of `ProtocolCodecFactory.getEncoder`. No `@param ioSession`, `@return`, or `@throws Exception` tag is present. A caller has no documentation indicating that the method may return `null` when the factory was constructed in client mode.
**Fix:** Add a Javadoc comment including `@param ioSession the current I/O session`, `@return the configured ProtocolEncoder, or null if constructed in client mode`, and `@throws Exception` if any exception can propagate (or explicitly document that none are thrown by this implementation).

---

## A21-4 — getDecoder: no Javadoc

**Severity:** MEDIUM
**File:** src/codec/GMTPCodecFactory.java:46
**Description:** The public method `getDecoder(IoSession ioSession)` has no Javadoc comment. It implements `ProtocolCodecFactory.getDecoder`. No `@param ioSession`, `@return`, or `@throws Exception` tag is present. The possibility of a `null` return in client mode is silently unaddressed.
**Fix:** Add a Javadoc comment including `@param ioSession the current I/O session`, `@return the configured ProtocolDecoder, or null if constructed in client mode`, and appropriate `@throws` documentation.

---

## A21-5 — GMTPRequestDecoder(HashMap): no Javadoc

**Severity:** MEDIUM
**File:** src/codec/GMTPRequestDecoder.java:40
**Description:** The public constructor `GMTPRequestDecoder(HashMap<String, String> routingMap)` has no Javadoc comment. The purpose of `routingMap` — which is stored as an instance field and subsequently passed to every `GMTPMessage` constructed during decoding — is completely undocumented. No `@param routingMap` tag is present.
**Fix:** Add a Javadoc comment describing the constructor and the role of the routing map, with an `@param routingMap` tag.

---

## A21-6 — GMTPRequestDecoder(): no Javadoc

**Severity:** LOW
**File:** src/codec/GMTPRequestDecoder.java:44
**Description:** The public no-argument constructor `GMTPRequestDecoder()` has no Javadoc comment. Although it takes no parameters, documenting it clarifies that it creates a decoder with an empty routing map, which is the implicit default and may produce different runtime behaviour compared to the routing-map-aware constructor.
**Fix:** Add a Javadoc comment indicating that this constructor initialises the decoder with an empty routing map.

---

## A21-7 — GMTPResponseEncoder.encode: no Javadoc

**Severity:** MEDIUM
**File:** src/codec/GMTPResponseEncoder.java:37
**Description:** The public method `encode(IoSession session, Object message, ProtocolEncoderOutput out)` has no Javadoc comment. This is the sole public encoding entry point overriding `ProtocolEncoderAdapter.encode`. Several behaviours are entirely undocumented: (1) `message` is cast without a null-check to `GMTPMessage` — a `ClassCastException` will be thrown for any other type; (2) the method reads the session attribute `"extVersion"` and conditionally includes a `dataId` field in the wire format only when that attribute equals `"1"` — this conditional encoding is a critical protocol detail; (3) a `NullPointerException` will be thrown if the session attribute `"extVersion"` is absent (null). None of `@param session`, `@param message`, `@param out`, nor `@throws Exception` are documented.
**Fix:** Add a full Javadoc comment describing the wire format produced, the dependency on the `"extVersion"` session attribute, the requirement that `message` must be a `GMTPMessage` instance, and the exception behaviour. Include `@param` for all three parameters and `@throws Exception` noting potential `ClassCastException` and `NullPointerException`.

---

## A21-8 — GMTPCodecFactory class-level Javadoc is an uninformative stub

**Severity:** LOW
**File:** src/codec/GMTPCodecFactory.java:13
**Description:** The class-level Javadoc at line 13 reads only `@author michel` with no description. It does not state that this class implements `ProtocolCodecFactory` as the GMTP codec entry point, nor does it describe the server vs. client mode distinction or the two construction modes.
**Fix:** Replace the stub with a meaningful class-level description explaining the factory's role in the GMTP codec pipeline.

---

## A21-9 — GMTPRequestDecoder class-level Javadoc is an uninformative stub

**Severity:** LOW
**File:** src/codec/GMTPRequestDecoder.java:19
**Description:** The class-level Javadoc at line 19 reads only `@author michel` with no description. It does not explain that this decoder parses the GMTP binary framing protocol, supports both standard and extended (ID-bearing) PDU structures, or the set of PDU types it handles.
**Fix:** Replace the stub with a meaningful class-level description of the decoder's wire-format parsing logic and supported PDU types.

---

## A21-10 — GMTPResponseEncoder class-level Javadoc is an uninformative stub

**Severity:** LOW
**File:** src/codec/GMTPResponseEncoder.java:17
**Description:** The class-level Javadoc at line 17 reads only `@author michel` with no description. It does not explain that this class encodes `GMTPMessage` objects to the GMTP binary wire format, the conditional extended-format logic, or the dependency on the `"extVersion"` session attribute.
**Fix:** Replace the stub with a meaningful class-level description of the encoder's responsibilities and protocol behaviour.

---

## Summary

| ID | Severity | Description |
|---|---|---|
| A21-1 | MEDIUM | `GMTPCodecFactory(boolean)` — no Javadoc, missing @param |
| A21-2 | MEDIUM | `GMTPCodecFactory(boolean, HashMap)` — no Javadoc, missing @param tags |
| A21-3 | MEDIUM | `getEncoder(IoSession)` — no Javadoc, missing @param, @return, @throws; silent null return undocumented |
| A21-4 | MEDIUM | `getDecoder(IoSession)` — no Javadoc, missing @param, @return, @throws; silent null return undocumented |
| A21-5 | MEDIUM | `GMTPRequestDecoder(HashMap)` — no Javadoc, missing @param |
| A21-6 | LOW | `GMTPRequestDecoder()` — no Javadoc on no-arg constructor |
| A21-7 | MEDIUM | `GMTPResponseEncoder.encode` — no Javadoc; undocumented ClassCastException, NullPointerException, and extVersion protocol dependency |
| A21-8 | LOW | `GMTPCodecFactory` class Javadoc is an uninformative IDE stub |
| A21-9 | LOW | `GMTPRequestDecoder` class Javadoc is an uninformative IDE stub |
| A21-10 | LOW | `GMTPResponseEncoder` class Javadoc is an uninformative IDE stub |
