# Pass 3: Documentation — B026
**Agent:** B026
**Files:**
- `lib/api_server_web/views/vx_rental_view.ex`
- `lib/api_server_web/views/vx_restriction_view.ex`
- `lib/api_server_web/views/vx_thing_event_view.ex`
- `lib/api_server_web/views/vx_thing_omega_view.ex`

**Date:** 2026-02-27

---

## vx_rental_view.ex

### Reading Evidence

**Module name:** `ApiServerWeb.VXRentalView`

**Public functions:**

| Function | Line |
|---|---|
| `render/2` ("rhm_rentals.json") | 8 |
| `render/2` ("rhm_rental.json") | 13 |
| `render/2` ("midpac_report.json") | 64 |
| `render/2` ("rental_anniversaries.json") | 68 |
| `convert_json_to_changeset/1` | 73 |

**Private functions:**
- None

**Types / errors / constants defined:** None

**Documentation present:**
- `@moduledoc`: absent
- `@doc` on any public function: absent

---

### Findings

#### B026-1 — Missing @moduledoc in VXRentalView
**Severity:** LOW
**File:** `lib/api_server_web/views/vx_rental_view.ex`, line 1

The module `ApiServerWeb.VXRentalView` has no `@moduledoc` attribute. There is no description of the module's purpose, the domain it covers (rental records, usage calculations, mid-pac and anniversary reporting), or the aliases it exposes to callers.

---

#### B026-2 — Missing @doc on render/2 ("rhm_rentals.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_rental_view.ex`, line 8

The public function clause `render("rhm_rentals.json", ...)` has no `@doc`. The expected shape of the `vx_rentals` list and the `customer` argument, and the structure of the returned JSON array, are undocumented.

---

#### B026-3 — Missing @doc on render/2 ("rhm_rental.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_rental_view.ex`, line 13

The public function clause `render("rhm_rental.json", ...)` has no `@doc`. This is the most complex clause in the module: it performs live usage calculations via `Vx.fetch_actual_usage/5`, `Vx.get_usage_since_service/2`, and `Vx.get_avg_weekly_hours/2`, applies conditional logic for overage data, and assembles a composite map. None of this behaviour or the expected input shape is documented.

---

#### B026-4 — Missing @doc on render/2 ("midpac_report.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_rental_view.ex`, line 64

The public function clause `render("midpac_report.json", ...)` has no `@doc`. The nature of the `data` value passed through and what the Mid-Pac report represents are undocumented.

---

#### B026-5 — Missing @doc on render/2 ("rental_anniversaries.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_rental_view.ex`, line 68

The public function clause `render("rental_anniversaries.json", ...)` has no `@doc`. The structure of `all_anniversary_data` and the expected return format are undocumented.

---

#### B026-6 — Missing @doc on convert_json_to_changeset/1
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_rental_view.ex`, line 73

The public function `convert_json_to_changeset/1` has no `@doc`. The function converts an incoming JSON map (with string keys) into an atom-keyed map suitable for an Ecto-style changeset, including special-casing the `"28 Day Period"` period string. The input key names, the output keys, and the `"28 Day Period"` -> `"28DAY"` translation are undocumented.

---

## vx_restriction_view.ex

### Reading Evidence

**Module name:** `ApiServerWeb.VXRestrictionView`

**Public functions:**

| Function | Line |
|---|---|
| `render/2` ("index.json") | 5 |
| `render/2` ("show.json") | 9 |
| `render/2` ("vx_restriction.json") | 13 |

**Private functions:** None

**Types / errors / constants defined:** None

**Documentation present:**
- `@moduledoc`: absent
- `@doc` on any public function: absent

---

### Findings

#### B026-7 — Missing @moduledoc in VXRestrictionView
**Severity:** LOW
**File:** `lib/api_server_web/views/vx_restriction_view.ex`, line 1

The module `ApiServerWeb.VXRestrictionView` has no `@moduledoc`. There is no description of what a restriction (`vxaau_rest`) represents in the domain, which fields it carries, or what the module's role is within the view layer.

---

#### B026-8 — Missing @doc on render/2 ("index.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_restriction_view.ex`, line 5

The public function clause `render("index.json", ...)` has no `@doc`. The expected type of `vxaau_rest` (a list of restriction structs) and the `%{data: [...]}` envelope shape are undocumented.

---

#### B026-9 — Missing @doc on render/2 ("show.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_restriction_view.ex`, line 9

The public function clause `render("show.json", ...)` has no `@doc`. The expected type of `vx_restriction` and the `%{data: ...}` envelope shape are undocumented.

---

#### B026-10 — Missing @doc on render/2 ("vx_restriction.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_restriction_view.ex`, line 13

The public function clause `render("vx_restriction.json", ...)` has no `@doc`. The mapping from the struct's raw database column names (e.g., `aauid`, `aauuser_id`, `aaucustcode`, `aaufun`, `aaucharval`, `aaunumval`) to their semantic meaning is undocumented.

---

## vx_thing_event_view.ex

### Reading Evidence

**Module name:** `ApiServerWeb.VXThingEventView`

**Public functions:**

| Function | Line |
|---|---|
| `render/2` ("index.json") | 5 |
| `render/2` ("show.json") | 9 |
| `render/2` ("vx_thing_event.json") | 13 |

**Private functions:**

| Function | Line |
|---|---|
| `omega_to_map/1` | 18 |
| `thingevent_to_map/1` | 83 |

**Types / errors / constants defined:** None

**Documentation present:**
- `@moduledoc`: absent
- `@doc` on any public function: absent

---

### Findings

#### B026-11 — Missing @moduledoc in VXThingEventView
**Severity:** LOW
**File:** `lib/api_server_web/views/vx_thing_event_view.ex`, line 1

The module `ApiServerWeb.VXThingEventView` has no `@moduledoc`. There is no description of what a "thing event" is, the relationship to the `thingeventomega` association, or the module's place in the view layer.

---

#### B026-12 — Missing @doc on render/2 ("index.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_event_view.ex`, line 5

The public function clause `render("index.json", ...)` has no `@doc`. The expected type of `vxthingevents` and the `%{data: [...]}` envelope shape are undocumented.

---

#### B026-13 — Missing @doc on render/2 ("show.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_event_view.ex`, line 9

The public function clause `render("show.json", ...)` has no `@doc`. The expected type of `vx_thing_event` and the fact that the result is a flat map (no `%{data: ...}` wrapper, unlike the index clause) are undocumented.

---

#### B026-14 — Missing @doc on render/2 ("vx_thing_event.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_event_view.ex`, line 13

The public function clause `render("vx_thing_event.json", ...)` has no `@doc`. The function merges two large maps produced by the private helpers `thingevent_to_map/1` and `omega_to_map/1`, requiring `vx_thing_event.thingeventomega` to be preloaded. This preload requirement and the resulting merged field set (approximately 80 fields) are entirely undocumented.

---

## vx_thing_omega_view.ex

### Reading Evidence

**Module name:** `ApiServerWeb.VXThingOmegaView`

**Public functions:**

| Function | Line |
|---|---|
| `render/2` ("container_lift_report.json") | 6 |
| `render/2` ("lift_summary_report_fleet.json") | 17 |
| `render/2` ("lift_summary_report.json") | 39 |
| `render/2` ("lift_list_report.json") | 63 |
| `render/2` ("engine_utilization_report.json") | 77 |
| `render/2` ("operation_summary_report.json") | 92 |

**Private functions:**

| Function | Line |
|---|---|
| `translate_lift_type_to_string/1` | 139 |

**Types / errors / constants defined:** None

**Documentation present:**
- `@moduledoc`: absent
- `@doc` on any public function: absent

---

### Findings

#### B026-15 — Missing @moduledoc in VXThingOmegaView
**Severity:** LOW
**File:** `lib/api_server_web/views/vx_thing_omega_view.ex`, line 1

The module `ApiServerWeb.VXThingOmegaView` has no `@moduledoc`. There is no description of what "omega" sensor data represents, what kinds of reports are produced, or what external data sources (tuples from database queries) are expected.

---

#### B026-16 — Missing @doc on render/2 ("container_lift_report.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_omega_view.ex`, line 6

The public function clause `render("container_lift_report.json", ...)` has no `@doc`. The expected shape of `lifts_by_day` (a list of 3-tuples `{{year, month, day}, day_name, lift_count}`) and the returned JSON structure are undocumented.

---

#### B026-17 — Missing @doc on render/2 ("lift_summary_report_fleet.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_omega_view.ex`, line 17

The public function clause `render("lift_summary_report_fleet.json", ...)` has no `@doc`. The expected shape of `lifts_by_day` (an 8-element tuple per entry) and the meaning of `count_20`, `count_30`, `count_40`, `count_chain`, and `count_bottom` fields are undocumented.

---

#### B026-18 — Missing @doc on render/2 ("lift_summary_report.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_omega_view.ex`, line 39

The public function clause `render("lift_summary_report.json", ...)` has no `@doc`. The expected shape of `lifts_by_day` (a 9-element tuple per entry, adding `thing_name` compared to the fleet variant) and the distinction from `lift_summary_report_fleet.json` are undocumented.

---

#### B026-19 — Missing @doc on render/2 ("lift_list_report.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_omega_view.ex`, line 63

The public function clause `render("lift_list_report.json", ...)` has no `@doc`. The expected shape of `all_lifts` (a list of 5-tuples `{datetime, lift_type, vehicle_load, operator, thing_name}`), the use of `Timex.to_datetime/1` on the raw datetime value, and the mapping of `lift_type` integers via `translate_lift_type_to_string/1` are undocumented.

---

#### B026-20 — Missing @doc on render/2 ("engine_utilization_report.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_omega_view.ex`, line 77

The public function clause `render("engine_utilization_report.json", ...)` has no `@doc`. The expected shape of `engine_use_by_day` (a list of 2-element lists where the first element is a date tuple) and the derived `high_idle` field (computed as `max(0, engine_hours - idle_hours)`) are undocumented.

---

#### B026-21 — Missing @doc on render/2 ("operation_summary_report.json")
**Severity:** INFO
**File:** `lib/api_server_web/views/vx_thing_omega_view.ex`, line 92

The public function clause `render("operation_summary_report.json", ...)` has no `@doc`. The expected shape of `operation_data` (a list of 6-element tuples), the division-by-zero guards applied before computing `average_lifts_per_hour`, `average_fuel_per_hour`, and `average_fuel_per_lift`, and the use of `Decimal` arithmetic throughout are undocumented.

---

## Summary

| ID | Severity | File | Description |
|---|---|---|---|
| B026-1 | LOW | vx_rental_view.ex:1 | Missing @moduledoc in VXRentalView |
| B026-2 | INFO | vx_rental_view.ex:8 | Missing @doc on render/2 ("rhm_rentals.json") |
| B026-3 | INFO | vx_rental_view.ex:13 | Missing @doc on render/2 ("rhm_rental.json") |
| B026-4 | INFO | vx_rental_view.ex:64 | Missing @doc on render/2 ("midpac_report.json") |
| B026-5 | INFO | vx_rental_view.ex:68 | Missing @doc on render/2 ("rental_anniversaries.json") |
| B026-6 | INFO | vx_rental_view.ex:73 | Missing @doc on convert_json_to_changeset/1 |
| B026-7 | LOW | vx_restriction_view.ex:1 | Missing @moduledoc in VXRestrictionView |
| B026-8 | INFO | vx_restriction_view.ex:5 | Missing @doc on render/2 ("index.json") |
| B026-9 | INFO | vx_restriction_view.ex:9 | Missing @doc on render/2 ("show.json") |
| B026-10 | INFO | vx_restriction_view.ex:13 | Missing @doc on render/2 ("vx_restriction.json") |
| B026-11 | LOW | vx_thing_event_view.ex:1 | Missing @moduledoc in VXThingEventView |
| B026-12 | INFO | vx_thing_event_view.ex:5 | Missing @doc on render/2 ("index.json") |
| B026-13 | INFO | vx_thing_event_view.ex:9 | Missing @doc on render/2 ("show.json") |
| B026-14 | INFO | vx_thing_event_view.ex:13 | Missing @doc on render/2 ("vx_thing_event.json") |
| B026-15 | LOW | vx_thing_omega_view.ex:1 | Missing @moduledoc in VXThingOmegaView |
| B026-16 | INFO | vx_thing_omega_view.ex:6 | Missing @doc on render/2 ("container_lift_report.json") |
| B026-17 | INFO | vx_thing_omega_view.ex:17 | Missing @doc on render/2 ("lift_summary_report_fleet.json") |
| B026-18 | INFO | vx_thing_omega_view.ex:39 | Missing @doc on render/2 ("lift_summary_report.json") |
| B026-19 | INFO | vx_thing_omega_view.ex:63 | Missing @doc on render/2 ("lift_list_report.json") |
| B026-20 | INFO | vx_thing_omega_view.ex:77 | Missing @doc on render/2 ("engine_utilization_report.json") |
| B026-21 | INFO | vx_thing_omega_view.ex:92 | Missing @doc on render/2 ("operation_summary_report.json") |
