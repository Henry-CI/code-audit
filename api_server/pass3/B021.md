# Pass 3: Documentation — B021
**Agent:** B021
**Files:**
- `lib/api_server_web/resolvers/puls.ex`
- `lib/api_server_web/resolvers/things.ex`

**Date:** 2026-02-27

---

## lib/api_server_web/resolvers/puls.ex

### Reading Evidence

**Module name:** `ApiServerWeb.Resolvers.Puls`

**Public functions:**

| Function | Arity | Line |
|---|---|---|
| `puls_record/3` | 3 | 3 |

**Types defined:** None

**Error constants defined:** None

**Other constants/module attributes defined:** None (the token string on line 4 is a bare local variable, not a module attribute)

**@moduledoc present:** No

**@doc present on any function:** No

**@spec present on any function:** No

---

### Findings

#### B021-1 — Missing @moduledoc in ApiServerWeb.Resolvers.Puls
**Severity:** LOW
**File:** `lib/api_server_web/resolvers/puls.ex`, line 1

The module `ApiServerWeb.Resolvers.Puls` has no `@moduledoc` attribute. There is no description of the module's purpose, which is to act as a GraphQL resolver for fetching device records from the CalAmp PULS API.

---

#### B021-2 — Missing @doc on puls_record/3
**Severity:** INFO
**File:** `lib/api_server_web/resolvers/puls.ex`, line 3

The public function `puls_record/3` has no `@doc` attribute. A reader has no way to know from documentation alone that this function:
- Accepts a `hardwareid` extracted from the arguments map
- Makes an HTTP GET request to the CalAmp PULS external API
- On HTTP error, blocks the calling process for 60 seconds and then retries recursively
- On HTTP success, decodes the JSON body and returns a map with keys `:esn`, `:iccid`, and `:group`
- Returns `{:ok, record}` on success

---

#### B021-3 — Missing @spec on puls_record/3
**Severity:** INFO
**File:** `lib/api_server_web/resolvers/puls.ex`, line 3

The public function `puls_record/3` has no `@spec` attribute. Standard Elixir convention for public resolver functions is to declare input and return types. The expected return shape is `{:ok, map()} | {:error, any()}`, but this is not documented.

---

## lib/api_server_web/resolvers/things.ex

### Reading Evidence

**Module name:** `ApiServerWeb.Resolvers.Things`

**Public functions:**

| Function | Arity | Line |
|---|---|---|
| `find_thing/3` | 3 | 3 |
| `get_all_things/3` | 3 | 13 |

**Types defined:** None

**Error constants defined:** None

**Other constants/module attributes defined:** None

**@moduledoc present:** No

**@doc present on any function:** No

**@spec present on any function:** No

---

### Findings

#### B021-4 — Missing @moduledoc in ApiServerWeb.Resolvers.Things
**Severity:** LOW
**File:** `lib/api_server_web/resolvers/things.ex`, line 1

The module `ApiServerWeb.Resolvers.Things` has no `@moduledoc` attribute. There is no description of the module's purpose, which is to act as a GraphQL resolver for looking up and listing VX "things" (devices) scoped to a customer.

---

#### B021-5 — Missing @doc on find_thing/3
**Severity:** INFO
**File:** `lib/api_server_web/resolvers/things.ex`, line 3

The public function `find_thing/3` has no `@doc` attribute. A reader has no way to know from documentation alone that this function:
- Accepts `aadhardwareid` (mapped locally to `hardwareid`) and `customer` from the arguments map
- Delegates to `ApiServer.Vx.get_vx_thing_with_hardware_id!/2`
- Returns `{:ok, thing}` on success or `{:error, message}` when the hardware ID is not found for that customer

---

#### B021-6 — Missing @doc on get_all_things/3
**Severity:** INFO
**File:** `lib/api_server_web/resolvers/things.ex`, line 13

The public function `get_all_things/3` has no `@doc` attribute. A reader has no way to know from documentation alone that this function:
- Accepts `customer` from the arguments map
- Delegates to `ApiServer.Vx.list_vxthings/1`
- Converts the `aadhardwareid` field on every returned thing from an integer to a string before returning
- Returns `{:ok, list}` on success or `{:error, message}` when the query returns `nil`

---

#### B021-7 — Missing @spec on find_thing/3
**Severity:** INFO
**File:** `lib/api_server_web/resolvers/things.ex`, line 3

The public function `find_thing/3` has no `@spec` attribute. The expected return shape is `{:ok, map()} | {:error, String.t()}`, but this is not declared.

---

#### B021-8 — Missing @spec on get_all_things/3
**Severity:** INFO
**File:** `lib/api_server_web/resolvers/things.ex`, line 13

The public function `get_all_things/3` has no `@spec` attribute. The expected return shape is `{:ok, list(map())} | {:error, String.t()}`, but this is not declared.

---

## Summary

| ID | Severity | File | Description |
|---|---|---|---|
| B021-1 | LOW | puls.ex:1 | Missing @moduledoc in ApiServerWeb.Resolvers.Puls |
| B021-2 | INFO | puls.ex:3 | Missing @doc on puls_record/3 |
| B021-3 | INFO | puls.ex:3 | Missing @spec on puls_record/3 |
| B021-4 | LOW | things.ex:1 | Missing @moduledoc in ApiServerWeb.Resolvers.Things |
| B021-5 | INFO | things.ex:3 | Missing @doc on find_thing/3 |
| B021-6 | INFO | things.ex:13 | Missing @doc on get_all_things/3 |
| B021-7 | INFO | things.ex:3 | Missing @spec on find_thing/3 |
| B021-8 | INFO | things.ex:13 | Missing @spec on get_all_things/3 |
