# Pass 3 Findings: A10

---

## File: ToggleImageButton.java
**Path:** `LibCommon/src/main/java/com/yy/libcommon/ToggleImageButton.java`

### Reading Evidence
- **Class:** `ToggleImageButton extends ImageButton implements Checkable`
- **Public Methods:**
  - `ToggleImageButton(Context context)` (line 16) — constructor
  - `ToggleImageButton(Context context, AttributeSet attrs)` (line 20) — constructor
  - `ToggleImageButton(Context context, AttributeSet attrs, int defStyle)` (line 25) — constructor
  - `isChecked()` (line 43)
  - `setChecked(boolean checked)` (line 48)
  - `toggle()` (line 61)
  - `performClick()` (line 66)
  - `getOnCheckedChangeListener()` (line 71)
  - `setOnCheckedChangeListener(OnCheckedChangeListener)` (line 75)
  - `setOnClickListener(OnCheckedChangeListener)` (line 79)
  - `OnCheckedChangeListener.onCheckedChanged(ToggleImageButton, boolean)` (line 84) — public method on inner class
- **Constants/Types:**
  - `checkedDrawable` (int, package-private field, line 30)
  - `uncheckedDrawable` (int, package-private field, line 31)
  - `isChecked` (boolean, package-private field, line 14)
  - Inner class: `OnCheckedChangeListener` (static public class, line 83)

### Findings

#### A10-1: No Javadoc on any public method or the class itself [INFO]
- **File:** `ToggleImageButton.java`, Lines 12–87
- **Description:** The class and all of its public methods (`ToggleImageButton` constructors, `isChecked`, `setChecked`, `toggle`, `performClick`, `getOnCheckedChangeListener`, `setOnCheckedChangeListener`, `setOnClickListener`, inner class `OnCheckedChangeListener` and its method `onCheckedChanged`) have no Javadoc comments whatsoever.

#### A10-2: `setOnClickListener(OnCheckedChangeListener)` is a no-op with no documentation [LOW]
- **File:** `ToggleImageButton.java`, Lines 79–81
- **Description:** The public method `setOnClickListener(OnCheckedChangeListener)` has an empty body — it takes a parameter and does nothing with it. The method name strongly implies it registers a click listener (and shadows `View.setOnClickListener`), but the implementation silently discards the argument. There is no Javadoc, no comment explaining the intentional no-op, and no `@deprecated` or `@Override` annotation. A caller who uses this method expecting click-listener registration will be silently surprised. At minimum, this needs documentation explaining that `View.setOnClickListener` is intentionally suppressed in favour of `setOnCheckedChangeListener`.

#### A10-3: `setChecked` sets image resource using `setBackgroundResource`-style logic but a commented-out line suggests prior behaviour [INFO]
- **File:** `ToggleImageButton.java`, Lines 51–53
- **Description:** Line 51 contains a commented-out call to `setBackgroundResource(...)`. The active implementation uses `setImageResource(...)` instead. No comment or Javadoc explains why the background approach was abandoned. While this is not strictly a documentation inaccuracy (there is no doc to be inaccurate), it leaves dead code without explanation and could confuse maintainers.

---

## File: Util.java
**Path:** `LibCommon/src/main/java/com/yy/libcommon/Util.java`

### Reading Evidence
- **Class:** `Util` (utility class, no superclass beyond Object)
- **Public Methods:**
  - `arrayListFromStrings(String[] ar)` (line 46)
  - `generateDeviceId(Context pContext)` (line 56)
  - `colorToHexString(int color)` (line 86)
  - `dpToPx(int dp, Context pContext)` (line 90)
  - `dpToPx(float dp, Context pContext)` (line 103) — overload
  - `getLastDigitSufix(int number)` (line 116)
  - `getRandomInstanceId()` (line 126)
  - `getRandomString()` (line 134)
  - `getRandomNumber()` (line 150)
  - `isStringEmpty(String input)` (line 168)
  - `setLayoutClickable(View view, boolean enabled)` (line 172)
  - `decodeFile(String path, int maxSize)` (line 190)
  - `decodeFile(File f, int maxSize)` (line 194)
  - `preProcessBitmapToByteArray(String pathToOurFile)` (line 236)
  - `preProcessBitmap(Bitmap bitmap, ByteArrayOutputStream byteArrayOutputStream)` (line 257)
  - `decodeFileFixOrientation(String file)` (line 281)
  - `bigDecimalToPriceStr(BigDecimal bigDecimal)` (line 309)
  - `bigDecimalsAreTheSame(BigDecimal bd1, BigDecimal bd2)` (line 313)
  - `integersAreTheSame(Integer i1, Integer i2)` (line 340)
  - `getRealPathFromURI(Context context, Uri contentUri)` (line 367)
- **Constants/Types:**
  - `MAX_UPLOAD_IMAGE_SIZE` (`public final static int`, value `480`, line 44)

### Findings

#### A10-4: Nearly all public methods lack Javadoc [INFO]
- **File:** `Util.java`, Lines 46–382
- **Description:** Of the 20 public methods, only `getLastDigitSufix` (line 113–115) has a Javadoc comment. All other public methods — `arrayListFromStrings`, `generateDeviceId`, `colorToHexString`, `dpToPx` (both overloads), `getRandomInstanceId`, `getRandomString`, `getRandomNumber`, `isStringEmpty`, `setLayoutClickable`, `decodeFile` (both overloads), `preProcessBitmapToByteArray`, `preProcessBitmap`, `decodeFileFixOrientation`, `bigDecimalToPriceStr`, `bigDecimalsAreTheSame`, `integersAreTheSame`, `getRealPathFromURI` — have no Javadoc.

#### A10-5: `isStringEmpty` returns `false` for `null` input — misleading name [MEDIUM]
- **File:** `Util.java`, Line 168–170
- **Description:** The method is named `isStringEmpty` and its implementation is:
  ```java
  return (input != null && input.length() == 0);
  ```
  This returns `false` when `input` is `null`. A method named `isStringEmpty` would conventionally return `true` for `null` (treating null as empty), or at least document the null-exclusion behaviour. There is no Javadoc explaining this semantic. Any caller who passes `null` expecting `true` will receive a silently incorrect result.

#### A10-6: `getRandomNumber` returns a biased, off-by-one result with no documentation [MEDIUM]
- **File:** `Util.java`, Lines 150–166
- **Description:** The method always returns `randomInt - 1` unless `randomInt` is `0`, in which case it returns `0`. The range from `random.nextInt(_CHAR.length())` is `[0, 35]`. The adjustment means the method can never return `35` (the index of `'0'` at the end of `_CHAR`), and the character at index `0` (`'A'`) has double the probability compared to others. There is no Javadoc explaining why the offset exists or what the intended return range is.

#### A10-7: `generateDeviceId` can return a low-entropy 4-digit random string in the emulator path with no documentation [LOW]
- **File:** `Util.java`, Lines 56–84
- **Description:** When `WifiInfo.getMacAddress()` or `Settings.Secure.ANDROID_ID` returns null (or on emulator), the method catches `NullPointerException` and returns a random integer in the range `[1000, 99999]`. There is no Javadoc documenting this fallback, the range of the returned string, or the fact that it will be non-unique across devices. Callers treating the return value as a reliable device identifier may have correctness issues.

#### A10-8: `dpToPx(float, Context)` overload does not guard against null Context [LOW]
- **File:** `Util.java`, Lines 103–111
- **Description:** The `dpToPx(int, Context)` overload (line 90) has a null-check for `pContext` and returns `0` safely. The `dpToPx(float, Context)` overload (line 103) has no null-check and will throw `NullPointerException` if `pContext` is null. Neither overload has Javadoc. The inconsistency is a latent defect that documentation could at minimum have flagged.

#### A10-9: `bigDecimalToPriceStr` hard-codes USD `$` symbol with no documentation [INFO]
- **File:** `Util.java`, Line 309–311
- **Description:** The method prepends a literal `"$"` character. There is no Javadoc noting the currency assumption. Callers in other locales or currencies would produce incorrect output with no warning.

#### A10-10: `decodeFile(File, int)` uses deprecated `inPurgeable` option with no documentation [INFO]
- **File:** `Util.java`, Line 218
- **Description:** `BitmapFactory.Options.inPurgeable` was deprecated in API level 21. The code sets `o2.inPurgeable = true` with no comment or Javadoc noting the deprecation or any minimum API constraint.

---

## File: WebActivity.java
**Path:** `LibCommon/src/main/java/com/yy/libcommon/WebActivity.java`

### Reading Evidence
- **Class:** `WebActivity extends BaseActivity`
- **Public Methods:**
  - `onCreate(Bundle savedInstanceState)` (line 23) — `@Override`
- **Constants/Types:**
  - `URL_KEY` (`static public final String`, value `"com.webactivity.url"`, line 20)
- **Package-private methods (not public, noted for completeness):**
  - `initWebView()` (line 32) — package-private

### Findings

#### A10-11: No Javadoc on the class or any public member [INFO]
- **File:** `WebActivity.java`, Lines 13–86
- **Description:** The class `WebActivity`, the constant `URL_KEY`, and the overridden `onCreate` method have no Javadoc. `URL_KEY` is the Intent extra key that a caller must use to pass a URL to this Activity; its lack of documentation means external callers have no contract description of what value to supply or what format the URL should take.

#### A10-12: `initWebView` silently crashes if the `URL_KEY` Intent extra is absent [LOW]
- **File:** `WebActivity.java`, Lines 32–85
- **Description:** `getIntent().getStringExtra(URL_KEY)` returns `null` when the extra is not provided. `webView.loadUrl(null)` (line 84) will throw a `NullPointerException` at runtime. There is no Javadoc on `URL_KEY` documenting that it is mandatory, no null-guard in `initWebView`, and no documentation stating the Activity's launch requirement.

#### A10-13: Contradictory zoom settings applied with no explanatory comment [INFO]
- **File:** `WebActivity.java`, Lines 44–46
- **Description:** `setDisplayZoomControls(false)` disables the on-screen zoom controls, `setSupportZoom(false)` disables all zoom, but then `setBuiltInZoomControls(true)` re-enables the built-in pinch-zoom mechanism. The combined effect (built-in zoom gestures active, UI zoom buttons hidden) may be intentional, but there is no comment or Javadoc explaining this combination. Maintainers may inadvertently break the intended UX when modifying these settings.
