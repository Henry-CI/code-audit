# Pass 3 Findings: A12

---

## File: AndroidImagePicker.java
**Full path:** `LibImagePicker/src/main/java/com/pizidea/imagepicker/AndroidImagePicker.java`

### Reading Evidence

- **Class:** `AndroidImagePicker` (public, singleton)
- **Public Methods:**
  - `getInstance()` (line 71)
  - `getSelectLimit()` (line 83)
  - `setSelectLimit(int)` (line 86)
  - `getSelectMode()` (line 91)
  - `isShouldShowCamera()` (line 99)
  - `getCurrentPhotoPath()` (line 107)
  - `addOnImageSelectedChangeListener(OnImageSelectedChangeListener)` (line 115)
  - `removeOnImageItemSelectedChangeListener(OnImageSelectedChangeListener)` (line 123)
  - `addOnImageCropCompleteListener(OnImageCropCompleteListener)` (line 149)
  - `removeOnImageCropCompleteListener(OnImageCropCompleteListener)` (line 157)
  - `notifyImageCropComplete(Bitmap, int)` (line 164)
  - `setOnImagePickCompleteListener(OnImagePickCompleteListener)` (line 178)
  - `deleteOnImagePickCompleteListener(OnImagePickCompleteListener)` (line 182)
  - `notifyOnImagePickComplete()` (line 189)
  - `getImageSets()` (line 202)
  - `getImageItemsOfCurrentImageSet()` (line 206)
  - `setImageSets(List<ImageSet>)` (line 214)
  - `clearImageSets()` (line 218)
  - `getCurrentSelectedImageSetPosition()` (line 225)
  - `setCurrentSelectedImageSetPosition(int)` (line 229)
  - `addSelectedImageItem(int, ImageItem)` (line 234)
  - `deleteSelectedImageItem(int, ImageItem)` (line 240)
  - `isSelect(int, ImageItem)` (line 246)
  - `getSelectImageCount()` (line 250)
  - `onDestroy()` (line 257)
  - `getSelectedImages()` (line 277)
  - `clearSelectedImages()` (line 283)
  - `getCroppedBitmap(Bitmap)` (line 290) — static
  - `makeCropBitmap(Bitmap, Rect, RectF, int)` (line 312) — static
  - `takePicture(Activity, int)` (line 392)
  - `takePicture(Fragment, int)` (line 412)
  - `galleryAddPic(Context, String)` (line 444) — static
  - `pickSingle(Activity, boolean, OnImagePickCompleteListener)` (line 480)
  - `pickMulti(Activity, boolean, OnImagePickCompleteListener)` (line 496)
  - `pickAndCrop(Activity, boolean, int, OnImageCropCompleteListener)` (line 513)

- **Public Fields:**
  - `TAG` (line 58) — `public static final String`
  - `REQ_CAMERA` (line 60) — `public static final int = 1431`
  - `REQ_PREVIEW` (line 61) — `public static final int = 2347`
  - `KEY_PIC_PATH` (line 64) — `public static final String`
  - `KEY_PIC_SELECTED_POSITION` (line 65) — `public static final String`
  - `cropMode` (line 67) — `public boolean`
  - `cropSize` (line 68) — `public int`
  - `mSelectedImages` (line 201) — `Set<ImageItem>` (package-private)

- **Interfaces defined (public):**
  - `OnImageSelectedChangeListener` (line 456)
  - `OnImageCropCompleteListener` (line 460)
  - `OnImagePickCompleteListener` (line 464)
  - `Select_Mode` (line 468) — constants `MODE_SINGLE = 0`, `MODE_MULTI = 1`

---

### Findings

#### A12-1: `getInstance()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 71
- **Description:** The singleton accessor `getInstance()` has no Javadoc comment. There is no documentation describing the double-checked locking pattern used, thread-safety guarantees, or the fact that it returns the single shared instance. Callers have no documentation to rely on.

#### A12-2: `getSelectLimit()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 83
- **Description:** No Javadoc. The method returns the maximum number of images the user can select. Neither the return value semantics nor the default value (9) are documented.

#### A12-3: `setSelectLimit(int)` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 86
- **Description:** No Javadoc. The parameter and the effect on picker behaviour are undocumented.

#### A12-4: `getSelectMode()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 91
- **Description:** No Javadoc. No explanation that the return value maps to `Select_Mode.MODE_SINGLE` or `Select_Mode.MODE_MULTI`.

#### A12-5: `isShouldShowCamera()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 99
- **Description:** No Javadoc. Purpose and default value (`true`) are undocumented.

#### A12-6: `getCurrentPhotoPath()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 107
- **Description:** No Javadoc. No documentation that this path is set only after `takePicture()` is called, or that it may be `null` before any photo is taken.

#### A12-7: `addOnImageSelectedChangeListener()` Javadoc is misleading [LOW]
- **File:** `AndroidImagePicker.java`, Line: 111–122
- **Description:** The Javadoc comment at line 111 reads "Listeners of image selected changes, if you want to custom the Activity of ImagesGrid or ImagePreview, you might use it." This description frames the listener as being for Activity customisation, which is inaccurate. The actual purpose is to receive callbacks when the set of selected images changes (items added or removed). The conditional-customisation framing could mislead developers into omitting the listener for the common selection-tracking use-case.

#### A12-8: `removeOnImageItemSelectedChangeListener()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 123
- **Description:** No Javadoc. The method name contains a minor inconsistency with its counterpart (`addOnImageSelectedChangeListener` vs. `removeOnImageItem...`) but this is not documented or explained.

#### A12-9: `addOnImageCropCompleteListener()` — block comment is not Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 145–156
- **Description:** The comment at line 145 (`/** listeners of image crop complete */`) is a bare one-liner with no `@param` or description of when the callback fires. It is insufficient to describe the listener lifecycle (multiple listeners may be registered; all are called on crop completion).

#### A12-10: `removeOnImageCropCompleteListener()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 157
- **Description:** No Javadoc. No documentation of the no-op behaviour when `mImageCropCompleteListeners` is `null`.

#### A12-11: `notifyImageCropComplete(Bitmap, int)` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 164
- **Description:** No Javadoc. This is a public method intended to be called by crop-result handlers; the `ratio` parameter semantics are entirely undocumented. The `ratio` value is declared as `int` here but the `OnImageCropCompleteListener.onImageCropComplete` callback signature declares it as `float ratio` — this mismatch is not explained anywhere.

#### A12-12: `notifyImageCropComplete` parameter type mismatch with interface is undocumented [MEDIUM]
- **File:** `AndroidImagePicker.java`, Line: 164 and Line: 461
- **Description:** `notifyImageCropComplete(Bitmap bmp, int ratio)` accepts `ratio` as `int`, but the `OnImageCropCompleteListener.onImageCropComplete(Bitmap bmp, float ratio)` callback declares it as `float`. Java silently widens the `int` to `float` at the call site (line 168), meaning sub-unit precision is silently discarded before the callback receives the value. Neither method has any documentation warning callers about this implicit narrowing/widening relationship. This is a silent correctness risk for any caller that passes a fractional ratio.

#### A12-13: `setOnImagePickCompleteListener()` — Javadoc block is inadequate [INFO]
- **File:** `AndroidImagePicker.java`, Line: 174–179
- **Description:** The comment at line 174 (`/** Listener when image pick completed */`) describes the field, not the method. There is no `@param` tag, no mention that only a single listener is supported (replacing any previously set listener), and no documentation of the `NullPointerException` risk in `deleteOnImagePickCompleteListener` if `mOnImagePickCompleteListener` is `null` when that method is called.

#### A12-14: `deleteOnImagePickCompleteListener()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 182
- **Description:** No Javadoc. The method compares class names (not object identity or equality) to decide whether to clear the listener. This non-obvious implementation detail — and the potential `NullPointerException` if `mOnImagePickCompleteListener` is `null` at the time of the call — are entirely undocumented.

#### A12-15: `notifyOnImagePickComplete()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 189
- **Description:** No Javadoc. No documentation that this is a public method intended for internal library use, that it delivers the current `mSelectedImages` snapshot to the registered listener, or that it silently no-ops when no listener is set.

#### A12-16: `getImageSets()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 202
- **Description:** No Javadoc. No documentation that the return value may be `null` before image scanning completes.

#### A12-17: `getImageItemsOfCurrentImageSet()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 206
- **Description:** No Javadoc. No documentation that the method returns `null` when `mImageSets` is `null`, or that it is indexed by `mCurrentSelectedImageSetPosition` (index 0 being "all images").

#### A12-18: `setImageSets()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 214
- **Description:** No Javadoc.

#### A12-19: `clearImageSets()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 218
- **Description:** No Javadoc. No documentation that the method also sets `mImageSets` to `null` (not merely clears the list contents), which has side-effects on callers that hold a reference to the previously returned list.

#### A12-20: `getCurrentSelectedImageSetPosition()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 225
- **Description:** No Javadoc. The significance of position 0 ("all images") is undocumented.

#### A12-21: `setCurrentSelectedImageSetPosition()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 229
- **Description:** No Javadoc. No bounds documentation or description of what happens if an out-of-bounds index is set.

#### A12-22: `addSelectedImageItem()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 234
- **Description:** No Javadoc. No documentation that duplicate items are silently ignored (since `mSelectedImages` is a `LinkedHashSet`), or that this method fires `notifyImageSelectedChanged`.

#### A12-23: `deleteSelectedImageItem()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 240
- **Description:** No Javadoc.

#### A12-24: `isSelect()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 246
- **Description:** No Javadoc. The `position` parameter appears to be unused by the method body; only `item` is checked against `mSelectedImages`. This discrepancy is undocumented.

#### A12-25: `getSelectImageCount()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 250
- **Description:** No Javadoc.

#### A12-26: `onDestroy()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 257
- **Description:** No Javadoc. Important lifecycle semantics — that `mSelectedImages` is intentionally NOT cleared (commented-out code at lines 267–268) — are undocumented. Callers relying on this method to reset all state will be misled.

#### A12-27: `getSelectedImages()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 277
- **Description:** No Javadoc. No documentation that a defensive copy of the internal set is returned (not the live backing collection).

#### A12-28: `clearSelectedImages()` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 283
- **Description:** No Javadoc.

#### A12-29: `getCroppedBitmap(Bitmap)` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 290
- **Description:** No Javadoc. The method crops a bitmap to a circular shape. The algorithm, the fact that the output dimensions equal the input dimensions, and the color constant `0xff424242` used as a paint colour are undocumented. There is also a commented-out rescaling block (lines 307–308) with no explanation.

#### A12-30: `makeCropBitmap(Bitmap, Rect, RectF, int)` has no Javadoc [INFO]
- **File:** `AndroidImagePicker.java`, Line: 312
- **Description:** No Javadoc. Parameters (`rectBox`, `imageMatrixRect`, `expectSize`) and their coordinate-space relationships are undocumented. The clamping logic (lines 321–333) and the simplified `k = expectSize` always-branch (lines 335–341, where `k` is unconditionally set to `expectSize` regardless of whether `width` is smaller or larger) are undocumented. The `OutOfMemoryError` catch with only a log message (returning a potentially unmodified bitmap) is undocumented.

#### A12-31: `takePicture(Activity, int)` Javadoc is a placeholder only [INFO]
- **File:** `AndroidImagePicker.java`, Line: 389–407
- **Description:** The Javadoc comment is "take picture" — a single line that restates the method name. No `@param` tags, no `@throws IOException` tag (the method declares `throws IOException`), and no documentation that the chosen file path is stored in `mCurrentPhotoPath`. The Activity-overload passes a bare `Uri.fromFile()` rather than a `FileProvider` URI, which will cause a `FileUriExposedException` on Android 7.0+ — this known limitation is entirely undocumented.

#### A12-32: `takePicture(Fragment, int)` Javadoc is a placeholder only [LOW]
- **File:** `AndroidImagePicker.java`, Line: 409–437
- **Description:** The Javadoc comment is "take picture" — identical to the Activity overload — with no `@param` tags and no `@throws IOException` tag. The hardcoded FileProvider authority `au.com.collectiveintelligence.fleetiq360.fileprovider` (line 429) is embedded with no documentation warning implementers that this string must match the authority declared in the app's `AndroidManifest.xml`. An incorrect authority will cause a `IllegalArgumentException` at runtime; the lack of any documentation significantly raises integration risk.

#### A12-33: `galleryAddPic(Context, String)` Javadoc is accurate but lacks `@param` tags [INFO]
- **File:** `AndroidImagePicker.java`, Line: 439–451
- **Description:** The Javadoc ("scan the photo so that the gallery can read it") is broadly accurate but provides no `@param` documentation for `ctx` or `path`. No note that `ACTION_MEDIA_SCANNER_SCAN_FILE` is deprecated on Android 4.4+ (where `MediaScannerConnection.scanFile()` is preferred).

#### A12-34: `pickSingle()` Javadoc is in Chinese only [LOW]
- **File:** `AndroidImagePicker.java`, Line: 474–487
- **Description:** The Javadoc comment (lines 474–478) is written entirely in Chinese. While the parameter annotations (`@param act 必须传一个Activity`, `@param showCamera 是否需要显示拍照按钮`, `@param l 回调Listener`) are technically present, an English-speaking maintainer or integrator has no accessible documentation. Additionally, `cropMode` is unconditionally set to `false` by this method — a side-effect that is not documented anywhere.

#### A12-35: `pickMulti()` Javadoc is in Chinese only [LOW]
- **File:** `AndroidImagePicker.java`, Line: 490–503
- **Description:** Same issue as A12-34. Javadoc is entirely in Chinese. The `cropMode = false` side-effect is also undocumented.

#### A12-36: `pickAndCrop()` Javadoc is in Chinese and incomplete [LOW]
- **File:** `AndroidImagePicker.java`, Line: 505–521
- **Description:** The Javadoc comment (lines 505–511) is written entirely in Chinese. One `@param` tag (`@param act`) has no description text; the others are minimal. The method uses `addOnImageCropCompleteListener` (allowing multiple listeners) rather than a single-setter pattern, and the `cropMode = true` side-effect is not noted. The interaction between `cropSize` and the crop UI is undocumented.

---

## File: ImgLoader.java
**Full path:** `LibImagePicker/src/main/java/com/pizidea/imagepicker/ImgLoader.java`

### Reading Evidence

- **Class:** `ImgLoader` (public interface)
- **Public Methods:**
  - `onPresentImage(ImageView imageView, String imageUri, int size)` (line 30)
- **Constants/Types:** None

### Findings

#### A12-37: `onPresentImage()` has no Javadoc [INFO]
- **File:** `ImgLoader.java`, Line: 30
- **Description:** The interface method `onPresentImage` has no Javadoc. The class-level comment mentions UIL, Picasso, or Glide as possible implementations, but the contract of `onPresentImage` itself — the expected format of `imageUri` (file path vs. URI vs. URL), the meaning of `size` (pixels? dp?), and any threading requirements — is entirely undocumented. Interface contracts are particularly important to document because implementors have no source to inspect.

---

## File: PicassoImgLoader.java
**Full path:** `LibImagePicker/src/main/java/com/pizidea/imagepicker/PicassoImgLoader.java`

### Reading Evidence

- **Class:** `PicassoImgLoader` (public, implements `ImgLoader`)
- **Public Methods:**
  - `onPresentImage(ImageView imageView, String imageUri, int size)` (line 31) — `@Override`
- **Constants/Types:** None

### Findings

#### A12-38: Class-level Javadoc is a placeholder [LOW]
- **File:** `PicassoImgLoader.java`, Line: 25–28
- **Description:** The class Javadoc reads `<b>desc your class</b>` — an unfilled template placeholder left over from the project scaffold. It provides no description of the class purpose, which is to implement `ImgLoader` using the Picasso image-loading library.

#### A12-39: `onPresentImage()` has no Javadoc [INFO]
- **File:** `PicassoImgLoader.java`, Line: 31
- **Description:** The overriding method has no Javadoc. Important implementation details are undocumented: (1) `imageUri` is treated as a file-system path (wrapped in `new File(imageUri)`) rather than a general URI — passing an HTTP URL or `content://` URI will silently fail; (2) `size` is used as `size/4*3` (integer arithmetic, deliberately resizing to 75% of the supplied size), which is a non-obvious behaviour that diverges from the `ImgLoader` interface contract implied by the parameter name; (3) several configuration options are commented out (`.dontAnimate()`, `.thumbnail(0.5f)`, `.override(size, size)`) with no explanation of why they were disabled; (4) the `Picasso.with()` factory method used here is deprecated in Picasso 2.71828+ (replaced by `Picasso.get()`).
