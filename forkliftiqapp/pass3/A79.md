# Pass 3 Findings: A79

## File: MyCommonValue.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/model/MyCommonValue.java`

### Reading Evidence
- Class: `MyCommonValue` (public)
- Public Methods: none
- Public Fields:
  - `currentEquipmentItem` (line 10) — `public static EquipmentItem`
  - `isCheckLocationPermissionDone` (line 11) — `public static Boolean`
  - `companyName` (line 13) — `public static String`
  - `companyContract` (line 14) — `public static String`
  - `companyRole` (line 15) — `public static String`
  - `companyenabled` (line 16) — `public static String`
- Constants/Types: none (no `final` fields, no enums, no inner types)
- Class-level comment: IDE-generated stub only — `/** Created by Administrator on 2017/6/18. */` (lines 5–7); not a Javadoc description

### Findings

#### A79-1: No class-level Javadoc on `MyCommonValue` [INFO]
- File: `MyCommonValue.java`, Line: 5
- Description: The only comment on the class is an IDE-generated creation stub (`Created by Administrator on 2017/6/18.`). This is not a Javadoc description. The purpose of the class — acting as a global singleton-style holder for shared application state (current equipment item, location permission flag, and company profile strings) — is entirely undocumented. A reader must infer intent from field names alone.

#### A79-2: All public fields undocumented [INFO]
- File: `MyCommonValue.java`, Lines: 10–16
- Description: None of the six public static fields carry a Javadoc comment:
  - `currentEquipmentItem` (line 10): purpose, lifecycle, and valid null semantics are undocumented.
  - `isCheckLocationPermissionDone` (line 11): the distinction between `false` (unchecked) and a denied result is undocumented.
  - `companyName` (line 13), `companyContract` (line 14), `companyRole` (line 15): source and update trigger undocumented.
  - `companyenabled` (line 16): type is `String` but the name implies a boolean; valid values (`"true"`/`"false"`, `"1"`/`"0"`, etc.) are undocumented.

#### A79-3: Field `companyenabled` uses inconsistent naming convention [INFO]
- File: `MyCommonValue.java`, Line: 16
- Description: All other fields follow camelCase (`companyName`, `companyContract`, `companyRole`), but `companyenabled` is entirely lowercase. While this is a style issue rather than a documentation issue, the absence of any comment means there is no explanation for the deviation. Documented intent would clarify whether this is intentional (e.g., matches a network response key) or an oversight.

---

## File: PreStartHistoryDb.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/model/PreStartHistoryDb.java`

### Reading Evidence
- Class: `PreStartHistoryDb` (public, extends `RealmObject`)
- Public Methods:
  - `hasPreStartDoneForToday(int driver_id, int unit_id)` (line 19) — `public static boolean`
- Package-private Methods (not public; listed for completeness):
  - `setPreStartDone(int driver_id, int unit_id)` (line 33) — `static void`
- Public Fields:
  - `userKey` (line 13) — `public int`, initialised to `WebData.instance().getUserId()`
  - `driver_id` (line 16) — `public int`
  - `unit_id` (line 17) — `public int`
- Private Fields:
  - `dateTime` (line 15) — `private String`
- Constants/Types: none
- Class-level Javadoc: none

### Findings

#### A79-4: No class-level Javadoc on `PreStartHistoryDb` [INFO]
- File: `PreStartHistoryDb.java`, Line: 11
- Description: The class has no Javadoc comment. Its purpose — persisting a record of completed pre-start checks per driver/unit pair via Realm — is not documented. Key design decisions (one record per driver+unit pair, overwritten on update; `dateTime` stored as an ISO-8601 string) are invisible without reading the implementation.

#### A79-5: `hasPreStartDoneForToday` is undocumented [INFO]
- File: `PreStartHistoryDb.java`, Line: 19
- Description: The public static method `hasPreStartDoneForToday(int driver_id, int unit_id)` has no Javadoc. The following behaviours are undocumented:
  - Return value semantics: returns `true` only if a history record exists for the given driver/unit pair AND its stored `dateTime` falls on the current calendar day (via `CommonFunc.isCurrentDay`).
  - Behaviour when no record exists: returns `false`.
  - Thread-safety: executes inside `SafeRealm.Execute`, which manages the Realm lifecycle; callers do not need to pass a Realm instance.
  - The method checks only the first result (`preStartHistories.get(0)`) when multiple records could theoretically exist — this implicit assumption is undocumented.

#### A79-6: Public fields `userKey`, `driver_id`, `unit_id` are undocumented [INFO]
- File: `PreStartHistoryDb.java`, Lines: 13, 16, 17
- Description: None of the three public fields carry Javadoc. In particular:
  - `userKey` is eagerly initialised at field-declaration time from `WebData.instance().getUserId()`, which means it captures the user ID at object-construction time rather than at persist time. This subtle lifecycle behaviour is completely undocumented.
  - `driver_id` and `unit_id` form a composite key for the Realm query but there is no documentation of this role or of the fact that the combination is treated as a logical unique identifier.

---

## File: PreStartQuestionDb.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/model/PreStartQuestionDb.java`

### Reading Evidence
- Class: `PreStartQuestionDb` (public, extends `RealmObject`)
- Public Methods:
  - `getQuestionResultArray(int equipmentId)` (line 37) — `public static PreStartQuestionResultArray`
  - `saveQuestions(int equipmentId, PreStartQuestionResultArray getEquipmentResultArray)` (line 53) — `public static void`
- Package-private Methods (not public; listed for completeness):
  - `needToCache(int equipmentId)` (line 26) — `static boolean`
- Private Methods:
  - `isExpired()` (line 22) — `private boolean`
- Public Fields:
  - `userKey` (line 15) — `public int`, initialised to `WebData.instance().getUserId()`
- Private Fields:
  - `updateTime` (line 17) — `private long` (epoch milliseconds)
  - `prestartQuestionResultArray` (line 18) — `private String` (JSON serialisation of `PreStartQuestionResultArray`)
  - `equipmentId` (line 20) — `private int`
- Constants/Types: none
- Class-level Javadoc: none

### Findings

#### A79-7: No class-level Javadoc on `PreStartQuestionDb` [INFO]
- File: `PreStartQuestionDb.java`, Line: 13
- Description: The class has no Javadoc comment. Its purpose — caching pre-start questions for a given equipment ID in Realm, with an expiry mechanism controlled by `DataBaseHelp.isExpired` — is entirely undocumented. The caching strategy (one record per `equipmentId`, upserted on save, checked for expiry via `updateTime`) must be reverse-engineered from the implementation.

#### A79-8: `getQuestionResultArray` is undocumented [INFO]
- File: `PreStartQuestionDb.java`, Line: 37
- Description: The public static method `getQuestionResultArray(int equipmentId)` has no Javadoc. Undocumented behaviours include:
  - Return value when a cached record exists: deserialises the stored JSON string into a `PreStartQuestionResultArray` object.
  - Return value when no cached record exists: returns a new, empty `PreStartQuestionResultArray` with an initialised but empty `arrayList`. This is a non-null default return — callers cannot use `null`-checking to detect a cache miss.
  - The method does NOT check expiry; it returns stale data without warning. Callers must call `needToCache` separately. This separation of concerns is undocumented.
  - Only the first result is used when multiple records with the same `equipmentId` exist.

#### A79-9: `saveQuestions` is undocumented [INFO]
- File: `PreStartQuestionDb.java`, Line: 53
- Description: The public static method `saveQuestions(int equipmentId, PreStartQuestionResultArray getEquipmentResultArray)` has no Javadoc. Undocumented behaviours include:
  - Upsert semantics: creates a new Realm record if none exists for `equipmentId`, otherwise overwrites the first existing record.
  - `updateTime` is set to `System.currentTimeMillis()` at save time, which resets the expiry clock.
  - The parameter name `getEquipmentResultArray` is a verb-form name (suggesting a getter) on a parameter that is an input value — this is misleading, and the absence of Javadoc means there is no corrective explanation.
  - No documented null-safety contract for the `getEquipmentResultArray` parameter.

#### A79-10: Public field `userKey` undocumented with non-obvious eager-initialisation [INFO]
- File: `PreStartQuestionDb.java`, Line: 15
- Description: Same pattern as `PreStartHistoryDb.userKey` (finding A79-6). The field is initialised at object-construction time from `WebData.instance().getUserId()`. If the user ID changes between construction and persistence (e.g., during a session hand-off), the stored value may not reflect the persisting user. This subtle behaviour is completely undocumented.
