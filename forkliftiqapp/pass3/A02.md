# Pass 3 Findings: A02

---

## File: LibCommon/src/main/java/com/yy/libcommon/BaseDialog.java

### Reading Evidence

- **Class:** `BaseDialog extends DialogFragment implements BaseController`
- **Public Fields:** `mGenericCallback` (line 27), `isDestroyed` (line 28)
- **Public Methods:**
  - `getScreenWidth()` (line 32)
  - `showProgress(String title, String message)` (line 39)
  - `showSavingProgress()` (line 45)
  - `showDeletingProgress()` (line 51)
  - `showLoadingProgress()` (line 57)
  - `updateProgress(String message)` (line 63)
  - `hideProgress()` (line 68)
  - `getBaseActivity()` (line 74)
  - `onDismiss(DialogInterface dialog)` (line 80) [override]
  - `showToast(String msg)` (line 88)
  - `onSaveInstanceState(Bundle outState)` (line 97) [override]
  - `onActivityCreated(Bundle savedInstanceState)` (line 102) [override]
  - `onDestroy()` (line 112) [override]
  - `onDetach()` (line 121) [override]
  - `onPause()` (line 130) [override]
  - `onResume()` (line 135) [override]
  - `onStart()` (line 141) [override]
  - `onStop()` (line 146) [override]
  - `getSubFragPermission()` (line 153)
  - `isDestroyed()` (line 159) [override]
  - `getCurrentFragmentManager()` (line 164) [override]
  - `hideKeyboard(View view)` (line 168)
  - `addFragment(FragmentManager fragmentManager, Fragment fragment, int container)` (line 174) [static]
  - `addFragment(FragmentManager fragmentManager, Fragment fragment, int container, boolean backStack)` (line 178) [static]
  - `removeFragment(FragmentManager fragmentManager, int container)` (line 189) [static]
  - `addFragment(Fragment fragment, int container)` (line 196) [instance]
  - `addFragment(Fragment fragment, int container, boolean backStack)` (line 201) [instance]
  - `removeSelfFromParent()` (line 211)
- **Constants/Types:** None defined in this class. Implements `BaseController` interface.
- **Class-level Javadoc:** Only an author/date comment block (lines 19–23); no class-purpose description.

### Findings

#### A02-1: No Javadoc on any public method in BaseDialog [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseDialog.java`, Lines 32–221
- **Description:** None of the public methods in `BaseDialog` have Javadoc comments. The only documentation present is an author/date block at the class level (lines 19–23) which does not describe the class purpose or contract. All of the following public methods are entirely undocumented:
  - `getScreenWidth()` (line 32)
  - `showProgress(String, String)` (line 39)
  - `showSavingProgress()` (line 45)
  - `showDeletingProgress()` (line 51)
  - `showLoadingProgress()` (line 57)
  - `updateProgress(String)` (line 63)
  - `hideProgress()` (line 68)
  - `getBaseActivity()` (line 74)
  - `showToast(String)` (line 88)
  - `getSubFragPermission()` (line 153)
  - `isDestroyed()` (line 159)
  - `getCurrentFragmentManager()` (line 164)
  - `hideKeyboard(View)` (line 168)
  - `addFragment(FragmentManager, Fragment, int)` static (line 174)
  - `addFragment(FragmentManager, Fragment, int, boolean)` static (line 178)
  - `removeFragment(FragmentManager, int)` static (line 189)
  - `addFragment(Fragment, int)` instance (line 196)
  - `addFragment(Fragment, int, boolean)` instance (line 201)
  - `removeSelfFromParent()` (line 211)

#### A02-2: `onDismiss` fires `mGenericCallback` with no null guard on dismissal source [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseDialog.java`, Lines 80–86
- **Description:** `onDismiss` is undocumented. The implementation invokes `mGenericCallback.callBack()` whenever a dismiss event occurs, regardless of how the dialog was dismissed (user cancel, back press, or programmatic). There is no Javadoc explaining this side-effect or the condition under which `mGenericCallback` is invoked. Callers who set `mGenericCallback` have no documented indication that it fires on every dismissal path.

#### A02-3: `addFragment` instance method silently delegates without documentation [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseDialog.java`, Lines 196–209
- **Description:** Two overloaded instance `addFragment` methods and the static overloads share the same name as `addFragment` static methods, creating four overloads with no documentation differentiating their behaviour. The instance overloads use `getChildFragmentManager()` while the static overloads accept an explicit `FragmentManager`. The distinction is important for correct use but is undocumented.

#### A02-4: `removeSelfFromParent()` calls `getChildFragmentManager().executePendingTransactions()` on child manager, not parent [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseDialog.java`, Lines 211–220
- **Description:** `removeSelfFromParent()` is undocumented. The implementation removes `this` from the parent fragment's child fragment manager (line 215–217) but then calls `getChildFragmentManager().executePendingTransactions()` (line 218) — i.e., it flushes *this* dialog's own child manager, not the parent's. This is likely a latent bug (executing transactions on the wrong manager), and the absence of any Javadoc means maintainers have no stated intent to compare against. The mismatch between stated goal (remove self from parent) and the pending-transactions call warrants documentation at minimum, and code review for correctness.

---

## File: LibCommon/src/main/java/com/yy/libcommon/BaseFragment.java

### Reading Evidence

- **Class:** `BaseFragment extends Fragment implements BaseController`
- **Public Fields/Constants:**
  - `REQUEST_TAKE_PHOTO = 200` (line 33) — `public static final int`
  - `isDestroyed` (line 38) — `public boolean`
  - `tempPhotoFilePath` (line 41) — `public String`
  - `subFragPermission` (line 42) — `public SubFragPermission`
- **Private Constants:**
  - `sChildFragmentManagerField` (line 35) — `private static final Field`
  - `LOGTAG = "BaseFragment"` (line 36) — `private static final String`
- **Public Methods:**
  - `takePhoto()` (line 45)
  - `getBaseActivity()` (line 90)
  - `BaseFragment()` constructor (line 94)
  - `getScreenWidth()` (line 97)
  - `setSimpleSpinner(Spinner spinner, int stringArrayId)` (line 104)
  - `showErrDialog(String s)` (line 112)
  - `showToast(String msg)` (line 116)
  - `showProgress(String title, String message)` (line 124)
  - `showSavingProgress()` (line 130)
  - `showDeletingProgress()` (line 136)
  - `showLoadingProgress()` (line 142)
  - `updateProgress(String message)` (line 148)
  - `hideProgress()` (line 154)
  - `onStart()` (line 172) [override]
  - `onActivityCreated(Bundle savedInstanceState)` (line 179) [override]
  - `onDetach()` (line 198) [override]
  - `onDestroy()` (line 212) [override]
  - `onStop()` (line 221) [override]
  - `onResume()` (line 227) [override]
  - `onPause()` (line 233) [override]
  - `showDialog(Context, String, String)` (line 237)
  - `showDialog(Context, String, String, boolean, ErrorDialog.OnErrorCallback)` (line 249)
  - `showDialog(Context, String, String, ErrorDialog.OnErrorCallback)` (line 263)
  - `getSubFragPermission()` (line 276)
  - `isDestroyed()` (line 281) [override]
  - `getCurrentFragmentManager()` (line 286) [override]
  - `addFragment(FragmentManager, Fragment, int)` static (line 292)
  - `addFragment(FragmentManager, Fragment, int, boolean)` static (line 296)
  - `removeFragment(FragmentManager, int)` static (line 305)
  - `addFragment(Fragment, int)` instance (line 311)
  - `addFragment(Fragment, int, boolean)` instance (line 315)
  - `removeSelfFromParent()` (line 324)
- **Constants/Types:** `REQUEST_TAKE_PHOTO = 200` (line 33)
- **Class-level Javadoc:** Only an author/date block (lines 26–30); no class-purpose description.

### Findings

#### A02-5: No Javadoc on any public method in BaseFragment [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseFragment.java`, Lines 45–332
- **Description:** None of the public methods in `BaseFragment` have Javadoc comments. The class-level comment is an author/date block only. All of the following public methods are entirely undocumented:
  - `takePhoto()` (line 45)
  - `getBaseActivity()` (line 90)
  - `getScreenWidth()` (line 97)
  - `setSimpleSpinner(Spinner, int)` (line 104)
  - `showErrDialog(String)` (line 112)
  - `showToast(String)` (line 116)
  - `showProgress(String, String)` (line 124)
  - `showSavingProgress()` (line 130)
  - `showDeletingProgress()` (line 136)
  - `showLoadingProgress()` (line 142)
  - `updateProgress(String)` (line 148)
  - `hideProgress()` (line 154)
  - `showDialog(Context, String, String)` (line 237)
  - `showDialog(Context, String, String, boolean, ErrorDialog.OnErrorCallback)` (line 249)
  - `showDialog(Context, String, String, ErrorDialog.OnErrorCallback)` (line 263)
  - `getSubFragPermission()` (line 276)
  - `isDestroyed()` (line 281)
  - `getCurrentFragmentManager()` (line 286)
  - `addFragment(FragmentManager, Fragment, int)` static (line 292)
  - `addFragment(FragmentManager, Fragment, int, boolean)` static (line 296)
  - `removeFragment(FragmentManager, int)` static (line 305)
  - `addFragment(Fragment, int)` instance (line 311)
  - `addFragment(Fragment, int, boolean)` instance (line 315)
  - `removeSelfFromParent()` (line 324)

#### A02-6: `takePhoto()` has undocumented side-effects and hardcoded authority string [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseFragment.java`, Lines 45–87
- **Description:** `takePhoto()` is undocumented. The method has multiple non-obvious behaviours that require documentation: (1) it performs asynchronous permission checks via `subFragPermission` before launching the camera; (2) it sets `tempPhotoFilePath` as a side-effect so the caller can retrieve the image path after `onActivityResult`; (3) it hardcodes the FileProvider authority string `au.com.collectiveintelligence.fleetiq360.fileprovider` (line 71), making the method non-reusable outside this specific application without modification. None of these behaviours or constraints are documented.

#### A02-7: `takePhoto()` sends `MediaStore.EXTRA_OUTPUT` extra twice, second silently overwriting first [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseFragment.java`, Lines 63–72
- **Description:** `takePhoto()` calls `takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(photoFile))` on line 63, then overwrites it with `takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, photoURI)` on line 72 (the FileProvider URI). The first `putExtra` call is therefore dead code. The absence of any comment or documentation makes this look like an intentional two-step, when in reality the first call has no effect. This could mislead future maintainers.

#### A02-8: `onDetach()` uses reflection to null out `mChildFragmentManager` with no documentation [LOW]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseFragment.java`, Lines 198–209 and static initializer lines 160–169
- **Description:** `onDetach()` uses a private static reflective `Field` (`sChildFragmentManagerField`) to forcibly set `mChildFragmentManager` to `null` on detach. This is an undocumented workaround — likely targeting a known Android support library memory-leak or crash bug. There is no comment anywhere in the class explaining *why* this reflection is needed, what bug it addresses, which library version introduced or fixed it, or whether it is still necessary. This is LOW severity because the missing documentation increases maintenance risk: a future developer could remove this code not understanding its purpose, or the reflection could silently break if the internal field name changes across library versions.

#### A02-9: `REQUEST_TAKE_PHOTO` constant undocumented [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseFragment.java`, Line 33
- **Description:** The public constant `REQUEST_TAKE_PHOTO = 200` has no Javadoc. Subclasses that override `onActivityResult` must use this value to identify camera results, but there is no documentation linking the constant to its purpose or usage pattern.

---

## File: LibCommon/src/main/java/com/yy/libcommon/BaseSubFragment.java

### Reading Evidence

- **Class:** `BaseSubFragment` (no superclass beyond `Object`, no interface)
- **Protected Fields:** `mRootView` (line 13), `mBaseController` (line 14), `mBaseActivity` (line 15), `isHidden` (line 16, initialised to `true`)
- **Public Methods:**
  - `BaseSubFragment(BaseController baseController, BaseActivity activity)` constructor (line 18)
  - `onActive(View rootView)` (line 25)
  - `onActive()` (line 30)
  - `isActive()` (line 34)
  - `onHidden()` (line 38)
  - `onDestroy()` (line 43)
- **Constants/Types:** None
- **Class-level Javadoc:** Only an author/date comment (lines 7–9); no class-purpose description.

### Findings

#### A02-10: No Javadoc on any public method in BaseSubFragment [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseSubFragment.java`, Lines 18–45
- **Description:** None of the public methods in `BaseSubFragment` have Javadoc comments. All of the following are entirely undocumented:
  - `BaseSubFragment(BaseController, BaseActivity)` constructor (line 18)
  - `onActive(View rootView)` (line 25)
  - `onActive()` (line 30)
  - `isActive()` (line 34)
  - `onHidden()` (line 38)
  - `onDestroy()` (line 43)

#### A02-11: `onActive(View)` and `onActive()` overloads have divergent behaviour with no documentation [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseSubFragment.java`, Lines 25–32
- **Description:** `onActive(View rootView)` sets `mRootView` and sets `isHidden = false`, while `onActive()` only sets `isHidden = false`. The no-arg `onActive()` leaves `mRootView` from a previous call (or `null` if never set). There is no documentation explaining when each overload should be called, whether `mRootView` is expected to be set before `onActive()` is called, or what the consequence is of calling the no-arg form without having first called the `View` form. This is particularly important because `isHidden` is initialised to `true` and the class provides no way to set `mRootView` other than through `onActive(View)`.

#### A02-12: `onDestroy()` is an empty method with no documentation of intent [INFO]

- **File:** `LibCommon/src/main/java/com/yy/libcommon/BaseSubFragment.java`, Lines 43–45
- **Description:** `onDestroy()` has an empty body and no Javadoc. Subclasses are expected to override it for cleanup, but there is no documentation stating this is a template method, what invariants should hold when it is called, or whether `super.onDestroy()` should be invoked by subclasses.
