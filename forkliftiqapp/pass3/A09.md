# Pass 3 Findings: A09

---

## File: SubFragPermission.java
**Full path:** `LibCommon/src/main/java/com/yy/libcommon/SubFragPermission.java`

### Reading Evidence

- **Class:** `SubFragPermission extends BaseSubFragment` (line 23)
- **Public Fields:**
  - `cameraPendingRunnable` (line 28, `public Runnable`)
  - `filePendingRunnable` (line 29, `public Runnable`)
- **Public Methods:**
  - `SubFragPermission(BaseActivity, BaseController)` — constructor (line 32)
  - `onCameraFeatureEnabled()` (line 37)
  - `onCameraFeatureDisabled()` (line 50)
  - `onFileFeatureEnabled()` (line 61)
  - `onFileFeatureDisabled()` (line 74)
  - `onActive()` (line 114)
  - `onHidden()` (line 123)
  - `onDestroy()` (line 128)
  - `checkCameraPermissionWithRun(Runnable)` (line 132)
  - `isFilePermissionEnabled(Context)` (line 150, `public static`)
  - `checkFilePermissionWithRun(Runnable)` (line 159)
  - `requestFilePermission()` (line 180)
  - `requestCameraPermission()` (line 191)
  - `onRequestPermissionsResult(int, String[], int[])` (line 202)
- **Constants:**
  - `FILE_EDIT_NOTIFY` (line 25, package-private `final String`) — value `"com.fleetiq.fleetiq360.file"`
  - `CAMERA_NOTIFY` (line 26, package-private `final String`) — value `"com.fleetiq.fleetiq360.file"`
  - `REQUEST_FILE_PERMISSION` (line 178, `public static final int`) — value `100`
  - `REQUEST_CAMERA_PERMISSION` (line 179, `public static final int`) — value `200`

### Findings

#### A09-1: No Javadoc on any public method or constructor [INFO]
- File: `SubFragPermission.java`, Lines: 32, 37, 50, 61, 74, 114, 123, 128, 132, 150, 159, 180, 191, 202
- Description: The class has a file-level block comment (author/date only, lines 18-22) but zero Javadoc comments (`/** ... */`) on any public method, constructor, or public field. All 14 public methods and 2 public fields are completely undocumented. Affected members: `SubFragPermission()`, `onCameraFeatureEnabled()`, `onCameraFeatureDisabled()`, `onFileFeatureEnabled()`, `onFileFeatureDisabled()`, `onActive()`, `onHidden()`, `onDestroy()`, `checkCameraPermissionWithRun()`, `isFilePermissionEnabled()`, `checkFilePermissionWithRun()`, `requestFilePermission()`, `requestCameraPermission()`, `onRequestPermissionsResult()`, `cameraPendingRunnable`, `filePendingRunnable`.

#### A09-2: `FILE_EDIT_NOTIFY` and `CAMERA_NOTIFY` share identical broadcast action string [LOW]
- File: `SubFragPermission.java`, Lines: 25-26
- Description: Both `FILE_EDIT_NOTIFY` (line 25) and `CAMERA_NOTIFY` (line 26) are assigned the same string value `"com.fleetiq.fleetiq360.file"`. This is almost certainly a copy-paste defect — the camera broadcast action should be distinct from the file broadcast action. Because these constants are not documented, there is no indication this is intentional. In `broadcastReceiver.onReceive()` (lines 95-109) the two `if` branches both match the same action string, meaning both camera and file handlers fire for every broadcast on that single action, creating silent misbehaviour. A documentation finding is raised here because the absence of any comment obscures the defect; correct documentation would either explain the intent or expose the bug.

#### A09-3: `onHidden()` is an empty stub with no documentation [INFO]
- File: `SubFragPermission.java`, Line: 123
- Description: `onHidden()` has an empty body with no comment explaining why it is intentionally a no-op (e.g., "unregistration is deferred to `onDestroy`"). Without documentation, it is impossible to distinguish an intentional empty override from an incomplete implementation.

#### A09-4: Public constants `REQUEST_FILE_PERMISSION` and `REQUEST_CAMERA_PERMISSION` have no Javadoc [INFO]
- File: `SubFragPermission.java`, Lines: 178-179
- Description: These public static final request codes are part of the class API — callers may need to reference them in `onRequestPermissionsResult` overrides — but carry no documentation describing their purpose or expected usage context.

---

## File: ThemedDialogSingleListAdapter.java
**Full path:** `LibCommon/src/main/java/com/yy/libcommon/ThemedDialogSingleListAdapter.java`

### Reading Evidence

- **Class:** `ThemedDialogSingleListAdapter<T> extends ArrayAdapter<T>` (line 19)
- **Public Methods:**
  - `ThemedDialogSingleListAdapter(Context, int, ArrayList<T>)` — constructor (line 28)
  - `ThemedDialogSingleListAdapter(Context, int, ArrayList<T>, ThemedSingleListDialog.SubCallback)` — constructor (line 35)
  - `setSelectedIndex(int)` (line 49)
  - `getView(int, View, ViewGroup)` (line 55, `@Override`)
  - `getCount()` (line 115, `@Override`)
  - `getItem(int)` (line 120, `@Override`)
- **Package-private fields:**
  - `context` (line 21), `layoutResourceId` (line 22), `data` (line 23), `mShowSubText` (line 25), `mSubCallback` (line 26)
- **Private fields:**
  - `mSelectedIndex` (line 24, `Integer`)
- **Inner class (package-private static):**
  - `ListHolder` (line 124) — ViewHolder pattern; fields: `textView`, `themed_dialog_single_list_item_subtextView`, `isSelectedImageView`
- **Constants/Types:** None beyond inherited `ArrayAdapter` constants.

### Findings

#### A09-5: No Javadoc on any public method or constructor [INFO]
- File: `ThemedDialogSingleListAdapter.java`, Lines: 28, 35, 49, 55, 115, 120
- Description: The class has a file-level block comment (author/date only, lines 14-18) but no Javadoc on any public member. All six public methods/constructors are completely undocumented. Affected members: both constructors, `setSelectedIndex()`, `getView()`, `getCount()`, `getItem()`.

#### A09-6: `getView()` — null item handled as "All" with no documentation [INFO]
- File: `ThemedDialogSingleListAdapter.java`, Lines: 89-91
- Description: When `getItem(position)` returns `null`, `getView()` silently sets the row text to `context.getString(R.string.all)` (the "All" sentinel). This is a non-obvious contract between the adapter and `ThemedSingleListDialog` (which inserts `null` at index 0 when `addAllAtTop` is true). No comment or Javadoc describes this convention, making the behaviour invisible to future maintainers of either class.

---

## File: ThemedSingleListDialog.java
**Full path:** `LibCommon/src/main/java/com/yy/libcommon/ThemedSingleListDialog.java`

### Reading Evidence

- **Class:** `ThemedSingleListDialog<T> extends BaseThemedDialog` (line 14)
- **Public Methods:**
  - `ThemedSingleListDialog()` — constructor (line 26)
  - `newInstance(ArrayList<T>, T, String, boolean, Callback<T>)` (line 30, `public static`)
  - `newInstance(ArrayList<T>, T, String, boolean, Callback<T>, SubCallback)` (line 50, `public static`)
- **Protected Methods (overrides):**
  - `setupViews()` (line 60, `@Override protected`)
- **Private Methods:**
  - `onClick(int)` (line 94)
- **Inner types:**
  - `SubCallback<T>` (line 44, `public static class`) — has one public method: `getSubText(T)` (line 45)
  - `Callback<T>` (line 104, `public interface`) — has one method: `callBack(T, int)` (line 105)
- **Fields (private):**
  - `mObjects`, `mCallback`, `mSubCallback`, `mTitle`, `mListView`, `mArrayAdapter`, `mSelectedObject`, `mAddAllOption`

### Findings

#### A09-7: No Javadoc on any public method, constructor, interface, or inner class [INFO]
- File: `ThemedSingleListDialog.java`, Lines: 26, 30, 44, 50, 104, 105
- Description: The class carries only a file-level author/date block comment (lines 9-13). None of the public members have Javadoc: the no-arg constructor, both `newInstance` factory methods, the `SubCallback` class and its `getSubText()` method, and the `Callback` interface and its `callBack()` method are all undocumented.

#### A09-8: `newInstance` (5-param) — `addAllAtTop` parameter behaviour undocumented [INFO]
- File: `ThemedSingleListDialog.java`, Line: 30
- Description: The `addAllAtTop` parameter causes a `null` sentinel to be inserted at index 0 of the caller-supplied `mObjects` list (line 65 in `setupViews`). This mutates the list passed by the caller, which is a side-effect that is not documented anywhere. A Javadoc `@param` note warning callers about the list mutation is absent.

#### A09-9: `SubCallback.getSubText()` returns empty string by default with no documentation [INFO]
- File: `ThemedSingleListDialog.java`, Lines: 44-48
- Description: `SubCallback` is a concrete class (not abstract) whose `getSubText()` method returns `""` by default. There is no Javadoc explaining that subclasses are expected to override it, the intended return contract, or what happens when `""` is returned (the sub-text view is populated with an empty string and made visible). Without documentation this pattern (a non-abstract "default" base class meant for subclassing) is opaque.

#### A09-10: `Callback.callBack()` — `index` parameter semantics undocumented [INFO]
- File: `ThemedSingleListDialog.java`, Lines: 104-106
- Description: The `callBack(T object, int index)` interface method exposes both the selected object and its adapter position. When `addAllAtTop` is `true` the position 0 maps to `null` (the "All" item). There is no Javadoc explaining whether `index` is the raw adapter position (which includes the synthetic null at 0) or a logical index into the original list, leaving implementors to reverse-engineer the contract from `onClick` (line 99).

---

## Summary

| ID | File | Line(s) | Severity | Title |
|----|------|---------|----------|-------|
| A09-1 | SubFragPermission.java | 32,37,50,61,74,114,123,128,132,150,159,180,191,202 | INFO | No Javadoc on any public method or constructor |
| A09-2 | SubFragPermission.java | 25-26 | LOW | `FILE_EDIT_NOTIFY` and `CAMERA_NOTIFY` share identical broadcast action string, undocumented |
| A09-3 | SubFragPermission.java | 123 | INFO | `onHidden()` is an empty stub with no documentation |
| A09-4 | SubFragPermission.java | 178-179 | INFO | Public request-code constants have no Javadoc |
| A09-5 | ThemedDialogSingleListAdapter.java | 28,35,49,55,115,120 | INFO | No Javadoc on any public method or constructor |
| A09-6 | ThemedDialogSingleListAdapter.java | 89-91 | INFO | Null-item-as-"All" sentinel contract is undocumented in `getView()` |
| A09-7 | ThemedSingleListDialog.java | 26,30,44,50,104,105 | INFO | No Javadoc on any public member, interface, or inner class |
| A09-8 | ThemedSingleListDialog.java | 30,65 | INFO | `addAllAtTop` list-mutation side-effect undocumented |
| A09-9 | ThemedSingleListDialog.java | 44-48 | INFO | `SubCallback.getSubText()` default return and override intent undocumented |
| A09-10 | ThemedSingleListDialog.java | 104-106 | INFO | `Callback.callBack()` `index` parameter semantics undocumented |
