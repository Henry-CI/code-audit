# Pass 3 Findings: A49

## File: GsonRequest.java
### Reading Evidence
- Class: `GsonRequest<T>` (extends `WebRequest<T>`)
- Public Methods:
  - `getHeaders()` (line 29) — overrides Volley's `Request.getHeaders()`
  - `update()` (line 111)
- Package-private Methods (not public, noted for completeness):
  - `GsonRequest(UrlItem, Class<T>, boolean, String, WebListener<T>)` constructor (line 19)
  - `GsonRequest(UrlItem, WebServiceParameterPacket, Class<T>, WebListener<T>)` constructor (line 24)
  - `deliverResult(int, String)` (line 79)
- Protected Methods:
  - `parseNetworkResponse(NetworkResponse)` (line 52) — overrides Volley
  - `deliverResponse(T)` (line 72) — overrides Volley
- Private Methods:
  - `createResultWithJsonArray(JSONArray)` (line 33)
  - `createResultWithJson(JSONObject)` (line 42)
  - `getResult(String)` (line 97)
- Constants/Types: none defined in this file

### Findings

#### A49-1: `getHeaders()` has no Javadoc [INFO]
- File: GsonRequest.java, Line: 29
- Description: The public override `getHeaders()` has no Javadoc comment. Its behaviour — returning `webHeaders` if non-null, otherwise delegating to the superclass — is not documented.

#### A49-2: `update()` has no Javadoc [INFO]
- File: GsonRequest.java, Line: 111
- Description: The public method `update()` has no Javadoc comment. Its purpose (reconstructing a new `GsonRequest` with the same parameters, used for retry after auth failure) and return value are undocumented.

#### A49-3: `deliverResult(int, String)` has no Javadoc [INFO]
- File: GsonRequest.java, Line: 79
- Description: The package-private method `deliverResult(int, String)` has no Javadoc comment. Its role (used by `HttpClient.syncSendRequest` to deliver a synchronous HTTP response back into the Volley-style callback chain) and parameter semantics (`statusCode`, `response`) are undocumented.

#### A49-4: Both constructors have no Javadoc [INFO]
- File: GsonRequest.java, Lines: 19, 24
- Description: Neither package-private constructor documents its parameters or the distinction between them (one accepts a raw `requestBody` string and an `authMessage` flag; the other accepts a `WebServiceParameterPacket`).

---

## File: HttpClient.java
### Reading Evidence
- Class: `HttpClient`
- File-level Javadoc (lines 33-37): "Singleton class, in charge of logging in to the webservice multiple times throughout the app. Callback to original calling activity after login completed, whether successful or unsuccessful."
- Public Fields:
  - `isSynchronous` (line 40)
- Public Constants:
  - `DEFAULT_TIMEOUT_MS = 30000` (line 42)
  - `LOGIN_TIMEOUT_MS = 60000` (line 43)
  - `TAG = "Volley"` (line 62)
- Public Methods:
  - `HttpClient(Context)` constructor (line 65)
  - `initRequestQueue(Context)` (line 72) — static
  - `getRequestQueue()` (line 79)
  - `setCommonData(JSONObject)` (line 92) — static
  - `jsonFromWebParam(Object)` (line 104) — static
  - `removeRequest(WebRequest)` (line 149)
  - `enqueueRequest(GsonRequest)` (line 154)
- Package-private Methods:
  - `syncSendRequest(GsonRequest)` (line 162)
- Protected Methods:
  - `retryOnAuthFail(WebRequest)` (line 248)
- Private Methods:
  - `sendRequest(WebRequest)` (line 110)
  - `sendRequest(GsonRequest)` (line 131)
  - `addRequest(WebRequest)` (line 120)
  - `readStream(InputStream, int)` (line 225) — static

### Findings

#### A49-5: Class-level Javadoc is inaccurate — class is not a singleton [LOW]
- File: HttpClient.java, Lines: 33-37
- Description: The class Javadoc states "Singleton class", but the implementation has no singleton enforcement: there is a public constructor (`HttpClient(Context)`) and no static instance field or `getInstance()` method. The only static field is `mRequestQueue`, which is shared across instances. The description is misleading and will cause readers to assume thread-safety and uniqueness guarantees that do not exist.

#### A49-6: Class-level Javadoc describes login responsibility inaccurately [LOW]
- File: HttpClient.java, Lines: 33-37
- Description: The class Javadoc says the class is "in charge of logging in to the webservice". Reviewing the implementation, `HttpClient` is a general-purpose HTTP request dispatcher (enqueuing Volley requests, supporting synchronous requests, retrying on auth failure). Login is only one incidental use; the description overstates and mischaracterises the class's actual role.

#### A49-7: `initRequestQueue(Context)` has no Javadoc [INFO]
- File: HttpClient.java, Line: 72
- Description: The public static method `initRequestQueue(Context)` has no Javadoc. Its behaviour (lazily initialises the shared Volley `RequestQueue` if it is null; no-op if already initialised) and the requirement to call it before `getRequestQueue()` are undocumented.

#### A49-8: `getRequestQueue()` has no Javadoc [INFO]
- File: HttpClient.java, Line: 79
- Description: The public method `getRequestQueue()` has no Javadoc. Callers are not told that it throws `IllegalStateException` if the queue was never initialised, nor that `initRequestQueue(Context)` must be called first.

#### A49-9: `setCommonData(JSONObject)` has no Javadoc and body is empty [LOW]
- File: HttpClient.java, Lines: 92-102
- Description: The public static method `setCommonData(JSONObject)` has no Javadoc. Furthermore, its body is effectively a no-op: the `if (jsonObject != null)` block is empty (no statements inside) and the `catch` block silently swallows all exceptions. Without documentation it is impossible to determine whether this is intentional dead code, an incomplete feature, or a regression. The absence of documentation raises the risk of future callers relying on a method that does nothing.

#### A49-10: `jsonFromWebParam(Object)` has no Javadoc [INFO]
- File: HttpClient.java, Line: 104
- Description: The public static method `jsonFromWebParam(Object)` has no Javadoc. Its purpose (serialise an arbitrary object to a `JSONObject` via `GsonHelper` and decorate it with common data via `setCommonData`) and its return value are undocumented.

#### A49-11: `removeRequest(WebRequest)` has no Javadoc [INFO]
- File: HttpClient.java, Line: 149
- Description: The public method `removeRequest(WebRequest)` has no Javadoc. It removes the request only from the internal `mWebRequestQueue` deque; it does NOT cancel the request in the Volley `RequestQueue`. This distinction is important to callers and is undocumented.

#### A49-12: `enqueueRequest(GsonRequest)` has no Javadoc [INFO]
- File: HttpClient.java, Line: 154
- Description: The public method `enqueueRequest(GsonRequest)` has no Javadoc. Its branching behaviour — dispatching synchronously via `syncSendRequest` when `isSynchronous` is true, or asynchronously via `sendRequest` otherwise — is undocumented.

#### A49-13: `syncSendRequest(GsonRequest)` has no Javadoc [INFO]
- File: HttpClient.java, Line: 162
- Description: The package-private method `syncSendRequest(GsonRequest)` has no Javadoc. It performs a blocking HTTP call on whatever thread it is invoked from, supports GET, PUT, and POST methods, reads up to 1 MB of response, and calls `gsonRequest.deliverResult()` directly. None of this behaviour, nor the threading implications, are documented.

#### A49-14: `readStream(InputStream, int)` Javadoc is incomplete [INFO]
- File: HttpClient.java, Lines: 222-225
- Description: The private static method `readStream` has a one-line Javadoc ("Converts the contents of an InputStream to a String."). While accurate, it omits: the `maxLength` parameter semantics (maximum number of characters to read), the UTF-8 encoding assumption, and the return value (the string read, or `null` if the stream was empty). Since this is private the risk is low, but the documentation does not match the full behaviour.

#### A49-15: `retryOnAuthFail(WebRequest)` has no Javadoc [INFO]
- File: HttpClient.java, Line: 248
- Description: The protected method `retryOnAuthFail(WebRequest)` has no Javadoc. Its behaviour — re-authenticating via `WebApi.async().authApp()` and retrying the original request on success, or forwarding failure to `msg.onRequestFailed()` on failure — is not documented for subclasses that may override or call it.

#### A49-16: `HttpClient(Context)` constructor has no Javadoc [INFO]
- File: HttpClient.java, Line: 65
- Description: The public constructor has no Javadoc. It initialises the internal request deque and calls `initRequestQueue(Context)`. The requirement to supply a valid `Context` (used to initialise the Volley queue) is undocumented.

---

## File: ImagePostBackgroundTask.java
### Reading Evidence
- Class: `ImagePostBackgroundTask` (extends `AsyncTask<ImageUploadParam, String, ImageUploadResult>`)
- File-level Javadoc: none (only an author/date comment: "Created by steveyang on 7/6/17.")
- Nested Static Public Classes:
  - `ImageUploadParam` (line 21) — fields: `url`, `imagePath`, `multiPathArray`, `fileNames`, `bitmap`, `callback`
  - `ImageUploadResult` (line 30) — fields: `imageParam`, `succeed`
  - `ImageUploadCallBack` (line 35) — method: `onUploadResult(ImageUploadResult)` (line 36)
- Public Methods:
  - `ImageUploadCallBack.onUploadResult(ImageUploadResult)` (line 36)
  - `uploadImage(String, ArrayList<String>, ArrayList<String>, ImageUploadCallBack)` (line 77) — static
  - `uploadImage(String, String, ImageUploadCallBack)` (line 97) — static
  - `uploadImage(String, Bitmap, ImageUploadCallBack)` (line 114) — static
- Protected Methods (AsyncTask overrides):
  - `doInBackground(ImageUploadParam...)` (line 42)
  - `onPostExecute(ImageUploadResult)` (line 65)
- Package-private Methods:
  - `readFileData(String)` (line 131) — static
- Private Methods:
  - `uploadImage(ImageUploadParam)` (line 72) — static (private overload)
- Constants/Types: none (the nested classes serve as data-transfer types)

### Findings

#### A49-17: Class has no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Line: 15
- Description: The class `ImagePostBackgroundTask` has no Javadoc. Its purpose (an `AsyncTask` wrapper that dispatches image uploads via `ImagePostRequest` in a background thread), the three upload modes it supports (file path, `Bitmap`, or multiple paths), and its callback mechanism are entirely undocumented.

#### A49-18: `ImageUploadParam` nested class has no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Line: 21
- Description: The public static nested class `ImageUploadParam` has no Javadoc. None of its six public fields (`url`, `imagePath`, `multiPathArray`, `fileNames`, `bitmap`, `callback`) are documented, and there is no explanation of the mutual exclusivity of `imagePath`, `bitmap`, and `multiPathArray` (only one is used per upload dispatch in `doInBackground`).

#### A49-19: `ImageUploadResult` nested class has no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Line: 30
- Description: The public static nested class `ImageUploadResult` has no Javadoc. Its fields `imageParam` and `succeed` are undocumented.

#### A49-20: `ImageUploadCallBack` nested class and `onUploadResult` have no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Lines: 35-38
- Description: The public static nested class `ImageUploadCallBack` and its public method `onUploadResult(ImageUploadResult)` have no Javadoc. The intended override pattern (callers subclass `ImageUploadCallBack` and override `onUploadResult`) is undocumented.

#### A49-21: `uploadImage(String, ArrayList<String>, ArrayList<String>, ImageUploadCallBack)` has no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Line: 77
- Description: The public static `uploadImage` overload for multipart upload has no Javadoc. Parameters `url`, `pathArray`, `fileNames`, and `callback` are undocumented. The relationship between `pathArray` and `fileNames` (expected to be parallel lists) is not explained.

#### A49-22: `uploadImage(String, String, ImageUploadCallBack)` has no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Line: 97
- Description: The public static `uploadImage` overload for single file-path upload has no Javadoc. Parameters are undocumented, and there is no indication that `path` must be a valid filesystem path accessible to the process.

#### A49-23: `uploadImage(String, Bitmap, ImageUploadCallBack)` has no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Line: 114
- Description: The public static `uploadImage` overload for `Bitmap` upload has no Javadoc. There is no documentation indicating that the `Bitmap` is sent directly via `ImagePostRequest.SendHttpImage` or noting any size/format constraints.

#### A49-24: `readFileData(String)` has no Javadoc [INFO]
- File: ImagePostBackgroundTask.java, Line: 131
- Description: The package-private static method `readFileData(String)` has no Javadoc. It decodes a file at `imagePath` to a `Bitmap`, pre-processes it via `Util.preProcessBitmap`, and returns the result as a `byte[]`. The method's purpose, parameter, return value, and the fact that it may return an empty array if the file cannot be decoded are not documented. Additionally, the imported but unused `ByteArrayOutputStream` class at line 9 (used here but not imported separately for this method's context) is consistent, but the lack of any null-guard on the `Bitmap` returned by `BitmapFactory.decodeFile` is a latent defect not flagged by any comment.
