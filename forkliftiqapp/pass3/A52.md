# Pass 3 Findings: A52

---

## File: WebListener.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/WebListener.java`

### Reading Evidence
- **Class:** `WebListener<T>` (generic class, package-level, line 7)
- **Constants/Types:** `TAG` (private static final String, line 9)
- **Public Methods:**
  - `onSucceed(T result)` (line 11) — empty default implementation
  - `onFailed(WebResult result)` (line 13) — empty default implementation

### Findings

#### A52-1: `onSucceed(T result)` has no Javadoc [INFO]
- **File:** WebListener.java, Line: 11
- **Description:** The method `onSucceed(T result)` has no Javadoc comment. There is no description of when this callback is invoked, what the `result` parameter represents, or what implementors are expected to do. The class-level block comment (lines 2–6) is a creation stamp only and provides no behavioral documentation.

#### A52-2: `onFailed(WebResult result)` has no Javadoc [INFO]
- **File:** WebListener.java, Line: 13
- **Description:** The method `onFailed(WebResult result)` has no Javadoc comment. There is no description of when this callback fires, what `WebResult` contains at failure time, or how implementors should handle it.

#### A52-3: Class `WebListener<T>` has no class-level Javadoc [INFO]
- **File:** WebListener.java, Lines: 2–7
- **Description:** The only comment on the class is a creation-stamp block (author and date). There is no Javadoc describing the purpose of this callback/listener interface, its generic type parameter `T`, or the contract between `WebRequest` and implementors.

---

## File: WebRequest.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/WebRequest.java`

### Reading Evidence
- **Class:** `WebRequest<T>` extends `Request<T>` (Volley), line 45
- **Constants/Types:**
  - `WEBREQUEST_TIMEOUT_MS` — `public static final int`, value `30 * 1000` ms (line 46)
  - `PROTOCOL_CHARSET` — `static final String`, value `"utf-8"` (line 60)
  - `PROTOCOL_CONTENT_TYPE` — `static final String`, value `"application/json; charset=utf-8"` (line 63)
- **Public Methods (all lines):**
  - `cancel()` — override (line 68)
  - `setPriority(Priority priority)` (line 75)
  - `getPriority()` (line 79)
  - `setHttpClient(HttpClient httpClient)` (line 84)
  - `getPostBodyContentType()` — override, deprecated (line 111)
  - `getPostBody()` — override, deprecated (line 119)
  - `getBodyContentType()` — override (line 124)
  - `getBody()` — override (line 129)
  - `WebRequest(UrlItem, WebServiceParameterPacket, Class<T>, WebListener<T>)` — constructor (line 143)
  - `WebRequest(UrlItem, String, boolean, Class<T>, WebListener<T>)` — constructor (line 176)
  - `getHeaders()` — override (line 188)
  - `getMsgId()` — public instance (line 192)
  - `onSucceed(T response)` (line 197)
  - `onConnectFailed(VolleyError volleyError)` (line 211)
  - `onRequestFailed(WebResult webResult)` (line 239)
  - `deliverError(VolleyError error)` — override (line 263)
  - `update()` (line 274)

### Findings

#### A52-4: `cancel()` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 68
- **Description:** The overridden `cancel()` method sets the `canceledByUser` flag to `true` in addition to calling `super.cancel()`, which has the side effect of causing `ignoreResponse()` to suppress delivery of any subsequent response. This behavior difference from the base class is not documented.

#### A52-5: `setPriority(Priority priority)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 75
- **Description:** No Javadoc. The parameter `priority` and the effect on request scheduling are undocumented.

#### A52-6: `getPriority()` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 79
- **Description:** No Javadoc. Return value semantics are undocumented.

#### A52-7: `setHttpClient(HttpClient httpClient)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 84
- **Description:** No Javadoc. The role of the `HttpClient` reference (used later for `removeRequest` and `retryOnAuthFail`) is not described.

#### A52-8: `getBodyContentType()` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 124
- **Description:** No Javadoc. The method returns `PROTOCOL_CONTENT_TYPE` (`application/json; charset=utf-8`). The constant is documented inline, but the override itself has no doc comment.

#### A52-9: `getBody()` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 129
- **Description:** No Javadoc. The method returns `null` when `mRequestBody` is null (i.e., for GET requests with no body) and returns UTF-8 bytes otherwise. The null-return contract and the encoding behavior are not documented.

#### A52-10: Constructor `WebRequest(UrlItem, WebServiceParameterPacket, Class<T>, WebListener<T>)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 143
- **Description:** No Javadoc on this constructor. It performs several non-trivial side effects: serialising the parameter packet to JSON, setting HTTP headers, generating a message ID, and starting a 30-second `CountDownTimer` that fires `onRequestFailed` on expiry. None of these behaviors are documented.

#### A52-11: Constructor `WebRequest(UrlItem, String, boolean, Class<T>, WebListener<T>)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 176
- **Description:** No Javadoc. The `authMessage` boolean changes which HTTP headers are set (via `WebData.instance().setHttpHeader`) and suppresses the 401-triggered auth-retry in `onConnectFailed`. This parameter has significant behavioral impact and is entirely undocumented. Notably, unlike the first constructor, this constructor does NOT start the `CountDownTimer`, which is a behavioral asymmetry that is not documented.

#### A52-12: `getHeaders()` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 188
- **Description:** No Javadoc. Returns the pre-populated `webHeaders` map built during construction.

#### A52-13: `getMsgId()` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 192
- **Description:** No Javadoc. The no-arg public `getMsgId()` simply returns the field `msgId`. Note that a separate package-private `getMsgId(String url)` (line 172) returns a concatenation of URL and timestamp, which is a distinct method. The relationship between the two is undocumented, and the public no-arg version's contract (may return null on the second constructor path if `msgId` was never initialized before the field assignment) is not stated.

#### A52-14: `onSucceed(T response)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 197
- **Description:** No Javadoc. This method cancels the countdown timer, forwards the response to `webListener.onSucceed()`, and removes the request from the `HttpClient` queue. These orchestration responsibilities are undocumented.

#### A52-15: `onConnectFailed(VolleyError volleyError)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 211
- **Description:** No Javadoc. The method has conditional routing logic: a 401 HTTP_UNAUTHORIZED response on non-auth requests triggers `mHttpClient.retryOnAuthFail(this)` rather than propagating the failure to the listener. All other failures (including null `volleyError`, which is explicitly possible from the timer's `onFinish` callback) call `onRequestFailed`. This branching behavior is not documented anywhere.

#### A52-16: `onRequestFailed(WebResult webResult)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 239
- **Description:** No Javadoc. Forwards to `webListener.onFailed()` and calls `removeRequest()`. The public visibility of this method (allowing external callers to inject synthetic failure) and the guard on null `webListener` are not documented.

#### A52-17: `deliverError(VolleyError error)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 263
- **Description:** No Javadoc. Simply delegates to `onConnectFailed`. The delegation chain and the fact that the timer is cancelled inside `onConnectFailed` (not here) are not documented.

#### A52-18: `update()` Javadoc is inaccurate [MEDIUM]
- **File:** WebRequest.java, Lines: 267–283
- **Description:** The Javadoc for `update()` states: _"Updates Token, InstanceID & SessionID either in the URL or in the jsonObject params, then returns a new instance of this object."_ The implementation (lines 275–282) contains only empty `case` branches for `Method.POST` and `Method.GET` — no token, instance ID, or session ID is updated in either branch. The method unconditionally constructs and returns a new `WebRequest` with the same fields as the original, with no mutation of credentials at all. The Javadoc description is entirely inaccurate: it promises credential-refresh logic that does not exist, which could mislead callers into believing the returned request carries refreshed authentication state.

#### A52-19: `parseNetworkResponse(NetworkResponse)` has no Javadoc [INFO]
- **File:** WebRequest.java, Line: 89
- **Description:** No Javadoc. The method attempts to instantiate `webClazz` via no-arg reflection (`newInstance()`), ignoring the actual network response body entirely. It returns the empty instance on success or a `ParseError` on reflection failure. The fact that the response body is discarded is a significant behavioral detail that is not documented.

---

## File: WebResult.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/WebResult.java`

### Reading Evidence
- **Class:** `WebResult` (line 11)
- **Public Fields:** `volleyError` — `public VolleyError` (line 12)
- **Public Methods:**
  - `isBadGateway()` (line 14)
  - `getStatusCode()` (line 21)

### Findings

#### A52-20: Class `WebResult` has no class-level Javadoc [INFO]
- **File:** WebResult.java, Lines: 7–11
- **Description:** The only comment is a creation-stamp block (`Created by steveyang on 6/6/17`). There is no Javadoc describing the purpose of this class, the role of the public `volleyError` field, or the intended usage pattern.

#### A52-21: `isBadGateway()` has no Javadoc [INFO]
- **File:** WebResult.java, Line: 14
- **Description:** No Javadoc. The method checks for HTTP status 502 (`HttpsURLConnection.HTTP_BAD_GATEWAY`). The return value semantics (`true` = 502 received, `false` = any other condition including null error or null network response) are undocumented.

#### A52-22: `getStatusCode()` has no Javadoc [INFO]
- **File:** WebResult.java, Line: 21
- **Description:** No Javadoc. The method returns `0` when `volleyError` is null or `volleyError.networkResponse` is null (i.e., for network timeouts and connection errors that produce no HTTP response). The sentinel value of `0` is not documented and callers cannot distinguish "no HTTP response received" from a legitimate status code of 0.

---

## Summary

| Finding | File | Line | Severity |
|---------|------|------|----------|
| A52-1 | WebListener.java | 11 | INFO |
| A52-2 | WebListener.java | 13 | INFO |
| A52-3 | WebListener.java | 7 | INFO |
| A52-4 | WebRequest.java | 68 | INFO |
| A52-5 | WebRequest.java | 75 | INFO |
| A52-6 | WebRequest.java | 79 | INFO |
| A52-7 | WebRequest.java | 84 | INFO |
| A52-8 | WebRequest.java | 124 | INFO |
| A52-9 | WebRequest.java | 129 | INFO |
| A52-10 | WebRequest.java | 143 | INFO |
| A52-11 | WebRequest.java | 176 | INFO |
| A52-12 | WebRequest.java | 188 | INFO |
| A52-13 | WebRequest.java | 192 | INFO |
| A52-14 | WebRequest.java | 197 | INFO |
| A52-15 | WebRequest.java | 211 | INFO |
| A52-16 | WebRequest.java | 239 | INFO |
| A52-17 | WebRequest.java | 263 | INFO |
| A52-18 | WebRequest.java | 267 | **MEDIUM** |
| A52-19 | WebRequest.java | 89 | INFO |
| A52-20 | WebResult.java | 7 | INFO |
| A52-21 | WebResult.java | 14 | INFO |
| A52-22 | WebResult.java | 21 | INFO |

Total findings: 22 (21 INFO, 1 MEDIUM)
