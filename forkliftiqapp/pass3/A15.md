# Pass 3 Findings: A15

## File: LibImagePicker/src/main/java/com/pizidea/imagepicker/data/impl/LocalDataSource.java

### Reading Evidence
- Class: `LocalDataSource` (implements `DataSource`, `LoaderManager.LoaderCallbacks<Cursor>`)
- Public Methods:
  - `LocalDataSource(Context ctx)` — constructor (line 73)
  - `provideMediaItems(OnImagesLoadedListener loadedListener)` — line 64 (interface override)
  - `onCreateLoader(int id, Bundle args)` — line 78 (interface override)
  - `onLoadFinished(Loader<Cursor> loader, Cursor data)` — line 95 (interface override)
  - `onLoaderReset(Loader<Cursor> loader)` — line 151 (interface override)
- Constants/Types:
  - `public static final int LOADER_ALL = 0` (line 55)
  - `public static final int LOADER_CATEGORY = 1` (line 56)
  - `private final String[] IMAGE_PROJECTION` (line 48) — non-public field

### Findings

#### A15-1: Constructor `LocalDataSource(Context)` has no Javadoc [INFO]
- File: `LocalDataSource.java`, Line: 73
- Description: The public constructor `LocalDataSource(Context ctx)` has no Javadoc comment. There is no documentation explaining the expected type of the `ctx` parameter (which must be a `FragmentActivity` at runtime, as enforced by a `RuntimeException` throw in `provideMediaItems`). A caller passing a non-`FragmentActivity` `Context` will receive a runtime crash with no compile-time warning or documentation hint.

#### A15-2: `provideMediaItems(OnImagesLoadedListener)` has no Javadoc [INFO]
- File: `LocalDataSource.java`, Line: 64
- Description: The public interface implementation `provideMediaItems` has no Javadoc. Its runtime constraint — that the `Context` supplied at construction time must be a `FragmentActivity` or a `RuntimeException` is thrown — is undocumented. This is a material omission because callers cannot discover the constraint without reading the source.

#### A15-3: `onCreateLoader(int, Bundle)` has no Javadoc [INFO]
- File: `LocalDataSource.java`, Line: 78
- Description: Public interface override `onCreateLoader` has no Javadoc. Notably, the `LOADER_CATEGORY` branch reads a `"path"` key from the `Bundle` argument; this contract is undocumented. If the Bundle is null or missing that key, a `NullPointerException` will occur.

#### A15-4: `onLoadFinished(Loader<Cursor>, Cursor)` has no Javadoc [INFO]
- File: `LocalDataSource.java`, Line: 95
- Description: Public interface override `onLoadFinished` has no Javadoc. The method has a silent early-return when the cursor count is zero (line 101), meaning `imagesLoadedListener.onImagesLoaded` is never called in that case. This subtle behaviour is undocumented.

#### A15-5: `onLoaderReset(Loader<Cursor>)` has no Javadoc [INFO]
- File: `LocalDataSource.java`, Line: 151
- Description: Public interface override `onLoaderReset` has no Javadoc. Its empty implementation (no-op) means any previously loaded cursor data is not cleared on reset; this is intentional or an omission — either way it is undocumented.

---

## File: LibImagePicker/src/main/java/com/pizidea/imagepicker/ui/AvatarCropFragment.java

### Reading Evidence
- Class: `AvatarCropFragment` (extends `Fragment`)
- Public Methods:
  - `onCreate(Bundle savedInstanceState)` — line 72 (lifecycle override)
  - `onCreateView(LayoutInflater, ViewGroup, Bundle)` — line 80 (lifecycle override)
  - `getCropBitmap(int expectSize)` — line 123
- Package/Internal Methods (not public):
  - `initView(View contentView)` — line 108 (package-private)
- Constants/Types:
  - `public static boolean roundCropImage = false` (line 57) — mutable public static field

### Findings

#### A15-6: `getCropBitmap(int)` Javadoc is incomplete — missing `@param`, `@return`, and null-return condition [LOW]
- File: `AvatarCropFragment.java`, Line: 119–123
- Description: The existing Javadoc comment ("public method to get the crop bitmap") does not include a `@param` tag for `expectSize`, a `@return` tag, or documentation of the fact that the method returns `null` when `expectSize <= 0`. A caller has no documented indication that a non-positive size causes a null return rather than an exception, which could result in unguarded `NullPointerException`s at call sites.

#### A15-7: `getCropBitmap(int)` Javadoc does not document the `roundCropImage` flag behaviour [INFO]
- File: `AvatarCropFragment.java`, Line: 119–145
- Description: The method silently changes its return value type (rectangular crop vs. circular crop) depending on the static field `roundCropImage`, but this branching behaviour is not mentioned in the Javadoc at all. Callers relying on the comment alone will not know that the shape of the returned bitmap depends on external state.

#### A15-8: `onCreate(Bundle)` and `onCreateView(...)` lifecycle overrides have no Javadoc [INFO]
- File: `AvatarCropFragment.java`, Lines: 72, 80
- Description: Both lifecycle override methods are public and have no Javadoc. Of particular note, `onCreateView` throws a `RuntimeException` if the `AndroidImagePicker.KEY_PIC_PATH` argument is absent or empty (line 95), and this contract is entirely undocumented.

#### A15-9: `roundCropImage` is a mutable public static field with no Javadoc [INFO]
- File: `AvatarCropFragment.java`, Line: 57
- Description: The public static mutable field `roundCropImage` has no documentation explaining its purpose, its default value, or that it globally affects the shape of the bitmap returned by `getCropBitmap`. Using a mutable public static field as a configuration flag is itself a code-quality concern, but from a documentation standpoint its contract is entirely absent.

---

## File: LibImagePicker/src/main/java/com/pizidea/imagepicker/ui/ImagePreviewFragment.java

### Reading Evidence
- Class: `ImagePreviewFragment` (extends `Fragment`)
- Inner classes:
  - `TouchImageAdapter` (package-private, extends `FragmentStatePagerAdapter`) — line 138
  - `SinglePreviewFragment` (`@SuppressLint("ValidFragment")`, private inner `Fragment`) — line 160
- Public Methods on `ImagePreviewFragment`:
  - `onCreate(Bundle savedInstanceState)` — line 68 (lifecycle override)
  - `onCreateView(LayoutInflater, ViewGroup, Bundle)` — line 78 (lifecycle override)
  - `selectCurrent(boolean isCheck)` — line 123
- Public Members on inner classes:
  - `TouchImageAdapter.TouchImageAdapter(FragmentManager fm)` — constructor, line 139
  - `TouchImageAdapter.getCount()` — line 144
  - `TouchImageAdapter.getItem(int position)` — line 148
  - `SinglePreviewFragment.KEY_URL = "key_url"` — public static final constant, line 161
- Public Interfaces defined in file:
  - `OnImageSingleTapClickListener` — line 215, method `onImageSingleTap(MotionEvent e)`
  - `OnImagePageSelectedListener` — line 222, method `onImagePageSelected(int position, ImageItem item, boolean isSelected)`
- Constants/Types:
  - `private static final String TAG` (line 52)
  - `public static final String KEY_URL = "key_url"` on `SinglePreviewFragment` (line 161)

### Findings

#### A15-10: `selectCurrent(boolean)` Javadoc is present but incomplete — missing `@param` and side-effect description [LOW]
- File: `ImagePreviewFragment.java`, Line: 120–136
- Description: The Javadoc comment ("public method:select the current show image") describes the method at an extremely high level but omits: a `@param` tag for `isCheck`, documentation of the side effect (modifying the global `AndroidImagePicker` selection state via `addSelectedImageItem` / `deleteSelectedImageItem`), and the fact that the method is a no-op if the image is already in the desired state. The abbreviated comment gives callers insufficient information about what the method actually does.

#### A15-11: `onCreate(Bundle)` and `onCreateView(...)` lifecycle overrides have no Javadoc [INFO]
- File: `ImagePreviewFragment.java`, Lines: 68, 78
- Description: Both lifecycle override methods are public and have no Javadoc. `onCreateView` in particular pulls configuration from `getArguments()` (`KEY_PIC_SELECTED_POSITION`) and will throw a `NullPointerException` if no arguments are set; this is undocumented.

#### A15-12: `OnImageSingleTapClickListener` interface Javadoc does not document the `onImageSingleTap` method [INFO]
- File: `ImagePreviewFragment.java`, Line: 214–217
- Description: The interface itself has a one-line Javadoc ("Interface for SingleTap Watching") but the interface method `onImageSingleTap(MotionEvent e)` has no Javadoc. It is unclear whether implementors should return `true` to consume the event (the method is `void`, but the contract around when it is triggered versus suppressed by `enableSingleTap` is undocumented).

#### A15-13: `OnImagePageSelectedListener` interface method `onImagePageSelected` has no Javadoc [INFO]
- File: `ImagePreviewFragment.java`, Line: 222–224
- Description: The interface has a reasonable one-line class-level comment but the method `onImagePageSelected(int position, ImageItem item, boolean isSelected)` has no Javadoc. The semantics of each parameter — particularly whether `position` is zero-based or the absolute MediaStore index, and what `isSelected` reflects (selection state before or after any change) — are undocumented.

#### A15-14: `SinglePreviewFragment` suppresses `ValidFragment` lint with no explanation [INFO]
- File: `ImagePreviewFragment.java`, Line: 159
- Description: `@SuppressLint("ValidFragment")` is applied to `SinglePreviewFragment` without any comment explaining why the lint warning is being suppressed. Android requires Fragments to have a public no-argument constructor; this lint suppression hides the violation with no documentation of the design rationale or risk.
