# Pass 3 Findings: A21

## File: StrictLineReader.java
**Full path:** `LibImageloader/src/main/java/com/nostra13/universalimageloader/cache/disc/impl/ext/StrictLineReader.java`

### Reading Evidence
- Class: `StrictLineReader` (package-private, implements `Closeable`)
- Public Methods:
  - `StrictLineReader(InputStream in, Charset charset)` (line 70) — constructor
  - `StrictLineReader(InputStream in, int capacity, Charset charset)` (line 85) — constructor
  - `close()` (line 107)
  - `readLine()` (line 124)
- Private Methods (not audited for public-API docs):
  - `fillBuf()` (line 182)
- Constants:
  - `CR` — `static final byte` = `(byte) '\r'` (line 45)
  - `LF` — `static final byte` = `(byte) '\n'` (line 46)

---

### Findings

#### A21-1: Two-arg constructor Javadoc claims default capacity but omits the actual value [INFO]
- File: `StrictLineReader.java`, Line: 62
- Description: The Javadoc for `StrictLineReader(InputStream, Charset)` states the reader is constructed with "the default capacity" but does not state what that capacity is (8192 bytes). Readers consulting only the Javadoc have no way to know the buffer size without reading the implementation. While minor, documenting the default value explicitly is standard practice for capacity-bearing constructors.

#### A21-2: Three-arg constructor Javadoc claims capacity <= 0 throws IllegalArgumentException, but zero is accepted [MEDIUM]
- File: `StrictLineReader.java`, Line: 82
- Description: The Javadoc states: "throws IllegalArgumentException if `capacity` is negative or zero". The implementation guard at line 89 is `if (capacity < 0)`, which means a capacity of exactly zero is silently accepted and an empty byte buffer (`new byte[0]`) is allocated. Any caller relying on the documented contract and passing zero would expect an exception to be thrown; instead they receive a non-functional reader. The documentation overclaims the validation performed.

#### A21-3: Constructor Javadocs (both) claim UTF-8 and ISO-8859-1 are supported charsets, but implementation rejects them [HIGH]
- File: `StrictLineReader.java`, Lines: 65–66 (two-arg constructor), 79–80 (three-arg constructor)
- Description: Both constructor Javadocs state: "Only US-ASCII, UTF-8 and ISO-8859-1 are supported." The implementation check at line 92 is `if (!(charset.equals(Util.US_ASCII)))`, which throws `IllegalArgumentException` for any charset that is not US-ASCII — including UTF-8 and ISO-8859-1. A caller following the documented contract and passing `Charset.forName("UTF-8")` or `Charset.forName("ISO-8859-1")` will receive an `IllegalArgumentException` at runtime. This is a directly misleading API contract.

#### A21-4: Class-level Javadoc states UTF-8 and ISO-8859-1 are checked and accepted, contradicting implementation [HIGH]
- File: `StrictLineReader.java`, Lines: 39–41
- Description: The class-level Javadoc reads: "We currently check in constructor that the charset is one of US-ASCII, UTF-8 and ISO-8859-1." The actual constructor check (line 92) accepts only US-ASCII. UTF-8 and ISO-8859-1 are rejected. This compounds finding A21-3 by making the same false claim at the class level, increasing the likelihood that integrators will attempt to use those charsets.

#### A21-5: Class-level Javadoc references non-existent method `hasUnterminatedLine()` [MEDIUM]
- File: `StrictLineReader.java`, Line: 32
- Description: The class-level Javadoc states: "the caller may use `hasUnterminatedLine()` to detect it after catching the `EOFException`." No such method exists in the class. The class has no public or package-private method named `hasUnterminatedLine()`. This is a reference to either a removed method or a method that was never implemented. Callers who rely on this documentation to handle unterminated lines will encounter a compile error or be unable to perform the described detection.

---

## File: Util.java
**Full path:** `LibImageloader/src/main/java/com/nostra13/universalimageloader/cache/disc/impl/ext/Util.java`

### Reading Evidence
- Class: `Util` (package-private `final` class)
- Public Methods: none (all methods are package-private `static`)
- Package-private Methods:
  - `readFully(Reader reader)` (line 33)
  - `deleteContents(File dir)` (line 51)
  - `closeQuietly(Closeable closeable)` (line 66)
- Constants/Fields:
  - `US_ASCII` — `static final Charset` = `Charset.forName("US-ASCII")` (line 27)
  - `UTF_8` — `static final Charset` = `Charset.forName("UTF-8")` (line 28)

### Findings

#### A21-6: `readFully` has no Javadoc [INFO]
- File: `Util.java`, Line: 33
- Description: The package-private static method `readFully(Reader reader)` has no Javadoc comment. The method reads all characters from a `Reader`, closes it in a `finally` block, and returns the full content as a `String`. The close-on-completion side effect and the fact that the reader is always closed (even on exception) are not documented anywhere. While the method is not public API, it is used within the package and the close-always behaviour is a non-obvious contract worth documenting.

#### A21-7: `closeQuietly` has no Javadoc [INFO]
- File: `Util.java`, Line: 66
- Description: The package-private static method `closeQuietly(Closeable closeable)` has no Javadoc comment. The method suppresses all non-`RuntimeException` checked exceptions from `Closeable.close()` but re-throws `RuntimeException`. The distinction between suppressed checked exceptions and re-thrown runtime exceptions is a behavioural subtlety that is undocumented. While not public API, the behaviour is non-obvious enough to warrant a comment.

---

## File: FileNameGenerator.java
**Full path:** `LibImageloader/src/main/java/com/nostra13/universalimageloader/cache/disc/naming/FileNameGenerator.java`

### Reading Evidence
- Class: `FileNameGenerator` (public interface)
- Public Methods:
  - `generate(String imageUri)` (line 27)
- Constants/Types: none

### Findings

#### A21-8: `generate` method doc missing `@param` and `@return` Javadoc tags [INFO]
- File: `FileNameGenerator.java`, Line: 26
- Description: The single-line comment `/** Generates unique file name for image defined by URI */` is present but does not include a `@param imageUri` description or a `@return` tag. For a public interface method that forms part of the library's extension API, the parameter meaning (e.g., whether the URI may be null, whether it is expected to be a fully-qualified URI or a relative path) and the return contract (e.g., whether the returned name must be unique, whether null may be returned) are undocumented. This is low risk given the brevity of the interface but represents incomplete Javadoc for a public API surface.
