# Pass 3 Findings: A91

## File: FleetActivity.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/ui/common/FleetActivity.java`

### Reading Evidence
- Class: `FleetActivity` (abstract, extends `BaseActivity`)
- Public Fields: `connectingDevice` (boolean, line 60)
- Public Constants: `LOCATION_SETTINGS_REQUEST_GPS` (static int, line 329)
- Public Methods:
  - `showLoadingLayout()` (line 84)
  - `hideLoadingLayout()` (line 90)
  - `setContentView(int layoutId)` (line 97) — @Override
  - `onActivityResult(int, int, Intent)` (line 331) — @Override
  - `abortSessionWithCallback(SessionResult, AbortSessionCallback)` (static, line 418)
  - `onResume()` (line 441) — @Override (protected)
  - `onPause()` (line 454) — @Override (protected)
- Inner class: `AbortSessionCallback` (static, line 410) with public methods `onSessionStopped()` (line 411) and `onSessionStopFailed()` (line 414)
- Constants: `RECONNECT_REQUEST_ENABLE_BT` (private int, line 328); `LOCATION_SETTINGS_REQUEST_GPS` (public static int, line 329)

### Findings

#### A91-1: `showLoadingLayout()` has no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 84
- Description: The public method `showLoadingLayout()` has no Javadoc comment. Its behaviour is to make `mLoadingView` visible if it is non-null, which is non-trivial (it silently no-ops when the loading view has not been set via `setContentView`). No documentation exists.

#### A91-2: `hideLoadingLayout()` has no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 90
- Description: The public method `hideLoadingLayout()` has no Javadoc comment. Its behaviour is to set `mLoadingView` to `GONE` if non-null; the same silent-no-op edge case as above applies and is not documented.

#### A91-3: `setContentView(int)` override has no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 97
- Description: The public override of `setContentView` has no Javadoc. This override is semantically significant: rather than simply replacing the content view it wraps it inside a `FrameLayout` together with a progress overlay (`progress_layout`). Callers relying on standard `Activity.setContentView` semantics would not expect this side-effect. The absence of documentation is a risk because the behaviour diverges materially from the overridden superclass method.

#### A91-4: `onActivityResult(int, int, Intent)` has no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 331
- Description: The public override `onActivityResult` has no Javadoc. It handles two distinct request codes — `RECONNECT_REQUEST_ENABLE_BT` (Bluetooth enable result) and `LOCATION_SETTINGS_REQUEST_GPS` (GPS settings result) — and the logic per code is non-obvious. Neither the request codes nor the side-effects are described.

#### A91-5: `abortSessionWithCallback(SessionResult, AbortSessionCallback)` has no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 418
- Description: This protected static method has no Javadoc. It performs several significant side-effects: stops the BLE connection, issues a `deleteSession` web API call, and on failure marks the session as aborted in local storage. None of these behaviours, nor the nullable `sessionResult` guard, are documented.

#### A91-6: `AbortSessionCallback` inner class and its public methods have no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 410–416
- Description: The public static inner class `AbortSessionCallback` has no class-level Javadoc and its two public callback methods `onSessionStopped()` and `onSessionStopFailed()` have no Javadoc. As an intended extension point (the class exists to be subclassed and overridden), the contract and intended override semantics should be documented.

#### A91-7: `LOCATION_SETTINGS_REQUEST_GPS` constant has no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 329
- Description: The public static field `LOCATION_SETTINGS_REQUEST_GPS` has no Javadoc. It is used as an `Activity.startActivityForResult` request code by subclasses and fragments (it is imported from this class by `FleetFragment`), so its purpose and expected lifecycle handling should be documented.

#### A91-8: `connectingDevice` public field has no Javadoc [INFO]
- File: `FleetActivity.java`, Line: 60
- Description: The public field `connectingDevice` is a package-visible state flag with no documentation. Its meaning (true while a BLE reconnect attempt is in progress) and threading expectations are undocumented.

---

## File: FleetFragment.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/ui/common/FleetFragment.java`

### Reading Evidence
- Class: `FleetFragment` (extends `BaseFragment`)
- Public Methods:
  - `checkUsePreviousPreStart(BaseActivity, SessionResult, Runnable, Runnable)` (static, line 65)
  - `initBottomBar(int[], String[], View)` (line 137)
  - `onLeftButton(View)` (line 177)
  - `onMiddleButton(View)` (line 181)
  - `onRightButton(View)` (line 184)
  - `showLoadingLayout()` (line 187)
  - `hideLoadingLayout()` (line 194)
  - `onActivityCreated(Bundle)` (line 202) — @Override
  - `onRequestPermissionsResult(int, String[], int[])` (line 265) — @Override
  - `initViews()` (line 282)
  - `onSessionEnded()` (line 285)
- Protected Methods:
  - `showPreStartOrJobFragment()` (line 39)
  - `initChart()` (line 106)
  - `initChartExtra(PieChart)` (line 127)

### Findings

#### A91-9: `checkUsePreviousPreStart(...)` has no Javadoc [INFO]
- File: `FleetFragment.java`, Line: 65
- Description: This public static method has no Javadoc. Its behaviour is complex: it reads the running equipment item, checks `sessionResult.prestart_required`, and depending on whether the equipment is driver-based either navigates directly to jobs or prompts the user to accept their previous pre-op check. Four parameters, two nullable, with non-trivial conditional routing — none documented.

#### A91-10: `initBottomBar(int[], String[], View)` has no Javadoc [INFO]
- File: `FleetFragment.java`, Line: 137
- Description: The public method `initBottomBar` has no Javadoc. It populates up to three fixed bottom-bar button slots (left, middle, right) using parallel arrays, hiding any button whose text array entry is `null`. The parallel-array contract and the null-means-invisible behaviour are not documented.

#### A91-11: `onLeftButton(View)`, `onMiddleButton(View)`, `onRightButton(View)` have no Javadoc [INFO]
- File: `FleetFragment.java`, Lines: 177, 181, 184
- Description: These three public methods are intended override hooks invoked by the click listeners registered in `initBottomBar`. No Javadoc describes their intended override contract. The default implementation of `onLeftButton` finishes the activity, while `onMiddleButton` and `onRightButton` are no-ops by default — behaviours that subclass authors should be informed of.

#### A91-12: `showLoadingLayout()` and `hideLoadingLayout()` have no Javadoc [INFO]
- File: `FleetFragment.java`, Lines: 187, 194
- Description: Both public delegation methods have no Javadoc. They silently no-op when the host activity is not a `FleetActivity` instance. This silent-no-op when the cast condition is unmet is undocumented.

#### A91-13: `initViews()` has no Javadoc [INFO]
- File: `FleetFragment.java`, Line: 282
- Description: The public method `initViews()` is an empty override hook with no Javadoc. Its purpose as a lifecycle-safe initialisation hook (called from `onActivityCreated`) and the expectation that subclasses override it are undocumented.

#### A91-14: `onSessionEnded()` has no Javadoc [INFO]
- File: `FleetFragment.java`, Line: 285
- Description: The public method `onSessionEnded()` is an empty override hook with no Javadoc. It is called from `FleetActivity.onStopSessionByUser()` on all `FleetFragment` instances when a session ends. The caller, trigger conditions, and expected override contract are completely undocumented.

#### A91-15: `onRequestPermissionsResult` logs to System.out [INFO]
- File: `FleetFragment.java`, Line: 269
- Description: Although not a documentation issue per se, line 269 contains `System.println("fine location permission granted")` — a debug-logging artefact. This is noted here as it indicates the method was never reviewed for production readiness and has no Javadoc explaining the permission code (hardcoded `300`) or the deferred runnable pattern.

---

## File: AddEquipmentFragment.java
**Full path:** `app/src/main/java/au/com/collectiveintelligence/fleetiq360/ui/fragment/AddEquipmentFragment.java`

### Reading Evidence
- Class: `AddEquipmentFragment` (extends `FleetFragment`)
- Private Constants:
  - `TYPE_TITLE` = `"--Type--"` (line 45)
  - `FUEL_TITLE` = `"--Power--"` (line 46)
- Public Methods (overrides from `FleetFragment`):
  - `initViews()` (line 67)
  - `onMiddleButton(View)` (line 388)
  - `onRightButton(View)` (line 420)
- Public Methods (from `Fragment` lifecycle):
  - `onCreateView(LayoutInflater, ViewGroup, Bundle)` (line 50) — @Override

### Findings

#### A91-16: `initViews()` has no Javadoc [INFO]
- File: `AddEquipmentFragment.java`, Line: 67
- Description: The public override `initViews()` has no Javadoc. It sets up the bottom bar, binds all form field views, attaches the MAC address text watcher, and registers click listeners for the manufacturer, type, and fuel type selectors. The side-effects and the fact this is the primary initialisation entry point for the fragment's UI are undocumented.

#### A91-17: `onMiddleButton(View)` has no Javadoc [INFO]
- File: `AddEquipmentFragment.java`, Line: 388
- Description: The public override `onMiddleButton` (the Save button handler) has no Javadoc. It performs sequential validation of equipment name, MAC address length (when the expansion module checkbox is checked), manufacturer, equipment type, and power type before calling `saveEquipment()`. The validation rules, especially the MAC address length check of 17 characters, are undocumented.

#### A91-18: `onRightButton(View)` has no Javadoc [INFO]
- File: `AddEquipmentFragment.java`, Line: 420
- Description: The public override `onRightButton` (the Back button handler) has no Javadoc. Its behaviour is to call `getActivity().onBackPressed()`, navigating back. The method is trivial but undocumented in accordance with the project's absence of any Javadoc practice.

#### A91-19: `loadType` cache-key bug is undocumented and potentially incorrect [LOW]
- File: `AddEquipmentFragment.java`, Line: 340
- Description: In `loadType()`, the early-exit duplicate-check at line 340 uses the key `Integer.toString(manufactureItem.id)` (a String) to query `mapFuelTypesForEquipmentType` (a `HashMap<String, FuelTypeResultArray>`). This is the fuel-type map, not the equipment-type map; the equipment-type map (`mapEquipmentTypesForManu`) is keyed by integer manufacturer ID. The guard therefore always evaluates to `null` (the fuel-type map is never populated with a pure manufacturer-ID key) and never short-circuits, causing redundant network requests on every type selection for the same manufacturer. While not a documentation audit finding in the Javadoc sense, the method has no comment of any kind, and the incorrect map reference constitutes an inaccurate implicit assumption embedded in the code. This is noted because documenting the caching strategy would have revealed the bug. Risk is LOW (redundant API calls, no data loss).

#### A91-20: `onCreateView(LayoutInflater, ViewGroup, Bundle)` has no Javadoc [INFO]
- File: `AddEquipmentFragment.java`, Line: 50
- Description: The public lifecycle override `onCreateView` has no Javadoc. Trivial for experienced Android developers, but consistent with the total absence of documentation in this file.
