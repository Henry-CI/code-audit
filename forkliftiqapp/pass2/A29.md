# Audit Pass 2 — Agent A29
**Audit run:** 2026-02-26-01
**Agent:** A29
**Files assigned:**
1. `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/webserviceclasses/parameters/AddEquipmentParameter.java`
2. `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/webserviceclasses/parameters/GetTokenParameter.java`
3. `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/webserviceclasses/parameters/ImpactParameter.java`

---

## Project-Wide Finding: Zero Automated Test Coverage

**A29-1 | CRITICAL | Project-wide**

Neither the `app/` module nor the `LibCommon/` module contains a `test/` or `androidTest/` directory. There are zero JUnit, Espresso, Robolectric, or any other automated test files anywhere in either module. This was confirmed by a recursive glob for `**/test/**/*.java` across the entire repository root, which returned no results.

The practical consequence for this audit is that every single source file in `app/` and `LibCommon/` has 0 % test coverage. All methods, all fields, all error paths, and all edge cases are untested. This finding applies globally and is stated once here to avoid repeating it for every subsequent finding in this agent's report and across all A-series agent reports for this audit run.

The absence of any test harness also means that regressions introduced by future changes — including security-sensitive changes to authentication, credential handling, and incident reporting — cannot be caught automatically before shipping.

---

## File 1: AddEquipmentParameter.java

### Reading Evidence

**Fully qualified class name:**
`au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.parameters.AddEquipmentParameter`

**Extends / implements:**
- `WebServiceParameterPacket` (parent)
- `java.io.Serializable`

**Fields defined (all `public`, no initializer):**

| Line | Type | Name |
|------|------|------|
| 14 | `String` | `name` |
| 15 | `int` | `manu_id` |
| 16 | `int` | `type_id` |
| 17 | `int` | `fuel_type_id` |
| 18 | `String` | `serial_no` |
| 19 | `String` | `mac_address` |
| 20 | `int` | `comp_id` |

**Methods defined:**

| Line | Signature |
|------|-----------|
| 22–23 | `public AddEquipmentParameter()` — no-arg constructor, empty body |

**Constants defined:** None.

**Imports used:** `JSONException`, `JSONObject`, `Serializable`, `JSONArray`, `ArrayList`, `BigDecimal`, wildcard imports for `webserviceclasses.*` and `webserviceclasses.results.*` — none of these imports are actually referenced in the class body; all are dead imports carried over from a code-generation template.

**Usage in production code (cross-reference):**
- `WebApi.addEquipment(AddEquipmentParameter, WebListener<CommonResult>)` — passes the object directly to `GsonRequest`, which serialises it via `GsonHelper.stringFromObjectNoPolicy()` and transmits it as the HTTP request body.
- `AddEquipmentFragment` populates the fields before calling `WebApi.addEquipment()`.

---

### Findings for AddEquipmentParameter.java

**A29-2 | LOW | AddEquipmentParameter — no test file exists**

There is no test file for `AddEquipmentParameter`. The class is a plain data-transfer object (DTO) with a single empty constructor and seven public fields. While the class itself contains no logic, the absence of any test means that:

- No test verifies that the object can be instantiated and its fields set without error.
- No test verifies that `GsonHelper.stringFromObjectNoPolicy()` serialises all seven fields into the expected JSON keys (the field names use snake_case and must match the server API contract; a rename refactor would silently break the API with no test catching it).
- No test verifies the `mac_address` field format. The field is a plain `String` with no length constraint or format validation. `WebData.isValidMacAddress()` enforces a 17-character check elsewhere, but no test confirms that `AddEquipmentParameter` only ever carries a validly formatted MAC address when submitted.

Severity is LOW because the class carries no credential or PII data and the logic risk is confined to silent API contract breakage.

**A29-3 | INFO | AddEquipmentParameter — seven dead template imports**

Lines 3–10 contain seven imports (`JSONException`, `JSONObject`, `Serializable` (used), `JSONArray`, `ArrayList`, `BigDecimal`, two wildcard package imports) of which at least five (`JSONException`, `JSONArray`, `ArrayList`, `BigDecimal`, and the `results.*` wildcard) are unused in this class. These are dead imports inherited from a code-generation template. No test flags this, and no IDE lint check is enforced in CI (there is no CI). Dead imports do not cause runtime failures but increase maintenance confusion and are a signal that code was generated without review.

---

## File 2: GetTokenParameter.java

### Reading Evidence

**Fully qualified class name:**
`au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.parameters.GetTokenParameter`

**Extends / implements:**
- `WebServiceParameterPacket` (parent)
- `java.io.Serializable`

**Fields defined (all `public`, no initializer):**

| Line | Type | Name | Sensitivity |
|------|------|------|-------------|
| 14 | `String` | `grant_type` | Low |
| 15 | `String` | `client_id` | HIGH — OAuth2 client credential |
| 16 | `String` | `client_secret` | CRITICAL — OAuth2 client secret |
| 17 | `String` | `username` | HIGH — service account username |
| 18 | `String` | `password` | CRITICAL — service account password |

**Methods defined:**

| Line | Signature |
|------|-----------|
| 20–21 | `public GetTokenParameter()` — no-arg constructor, empty body |

**Constants defined:** None.

**Usage in production code (cross-reference):**
- The class is defined but is **not directly instantiated** by any caller found in the codebase. The actual OAuth2 credential bundle is constructed inline in `WebData.getTokenFormData()` (lines 56–82 of `WebData.java`) as a URL-encoded form string, with hardcoded literal values:
  - `client_id` = `"987654321"` (line 64)
  - `client_secret` = `"8752361E593A573E86CA558FFD39E"` (line 68)
  - `username` = `"gas"` (line 72)
  - `password` = `"ciiadmin"` (line 76)
- That form string is transmitted by `WebApi.authApp()` (via `GsonRequest`) and by `TokenAuthenticator` (via a raw `DataOutputStream`).
- `GetTokenParameter` itself carries public fields for the same credential set, meaning if any caller were to populate and pass it to a future `GsonRequest`, the credentials would be serialised via `GsonHelper.stringFromObjectNoPolicy()` into a JSON body — the method name explicitly states "NoPolicy", implying no `@Expose`/exclusion strategy is applied, so all five public fields would appear in the JSON.

---

### Findings for GetTokenParameter.java

**A29-4 | CRITICAL | GetTokenParameter — OAuth2 client secret and service account password exposed as public fields with no test verifying non-disclosure**

`GetTokenParameter` declares `client_secret` (line 16) and `password` (line 18) as `public String` fields. The class implements `Serializable` with no `transient` qualifier on either field, meaning Java object serialisation will include both credentials in any serialised byte stream.

Because there are zero tests, none of the following properties are verified:

1. That `client_secret` and `password` are never written to Android `Log.*` calls (e.g., via implicit `toString()` in a log statement that prints the enclosing object or request body).
2. That `client_secret` and `password` are marked `transient` before any serialisation path can persist them to shared preferences, a file, or a `Bundle`.
3. That a Gson serialisation of this object (via `GsonHelper.stringFromObjectNoPolicy()`) does not embed the plaintext credentials in a log-tagged HTTP request body string visible in `logcat`.
4. That the class is not inadvertently passed to a `GsonRequest` instead of the form-body path, causing credentials to appear in a JSON body.

The companion finding in `WebData.java` (outside this agent's scope) is that `client_secret = "8752361E593A573E86CA558FFD39E"` and `password = "ciiadmin"` are hardcoded plaintext literals. `GetTokenParameter`'s role as a public-field DTO for the same credential set compounds that risk: any future refactor that routes credentials through this parameter object rather than through `getTokenFormData()` would silently expose credentials in JSON with no test catching it.

Severity: CRITICAL. The credential fields are OAuth2 application-level secrets and a service account password. Public access, no `transient` marker, no `toString()` override to redact values, no test coverage of any kind.

**A29-5 | HIGH | GetTokenParameter — implements Serializable with credential fields not marked transient**

`GetTokenParameter` implements `java.io.Serializable` (line 12). Fields `client_secret` (line 16) and `password` (line 18) are not marked `transient`. Under Java's default serialisation mechanism, both fields will be written to any `ObjectOutputStream`, including those used when an Android `Activity` or `Fragment` saves state to a `Bundle` via `putSerializable()`, or when the OS saves the back-stack during low-memory reclaim.

If the OS writes the serialised object to disk (which Android does for back-stack and saved instance state), the plaintext credential values could be present in the app's private data directory. On rooted devices or via ADB backup (if `android:allowBackup` is not explicitly set to `false`), that data is accessible.

No test verifies that `client_secret` and `password` are excluded from serialisation output.

Severity: HIGH. Exploitable on rooted devices or via backup extraction; requires specific conditions (device compromise or developer options enabled).

**A29-6 | HIGH | GetTokenParameter — no toString() override; credential values will appear in default object representation**

`GetTokenParameter` does not override `toString()`. Java's default `Object.toString()` returns `ClassName@hashcode`, which does not expose field values directly. However, Gson's `toJson()` — called by `GsonHelper.stringFromObjectNoPolicy()` in `WebRequest` (line 147 of `WebRequest.java`) — serialises all non-transient public fields by reflection. If any caller passes a populated `GetTokenParameter` instance to the existing `GsonRequest(UrlItem, WebServiceParameterPacket, Class, WebListener)` constructor, the resulting JSON body will contain `client_secret` and `password` as plaintext JSON string values. The absence of a `toString()` override that redacts sensitive fields is a defence-in-depth gap. No test verifies this behaviour.

Severity: HIGH. The serialisation path is already wired and used for other parameter types; the gap is that this class is positioned to be used the same way with no safeguard.

**A29-7 | INFO | GetTokenParameter — class appears unused; credentials are handled via WebData.getTokenFormData() instead**

A codebase search found no instantiation of `GetTokenParameter` outside of its own file. The actual credential bundle for OAuth2 token acquisition is assembled in `WebData.getTokenFormData()` as a hardcoded URL-encoded string. `GetTokenParameter` appears to be a dead class — a leftover from a prior design or a code-generation artefact.

Dead code that carries credential field names is a maintenance hazard: future developers may assume it is the intended credential carrier and begin populating it, activating the risks described in A29-4, A29-5, and A29-6. No test asserts that the class is not used in production paths. This is an INFO finding because the class being unused is currently a mitigating factor for A29-4 through A29-6.

---

## File 3: ImpactParameter.java

### Reading Evidence

**Fully qualified class name:**
`au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.parameters.ImpactParameter`

**Extends / implements:**
- `WebServiceParameterPacket` (parent)
- `java.io.Serializable`

**Fields defined (all `public`, no initializer):**

| Line | Type | Name | Semantic meaning |
|------|------|------|-----------------|
| 14 | `String` | `injury_type` | Category of injury sustained |
| 15 | `String` | `description` | Free-text description of incident |
| 16 | `String` | `witness` | Witness name(s) |
| 17 | `String` | `report_time` | Timestamp when report was filed |
| 18 | `String` | `event_time` | Timestamp when incident occurred |
| 19 | `boolean` | `injury` | Flag: injury occurred |
| 20 | `boolean` | `near_miss` | Flag: near-miss event |
| 21 | `boolean` | `incident` | Flag: general incident flag |
| 22 | `String` | `location` | Location of incident |
| 23 | `int` | `driver_id` | ID of driver involved |
| 24 | `int` | `unit_id` | ID of equipment unit involved |

**Methods defined:**

| Line | Signature |
|------|-----------|
| 26–27 | `public ImpactParameter()` — no-arg constructor, empty body |

**Constants defined:** None.

**Usage in production code (cross-reference):**
- `IncidentActivity` (line 12) declares a `public ImpactParameter impactParameter` field, populates `incident = true`, `injury = false`, and `injury_type = injuryTypes[0]` in `onCreate()`, then passes the partially-initialised object to `IncidentFragment`.
- `WebApi` contains a method that submits `ImpactParameter` to the server (the exact method is in the `WebApi` file which uses `saveImpact` or equivalent; the parameter class is referenced via wildcard import).
- The object carries workplace incident data that may constitute a legally reportable workplace health and safety (WHS/OHS) record.

---

### Findings for ImpactParameter.java

**A29-8 | HIGH | ImpactParameter — no test for field validation on workplace incident data**

`ImpactParameter` carries workplace incident data that may be legally significant (injury type, witness identity, incident timestamps, driver identity). All eleven fields are public with no validation, no constraints, and no documented format contract. Specific gaps with no test coverage:

- `injury_type` (line 14): accepts any string including empty string. `IncidentActivity.onCreate()` sets it to `injuryTypes[0]` from a resource array, but no code prevents a caller from leaving it `null` or empty before submission. No test verifies that a null or empty `injury_type` is rejected or handled.
- `report_time` and `event_time` (lines 17–18): plain `String` fields. No format is enforced (ISO-8601? localised string? Unix epoch string?). No test verifies the format matches what the server expects. A format mismatch would silently corrupt the incident timestamp in the backend database.
- `event_time` vs `report_time` ordering: no test verifies that `event_time` is not set to a value after `report_time` (a logical impossibility that the server may or may not enforce).
- `driver_id` and `unit_id` (lines 23–24): default to `0` (Java `int` zero-initialisation). No test verifies that a zero or negative ID is treated as "not set" vs a valid ID. Submitting `driver_id = 0` could link a real incident report to a non-existent or incorrect driver record.
- `injury`, `near_miss`, `incident` flags (lines 19–21): three independent booleans with no documented mutual-exclusion constraint. No test verifies behaviour when all three are `false` (no category selected) or all three are `true` (logically inconsistent).
- `description` and `witness` (lines 15–16): no maximum-length constraint. No test verifies server-side truncation or rejection of excessively long strings does not corrupt incident records.

Severity: HIGH. This data is likely subject to WHS/OHS regulatory requirements. Corrupt or incomplete incident records submitted silently (no validation, no test) create legal and safety risk.

**A29-9 | HIGH | ImpactParameter — implements Serializable with PII fields not marked transient**

`ImpactParameter` implements `java.io.Serializable`. Fields `witness` (line 16), `description` (line 15), `location` (line 22), and `driver_id` (line 23) together constitute personally identifiable information (PII) about a workplace incident participant. None are marked `transient`.

`IncidentActivity` stores the `ImpactParameter` as a `public` field without any lifecycle handling to clear it. If the Android OS serialises the activity's state (e.g., to handle the back-stack under memory pressure), the PII-bearing `ImpactParameter` object will be written to disk in the app's private data directory. On rooted devices or via ADB backup, this data is accessible.

No test verifies that PII fields are excluded from serialisation or that the object is cleared from memory after submission.

Severity: HIGH. PII relating to workplace injuries written to disk without explicit protection violates privacy-by-design principles and may breach applicable data protection regulations.

**A29-10 | LOW | ImpactParameter — no test for the incomplete initialisation pattern in IncidentActivity**

`IncidentActivity.onCreate()` creates a new `ImpactParameter` and sets three of eleven fields (`incident`, `injury`, `injury_type`), leaving `description`, `witness`, `report_time`, `event_time`, `location`, `driver_id`, `unit_id`, and `near_miss` at their Java defaults (`null` for strings, `0` for ints, `false` for booleans). The partially-initialised object is passed to `IncidentFragment` for further population before submission.

No test verifies:
- That all required fields are populated before `WebApi` submits the object.
- That submitting a partially-initialised `ImpactParameter` (e.g., after a fragment lifecycle interruption) produces a server-side error that is surfaced to the user rather than silently creating an incomplete incident record.
- That the `near_miss` field, never explicitly set in `IncidentActivity`, defaults correctly and cannot be submitted as `false` when the user actually recorded a near-miss.

Severity: LOW. The risk is an incomplete incident record rather than a security breach, but in a WHS context an incomplete record is still a meaningful failure.

**A29-11 | INFO | ImpactParameter — seven dead template imports**

As with `AddEquipmentParameter`, lines 3–10 contain dead imports from a code-generation template (`JSONException`, `JSONArray`, `ArrayList`, `BigDecimal`, `results.*` wildcard). None are referenced in the class body. No lint or CI check enforces import hygiene.

---

## Summary Table

| ID | Severity | File | Description |
|----|----------|------|-------------|
| A29-1 | CRITICAL | Project-wide | Zero automated test coverage in `app/` and `LibCommon/` modules |
| A29-2 | LOW | AddEquipmentParameter | No test file; API contract and MAC address format untested |
| A29-3 | INFO | AddEquipmentParameter | Seven dead template imports, no lint enforcement |
| A29-4 | CRITICAL | GetTokenParameter | OAuth2 `client_secret` and `password` as public fields; no test verifies non-disclosure via Gson serialisation or logging |
| A29-5 | HIGH | GetTokenParameter | `Serializable` without `transient` on credential fields; credentials may be written to disk by Android OS |
| A29-6 | HIGH | GetTokenParameter | No `toString()` override; Gson serialisation via `GsonHelper.stringFromObjectNoPolicy()` would emit credentials as plaintext JSON |
| A29-7 | INFO | GetTokenParameter | Class appears unused (dead code); credentials handled via `WebData.getTokenFormData()` instead |
| A29-8 | HIGH | ImpactParameter | No field validation on legally significant workplace incident data; null/empty/invalid fields submitted silently |
| A29-9 | HIGH | ImpactParameter | `Serializable` without `transient` on PII fields; witness identity and driver PII may be written to disk |
| A29-10 | LOW | ImpactParameter | Partially-initialised pattern in `IncidentActivity` not tested; incomplete incident records possible |
| A29-11 | INFO | ImpactParameter | Seven dead template imports, no lint enforcement |
