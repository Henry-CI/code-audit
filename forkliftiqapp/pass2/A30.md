# Audit Pass 2 — Agent A30
**Audit run:** 2026-02-26-01
**Agent:** A30
**Files assigned:**
1. `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/webserviceclasses/parameters/JoinCompanyParameter.java`
2. `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/webserviceclasses/parameters/LoginParameter.java`
3. `app/src/main/java/au/com/collectiveintelligence/fleetiq360/WebService/webserviceclasses/parameters/ResetPasswordParameter.java`

---

## Project-Wide Finding: Zero Automated Test Coverage

**ID:** A30-1
**Severity:** HIGH
**Scope:** Project-wide (`app/` and `LibCommon/` modules)

Neither the `app/` module nor the `LibCommon/` module contains any test directory. Glob searches for `**/test/**/*.java` and `**/androidTest/**/*.java` returned zero results. There are no JUnit unit tests and no Android instrumented tests anywhere in the project. Every finding below documents a gap against a test suite that does not exist.

The complete absence of automated test coverage means:
- No regression protection exists for any behaviour change.
- Security-sensitive flows (authentication, credential handling, password reset) have never been exercised by automated assertions.
- No CI gate can prevent regressions from shipping to production.

---

## File Reading Evidence

### File 1: `JoinCompanyParameter.java`

**Fully qualified class name:**
`au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.parameters.JoinCompanyParameter`

**Supertype:** `WebServiceParameterPacket` (extends) / `Serializable` (implements)

**Fields defined:**

| Line | Field | Type | Visibility |
|------|-------|------|------------|
| 14 | `driver_id` | `int` | `public` |
| 15 | `comp_id` | `int` | `public` |

**Methods defined:**

| Line | Signature |
|------|-----------|
| 17–18 | `public JoinCompanyParameter()` — no-arg constructor, empty body |

**Constants defined:** none

**Imports used:** `JSONException`, `JSONObject`, `Serializable`, `JSONArray`, `ArrayList`, `BigDecimal`, `WebServiceParameterPacket` (via wildcard), results wildcard — all are unused in the class body itself; they are boilerplate copy-paste from a class template.

---

### File 2: `LoginParameter.java`

**Fully qualified class name:**
`au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.parameters.LoginParameter`

**Supertype:** `WebServiceParameterPacket` (extends) / `Serializable` (implements)

**Fields defined:**

| Line | Field | Type | Visibility |
|------|-------|------|------------|
| 14 | `email` | `String` | `public` |
| 15 | `password` | `String` | `public` |

**Methods defined:**

| Line | Signature |
|------|-----------|
| 17–18 | `public LoginParameter()` — no-arg constructor, empty body |

**Constants defined:** none

**Usage context (cross-referenced):**
`CurrentUser.login()` (line 81–83 of `CurrentUser.java`) assigns `loginParameter.email = CommonFunc.MD5_Hash(loginEmail)` and `loginParameter.password = loginPassword` (the plaintext MD5 hash of the password stored in a static field). The `LoginParameter` object is then passed to `WebApi.async().login()`, which serialises it via `GsonHelper.stringFromObjectNoPolicy()` into JSON and transmits it over the network. There is no code that nulls out or overwrites the `password` field on the object after the request is enqueued.

---

### File 3: `ResetPasswordParameter.java`

**Fully qualified class name:**
`au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.parameters.ResetPasswordParameter`

**Supertype:** `WebServiceParameterPacket` (extends) / `Serializable` (implements)

**Fields defined:**

| Line | Field | Type | Visibility |
|------|-------|------|------------|
| 14 | `email` | `String` | `public` |

**Methods defined:**

| Line | Signature |
|------|-----------|
| 16–17 | `public ResetPasswordParameter()` — no-arg constructor, empty body |

**Constants defined:** none

**Usage context (cross-referenced):**
`WebApi.resetPassword()` (lines 112–129 of `WebApi.java`) receives a `ResetPasswordParameter` and immediately serialises and enqueues it. No null/empty check is applied to the `email` field before transmission.

---

## Findings

### A30-2 — No test file exists for `JoinCompanyParameter`
**Severity:** LOW
**File:** `JoinCompanyParameter.java`

There is no test class for `JoinCompanyParameter`. Cross-referencing grep of the entire codebase for the class name finds only the declaration file itself — it is not referenced anywhere outside `WebApi.java` method signatures (it does not even appear in any API call site in the search results, suggesting it may be dead code). Because there are no tests, the following are never exercised:

- Constructor produces a valid object with default `int` values (0 for both `driver_id` and `comp_id`).
- A zero value for `driver_id` or `comp_id` is a semantically invalid request. No test documents whether zero/negative IDs are accepted or rejected.
- Serialisation of the object to JSON (via `GsonHelper.stringFromObjectNoPolicy`) is never verified to include both fields.

---

### A30-3 — `LoginParameter.password` is a public `String` field with no post-use clearance; no test verifies clearance
**Severity:** HIGH
**File:** `LoginParameter.java` (line 15); also `CurrentUser.java` lines 81–83

The `password` field is declared `public String password`. `String` objects in Java are immutable and interned; once a password value is assigned, the character data resides in the JVM heap (and potentially in the string pool) until it is garbage-collected. There is no mechanism to zero the backing character array after the HTTP request is dispatched.

Because there are no tests, the following gaps are confirmed untested:

1. **No test verifies that `password` is cleared (set to `null` or overwritten) after `WebApi.login()` enqueues the request.** In the current code it is never cleared.
2. **No test verifies behaviour when `password` is `null`.** `GsonHelper.stringFromObjectNoPolicy` will serialise `null` as a JSON `null`, which will cause a server-side authentication failure. No test documents or asserts the expected outcome.
3. **No test verifies behaviour when `password` is an empty string.** An empty password would pass serialisation silently and produce a misleading server error.
4. **No test verifies the constructor initialises both fields to a defined state.** Fields are `null` by default; no validation or initialisation guard exists.

The `public` field modifier also removes all encapsulation — any caller can mutate `password` at any point in the object's lifetime with no visibility into when or whether it was changed.

---

### A30-4 — `LoginParameter.email` contains MD5-hashed value; no test validates hash format or null guard
**Severity:** MEDIUM
**File:** `LoginParameter.java` (line 14); `CurrentUser.java` line 82

`CurrentUser.login()` assigns `loginParameter.email = CommonFunc.MD5_Hash(loginEmail)`. The field name is `email` but it receives an MD5 hash of the email address, not the email address itself. This semantic mismatch is never documented by a test. No test asserts:

1. That a `null` `loginEmail` passed to `MD5_Hash` does not produce a `NullPointerException`.
2. That a non-email string (e.g., an empty string) produces a defined, safe hash value.
3. That the server accepts an MD5-hashed email in this field (versus the raw email address).

---

### A30-5 — `LoginParameter` implements `Serializable` with no `serialVersionUID`; no test covers serialisation round-trip
**Severity:** LOW
**File:** `LoginParameter.java` (line 12)

`LoginParameter` implements `Serializable` but declares no `serialVersionUID`. Java will compute a default UID based on class structure. Any change to the class fields or methods will silently change the UID, causing `InvalidClassException` on deserialisation of any previously serialised instance (e.g., from a `Bundle`, `Intent`, or stored session). No test exercises serialisation or deserialisation of the class.

The same issue applies to `JoinCompanyParameter` (line 12) and `ResetPasswordParameter` (line 12).

---

### A30-6 — `ResetPasswordParameter` has only `email` field; no test verifies null/empty email before dispatch
**Severity:** MEDIUM
**File:** `ResetPasswordParameter.java` (line 14); `WebApi.java` lines 112–129

`WebApi.resetPassword()` applies no null or empty guard to the `ResetPasswordParameter` before serialising and enqueuing it. If `parameter.email` is `null` or empty, the request is dispatched to the server with a `null` or blank email. No test verifies:

1. That a `null` email produces a controlled failure rather than a silent server error.
2. That an empty string email is rejected before network I/O is initiated.
3. That a malformed (non-email) string is handled gracefully.

**Note on the task brief reference to `old_password == new_password`:** The source file `ResetPasswordParameter.java` contains only one field (`email`). It does not contain `old_password` or `new_password` fields. This appears to be a different parameter class (possibly `UpdateUserParameter` or a class not yet added). As this analysis is limited to the content of the three assigned files, no finding is raised for a field that does not exist in the file. The finding above covers the missing validation that *does* apply to this class.

---

### A30-7 — `ResetPasswordParameter` implements `Serializable` with no `serialVersionUID`; same issue as A30-5
**Severity:** LOW
**File:** `ResetPasswordParameter.java` (line 12)

Identical to A30-5. Covered under that finding for completeness; flagged separately as it is a distinct class.

---

### A30-8 — Unused imports in all three parameter classes (boilerplate template pollution)
**Severity:** INFO
**Files:** `JoinCompanyParameter.java` lines 3–10, `LoginParameter.java` lines 3–10, `ResetPasswordParameter.java` lines 3–10

All three files share an identical import block:
```java
import org.json.JSONException;
import org.json.JSONObject;
import java.io.Serializable;
import org.json.JSONArray;
import java.util.ArrayList;
import java.math.BigDecimal;
import au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.*;
import au.com.collectiveintelligence.fleetiq360.WebService.webserviceclasses.results.*;
```

None of these types (except `Serializable`) are referenced in the class bodies. This is consistent with a copy-paste class template that was never cleaned up. While the compiler strips unused imports from bytecode, the presence of `webserviceclasses.results.*` as a wildcard import in a parameter class suggests no code review is performed, and supports the conclusion that no tests exist to catch structural regressions.

---

## Summary Table

| ID | Severity | File | Description |
|----|----------|------|-------------|
| A30-1 | HIGH | Project-wide | Zero automated test coverage in `app/` and `LibCommon/` |
| A30-2 | LOW | JoinCompanyParameter.java | No test file; zero-value IDs never validated; possible dead code |
| A30-3 | HIGH | LoginParameter.java | `password` field never cleared after use; null/empty cases untested |
| A30-4 | MEDIUM | LoginParameter.java | `email` field holds MD5 hash; semantic mismatch and null guard untested |
| A30-5 | LOW | LoginParameter.java | `Serializable` without `serialVersionUID`; no serialisation test |
| A30-6 | MEDIUM | ResetPasswordParameter.java | No null/empty guard on `email` before network dispatch; untested |
| A30-7 | LOW | ResetPasswordParameter.java | `Serializable` without `serialVersionUID`; no serialisation test |
| A30-8 | INFO | All three files | Unused boilerplate imports indicating no code review or test enforcement |
