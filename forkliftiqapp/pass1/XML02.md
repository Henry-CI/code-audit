# Pass 1 Security Audit — Agent XML02
**Repository:** forkliftiqapp
**Date:** 2026-02-27
**Agent:** XML02
**Scope:** Android layout XML files, values resources, styles, file_paths.xml

---

## Step 1 — Branch Verification

Command run: `git -C /c/Projects/cig-audit/repos/forkliftiqapp branch --show-current`
Result: `master`

**Discrepancy recorded:** The checklist header states `Branch: main`, but the actual current branch is `master`. Audit proceeds on `master`.

---

## Step 2 — Checklist Reference

Checklist read in full from `/c/Projects/cig-audit/audit-skills/PASS1-CHECKLIST-forkliftiqapp.md`. Sections relevant to this agent's assigned files are:

- **Item 2 (Network Security):** Check `res/values/` string resources for hardcoded API endpoints, server URLs, or IP addresses.
- **Item 3 (Data Storage):** Check `file_paths.xml` for overly permissive FileProvider path configurations.
- **Item 4 (Input and Intent Handling):** Check layout files for WebView elements; if present, verify JavaScript and file access settings.
- **Styles:** Note any WebView-related or security-relevant style attributes.

---

## Step 3 — Files Read

All 74 assigned files were read in full. Files are listed by category below with key observations.

---

## Step 4 — Reading Evidence

### 4.1 `res/values/strings.xml`

**Type:** String resource file
**Key elements:**

All string values enumerated:

| Name | Value (summary) |
|---|---|
| `app_name` | `ForkliftIQ360` |
| `auto_update_current_version` | `version 1.2.0` |
| `auto_update_requires_permissions` | Storage permissions message |
| `auto_update_contact_representative` | Contact text mentioning "Collective Intelligence representative" |
| `loading_content_str_2` | `version 1.2.0` |
| `loading_content_str_1` | `Another app by Collective Intelligence Group` |
| `gdpr_compliance` | Full GDPR privacy policy text (long string) |

URLs embedded in `gdpr_compliance` string (lines 143–152):

```
www.ciiquk.com
https://fms.fleetiq360.com
https://fms.fleetiq360.com/fleetfocus
https://fms.fleetiq360.com/digitaldashboard
www.thecollectiveintelligencegroup.com
https://pandora.fleetiq360.com/PandoraAdmin
```

Contact information embedded in `gdpr_compliance`:

```
CIIQ UK LTD
Unit 3 Bowdens Business Centre
Bowdens Farm, Hambridge, Nr Curry Rivel, Somerset TA10 0BP
Email: dp@ciiquk.com
Telephone: 01460 259101
```

**No hardcoded API base URLs, authentication endpoints, credentials, tokens, or IP addresses found.**
Version strings (`version 1.2.0`) appear in two strings but are UI display text only — not security-relevant. These are stale (the app is at 1.9.0 per recent commits) but that is a quality issue, not a security finding.
The URLs in `gdpr_compliance` are all web properties listed in a privacy policy notice. They are not API endpoint strings and do not constitute network security configuration.

---

### 4.2 `res/xml/file_paths.xml`

**Type:** FileProvider path configuration
**Content (full file, 4 lines):**

```xml
<?xml version="1.0" encoding="utf-8"?>
<paths xmlns:android="http://schemas.android.com/apk/res/android">
    <external-path name="external_files" path="."/>
</paths>
```

**Finding — HIGH: Overly Permissive FileProvider Path**

The single configured path uses `<external-path>` with `path="."`. The dot path means the FileProvider grants access to the entire root of external storage (typically `/sdcard/` or the equivalent). Any URI generated by this FileProvider can reference any file on external storage, not just files within the app's own external directory.

The correct, scoped configuration for apps that only need to share files from their own external-files directory would be:

```xml
<external-files-path name="external_files" path="."/>
```

Using `<external-path path="."/>` (the current configuration) instead of `<external-files-path>` exposes the entire external storage tree to any app receiving a FileProvider URI from this app. This is a well-known misconfiguration that has been flagged in multiple CVE write-ups.

**Recommendation:** Change `<external-path>` to `<external-files-path>` and restrict the `path` attribute to the minimum required subdirectory (e.g., `path="Pictures/"` if the feature only shares captured photos).

---

### 4.3 `res/values/styles.xml`

**Type:** Theme and style definitions
**Key elements:**

Three application themes defined: `AppThemeLight`, `AppThemeDark`, `AppThemeClear` — all extend `Theme.AppCompat.Light.NoActionBar`. One text style `header` extends `android:Widget.TextView`.

**No WebView-related style attributes found.** No `javascript`, `fileAccess`, `domStorage`, `allowUniversalAccess`, or any WebView-specific attributes are present. Styles are purely visual (colors, text sizes, drawables).

---

### 4.4 `res/values-v21/styles.xml`

**Type:** API 21 style override
**Content:** All content is commented out. The file contains an empty `<resources>` element with a full commented-out style block. **No active style definitions.** No security-relevant content.

---

### 4.5 `res/values/colors.xml`

**Type:** Color resource file
**Key elements:** 30 color entries, all hex color values. No URLs, credentials, or security-relevant content. Incidental note: line 17 contains a bare text fragment `6b8891` outside any XML element — this is a malformed XML artefact (likely a copy-paste remnant) but is ignored by the parser and carries no security impact.

---

### 4.6 `res/values/dimens.xml`

**Type:** Dimension resource file
**Key elements:** 18 dimension values (dp/sp). No security-relevant content.

---

### 4.7 `res/values-w820dp/dimens.xml`

**Type:** Wide-screen dimension override
**Key elements:** One dimension override (`activity_horizontal_margin: 64dp`). No security-relevant content.

---

### 4.8 `res/values/attrs.xml`

**Type:** Custom attribute declarations
**Content:** Empty `<resources>` element. No attributes declared. No security-relevant content.

---

### 4.9 `res/values/ids.xml`

**Type:** View ID declarations
**Key elements:** 85 declared view IDs covering login, signup, equipment, dashboard, jobs, and profile UI elements. IDs are purely for view referencing. No security-relevant content.

---

### 4.10 Layout Files — Activity-level Containers (10 files)

Files: `activity_common.xml`, `activity_dashboard.xml`, `activity_drivers.xml`, `activity_equipment.xml`, `activity_incident.xml`, `activity_jobs.xml`, `activity_login.xml`, `activity_profile.xml`, `activity_signup.xml`

**Pattern:** All activity layouts are thin wrappers containing a single `FrameLayout` or `CoordinatorLayout` used as a fragment container. None contain any direct UI widgets — they serve as shells for Fragment transactions.

**No WebView elements found in any activity layout.**

`activity_drivers.xml` uses `android.support.design.widget.CoordinatorLayout` — a legacy support library namespace. This is an indirect indicator that the app may still be on the pre-AndroidX support library stack, which is relevant to the library audit (agent scope item 6) but not directly a layout security finding.

---

### 4.11 Auto-Update Layout Files (5 files)

Files: `auto_update_searching.xml`, `auto_update_update.xml`, `auto_update_downloading.xml`, `auto_update_need_permission.xml`, `auto_update_ready.xml`

**Key elements:**

These screens form the in-app self-update flow. The download button in `auto_update_update.xml` (`@+id/auto_update_download`) triggers an APK download. The permission screen (`auto_update_need_permission.xml`) references storage permissions.

**Security observation (informational, not a layout finding):** The existence of a self-update mechanism (downloading and installing APKs from an external source) is security-relevant — the update source URL, download integrity checking (hash/signature verification), and whether the APK is verified before install all require examination in the Java source code. The layout files themselves contain only text and button widgets; no URL is hardcoded in any layout file.

**No WebView elements found.**

---

### 4.12 Navigation Bar Layouts (5 files)

Files: `bottom_bar_blue.xml`, `bottom_bar_button.xml`, `bottom_bar_button_white.xml`, `bottom_bar_dark_blue.xml`, `bottom_bar_yellow.xml`

Reusable bottom navigation bars. `bottom_bar_button_white.xml` contains a hardcoded text string `"DASHBOARD"` in the `android:text` attribute — a minor localisation issue, not a security finding.

**No WebView elements found.**

---

### 4.13 Fragment Layouts — Full Inventory

The following 40 fragment/component layouts were read. Key security-relevant observations per file:

**`fragment_login.xml`**
Password field uses `android:inputType="numberPassword"` with `android:maxLength="8"`. This constrains the PIN/password to 8 numeric digits maximum. This is an application design observation: an 8-digit numeric PIN is low entropy (10^8 = 100 million combinations). Whether this aligns with the intended authentication design requires review in the Java source (agent scope for Java files). No layout-level security finding.

**`fragment_signup.xml`**
Password field (`@id/sign_up_password_id`) and confirm-password field (`@id/sign_up_confirm_password_id`) are both marked `android:visibility="invisible"` in the layout. This means they are present in the view hierarchy but not shown. The visibility is likely controlled programmatically. No security finding from the layout alone.

**`fragment_selfie.xml`**
Displays a circular image view for user photo capture. No security-relevant content.

**`fragment_emails.xml`**
Four email address entry fields. No security-relevant content in the layout.

**`fragment_add_equipment.xml`**
MAC address entry field: `android:hint="Mac Address of Expansion Module"`. The field accepts free-text input for a Bluetooth/hardware MAC address. Input validation must be confirmed in Java source.

**`fragment_incident.xml` and `fragment_incident_2.xml`**
Incident report forms with free-text fields (description, location, witness name). No security-relevant layout content.

**`fragment_connect_equipment.xml`**
Equipment connection screen. No security-relevant content.

**`fragment_university_guide.xml`**
Contains a "GO TO UNIVERSITY" button (`@+id/university_guide_go_id`). This likely opens an external URL. The target URL and whether it opens in a WebView or external browser must be verified in Java source. No URL or WebView present in the layout itself.

**All remaining fragment and item layouts** (`fragment_dashboard.xml`, `fragment_drivers.xml`, `fragment_driver_stats_1.xml`, `fragment_driver_stats_3.xml`, `fragment_equipment_driver_access.xml`, `fragment_equipment_list.xml`, `fragment_equipment_prestart_checklist.xml`, `fragment_jobs.xml`, `fragment_loading.xml`, `fragment_photo_view.xml`, `fragment_profile.xml`, `fragment_saved_reports.xml`, `fragment_service.xml`, `fragment_service_records.xml`, `fragment_service_stats.xml`, `fragment_test.xml`, `fragment_title.xml`, `item_driver_select.xml`, `item_equipment_checklist.xml`, `item_equipment_diagnosis.xml`, `item_equipment_driver_access.xml`, `item_equipment_photoview.xml`, `item_equipment_select_fork.xml`, `item_equipment_university.xml`, `item_mycompany.xml`, `item_search_company_result.xml`, `list_item_driver_stats.xml`, `list_item_driver_stats_info.xml`, `list_item_report.xml`, `list_item_service_record.xml`, `list_item_service_stats.xml`, `loading_dialog.xml`, `photo_cell.xml`, `progress_layout.xml`, `user_info_in_resume.xml`, `driver_info_header.xml`, `equipment_stats_info.xml`, `dash_arrow.xml`, `dashboard_divider.xml`):
All are standard UI layouts using TextViews, ImageViews, RecyclerViews, ListViews, RadioButtons, CheckBoxes, ProgressBars, and custom widget extensions from `com.yy.libcommon`. **No WebView elements found in any file.**

---

## Step 5 — Security Review Against Checklist

### Checklist Item 2 — Network Security: Hardcoded API Endpoints in `res/values/`

**Result: No finding.**

`strings.xml` contains no hardcoded API base URLs, server hostnames, authentication endpoints, or IP addresses. The URLs present in `gdpr_compliance` are documentation/privacy policy links embedded in user-facing text — not API configuration.

---

### Checklist Item 3 — Data Storage: FileProvider Path Configuration

**Result: HIGH finding.**

`res/xml/file_paths.xml` configures a FileProvider with an overly permissive path:

```xml
<external-path name="external_files" path="."/>
```

**Impact:** `<external-path path="."/>` grants the FileProvider authority to create content URIs referencing any file on the device's external storage, not just files within the app's own scoped external directory. Any app that receives a URI from this FileProvider (e.g., via an Intent for APK install, photo sharing, or report attachment) could potentially be directed to access arbitrary files on external storage, depending on how URI generation is handled in the Java code.

**Location:** `/c/Projects/cig-audit/repos/forkliftiqapp/app/src/main/res/xml/file_paths.xml`, line 3.

**Recommendation:** Replace `<external-path>` with `<external-files-path>` to scope access to the app's own external files directory. Further restrict `path` to the minimum required subdirectory.

---

### Checklist Item 4 — Input and Intent Handling: WebView Usage

**Result: No finding.**

A full-text search for `WebView` and `webview` across all 74 assigned layout files returned zero matches. No `WebView` widget is declared in any layout file in this agent's scope. JavaScript enablement, `setAllowFileAccess`, and URL whitelisting are therefore not applicable at the layout level.

**Note for Java agent:** The "GO TO UNIVERSITY" navigation in `fragment_university_guide.xml` and `item_equipment_university.xml` may open external web content. The mechanism (external browser Intent vs. in-app WebView) must be confirmed by examining the corresponding Java code.

---

### Styles Review

**Result: No finding.**

`styles.xml` (main) and `styles.xml` (v21) contain no WebView-related style attributes, no attributes that loosen security constraints, and no theme configuration that would affect WebView behaviour.

---

## Summary of Findings

| ID | Severity | File | Finding |
|---|---|---|---|
| XML02-001 | HIGH | `res/xml/file_paths.xml` line 3 | FileProvider `<external-path path="."/>` exposes entire external storage root; should be `<external-files-path>` scoped to the app's own directory |
| XML02-002 | Informational | `res/values/strings.xml` | Stale version string `version 1.2.0` displayed in loading and login screens; actual app version is 1.9.0 (per recent commits). No security impact; maintenance quality issue. |
| XML02-003 | Informational | `res/values/strings.xml` | Multiple production web URLs embedded in the `gdpr_compliance` string, including `https://pandora.fleetiq360.com/PandoraAdmin`. These are privacy policy references, not API endpoints. Java agent should verify whether these URLs are loaded into a WebView. |
| XML02-004 | Informational | `res/layout/fragment_login.xml` | Password field restricted to 8-digit numeric PIN (`inputType="numberPassword"`, `maxLength="8"`). Low entropy credential design; requires review of server-side authentication policy in conjunction with Java audit. |

---

## Branch Discrepancy Record

The checklist (`PASS1-CHECKLIST-forkliftiqapp.md`) header states `Branch: main`. The repository's actual current branch is `master`. Audit was performed on `master` as instructed. No `main` branch was observed. This discrepancy should be noted in the audit summary and confirmed with the repository owner.
