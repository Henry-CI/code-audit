# Pass 1 Security Audit — Agent LC05
**Repo:** forkliftiqapp
**Date:** 2026-02-27
**Agent:** LC05
**Stack:** Android/Java

---

## Step 1 — Branch Verification

Command run: `git -C /c/Projects/cig-audit/repos/forkliftiqapp branch --show-current`
Result: `master`

**Discrepancy:** Checklist specifies `Branch: main`; actual branch is `master`. Proceeding on `master` as instructed.

---

## Step 2 — Checklist Read

Full checklist read from `/c/Projects/cig-audit/audit-skills/PASS1-CHECKLIST-forkliftiqapp.md`. Sections covered:
1. Signing and Keystores
2. Network Security
3. Data Storage
4. Input and Intent Handling
5. Authentication and Session
6. Third-Party Libraries
7. Google Play and Android Platform

---

## Step 3 — Files Read In Full

All three assigned files read in full. Supporting file `FontCache.java` also read for context on referenced methods.

---

## Step 4 — Reading Evidence

### File 1: `AMEditText.java`
**Path:** `/c/Projects/cig-audit/repos/forkliftiqapp/LibCommon/src/main/java/com/yy/libcommon/Font/AMEditText.java`
**Fully Qualified Class Name:** `com.yy.libcommon.Font.AMEditText`
**Extends:** `android.widget.EditText`
**Public Fields:** None
**Public Methods:**

| Line | Signature |
|------|-----------|
| 17 | `public AMEditText(Context context)` |
| 23 | `public AMEditText(Context context, AttributeSet attrs)` |
| 29 | `public AMEditText(Context context, AttributeSet attrs, int defStyle)` |

**Private Methods:**

| Line | Signature |
|------|-----------|
| 36 | `private void applyCustomFont(Context context, AttributeSet attrs)` |

**No Activities, Fragments, Services, BroadcastReceivers, or ContentProviders declared.**

---

### File 2: `AMRadioButton.java`
**Path:** `/c/Projects/cig-audit/repos/forkliftiqapp/LibCommon/src/main/java/com/yy/libcommon/Font/AMRadioButton.java`
**Fully Qualified Class Name:** `com.yy.libcommon.Font.AMRadioButton`
**Extends:** `android.widget.RadioButton`
**Public Fields:** None
**Public Methods:**

| Line | Signature |
|------|-----------|
| 18 | `public AMRadioButton(Context context)` |
| 24 | `public AMRadioButton(Context context, AttributeSet attrs)` |
| 30 | `public AMRadioButton(Context context, AttributeSet attrs, int defStyle)` |

**Private Methods:**

| Line | Signature |
|------|-----------|
| 37 | `private void applyCustomFont(Context context, AttributeSet attrs)` |

**Unused import:** `android.widget.EditText` imported at line 7 but not used.

**No Activities, Fragments, Services, BroadcastReceivers, or ContentProviders declared.**

---

### File 3: `AMTextView.java`
**Path:** `/c/Projects/cig-audit/repos/forkliftiqapp/LibCommon/src/main/java/com/yy/libcommon/Font/AMTextView.java`
**Fully Qualified Class Name:** `com.yy.libcommon.Font.AMTextView`
**Extends:** `android.widget.TextView`
**Public Fields:** None
**Public Methods:**

| Line | Signature |
|------|-----------|
| 17 | `public AMTextView(Context context)` |
| 23 | `public AMTextView(Context context, AttributeSet attrs)` |
| 29 | `public AMTextView(Context context, AttributeSet attrs, int defStyle)` |

**Private Methods:**

| Line | Signature |
|------|-----------|
| 36 | `private void applyCustomFont(Context context, AttributeSet attrs)` |

**No Activities, Fragments, Services, BroadcastReceivers, or ContentProviders declared.**

---

### Supporting Context: `FontCache.java`
**Path:** `/c/Projects/cig-audit/repos/forkliftiqapp/LibCommon/src/main/java/com/yy/libcommon/Font/FontCache.java`
**Fully Qualified Class Name:** `com.yy.libcommon.Font.FontCache`
**Public Static Fields:**
- `private static HashMap<String, Typeface> fontCache` — static, not public, but retained for life of process.

**Public Static Methods:**

| Line | Signature |
|------|-----------|
| 16 | `public static Typeface getTypeface(String fontname, Context context)` |
| 32 | `public static Typeface getTypeFace(Context context, String ttf)` |

Note: `FontCache` was read for supporting context only; it is not an assigned file and is not audited here.

---

## Step 5 — Checklist Review

### Section 1 — Signing and Keystores

No signing configuration, keystore files, Gradle signing blocks, or pipeline credentials are present in any of the three assigned files. These are UI widget classes with no build or deployment relevance.

**No issues found — Section 1: Signing and Keystores**

---

### Section 2 — Network Security

No network calls, HTTP clients, URL construction, SSL/TLS configuration, or server endpoints appear in any of the three files. These classes apply custom fonts to standard Android widgets and perform no network operations.

**No issues found — Section 2: Network Security**

---

### Section 3 — Data Storage

No SharedPreferences access, file I/O, SQLite usage, external storage access, or credential caching is present in any of the three files.

**Finding — Low — TypedArray Resource Leak (all three files)**

All three `applyCustomFont` methods obtain a `TypedArray` via `getContext().obtainStyledAttributes(...)` but never call `a.recycle()` on the resulting object. The Android documentation specifies that `TypedArray` objects obtained from `obtainStyledAttributes` must be recycled after use to avoid memory leaks. The leaked objects are held by the framework's internal pool until they are garbage-collected, which can increase memory pressure in UI-heavy screens with many custom-view instances.

Affected locations:
- `AMEditText.java`, line 42: `TypedArray a = getContext().obtainStyledAttributes(attrs, R.styleable.AMTextView);` — no `a.recycle()` call before method exits.
- `AMRadioButton.java`, line 43: same pattern — no `a.recycle()` call.
- `AMTextView.java`, line 42: same pattern — no `a.recycle()` call.

**Severity:** Low. No credential or data exposure; impact is memory management only.

---

### Section 4 — Input and Intent Handling

No Intent handling, WebView usage, deep link processing, or exported components are declared or used in any of the three files. The classes are passive custom View subclasses; they receive `AttributeSet` from the XML inflation framework (a trusted system path, not from external input).

**No issues found — Section 4: Input and Intent Handling**

---

### Section 5 — Authentication and Session

No authentication logic, token handling, session management, or credential storage is present in any of the three files.

**No issues found — Section 5: Authentication and Session**

---

### Section 6 — Third-Party Libraries

No third-party library dependencies are introduced by these files. The imports reference only Android SDK classes (`android.content.Context`, `android.content.res.TypedArray`, `android.graphics.Typeface`, `android.util.AttributeSet`, `android.widget.EditText`, `android.widget.RadioButton`, `android.widget.TextView`) and the internal library module `com.yy.libcommon.R`.

**Note — AMRadioButton.java — Unused Import**

`AMRadioButton.java` imports `android.widget.EditText` at line 7. The class extends `RadioButton`, not `EditText`, and `EditText` is not referenced anywhere in the file. This is dead code / leftover from a copy-paste. Severity is negligible from a security perspective but is a code quality flag.

**No issues found — Section 6: Third-Party Libraries**

---

### Section 7 — Google Play and Android Platform

No `targetSdkVersion`, `minSdkVersion`, permission declarations, runtime permission requests, or deprecated API usage appear in these three files.

**Observation — Deprecated three-argument View constructor target**

All three classes implement the `(Context, AttributeSet, int defStyle)` three-argument constructor, which is appropriate and not deprecated. No deprecated API usage was identified in the assigned files.

**No issues found — Section 7: Google Play and Android Platform**

---

## Summary of Findings

| ID | File | Section | Severity | Description |
|----|------|---------|----------|-------------|
| LC05-01 | AMEditText.java (line 42) | 3 — Data Storage | Low | `TypedArray` obtained via `obtainStyledAttributes` is never recycled — memory leak. |
| LC05-02 | AMRadioButton.java (line 43) | 3 — Data Storage | Low | Same `TypedArray` not recycled — memory leak. |
| LC05-03 | AMTextView.java (line 42) | 3 — Data Storage | Low | Same `TypedArray` not recycled — memory leak. |
| LC05-04 | AMRadioButton.java (line 7) | 6 — Third-Party Libraries | Info | Unused import `android.widget.EditText` — dead code, no security impact. |

**Branch discrepancy recorded:** Checklist specifies `Branch: main`; repository is on `master`.

No Critical, High, or Medium security findings identified in the three assigned files.
