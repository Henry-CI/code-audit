# Pass 1 Security Audit — forkliftiqapp
**Agent ID:** LC06
**Date:** 2026-02-27
**Stack:** Android/Java

---

## Step 1 — Branch Verification

Command run: `git -C /c/Projects/cig-audit/repos/forkliftiqapp branch --show-current`
Result: `master`

**Discrepancy noted:** The checklist states `Branch: main`; the actual branch is `master`. Proceeding on `master` as instructed.

---

## Step 2 — Files Audited

1. `LibCommon/src/main/java/com/yy/libcommon/Font/FontCache.java`
2. `LibCommon/src/main/java/com/yy/libcommon/FragmentInterface.java`
3. `LibCommon/src/main/java/com/yy/libcommon/IDialogGenericCallback.java`

---

## Step 3 — Reading Evidence

### File 1: `FontCache.java`

**Fully qualified class name:** `com.yy.libcommon.Font.FontCache`

**Public fields:**
- None declared public. `fontCache` (line 14) is `private static HashMap<String, Typeface>`.

**Public methods:**
| Line | Signature |
|------|-----------|
| 16 | `public static Typeface getTypeface(String fontname, Context context)` |
| 32 | `public static Typeface getTypeFace(Context context, String ttf)` |

**Activities / Fragments / Services / BroadcastReceivers / ContentProviders declared:** None.

**Notes:**
- No constructor is declared; class uses only static members and a static initialised `HashMap`.
- `getTypeface` (line 16) accepts a caller-supplied `fontname` string and appends it directly to the asset path `"fonts/" + fontname` (line 21).
- `getTypeFace` (line 32) acts as a convenience wrapper that maps a short keyword (`"bold"`, `"light"`, `"medium"`, `"thin"`, `"untrathin"`) to a specific `.ttf` filename before delegating to `getTypeface`.
- Exceptions thrown during `Typeface.createFromAsset` are silently caught and `null` is returned (line 23).

---

### File 2: `FragmentInterface.java`

**Fully qualified class name:** `com.yy.libcommon.FragmentInterface`

**Public members (outer class):** No fields, no methods — serves purely as a namespace wrapper.

**Nested interface `FragmentHandle` — public methods:**
| Line | Signature |
|------|-----------|
| 11 | `void addFragment(@IdRes int containerViewId, Fragment fragment, String tag)` |
| 12 | `void hideFragment(String tag)` |
| 13 | `void removeFragment(String tag)` |
| 14 | `Fragment findFramentByTag(String tag)` |
| 15 | `Fragment showFragment(@IdRes int containerViewId, String tag, String className)` |

**Activities / Fragments / Services / BroadcastReceivers / ContentProviders declared:** None (interface definition only).

**Notes:**
- Uses `android.support.annotation.IdRes` and `android.support.v4.app.Fragment` — legacy Android Support Library (not AndroidX).
- `findFramentByTag` contains a typo ("Frament" instead of "Fragment") at line 14.

---

### File 3: `IDialogGenericCallback.java`

**Fully qualified class name:** `com.yy.libcommon.IDialogGenericCallback`

**Public methods:**
| Line | Signature |
|------|-----------|
| 10 | `public void callBack()` |

**Activities / Fragments / Services / BroadcastReceivers / ContentProviders declared:** None (interface definition only).

**Notes:**
- Single-method callback interface; no state, no parameters, no return value.
- `public` modifier on an interface method is redundant but not harmful.

---

## Step 4 — Security Review by Checklist Section

### Section 1 — Signing and Keystores

No signing configuration, keystore references, Gradle dependency declarations, or pipeline configuration is present in any of the three assigned files.

**Finding: No issues found — Signing and Keystores** (out of scope for these files).

---

### Section 2 — Network Security

No network calls, HTTP clients, URL strings, API endpoints, or TLS/SSL configuration is present in any of the three assigned files.

**Finding: No issues found — Network Security** (out of scope for these files).

---

### Section 3 — Data Storage

No SharedPreferences access, file I/O, database operations, external storage calls, or credential caching is present in any of the three assigned files.

**Finding — FontCache static cache (Low / Informational):**

`FontCache.fontCache` is a `private static HashMap<String, Typeface>` (line 14). Because it is `static`, it lives for the lifetime of the process. `Typeface` objects contain only font metric data from the app's own asset bundle — no credentials, PII, or operator data. The retention pattern is acceptable for a font cache.

**Finding: No issues found — Data Storage** (no sensitive data involved).

---

### Section 4 — Input and Intent Handling

No Activities, Services, or BroadcastReceivers are declared. No WebView usage, implicit intents, or deep-link handlers are present.

**Finding — Unsanitised path concatenation in `FontCache.getTypeface` (Low):**

File: `FontCache.java`, line 21.

```java
typeface = Typeface.createFromAsset(context.getAssets(), "fonts/" + fontname);
```

The `fontname` parameter is appended directly to the asset path string with no sanitisation (no null check, no rejection of path-traversal sequences such as `../`). Because `getTypeFace` (the higher-level method, lines 32–64) only ever passes hardcoded literal strings to `getTypeface`, the risk in practice is limited to callers of the lower-level `getTypeface` method directly.

If any caller passes an externally-controlled string — for example one originating from a server response or an Intent extra — a relative path traversal sequence (`../../`) could cause `Typeface.createFromAsset` to attempt to open an arbitrary file within the APK's asset ZIP. On Android, `AssetManager` constrains access to the APK asset directory, so this does not constitute a device file-system traversal; however it could be used to probe or read unexpected asset entries. Severity is **Low** given the asset sandbox, but the absence of input validation is a code-quality concern that should be addressed.

**Recommendation:** Add a null check and reject any `fontname` containing `/` or `..` before constructing the asset path.

**Finding — `showFragment` accepts a raw `className` string (Informational):**

File: `FragmentInterface.java`, line 15.

```java
Fragment showFragment(@IdRes int containerViewId, String tag, String className);
```

The interface accepts an arbitrary `className` string. Depending on how implementations instantiate the class (e.g. via `Class.forName(className).newInstance()`), a caller passing an unexpected class name could trigger instantiation of an unintended class. This cannot be fully assessed without reviewing the concrete implementations, but the presence of a raw `className` parameter on a Fragment navigation method is a pattern worth flagging for follow-up in a later pass.

**Severity: Informational** — requires review of concrete implementations.

---

### Section 5 — Authentication and Session

No authentication logic, token handling, credential storage, or session management is present in any of the three assigned files.

**Finding: No issues found — Authentication and Session** (out of scope for these files).

---

### Section 6 — Third-Party Libraries

**Finding — Legacy Android Support Library (Low):**

File: `FragmentInterface.java`, lines 3–4.

```java
import android.support.annotation.IdRes;
import android.support.v4.app.Fragment;
```

Both imports reference the legacy `android.support.*` namespace (Android Support Library), which was superseded by AndroidX in 2018 and is no longer receiving security updates. Any security patches or bug fixes released by Google since the AndroidX migration are absent from the Support Library versions.

**Recommendation:** Migrate to AndroidX equivalents (`androidx.annotation.IdRes`, `androidx.fragment.app.Fragment`).

No version numbers or dependency declarations are present in the assigned files; full Gradle dependency CVE assessment is out of scope for these three files.

---

### Section 7 — Google Play and Android Platform

No `build.gradle`, `AndroidManifest.xml`, or permission declarations are present in the assigned files.

**Finding — Deprecated Support Library APIs (Low, overlaps Section 6):**

As noted above, `android.support.v4.app.Fragment` is a deprecated artifact. Google Play may surface warnings or compatibility issues as `targetSdkVersion` increases beyond the tested range of the Support Library.

**Finding — Silent exception suppression in `FontCache.getTypeface` (Informational):**

Lines 22–24:

```java
} catch (Exception e) {
    return null;
}
```

The broad `catch (Exception e)` silently discards any error loading a font asset and returns `null`. Callers of `getTypeface` and `getTypeFace` must null-check the return value or risk a `NullPointerException` when the result is applied to a UI widget. This is a defensive programming concern rather than a security finding, but silent failure can mask configuration errors (e.g. a missing font file) in production.

---

## Summary Table

| # | File | Section | Severity | Title |
|---|------|---------|----------|-------|
| 1 | `FontCache.java` line 21 | 4 — Input Handling | Low | Unsanitised string concatenation in asset path construction |
| 2 | `FragmentInterface.java` line 15 | 4 — Input Handling | Informational | Raw `className` parameter on `showFragment` — requires implementation review |
| 3 | `FragmentInterface.java` lines 3–4 | 6 — Third-Party Libraries | Low | Legacy Android Support Library imports (not AndroidX) |
| 4 | `FragmentInterface.java` lines 3–4 | 7 — Platform | Low | Deprecated Support Library APIs |
| 5 | `FontCache.java` lines 22–24 | 7 — Platform | Informational | Broad silent exception suppression masks font-load failures |

No Critical or High findings in the assigned files.
