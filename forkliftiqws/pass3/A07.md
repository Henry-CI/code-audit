# Audit Report A07 — Pass 3: Documentation
**Agent:** A07
**Pass:** 3 (Documentation)
**Date:** 2026-02-27
**Scope:** Controller layer Javadoc coverage and accuracy

---

## Source Files Examined

1. `src/main/java/com/journaldev/spring/jdbc/controller/EquipmentController.java`
2. `src/main/java/com/journaldev/spring/jdbc/controller/ImageController.java`
3. `src/main/java/com/journaldev/spring/jdbc/controller/ImpactController.java`

---

## Reading Evidence

### EquipmentController.java (lines 1–181)

- Class `EquipmentController extends ConfigurationController`, annotated `@Controller`.
- No class-level Javadoc.
- Declares six public endpoint methods:
  1. `getEquipmentByUser(int uid)` — GET, line 36
  2. `addEquipment(Equipment equipment)` — POST, line 44
  3. `getManufactureList(Authentication authentication)` — GET, line 78
  4. `getTypeList(int mid)` — GET, line 86
  5. `getFuelTypeList(int manuId, int typeID)` — GET, line 105
  6. `getService(int uid)` — GET, line 123
  7. `SaveService(Services services)` — POST, line 142
- No Javadoc comment exists on any method or on the class.
- `SaveService` uses PascalCase (non-standard Java method naming).
- Logger at line 143 inside `SaveService` reads `"Start addEquipment."` — this is a copy-paste of the log message from `addEquipment`, not the correct method name.

### ImageController.java (lines 1–48)

- Class `ImageController`, annotated `@Controller` and `@Slf4j`.
- No class-level Javadoc.
- Declares one public endpoint method:
  1. `downloadFile(String fileName)` — GET `/image/{fileName:.+}`, line 30
- No Javadoc comment exists on the method or on the class.
- Inline comment on line 32 (`// Load file as Resource`) and line 35 (`// Try to determine file's content type`) are implementation notes, not Javadoc.

### ImpactController.java (lines 1–196)

- Class `ImpactController extends ConfigurationController`, annotated `@Controller`.
- Class-level Javadoc exists at lines 39–41: `/** Handles requests for the Employee JDBC Service. */`
- Logger is incorrectly instantiated at line 44: `LoggerFactory.getLogger(ConfigurationController.class)` — passes the parent class rather than `ImpactController.class`.
- Declares four public endpoint methods:
  1. `saveIncident(Incidents incident)` — POST, line 59
  2. `saveImpactIMAGE(int impId, MultipartFile imageFile, String signatureFile)` — POST, line 83
  3. `saveImpactIMAGEAPP(int impId, String type, MultipartFile imageFile)` — POST, line 117
  4. `saveImpactData(ImpactList impactList)` — POST, line 152
- No Javadoc comment exists on any method.
- Lines 73–80 contain a block comment describing the expected multipart request format for `saveImpactIMAGE`; this is a plain `//` comment block, not Javadoc.

---

## Public Method Inventory

| # | Class | Method | Javadoc Present | Notes |
|---|-------|--------|-----------------|-------|
| 1 | EquipmentController | `getEquipmentByUser(int uid)` | No | — |
| 2 | EquipmentController | `addEquipment(Equipment equipment)` | No | — |
| 3 | EquipmentController | `getManufactureList(Authentication authentication)` | No | — |
| 4 | EquipmentController | `getTypeList(int mid)` | No | — |
| 5 | EquipmentController | `getFuelTypeList(int manuId, int typeID)` | No | — |
| 6 | EquipmentController | `getService(int uid)` | No | — |
| 7 | EquipmentController | `SaveService(Services services)` | No | Non-standard name |
| 8 | ImageController | `downloadFile(String fileName)` | No | — |
| 9 | ImpactController | `saveIncident(Incidents incident)` | No | — |
| 10 | ImpactController | `saveImpactIMAGE(int impId, MultipartFile imageFile, String signatureFile)` | No | — |
| 11 | ImpactController | `saveImpactIMAGEAPP(int impId, String type, MultipartFile imageFile)` | No | — |
| 12 | ImpactController | `saveImpactData(ImpactList impactList)` | No | — |

**Total public methods:** 12
**Methods with Javadoc:** 0
**Coverage:** 0%

---

## Findings

---

### A07-1
**Severity:** HIGH
**File:** `EquipmentController.java`
**Location:** Class declaration, line 23
**Description:** No class-level Javadoc on `EquipmentController`. The class exposes seven REST endpoints managing equipment lifecycle (retrieval, creation, update), manufacturer lookup, type/fuel-type lookup, and service record management. The absence of a class-level comment means the controller's purpose, REST base path, authentication requirements, and security posture are entirely undocumented.

---

### A07-2
**Severity:** HIGH
**File:** `EquipmentController.java`
**Location:** Line 36 — `getEquipmentByUser`
**Description:** No Javadoc. Method retrieves a list of `DriverEquipment` for a given user ID and returns `HTTP 400 BAD_REQUEST` when the result set is empty (atypical semantic — an empty list is not an error). Neither the path variable `uid`, the return type, nor the non-standard status-code behaviour is documented.

---

### A07-3
**Severity:** HIGH
**File:** `EquipmentController.java`
**Location:** Line 44 — `addEquipment`
**Description:** No Javadoc. Method performs dual-purpose logic: if `equipment.getId() > 0` it executes an UPDATE; otherwise it performs a duplicate-check then an INSERT. Returns `HTTP 502 BAD_GATEWAY` on duplicate detection. The branching behaviour, preconditions, error responses, and the unusual 502 status code are entirely undocumented.

---

### A07-4
**Severity:** MEDIUM
**File:** `EquipmentController.java`
**Location:** Line 78 — `getManufactureList`
**Description:** No Javadoc. Method uses the authenticated principal's username to filter manufacturers. The dependency on a valid `Authentication` object and the user-scoped filtering behaviour are not documented.

---

### A07-5
**Severity:** MEDIUM
**File:** `EquipmentController.java`
**Location:** Line 86 — `getTypeList`
**Description:** No Javadoc. When `mid == 0` all types are returned; otherwise types are filtered by manufacturer. The branching semantics of the `mid` parameter are not described.

---

### A07-6
**Severity:** MEDIUM
**File:** `EquipmentController.java`
**Location:** Line 105 — `getFuelTypeList`
**Description:** No Javadoc. When either `manuId` or `typeID` is 0 all fuel types are returned; otherwise filtering by both manufacturer and type applies. The conditional logic and parameter semantics are undocumented.

---

### A07-7
**Severity:** MEDIUM
**File:** `EquipmentController.java`
**Location:** Line 123 — `getService`
**Description:** No Javadoc. Method returns service schedule data joined across `unit` and `unit_service` tables for equipment accessible to the given user. The computed `service_due` column semantics and permission-based scoping are undocumented.

---

### A07-8
**Severity:** HIGH
**File:** `EquipmentController.java`
**Location:** Line 142 — `SaveService`
**Description:** No Javadoc. Method persists or updates a service record and conditionally appends a service-history entry. Additionally:
(a) The method name `SaveService` violates Java naming conventions (should be `saveService`).
(b) The log message on line 143 reads `"Start addEquipment."` — an incorrect copy from `addEquipment`. This constitutes inaccurate internal documentation (misleading log evidence).

---

### A07-9
**Severity:** HIGH
**File:** `ImageController.java`
**Location:** Class declaration, line 23
**Description:** No class-level Javadoc on `ImageController`. The class serves image resources from local storage via a public GET endpoint. The storage backend, URL pattern, and supported content types are not described anywhere in formal documentation.

---

### A07-10
**Severity:** HIGH
**File:** `ImageController.java`
**Location:** Line 30 — `downloadFile`
**Description:** No Javadoc. Method loads a file resource by name, detects MIME type via stream inspection, and returns it with appropriate Content-Type headers. On MIME detection failure it falls back to `application/octet-stream`. The path variable `fileName`, fallback behaviour, and error conditions (e.g., file not found) are undocumented.

---

### A07-11
**Severity:** HIGH
**File:** `ImpactController.java`
**Location:** Class declaration, lines 39–41
**Description:** The existing class-level Javadoc reads:
`/** Handles requests for the Employee JDBC Service. */`
This description is inaccurate: the class handles impact events, incident reports, and associated image uploads — it has no relation to employees or a generic "JDBC Service". The comment appears to be a template placeholder that was never updated, actively misleading readers about the controller's purpose.

---

### A07-12
**Severity:** HIGH
**File:** `ImpactController.java`
**Location:** Line 59 — `saveIncident`
**Description:** No Javadoc. Method allocates a sequence ID, inserts a new incident record with parsed ISO datetime fields, and returns the populated `Incidents` object. The sequence dependency, datetime parsing requirement, and all request/response fields are undocumented.

---

### A07-13
**Severity:** HIGH
**File:** `ImpactController.java`
**Location:** Line 83 — `saveImpactIMAGE`
**Description:** No Javadoc. Method accepts a multipart image file and a Base64-encoded signature string, stores both to AWS, and updates the incident record. The Base64 data-URL stripping logic (line 90), the AWS storage dependency, and both path/request parameters are undocumented. The informal block comment at lines 73–80 uses `//` notation and is not Javadoc; it does not document parameters, return type, or exception behaviour.

---

### A07-14
**Severity:** HIGH
**File:** `ImpactController.java`
**Location:** Line 117 — `saveImpactIMAGEAPP`
**Description:** No Javadoc. Method uploads a single file to AWS and updates either the `image` or `signature` column of an incident depending on the `type` path variable. If `type` matches neither `"image"` nor `"signature"`, neither column is updated and the method still returns `HTTP 200 OK` — a silent no-op that is entirely undocumented.

---

### A07-15
**Severity:** HIGH
**File:** `ImpactController.java`
**Location:** Line 152 — `saveImpactData`
**Description:** No Javadoc. Method iterates over a list of raw impact telemetry, resolves each to equipment by MAC address, deduplicates against stored records, persists new events, and conditionally fires impact threshold notifications. The deduplication strategy, threshold calculation (`impact_value > impact_threshold * 10`), notification trigger, and the two distinct error paths (`IncorrectResultSizeDataAccessException` / `IllegalArgumentException`) are undocumented.

---

### A07-16
**Severity:** MEDIUM
**File:** `ImpactController.java`
**Location:** Line 44
**Description:** The logger is instantiated with `LoggerFactory.getLogger(ConfigurationController.class)` instead of `ImpactController.class`. All log output from this controller will appear attributed to `ConfigurationController` in log aggregation systems, making log-based diagnosis misleading. While this is primarily a defect finding, it represents inaccurate internal documentation of the component's identity.

---

## Summary

| Severity | Count |
|----------|-------|
| CRITICAL | 0 |
| HIGH | 11 |
| MEDIUM | 5 |
| LOW | 0 |
| INFO | 0 |
| **Total** | **16** |

### Key Observations

1. **Zero Javadoc coverage across all three controllers.** All 12 public endpoint methods lack any `/** */` Javadoc comment. No `@param`, `@return`, or `@throws` tags are present anywhere in the three files.

2. **The only class-level Javadoc that exists is inaccurate.** `ImpactController` carries a stale template comment describing "Employee JDBC Service" — unrelated to the class's actual domain.

3. **Inaccurate log message constitutes misleading inline documentation.** `SaveService` logs `"Start addEquipment."` — this will actively mislead incident investigators reading log output.

4. **Non-standard method naming** (`SaveService`) compounds the documentation gap by departing from Java conventions without explanation.

5. **Silent no-op behaviour** in `saveImpactIMAGEAPP` (unrecognised `type` value returns HTTP 200 with no action) and **non-standard HTTP status semantics** in `getEquipmentByUser` (HTTP 400 on empty list) and `addEquipment` (HTTP 502 on duplicate) are patterns that demand Javadoc-level disclosure to all API consumers.
