# Audit Report A25 - Pass 3: Documentation
**Agent:** A25
**Date:** 2026-02-27
**Pass:** 3 (Documentation)
**Working Directory:** C:\Projects\cig-audit\repos\forkliftiqws

---

## Source Files Examined

1. `src/main/java/com/journaldev/spring/jdbc/service/APKUpdaterService.java`
2. `src/main/java/com/journaldev/spring/jdbc/service/AWSFileStorageService.java`
3. `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java`

---

## Reading Evidence

### File 1: APKUpdaterService.java (69 lines)

- `@Service`-annotated Spring service class.
- No class-level Javadoc present.
- Declares a compiled `Pattern` field `pattern` (line 25) matching APK filenames in the form `<name>-<version>.apk`.
- `packageDir` field injected via `@Value("${packageDir}")` (line 21-22).
- **Public method 1:** `getAvailablePackage(String baseUrl, String pkgName, String currentVersion)` (line 28)
  - Lists files in `packageDir`, parses each filename against the regex pattern, builds `PackageEntry` objects, filters to those whose version is greater than `currentVersion`, and returns the maximum by natural order.
  - Returns `Optional<PackageEntry>`.
  - No Javadoc present.
  - Throws custom `APKUpdaterException` on `IOException`; the custom `FileNotFoundException` is referenced in `loadPackageAsResource`.
- **Public method 2:** `loadPackageAsResource(String pkgname, String version)` (line 54)
  - Constructs a file path `<packageDir>/<pkgname>-<version>.apk`, wraps it as a `UrlResource`.
  - Returns the `Resource` if it exists; throws a custom `FileNotFoundException` if not; throws `APKUpdaterException` on `IOException`.
  - No Javadoc present.
- No class Javadoc. No method Javadoc. No field Javadoc.

### File 2: AWSFileStorageService.java (79 lines)

- Extends `AbstractFileStorageService`; annotated `@Service("awsFileStorage")` and `@Slf4j`.
- No class-level Javadoc present.
- Declares `cloudImagedDir` (property `${cloudImagedDir}`, line 25-26) and `bucketName` (line 28-29).
- **Hardcoded AWS credentials** at lines 31-34: a `BasicAWSCredentials` object is initialised with a literal access key ID and secret access key.
- **Public method 1:** `saveImage(InputStream inputStream)` (line 38, `@Override`)
  - Calls `super.saveImage(inputStream)` to store the file locally, then calls the private `uploadObject` to push it to S3.
  - Returns the generated `fileName`.
  - No Javadoc present.
- **Public method 2:** `loadImageAsResource(String fileName)` (line 45, `@Override`)
  - Body is a single `return null;` statement. This is an unimplemented stub.
  - No Javadoc present. No `@deprecated`, no `TODO`, no explanation for the null return.
- **Private method:** `connectAWSS3()` (line 50) - builds and returns an `AmazonS3` client. No Javadoc.
- **Private method:** `uploadObject(String key_name, String file_path)` (line 62)
  - Has three inline comments immediately before the method describing `bucketName`, `key`, and `file` (lines 58-60), but these are block comments (`//`), not Javadoc (`/** */`). They are also misattributed to named parameters that do not correspond to the actual parameter names `key_name` / `file_path`.

### File 3: AbstractFileStorageService.java (75 lines)

- Package-private abstract class (`abstract class`, no `public` modifier, line 23). Implements `FileStorageService`.
- Annotated `@Slf4j`.
- No class-level Javadoc present.
- Protected fields: `uploadDir`, `imageDir`, `imageStorageLocation`, `targetLocation`, `fileName`, `imageExt`. None have Javadoc or inline doc comments.
- Private field: `imagePrefix`. No doc.
- **Public method 1:** `initialize()` (line 43, `@PostConstruct`)
  - Creates the image storage directory on the filesystem. Throws `FileStorageException` if directory creation fails.
  - No Javadoc present.
- **Public method 2:** `saveImage(InputStream inputStream)` (line 53, `@Override`)
  - Guesses MIME type of the stream to determine file extension (falls back to `.jpg`). Generates a random filename using `imagePrefix` + `Util.generateRadomName()` + extension. Copies the stream to `imageStorageLocation`. Sets `targetLocation` and `fileName` as side effects on the instance.
  - Returns the generated filename string.
  - No Javadoc present.
  - The side effects on `targetLocation` and `fileName` are not documented anywhere.

---

## Public Method Inventory

| # | Class | Method Signature | Javadoc Present | Accurate |
|---|-------|-----------------|-----------------|----------|
| 1 | `APKUpdaterService` | `getAvailablePackage(String, String, String)` | No | N/A |
| 2 | `APKUpdaterService` | `loadPackageAsResource(String, String)` | No | N/A |
| 3 | `AWSFileStorageService` | `saveImage(InputStream)` | No | N/A |
| 4 | `AWSFileStorageService` | `loadImageAsResource(String)` | No | N/A |
| 5 | `AbstractFileStorageService` | `initialize()` | No | N/A |
| 6 | `AbstractFileStorageService` | `saveImage(InputStream)` | No | N/A |

All 6 public methods across all 3 files lack Javadoc. No inaccurate Javadoc was found because no Javadoc exists at all.

---

## Findings

---

### A25-1
**Severity:** CRITICAL
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AWSFileStorageService.java`
**Lines:** 31-34
**Issue:** Hardcoded AWS credentials (access key ID and secret access key) embedded as string literals in a static field initialiser.

```java
private static AWSCredentials credentials = new BasicAWSCredentials(
        "AKIA**REDACTED**",
        "****REDACTED****"
);
```

While this is primarily a security defect, it represents a complete failure of documentation discipline: no `@deprecated` notice, no comment indicating these are placeholders, no reference to externalised credential configuration. Any documentation review of this class must surface this finding. The credentials must be treated as compromised and rotated immediately.

---

### A25-2
**Severity:** HIGH
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AWSFileStorageService.java`
**Lines:** 45-47
**Issue:** `loadImageAsResource(String fileName)` is a public method that unconditionally returns `null`. There is no Javadoc, no `@deprecated` tag, no `TODO` comment, and no explanation of the null return. Callers have no documented contract; null returns without documentation guarantee will cause `NullPointerException` at call sites.

```java
@Override
public Resource loadImageAsResource(String fileName) {
    return null;
}
```

---

### A25-3
**Severity:** HIGH
**File:** `src/main/java/com/journaldev/spring/jdbc/service/APKUpdaterService.java`
**Lines:** 28-52
**Issue:** `getAvailablePackage(String baseUrl, String pkgName, String currentVersion)` has no Javadoc. This is a non-trivial public method with three parameters, a non-obvious return type (`Optional<PackageEntry>`), and two distinct exception pathways. None of the parameters, the return value, or the thrown exception are documented.

---

### A25-4
**Severity:** HIGH
**File:** `src/main/java/com/journaldev/spring/jdbc/service/APKUpdaterService.java`
**Lines:** 54-68
**Issue:** `loadPackageAsResource(String pkgname, String version)` has no Javadoc. The method throws two different custom exceptions (`FileNotFoundException` and `APKUpdaterException`), neither of which is documented. The expected filename format `<pkgname>-<version>.apk` is undocumented.

---

### A25-5
**Severity:** HIGH
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java`
**Lines:** 53-74
**Issue:** `saveImage(InputStream inputStream)` in the abstract base class has no Javadoc. Critically, the method has undocumented side effects: it writes to the protected instance fields `targetLocation` and `fileName`. Subclasses (such as `AWSFileStorageService`) depend on these side effects being set by `super.saveImage()`, but this contract is entirely undocumented. This creates a hidden coupling that is invisible to any subclass author.

---

### A25-6
**Severity:** MEDIUM
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AWSFileStorageService.java`
**Lines:** 38-42
**Issue:** `saveImage(InputStream inputStream)` override has no Javadoc. The method overrides the abstract base implementation and adds AWS S3 upload behaviour, which is a behavioural addition not described anywhere. No `@param`, `@return`, or `@throws` tags are present.

---

### A25-7
**Severity:** MEDIUM
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java`
**Lines:** 43-50
**Issue:** `initialize()`, annotated `@PostConstruct`, has no Javadoc. The lifecycle semantics of this method (it runs automatically after dependency injection) and its failure mode (throws `FileStorageException` if directory creation fails) are undocumented. Developers unfamiliar with the class will not know when or why this method executes.

---

### A25-8
**Severity:** MEDIUM
**File:** `src/main/java/com/journaldev/spring/jdbc/service/APKUpdaterService.java`
**Lines:** 19 (class declaration)
**Issue:** No class-level Javadoc on `APKUpdaterService`. The purpose of the class, its dependency on the `${packageDir}` configuration property, and the filename convention it expects (`<name>-<version>.apk`) are entirely undocumented at the class level.

---

### A25-9
**Severity:** MEDIUM
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AWSFileStorageService.java`
**Lines:** 24 (class declaration)
**Issue:** No class-level Javadoc on `AWSFileStorageService`. The class inherits from `AbstractFileStorageService` and adds AWS S3 upload capability, but neither the purpose, the required configuration properties (`${cloudImagedDir}`, `${bucketName}`), nor the AWS region (hardcoded to `US_EAST_1`) are documented anywhere.

---

### A25-10
**Severity:** MEDIUM
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java`
**Lines:** 23 (class declaration)
**Issue:** No class-level Javadoc on `AbstractFileStorageService`. The class defines the shared image-storage lifecycle for all concrete implementations, but its responsibilities, the configuration properties it consumes (`${uploadDir}`, `${imageDir}`, `${imagePrefix}`), and the contract it imposes on subclasses are completely undocumented.

---

### A25-11
**Severity:** MEDIUM
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AWSFileStorageService.java`
**Lines:** 58-60
**Issue:** Inline comments describing the `uploadObject` method parameters use incorrect identifiers. The comments reference `bucketName`, `key`, and `file`, but the actual parameter names are `key_name` and `file_path`, and `bucketName` is a class field rather than a parameter. These comments are misleading and would be inaccurate if promoted to Javadoc.

```java
// bucketName: The bucket name where we want to upload object
// key: This is the full path to the file
// file: The actual file containing the data to be uploaded
private void uploadObject(String key_name, String file_path) {
```

---

### A25-12
**Severity:** MEDIUM
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java`
**Lines:** 34-40
**Issue:** Six protected fields (`imageStorageLocation`, `targetLocation`, `fileName`, `imageExt`, `uploadDir`, `imageDir`) have no Javadoc or documentation comments. Because these fields are `protected`, they form part of the API surface exposed to all subclasses, yet their intended semantics, lifecycle (which are initialised by `initialize()` vs `saveImage()`), and mutability constraints are entirely undocumented.

---

### A25-13
**Severity:** LOW
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AWSFileStorageService.java`
**Lines:** 25-26
**Issue:** The `@Value` property key `${cloudImagedDir}` contains a typographic error ("Imaged" instead of "Image"). This is inconsistent with the semantics of the field. There is no comment documenting this as an intentional property name or noting the discrepancy.

```java
@Value("${cloudImagedDir}")
private String cloudImagedDir;
```

---

### A25-14
**Severity:** LOW
**File:** `src/main/java/com/journaldev/spring/jdbc/service/APKUpdaterService.java`
**Lines:** 25
**Issue:** The `pattern` field holds a `Pattern` compiled from a regex used to parse APK filenames. The regex `(\\w*)-(\\d*\\.?\\d*?\\.?\\d*?\\.?-\\w*)\\.apk` and the expected filename format it enforces are entirely undocumented. A single comment or Javadoc on this field describing the expected format and the named capture groups would substantially aid maintainability.

---

### A25-15
**Severity:** INFO
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java`
**Lines:** 23
**Issue:** The class is declared with package-private visibility (`abstract class`, no `public`) yet it implements `FileStorageService` (which is presumably public). While this is a valid design choice to prevent direct instantiation from outside the package, there is no documentation explaining the intentional scoping decision.

---

## Summary Table

| Finding | Severity | File | Lines | Issue |
|---------|----------|------|-------|-------|
| A25-1 | CRITICAL | AWSFileStorageService.java | 31-34 | Hardcoded AWS credentials with no documentation or placeholder notice |
| A25-2 | HIGH | AWSFileStorageService.java | 45-47 | `loadImageAsResource` returns null unconditionally with no Javadoc or explanation |
| A25-3 | HIGH | APKUpdaterService.java | 28-52 | `getAvailablePackage` missing all Javadoc (params, return, throws) |
| A25-4 | HIGH | APKUpdaterService.java | 54-68 | `loadPackageAsResource` missing all Javadoc (params, return, throws) |
| A25-5 | HIGH | AbstractFileStorageService.java | 53-74 | `saveImage` side effects on `targetLocation`/`fileName` completely undocumented |
| A25-6 | MEDIUM | AWSFileStorageService.java | 38-42 | `saveImage` override adds S3 behaviour with no Javadoc |
| A25-7 | MEDIUM | AbstractFileStorageService.java | 43-50 | `@PostConstruct initialize()` lifecycle and failure mode undocumented |
| A25-8 | MEDIUM | APKUpdaterService.java | 19 | No class-level Javadoc; config property and filename convention undocumented |
| A25-9 | MEDIUM | AWSFileStorageService.java | 24 | No class-level Javadoc; config properties and hardcoded region undocumented |
| A25-10 | MEDIUM | AbstractFileStorageService.java | 23 | No class-level Javadoc; config properties and subclass contract undocumented |
| A25-11 | MEDIUM | AWSFileStorageService.java | 58-60 | Inline parameter comments use wrong identifiers; inaccurate and misleading |
| A25-12 | MEDIUM | AbstractFileStorageService.java | 34-40 | Six protected fields forming subclass API have no documentation |
| A25-13 | LOW | AWSFileStorageService.java | 25-26 | Typo in `@Value` property key (`cloudImagedDir`) with no explanatory comment |
| A25-14 | LOW | APKUpdaterService.java | 25 | Regex `pattern` field undocumented; expected filename format not described |
| A25-15 | INFO | AbstractFileStorageService.java | 23 | Package-private class visibility scoping choice is undocumented |

**Totals:** 1 CRITICAL, 4 HIGH, 7 MEDIUM, 2 LOW, 1 INFO

---

*Report generated by Agent A25, Pass 3 (Documentation), 2026-02-27.*
