# Security Audit — Pass 1 — Agent B06
**Date:** 2026-02-27
**Repo:** forkliftiqws
**Branch:** master
**Agent:** B06
**Files reviewed:**
- `src/main/java/com/journaldev/spring/jdbc/controller/ConfigurationController.java`
- `src/main/java/com/journaldev/spring/jdbc/controller/DatabaseCleanupException.java`
- `src/main/java/com/journaldev/spring/jdbc/controller/DatabaseController.java`

**Supporting files consulted (for context only):**
- `src/main/webapp/WEB-INF/spring/spring-security.xml`
- `src/main/webapp/WEB-INF/web.xml`
- `src/main/webapp/WEB-INF/spring/appServlet/servlet-context.xml`
- `src/main/java/com/journaldev/spring/jdbc/util/Configuration.java`
- `src/main/java/com/journaldev/spring/jdbc/service/UserDetailsServiceImpl.java`
- `src/main/resources/fleetiq360ws.properties`
- `environment.dev.properties`
- `environment.prod.properties`
- `environment.uat.properties`
- `pom.xml`
- `.gitignore`

---

## Step 3 — Reading Evidence

### File 1: `ConfigurationController.java`

**Fully qualified class name:** `com.journaldev.spring.jdbc.controller.ConfigurationController`

**Class-level annotations:**
- `@Controller` (line 16)

**Modifier:** `public abstract class`

**Interfaces implemented / classes extended:** None

**Fields:**
- `protected Configuration configuration` — annotated `@Autowired` (line 19–20)
- `protected DataSource dataSource` — annotated `@Autowired`, `@Qualifier("dataSource")` (lines 22–24)

**Public methods:** None (abstract base class only; no mapped endpoints)

---

### File 2: `DatabaseCleanupException.java`

**Fully qualified class name:** `com.journaldev.spring.jdbc.controller.DatabaseCleanupException`

**Class-level annotations:**
- `@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)` (line 6)

**Modifier:** `public class`

**Interfaces implemented / classes extended:** `extends RuntimeException`

**Fields:** None declared

**Public methods:**
- `DatabaseCleanupException(String message)` — constructor, line 8; calls `super(message)`

---

### File 3: `DatabaseController.java`

**Fully qualified class name:** `com.journaldev.spring.jdbc.controller.DatabaseController`

**Class-level annotations:**
- `@Slf4j` (line 14)
- `@Controller` (line 15)

**Modifier:** `public class`

**Interfaces implemented / classes extended:** `extends ConfigurationController`

**Fields:**
- `private static final String QUERY_COMPANIES_TO_DELETE` (lines 18–60) — hardcoded multi-line SQL string containing a whitelist of email addresses and MAC addresses

**Public methods:**

| Return type | Method | Parameters | Line | Annotations |
|---|---|---|---|---|
| `void` | `cleanup` | none | 64 | `@RequestMapping(value = "/rest/db/cleanup", method = RequestMethod.POST)`, `@ResponseStatus(value = HttpStatus.OK)` |

**Private methods:**
- `void deleteCompanies(JdbcTemplate jdbcTemplate, int pass, List<Long> errors, List<Long> companies)` — line 84

---

## Step 4 — Checklist Review

### Section 1: Secrets and Configuration

**Finding B06-1 below:** Credentials hardcoded in environment property files committed to git.

**Finding B06-2 below:** Database credentials hardcoded in `pom.xml` profile definitions.

**Finding B06-3 below:** OAuth2 client secrets hardcoded in `spring-security.xml`.

**Finding B06-4 below:** Weak/default cognitoAPI credentials in all three environment files.

**`environment.dev.properties` / `environment.prod.properties` / `environment.uat.properties`:** All three files committed to git and contain `cognitoAPIUsername=ciiadmin` and `cognitoAPIPassword=ciiadmin`. The prod/uat files also expose the AWS EC2 hostname `ec2-54-86-82-22.compute-1.amazonaws.com` and the RDS endpoint `forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com`.

**`.gitignore`:** Only `environment.local.properties` is excluded. All environment property files (`dev`, `prod`, `uat`) are tracked in git.

**`pom.xml`:** Local and dev profiles contain plaintext database credentials (`fleetiq360`/`fleetiq360`). UAT profile contains `flyway.user=dev_admin` / `flyway.password=C!1admin`. These are committed to git.

**`spring-security.xml`:** OAuth2 client secrets are committed in plaintext:
- Client `987654321`: secret `8752361E593A573E86CA558FFD39E`
- Client `fleetiq360`: secret `rihah8eey4faibuengaixo6leiL1awii`

**`spring-security.xml` password hash:** The authentication manager uses `<password-encoder hash="md5"/>`. MD5 is a broken algorithm for password storage — it is not a suitable password hashing function (no salt, trivially reversible with rainbow tables). This is raised under Section 2 as it relates to auth strength, but is noted here also.

---

### Section 2: Authentication and Authorization

**Spring Security configuration reviewed:** `spring-security.xml`

**URL protection summary from `spring-security.xml` (lines 28–35):**
```xml
<http pattern="/rest/**" create-session="never" ...>
    <anonymous enabled="false" />
    <intercept-url pattern="/rest/db/**" access="ROLE_SYS_ADMIN" />
    <intercept-url pattern="/rest/apk/**" access="ROLE_CLIENT" />
    <intercept-url pattern="/rest/**" access="ROLE_DRIVER,ROLE_COMPANY_GROUP,ROLE_SYS_ADMIN,ROLE_CLIENT" />
    ...
</http>
```

The `/rest/db/cleanup` endpoint is covered by `<intercept-url pattern="/rest/db/**" access="ROLE_SYS_ADMIN" />`. At the security XML layer, this endpoint appears restricted to `ROLE_SYS_ADMIN`.

**However, the following concerns apply:**

**`spring-security.xml` lines 13–14 — Testing endpoints exposed with `security="none"`:**
```xml
<http pattern="/oauth/cache_approvals" security="none" ... />
<http pattern="/oauth/uncache_approvals" security="none" ... />
```
The comment says "Just for testing..." — these OAuth approval cache endpoints are completely unprotected on the live branch.

**`spring-security.xml` password encoder:** `<password-encoder hash="md5"/>` — MD5 is not a password hashing function. It has no salt and is trivially brute-forced. Any attacker who obtains a database dump can recover all user passwords. This is raised as a separate finding.

**No `@PreAuthorize` or `@Secured` annotations:** Neither `DatabaseController` nor `ConfigurationController` carry method-level authorization annotations. Enforcement is entirely at the URL-pattern level in the XML config. If the URL pattern is ever changed or a new route added under a different path, there is no defence-in-depth.

**`access-token-validity="0"` on client `987654321` (line 114):** An access token validity of `0` is ambiguous. In Spring Security OAuth2 1.x, `0` or negative values typically disable expiry, meaning tokens for this client never expire. This is a significant auth concern.

**`access-token-validity="300"` and `refresh-token-validity="300"` for client `fleetiq360` (line 117):** 300 seconds (5 minutes) access token is reasonable, but 300 seconds refresh token validity is extremely short — this is likely a misconfiguration that would cause frequent re-authentication, but is not a security risk per se. More important: if the refresh token expires as quickly as the access token, refresh tokens provide no practical benefit, potentially pushing developers toward insecure workarounds.

---

### Section 3: Input Validation and Injection

**`DatabaseController.java` — SQL injection in `deleteCompanies`:**

The `QUERY_COMPANIES_TO_DELETE` constant is a static string with no user input — it is safe from SQL injection as written. However, the `deleteCompanies` method at line 88 performs string concatenation to build the SQL call:

```java
jdbcTemplate.execute("select delete_company("+ c +")");
```

The variable `c` is a `Long` value drawn from the result of the prior database query (`QUERY_COMPANIES_TO_DELETE`), so in the current code path it is not directly user-controlled. However: (1) using string concatenation in SQL with a `JdbcTemplate` is a risky pattern — if the type of `c` or the data source of the list ever changes, this becomes injectable; (2) best practice for parameterised stored procedure calls with `JdbcTemplate` is to use `SimpleJdbcCall` or a `PreparedStatement`, not `execute()` with concatenation. This is flagged as a Medium finding.

**`ConfigurationController.java` — No request parameters accepted:** This abstract base class exposes no endpoints and accepts no request parameters. No injection risk in this file itself.

**`DatabaseController.cleanup()` — No input parameters:** The `cleanup()` endpoint takes no request parameters or request body. No direct injection vector at the HTTP boundary.

**No `@Valid`, `@RequestParam`, `@PathVariable`, or `@RequestBody` annotations in the reviewed files:** N/A — the reviewed controllers accept no user-supplied input at the HTTP layer.

---

### Section 4: Session and CSRF

**CSRF:** The `spring-security.xml` uses Spring Security's `<http>` element in OAuth2 resource server mode (`create-session="never"`). Spring Security 3.1 does include CSRF protection in its `<http>` element by default, but with stateless OAuth2 token-based authentication and `create-session="never"`, CSRF protection is generally not applicable (tokens in Authorization headers are not automatically sent by browsers, unlike cookies). This is acceptable for a token-based API.

However: the security configuration is Spring Security 3.1.1.RELEASE — an extremely old version. CSRF defaults and session management behaviour differ significantly from modern releases. Without confirmation of correct token handling in the front-end clients, this cannot be fully cleared.

**CORS:** No `@CrossOrigin` annotations found in the three reviewed files. No global CORS configuration observed in `servlet-context.xml`. CORS is not specifically addressed in reviewed files — CLEAR for reviewed files.

**Security headers (`X-Frame-Options`, `X-Content-Type-Options`, `HSTS`):** Not configured in any reviewed file or in `web.xml`. The `web.xml` `<transport-guarantee>CONFIDENTIAL</transport-guarantee>` enforces HTTPS at the container level, which is correct, but no application-level security headers are set.

---

### Section 5: Data Exposure

**`DatabaseCleanupException.java`:** The constructor accepts a `String message` and passes it to `super(message)`. The class is annotated `@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)`. In Spring MVC, when a `@ResponseStatus`-annotated exception is thrown, if no `@ExceptionHandler` or `@ControllerAdvice` intercepts it first, the framework uses the `reason` attribute of `@ResponseStatus` for the response body — not the exception message. Since no `reason` attribute is set here, Spring MVC's default behaviour (in Spring 3.x) will attempt to use `response.sendError(statusCode, message)`, which **will send the exception message string to the client** as part of the HTTP error response body or reason phrase.

This means if `DatabaseCleanupException("Unable to properly cleanup database")` is thrown, the string `"Unable to properly cleanup database"` is sent to the client. In the current code this specific string is benign, but the pattern is dangerous: any future `DatabaseCleanupException` carrying a SQL error or internal detail (e.g., if the catch at line 71 were to re-throw with the original exception message) would expose that detail to the client. This is flagged as a Medium finding.

**`DatabaseController.cleanup()` — Error suppression at line 71:**
```java
} catch(Exception e) {
    log.error("Unable to retrieve companies to delete");
}
```
The original exception `e` is caught and discarded without logging its message or stack trace. This suppresses diagnostic information while providing no additional client protection. If the query fails, `companies` remains `null`, and `deleteCompanies` will throw a `NullPointerException` (see below).

**`DatabaseController.deleteCompanies()` — Null pointer risk:**
```java
companies.forEach(c -> {
```
If the `try` block at lines 67–73 catches an exception, `companies` remains `null` (declared as `List<Long> companies = null;` at line 66). The subsequent call to `deleteCompanies(jdbcTemplate, pass, errors, companies)` at line 77 passes a `null` list. Inside `deleteCompanies`, `companies.forEach(...)` will throw a `NullPointerException`. This unhandled NPE will propagate out of `cleanup()` and produce an uncontrolled 500 error response. Depending on Spring's error handler configuration, this may expose a stack trace to the client.

**Customer PII in source code:** The `QUERY_COMPANIES_TO_DELETE` constant (lines 18–60) contains hardcoded real customer email addresses and device MAC addresses embedded in production source code. This is a data exposure and data governance concern — PII is embedded in the codebase and will appear in logs, stack traces, code reviews, and build artefacts.

---

### Section 6: Dependencies

**Spring Framework: `3.2.14.RELEASE`** — End of life since December 2016. Multiple CVEs exist against this version. Spring 3.x is no longer maintained and has known vulnerabilities.

**Spring Security: `3.1.1.RELEASE`** — End of life. Numerous CVEs, including authentication bypass and session fixation issues in older 3.x releases.

**Spring Security OAuth2: `1.0.0.RELEASE`** — This is the legacy OAuth2 library, archived since 2019. It has known vulnerabilities (including CVE-2018-15758, redirect URI bypass). Version 1.0.0 predates significant security fixes.

**Jackson Databind: `2.6.7`** — End of life. Multiple known deserialization CVEs (e.g., CVE-2017-7525, CVE-2018-5968, and many others) that allow remote code execution. This is a critical dependency concern.

**`commons-fileupload: 1.3.1`** — CVE-2016-3092 (DoS via malformed Content-Type header) affects versions before 1.3.2. This version is vulnerable.

**`logback-classic/logback-core: 1.2.3`** — CVE-2021-42550 (JNDI injection via logback configuration) affects versions before 1.2.9. Severity depends on whether logback configuration can be reloaded remotely; flagged as notable.

**`aws-java-sdk: 1.11.163`** — Old version from 2017. Multiple security and reliability patches have been applied since. Flagged as informational.

**`splunk-library-javalogging: 1.6.2`** — Fetched from `http://splunk.jfrog.io/splunk/ext-releases-local` over plain HTTP (not HTTPS). This repository URL is subject to MITM attacks during dependency resolution.

**`braintree-java: 2.53.0`** — Old version. Should be reviewed against current Braintree advisories.

**No SNAPSHOT dependencies** in production: CLEAR.

---

### Section 7: Build and CI

**Bitbucket Pipelines:** No `bitbucket-pipelines.yml` file found in the repository. Build and deployment CI/CD configuration is absent from the repo. Cannot verify whether tests are skipped, credentials are injected via variables, or deployment is automated securely.

**Maven profiles with credentials committed:** The `pom.xml` contains Flyway database credentials in plaintext for `local`, `dev`, and `uat` profiles. These are committed to git. See B06-2.

**Tomcat deployment plugin:** `tomcat7-maven-plugin` uses `${tomcat.url}` and `${tomcat.server}` from the profile, which in turn references `settings.xml` server credentials. The server credentials themselves are not in `pom.xml`, but the Tomcat manager URLs (including the plaintext HTTP URL `http://ec2-54-86-82-22.compute-1.amazonaws.com:8080/manager/text`) are committed. Deployment to the Tomcat manager over plain HTTP exposes the WAR file and credentials to MITM.

---

## Step 5 — Findings

---

**B06-1** — CRITICAL
**Section:** 1 — Secrets and Configuration
**File:** `environment.dev.properties:15-16`, `environment.prod.properties:15-16`, `environment.uat.properties:15-16`
**Description:** Cognito API credentials (`cognitoAPIUsername` and `cognitoAPIPassword`) are hardcoded with the same trivial value `ciiadmin` in all three environment property files, all of which are committed to git. The `.gitignore` excludes only `environment.local.properties`, leaving dev, prod, and uat files tracked. An attacker with read access to the repository can obtain credentials used to authenticate against the Cognito API service.
**Evidence:**
```
cognitoAPIPort=9090
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```
(identical in all three files)

---

**B06-2** — CRITICAL
**Section:** 1 — Secrets and Configuration
**File:** `pom.xml:29-30`, `pom.xml:45-46`, `pom.xml:76-77`
**Description:** Database credentials are committed in plaintext inside Maven profile definitions. The UAT profile exposes the Flyway user `dev_admin` with password `C!1admin` for an RDS instance on AWS. The local and dev profiles expose `fleetiq360`/`fleetiq360`. All three are tracked in git with no `.gitignore` exclusion.
**Evidence:**
```xml
<!-- local profile -->
<flyway.password>gmtp-postgres</flyway.password>
<flyway.password>fleetiq360</flyway.password>

<!-- dev profile -->
<flyway.password>fleetiq360</flyway.password>

<!-- uat profile -->
<flyway.user>dev_admin</flyway.user>
<flyway.password>C!1admin</flyway.password>
```

---

**B06-3** — CRITICAL
**Section:** 1 — Secrets and Configuration
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:113-118`
**Description:** OAuth2 client secrets are hardcoded in plaintext in a configuration file committed to git. Any party with repository access can authenticate as either OAuth2 client and obtain tokens.
**Evidence:**
```xml
<oauth:client client-id="987654321" ...
              secret="8752361E593A573E86CA558FFD39E" ... />

<oauth:client client-id="fleetiq360" ...
              secret="rihah8eey4faibuengaixo6leiL1awii" ... />
```

---

**B06-4** — HIGH
**Section:** 2 — Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:74`
**Description:** The Spring Security authentication provider for user passwords uses MD5 as the password hashing algorithm (`<password-encoder hash="md5"/>`). MD5 is not a password hashing function: it is unsalted in this configuration, fast to compute, and trivially reversible using rainbow tables. An attacker who obtains the `oauth_access_token` or user table can recover plaintext passwords for all users.
**Evidence:**
```xml
<authentication-provider user-service-ref="userDetailsService">
    <password-encoder hash="md5"/>
</authentication-provider>
```

---

**B06-5** — HIGH
**Section:** 2 — Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:113`
**Description:** The OAuth2 client `987654321` has `access-token-validity="0"`. In Spring Security OAuth2 1.x, a validity of `0` or less disables token expiry. Any access token issued to this client never expires, meaning a compromised or leaked token remains permanently valid.
**Evidence:**
```xml
<oauth:client client-id="987654321"
              authorized-grant-types="password,authorization_code,implicit"
              secret="8752361E593A573E86CA558FFD39E"
              authorities="ROLE_CLIENT"
              scope="read,write"
              access-token-validity="0"/>
```

---

**B06-6** — HIGH
**Section:** 2 — Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:13-14`
**Description:** Two OAuth approval endpoints are configured with `security="none"` with the comment "Just for testing..." These endpoints are completely unauthenticated and remain in the production branch. While the practical exploitability depends on the endpoint implementation, shipping test-mode security bypasses to production violates defence-in-depth.
**Evidence:**
```xml
<!-- Just for testing... -->
<http pattern="/oauth/cache_approvals" security="none" ... />
<http pattern="/oauth/uncache_approvals" security="none" ... />
```

---

**B06-7** — HIGH
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/DatabaseController.java:88`
**Description:** The `deleteCompanies` method constructs a SQL statement by string concatenation of a `Long` value. Although the value is currently sourced from a prior database query rather than directly from user input, the use of string concatenation in a `JdbcTemplate.execute()` call is an inherently unsafe pattern. If the data flow changes or if the `Long` value is ever influenced by user input (e.g., through the whitelist query results being manipulated), this becomes a SQL injection point. The correct approach is a parameterised `SimpleJdbcCall`.
**Evidence:**
```java
jdbcTemplate.execute("select delete_company("+ c +")");
```

---

**B06-8** — HIGH
**Section:** 6 — Dependencies
**File:** `pom.xml:99-101`
**Description:** Jackson Databind version `2.6.7` is in use. This version has multiple known critical CVEs for deserialization attacks (including CVE-2017-7525, CVE-2018-5968, CVE-2019-14379, and others) that can result in remote code execution when untrusted JSON is deserialized with polymorphic type handling. Jackson 2.6.x is end of life.
**Evidence:**
```xml
<jackson.databind-version>2.6.7</jackson.databind-version>
...
<artifactId>jackson-databind</artifactId>
<version>${jackson.databind-version}</version>
```

---

**B06-9** — HIGH
**Section:** 6 — Dependencies
**File:** `pom.xml:229-242`
**Description:** Spring Framework `3.2.14.RELEASE`, Spring Security `3.1.1.RELEASE`, and Spring Security OAuth2 `1.0.0.RELEASE` are all end-of-life versions. Spring Security OAuth2 1.0.0 is known to be affected by CVE-2018-15758 (redirect URI bypass leading to authorization code theft). Spring Security 3.1.1 is more than a decade old with numerous unpatched vulnerabilities.
**Evidence:**
```xml
<org.springframework-version>3.2.14.RELEASE</org.springframework-version>
...
<artifactId>spring-security-web</artifactId>
<version>3.1.1.RELEASE</version>
...
<artifactId>spring-security-oauth2</artifactId>
<version>1.0.0.RELEASE</version>
```

---

**B06-10** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/DatabaseCleanupException.java:6-10`
**Description:** `DatabaseCleanupException` is annotated `@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)` without a `reason` attribute. In Spring MVC 3.x, this causes the exception message passed to the constructor to be forwarded to `response.sendError()` and ultimately included in the HTTP error response sent to the client. Any future use of this exception class with a message containing SQL details, table names, or internal schema information would expose those details to callers. The current message `"Unable to properly cleanup database"` is benign, but the pattern creates a standing risk.
**Evidence:**
```java
@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)
public class DatabaseCleanupException extends RuntimeException {
    public DatabaseCleanupException(String message) {
        super(message);
    }
}
```

---

**B06-11** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/DatabaseController.java:66-73`
**Description:** The `companies` list is declared as `null` and is only assigned inside a `try` block. The `catch` block discards the original exception without logging its message or stack trace. If the query fails, `companies` remains `null` and is passed to `deleteCompanies`, which will throw an unhandled `NullPointerException` at `companies.forEach(...)`. Depending on the configured error handler, this NPE may produce a stack trace in the HTTP response or in logs at a level visible in production.
**Evidence:**
```java
List<Long> companies = null;
try {
    companies = jdbcTemplate.query(QUERY_COMPANIES_TO_DELETE, (rs, rowNum) -> rs.getLong(1));
} catch(Exception e) {
    log.error("Unable to retrieve companies to delete");
}
// companies may be null here:
deleteCompanies(jdbcTemplate, pass, errors, companies);
```

---

**B06-12** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/DatabaseController.java:18-60`
**Description:** Real customer email addresses (including named individuals and corporate email addresses) and hardware device MAC addresses are hardcoded as plaintext literals in a production source file. This constitutes PII embedded in the codebase. This data will appear in git history, build logs, IDE search results, code reviews, and any system where the source is accessible. This is a data governance violation and potentially a regulatory concern (PIPEDA/GDPR depending on jurisdiction).
**Evidence (excerpt):**
```java
private static final String QUERY_COMPANIES_TO_DELETE =
    "... c.email in (" +
    "  'foothillsbilly@bellsouth.com'," +
    "  'weedmandustin@gmail.com'," +
    "  'vance@gracelandportable.com'," +
    // ... additional personal email addresses ...
    ") or (u.mac_address in (" +
    "  '88:6B:0F:49:11:65'," +
    // ... additional MAC addresses ...
    "))";
```

---

**B06-13** — MEDIUM
**Section:** 6 — Dependencies
**File:** `pom.xml:199-201`
**Description:** `commons-fileupload 1.3.1` is in use. CVE-2016-3092 affects versions before 1.3.2 and allows a remote attacker to cause a denial of service via a crafted Content-Type header in a multipart upload request.
**Evidence:**
```xml
<artifactId>commons-fileupload</artifactId>
<version>1.3.1</version>
```

---

**B06-14** — MEDIUM
**Section:** 6 — Dependencies
**File:** `pom.xml:86-90`
**Description:** The Splunk JFrog repository URL uses plain HTTP (`http://splunk.jfrog.io/...`). Dependencies fetched over plain HTTP are susceptible to MITM attacks that can substitute malicious JARs during the build process. All Maven repository URLs should use HTTPS.
**Evidence:**
```xml
<repository>
    <id>splunk-artifactory</id>
    <name>Splunk Releases</name>
    <url>http://splunk.jfrog.io/splunk/ext-releases-local</url>
</repository>
```

---

**B06-15** — MEDIUM
**Section:** 1 — Secrets and Configuration / Build and CI
**File:** `environment.prod.properties:1-2`, `environment.uat.properties:1-2`
**Description:** AWS EC2 instance hostname (`ec2-54-86-82-22.compute-1.amazonaws.com`) and AWS RDS endpoint (`forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com`) are committed in plaintext to git in the prod and uat property files. These reveal cloud infrastructure topology and instance addresses, lowering the barrier for targeted attacks against the production environment.
**Evidence:**
```
# environment.prod.properties / environment.uat.properties
imageURL=https://ec2-54-86-82-22.compute-1.amazonaws.com:8443/fleetiq360ws/image/
# pom.xml uat profile
<flyway.url>jdbc:postgresql://forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com:5432/postgres</flyway.url>
<tomcat.url>http://ec2-54-86-82-22.compute-1.amazonaws.com:8080/manager/text</tomcat.url>
```

---

**B06-16** — MEDIUM
**Section:** 7 — Build and CI
**File:** `pom.xml:77`
**Description:** The UAT Tomcat manager URL uses plain HTTP (`http://ec2-54-86-82-22.compute-1.amazonaws.com:8080/manager/text`). WAR deployments to the Tomcat manager over plain HTTP expose the application binary and Tomcat manager credentials to network-level interception.
**Evidence:**
```xml
<!-- uat profile -->
<tomcat.url>http://ec2-54-86-82-22.compute-1.amazonaws.com:8080/manager/text</tomcat.url>
```

---

**B06-17** — LOW
**Section:** 6 — Dependencies
**File:** `pom.xml:130-137`
**Description:** `logback-classic` and `logback-core` version `1.2.3` are in use. CVE-2021-42550 (JNDI injection via logback configuration reload) affects versions before 1.2.9. Exploitability requires the ability to modify logback configuration at runtime (e.g., via a logback JMX interface or configuration socket). The risk is lower if remote configuration reload is not enabled, but the dependency should be updated.
**Evidence:**
```xml
<artifactId>logback-classic</artifactId>
<version>1.2.3</version>
<artifactId>logback-core</artifactId>
<version>1.2.3</version>
```

---

**B06-18** — LOW
**Section:** 2 — Authentication and Authorization
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/DatabaseController.java:62-82`
**Description:** The `/rest/db/cleanup` endpoint has no method-level authorization annotation (`@PreAuthorize`, `@Secured`). Role enforcement is solely through the URL-pattern match in `spring-security.xml`. This is defence-in-depth concern: there is no secondary enforcement if the security XML configuration is misconfigured, if the endpoint path changes, or if the controller is refactored.
**Evidence:**
```java
@RequestMapping(value = "/rest/db/cleanup", method = RequestMethod.POST)
@ResponseStatus(value = HttpStatus.OK)
public void cleanup() {
    // no @PreAuthorize or @Secured annotation
```

---

**B06-19** — LOW
**Section:** 4 — Session and CSRF
**File:** `src/main/webapp/WEB-INF/web.xml`, `src/main/webapp/WEB-INF/spring/appServlet/servlet-context.xml`
**Description:** No HTTP security response headers (`X-Frame-Options`, `X-Content-Type-Options`, `Strict-Transport-Security`) are configured in any reviewed configuration file. The `web.xml` enforces HTTPS at the transport level but does not set HSTS. Spring Security 3.1 does not add these headers automatically without explicit configuration.
**Evidence:** Absence of header configuration in `web.xml` and `servlet-context.xml`. No `<headers>` element in `spring-security.xml`.

---

**B06-20** — INFO
**Section:** 7 — Build and CI
**File:** (repository root)
**Description:** No `bitbucket-pipelines.yml` is present in the repository. There is no CI/CD pipeline configuration to review. It cannot be determined whether production deployments are automated, whether tests are run before deployment, or whether secrets are injected via pipeline variables rather than committed files. The absence of a pipeline means deployment is likely manual and ad-hoc.
**Evidence:** No `bitbucket-pipelines.yml` found in repository root or any subdirectory.

---

## Summary Table

| ID | Severity | Section | Short Description |
|---|---|---|---|
| B06-1 | CRITICAL | 1 — Secrets | Cognito credentials committed to git in all env files |
| B06-2 | CRITICAL | 1 — Secrets | Database credentials in pom.xml profiles committed to git |
| B06-3 | CRITICAL | 1 — Secrets | OAuth2 client secrets hardcoded in spring-security.xml |
| B06-4 | HIGH | 2 — Auth | MD5 used as password hashing algorithm (unsalted) |
| B06-5 | HIGH | 2 — Auth | OAuth2 client token validity = 0 (tokens never expire) |
| B06-6 | HIGH | 2 — Auth | Test OAuth endpoints with security="none" in production branch |
| B06-7 | HIGH | 3 — Injection | SQL string concatenation in deleteCompanies (Long c) |
| B06-8 | HIGH | 6 — Dependencies | Jackson Databind 2.6.7 — multiple RCE CVEs |
| B06-9 | HIGH | 6 — Dependencies | Spring 3.2.14 / Spring Security 3.1.1 / OAuth2 1.0.0 — EOL |
| B06-10 | MEDIUM | 5 — Data Exposure | DatabaseCleanupException message forwarded to HTTP response |
| B06-11 | MEDIUM | 5 — Data Exposure | Null companies list causes NPE, potential stack trace exposure |
| B06-12 | MEDIUM | 5 — Data Exposure | Customer PII (email, MAC addresses) hardcoded in source |
| B06-13 | MEDIUM | 6 — Dependencies | commons-fileupload 1.3.1 — CVE-2016-3092 DoS |
| B06-14 | MEDIUM | 6 — Dependencies | Maven repository URL uses plain HTTP (MITM risk) |
| B06-15 | MEDIUM | 1 — Secrets | AWS EC2 and RDS hostnames committed to git |
| B06-16 | MEDIUM | 7 — Build/CI | Tomcat manager deployment over plain HTTP |
| B06-17 | LOW | 6 — Dependencies | logback 1.2.3 — CVE-2021-42550 JNDI injection |
| B06-18 | LOW | 2 — Auth | No method-level @PreAuthorize on cleanup endpoint |
| B06-19 | LOW | 4 — CSRF/Session | No HTTP security headers configured |
| B06-20 | INFO | 7 — Build/CI | No bitbucket-pipelines.yml present |
