# Pass 1 Security Review — Agent B11
**Repo:** forkliftiqws
**Branch:** master
**Date:** 2026-02-27
**Auditor:** B11
**Files assigned:**
- `src/main/java/com/journaldev/spring/jdbc/model/APIConnections.java`
- `src/main/java/com/journaldev/spring/jdbc/model/Answers.java`
- `src/main/java/com/journaldev/spring/jdbc/model/AuthenticationRequest.java`

---

## Reading Evidence

### 1. `com.journaldev.spring.jdbc.model.APIConnections`

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.APIConnections`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:** none

**Fields:**

| Access    | Type   | Name               |
|-----------|--------|--------------------|
| private   | long   | serialVersionUID (static final) |
| private   | int    | IDAPIConnection    |
| private   | String | APIConnectionKey   |

**Public methods:**

| Line | Return Type | Method Signature |
|------|-------------|-----------------|
| 18   | int         | `getIDAPIConnection()` |
| 21   | void        | `setIDAPIConnection(int iDAPIConnection)` |
| 24   | String      | `getAPIConnectionKey()` |
| 27   | void        | `setAPIConnectionKey(String aPIConnectionKey)` |

**Method-level annotations:** none on any method

---

### 2. `com.journaldev.spring.jdbc.model.Answers`

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.Answers`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:** none

**Fields:**

| Access  | Type   | Name             |
|---------|--------|------------------|
| private | long   | serialVersionUID (static final) |
| private | int    | id               |
| private | String | answer           |
| private | int    | question_id      |

**Public methods:**

| Line | Return Type | Method Signature |
|------|-------------|-----------------|
| 16   | int         | `getId()` |
| 19   | void        | `setId(int id)` |
| 22   | String      | `getAnswer()` |
| 25   | void        | `setAnswer(String answer)` |
| 29   | int         | `getQuestion_id()` |
| 32   | void        | `setQuestion_id(int question_id)` |

**Method-level annotations:** none on any method

---

### 3. `com.journaldev.spring.jdbc.model.AuthenticationRequest`

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.AuthenticationRequest`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:**
- `@Data` (Lombok — generates `equals()`, `hashCode()`, `toString()`, and all getters/setters)
- `@NoArgsConstructor` (Lombok — generates public no-arg constructor)

**Fields:**

| Access  | Type   | Name          |
|---------|--------|---------------|
| private | long   | serialVersionUID (static final) |
| private | String | username      |
| private | String | password      |
| private | String | newPassword   |
| private | String | accessToken   |

**Public methods (generated by Lombok `@Data`):**

| Generated | Return Type | Method |
|-----------|-------------|--------|
| getter    | String      | `getUsername()` |
| setter    | void        | `setUsername(String)` |
| getter    | String      | `getPassword()` |
| setter    | void        | `setPassword(String)` |
| getter    | String      | `getNewPassword()` |
| setter    | void        | `setNewPassword(String)` |
| getter    | String      | `getAccessToken()` |
| setter    | void        | `setAccessToken(String)` |
| generated | String      | `toString()` — includes ALL fields |
| generated | boolean     | `equals(Object)` |
| generated | int         | `hashCode()` |

**Explicit methods:**

| Line | Access  | Return Type | Method Signature |
|------|---------|-------------|-----------------|
| 23   | private | constructor | `AuthenticationRequest(String username, String password, String newPassword, String accessToken)` annotated `@Builder` |

**Method-level annotations:**
- `@Builder` on the private all-args constructor (line 22)

---

## Checklist Review

### Section 1 — Secrets and Configuration

**APIConnections.java:** No hardcoded credentials, connection strings, or API keys in source. The field `APIConnectionKey` is a data model field populated at runtime, not a hardcoded secret. CLEAR.

**Answers.java:** No secrets or configuration. CLEAR.

**AuthenticationRequest.java:** No hardcoded credentials. CLEAR.

---

### Section 2 — Authentication and Authorization

These are model/DTO classes; they do not define endpoints, filter chains, or access control rules. N/A.

---

### Section 3 — Input Validation and Injection

**APIConnections.java:** No validation annotations (`@NotNull`, `@Size`, `@Pattern`) on any field. If this model is used as a `@RequestBody`, the `APIConnectionKey` field (which appears to carry an API credential/key value) accepts any string of arbitrary length and content with no constraints. FINDING — see B11-1.

**Answers.java:** No validation annotations on any field. The `answer` field (String) and `question_id` (int) are unconstrained. If used as `@RequestBody` input without a wrapping `@Valid`, any value is accepted. FINDING — see B11-2.

**AuthenticationRequest.java:** No validation annotations (`@NotNull`, `@Size`, `@Pattern`) on `username`, `password`, `newPassword`, or `accessToken`. If bound as `@RequestBody`, empty strings and null values will not be rejected by the framework at the DTO layer. FINDING — see B11-3.

No `@JsonTypeInfo` with default typing, no `ObjectInputStream` usage, no polymorphic deserialization config in any of the three files. Deserialization risk: CLEAR.

---

### Section 4 — Session and CSRF

These are model/DTO classes; they do not configure CSRF, CORS, or headers. N/A.

---

### Section 5 — Data Exposure

**APIConnections.java:**

The field `APIConnectionKey` (line 16) represents an API connection credential/key. It is exposed via a public getter `getAPIConnectionKey()` (line 24) with no `@JsonIgnore` annotation. If an `APIConnections` instance is serialized into a JSON response body (e.g., in a list of connections returned to the client), the key value will be included in the response payload. API keys should not be returned to clients after initial provisioning. FINDING — see B11-4.

**Answers.java:** No sensitive fields. CLEAR.

**AuthenticationRequest.java:**

The Lombok `@Data` annotation (line 9) automatically generates a `toString()` method that includes ALL fields: `username`, `password`, `newPassword`, and `accessToken`. If any framework component (Spring MVC exception handler, a logging interceptor, or application code) calls `toString()` on this object — or if it is logged as part of request binding — the plaintext password and access token will appear in logs. None of the sensitive fields (`password`, `newPassword`, `accessToken`) are annotated with `@JsonIgnore` to suppress serialization, nor is there a custom `toString()` override that redacts them. FINDING — see B11-5 and B11-6.

---

### Section 6 — Dependencies

N/A for model/DTO source files. Dependency review is performed against `pom.xml`.

---

### Section 7 — Build and CI

N/A for model/DTO source files.

---

## Findings

---

**B11-1** — LOW
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/APIConnections.java:16`
**Description:** No Bean Validation constraints on `APIConnectionKey`. If this class is used as a deserialized `@RequestBody`, the field accepts null and unbounded-length strings. An attacker can submit oversized or null values that may cause downstream errors or unexpected behaviour.
**Evidence:**
```java
private String APIConnectionKey;
```
No `@NotNull`, `@Size`, or `@Pattern` annotation is present on this field.

---

**B11-2** — LOW
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Answers.java:13-14`
**Description:** No Bean Validation constraints on the `answer` or `question_id` fields. If used as a deserialized `@RequestBody`, an attacker can submit null, empty, or arbitrarily large strings for `answer`, and negative or zero values for `question_id`.
**Evidence:**
```java
private String answer;
private int question_id;
```
No `@NotNull`, `@Size`, `@Min`, or `@Pattern` annotation is present on any field.

---

**B11-3** — MEDIUM
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/AuthenticationRequest.java:17-20`
**Description:** No Bean Validation constraints on any field of the authentication DTO. `username`, `password`, `newPassword`, and `accessToken` accept null and arbitrary-length values. Absence of `@NotNull` and `@Size` constraints means the framework will not reject malformed or empty authentication requests at the DTO layer, pushing validation burden entirely onto downstream service code. If downstream code is also absent, null passwords could reach Cognito API calls.
**Evidence:**
```java
private String username;
private String password;
private String newPassword;
private String accessToken;
```
No validation annotations present on any of these fields.

---

**B11-4** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/APIConnections.java:24`
**Description:** `APIConnectionKey` is a credential/API key field with a public getter and no `@JsonIgnore` annotation. If an `APIConnections` object is returned as part of any JSON response, the raw key value will be serialized and transmitted to the client. API keys must not be included in API responses after creation; they should be suppressed with `@JsonIgnore` on `getAPIConnectionKey()` or replaced with a masked representation.
**Evidence:**
```java
private String APIConnectionKey;

public String getAPIConnectionKey() {
    return APIConnectionKey;
}
```
No `@JsonIgnore` is present on the getter or field.

---

**B11-5** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/AuthenticationRequest.java:9`
**Description:** Lombok `@Data` generates a `toString()` method that includes all fields. The class holds `password`, `newPassword`, and `accessToken` in plaintext. Any call to `toString()` — by a logger, an exception handler, a Spring MVC debug interceptor, or even `String.format("%s", request)` — will emit these credentials in cleartext. There is no `@ToString.Exclude` on the sensitive fields and no manual `toString()` override to redact them.
**Evidence:**
```java
@Data
@NoArgsConstructor
public class AuthenticationRequest implements Serializable {
    private String username;
    private String password;
    private String newPassword;
    private String accessToken;
```
Lombok `@Data` at line 9 generates:
```java
// effective generated toString():
public String toString() {
    return "AuthenticationRequest(username=" + this.username
        + ", password=" + this.password
        + ", newPassword=" + this.newPassword
        + ", accessToken=" + this.accessToken + ")";
}
```
No `@ToString.Exclude` or custom override is present.

---

**B11-6** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/AuthenticationRequest.java:17-20`
**Description:** `password`, `newPassword`, and `accessToken` fields have no `@JsonIgnore` annotation. If an `AuthenticationRequest` object is ever serialized into a JSON response (error response, echo endpoint, debug output), these credential fields will be included in the response payload. While this class is primarily an inbound DTO, the absence of `@JsonIgnore` on credential fields is a defence-in-depth gap.
**Evidence:**
```java
private String password;
private String newPassword;
private String accessToken;
```
No `@JsonIgnore` annotation is present on any of these fields or their Lombok-generated getters.

---

## Summary Table

| ID    | Severity | Section | File | Short Description |
|-------|----------|---------|------|-------------------|
| B11-1 | LOW      | 3 — Input Validation | APIConnections.java:16 | No validation constraints on `APIConnectionKey` |
| B11-2 | LOW      | 3 — Input Validation | Answers.java:13-14 | No validation constraints on `answer` / `question_id` |
| B11-3 | MEDIUM   | 3 — Input Validation | AuthenticationRequest.java:17-20 | No validation constraints on auth credential fields |
| B11-4 | MEDIUM   | 5 — Data Exposure | APIConnections.java:24 | `APIConnectionKey` exposed via getter with no `@JsonIgnore` |
| B11-5 | HIGH     | 5 — Data Exposure | AuthenticationRequest.java:9 | Lombok `@Data` generates `toString()` leaking password/token in logs |
| B11-6 | MEDIUM   | 5 — Data Exposure | AuthenticationRequest.java:17-20 | `password`, `newPassword`, `accessToken` not annotated `@JsonIgnore` |
