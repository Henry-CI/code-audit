# Security Audit — Pass 1 (Security Review)
**Agent:** B26
**Date:** 2026-02-27
**Repository:** forkliftiqws
**Branch:** master
**Checklist:** PASS1-CHECKLIST-forkliftiq-spring.md

---

## Reading Evidence

### 1. `com.journaldev.spring.jdbc.service.AbstractFileStorageService`

**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java`

**Class-level annotations:**
- `@Slf4j` (Lombok logging)

**Modifiers / Inheritance:**
- `abstract class AbstractFileStorageService implements FileStorageService`
- Package-private (no `public` modifier on class declaration)

**Fields:**

| Modifier | Type | Name | Source |
|---|---|---|---|
| `protected` | `String` | `uploadDir` | `@Value("${uploadDir}")` |
| `protected` | `String` | `imageDir` | `@Value("${imageDir}")` |
| `private` | `String` | `imagePrefix` | `@Value("${imagePrefix}")` |
| `protected` | `Path` | `imageStorageLocation` | — |
| `protected` | `Path` | `targetLocation` | — |
| `protected` | `String` | `fileName` | — |
| `protected` | `String` | `imageExt` | initialised `".jpg"` |

**Public methods:**

| Return type | Method | Parameters | Line | Annotations |
|---|---|---|---|---|
| `void` | `initialize` | — | 43 | `@PostConstruct` |
| `String` | `saveImage` | `InputStream inputStream` | 53 | `@Override` |

**Interface implemented:** `FileStorageService`

---

### 2. `com.journaldev.spring.jdbc.service.BootstrapService`

**File:** `src/main/java/com/journaldev/spring/jdbc/service/BootstrapService.java`

**Class-level annotations:**
- `@Configuration`

**Fields:**

| Modifier | Type | Name | Source |
|---|---|---|---|
| `private` | `DataSource` | `dataSource` | `@Autowired` |
| `private` | `boolean` | `baseline` | `@Value("${flyway.baseline}")` |
| `private` | `boolean` | `enabled` | `@Value("${flyway.enabled}")` |

**Public methods:**

| Return type | Method | Parameters | Line | Annotations |
|---|---|---|---|---|
| `FlywayBean` | `getFlyway` | — | 28 | `@Bean(initMethod = "migrate")` |

**Inner class `FlywayBean`:**

| Return type | Method | Parameters | Line |
|---|---|---|---|
| — | `FlywayBean()` | — | 44 |
| — | `FlywayBean(Flyway flyway)` | `Flyway flyway` | 47 |
| `int` | `migrate` | — | 51 |

**No interface implemented. No class extended.**

---

### 3. `com.journaldev.spring.jdbc.service.CognitoService`

**File:** `src/main/java/com/journaldev/spring/jdbc/service/CognitoService.java`

**Class-level annotations:**
- `@Service`
- `@Slf4j` (Lombok logging)

**Fields:**

| Modifier | Type | Name | Source |
|---|---|---|---|
| `private` | `Configuration` | `configuration` | `@Autowired` |

**Public methods:**

| Return type | Method | Parameters | Line |
|---|---|---|---|
| `UserResponse` | `getUser` | `String username` | 30 |
| `AuthenticationResponse` | `authenticationRequest` | — | 69 |

**No interface implemented. No class extended.**

**Supporting class read — `com.journaldev.spring.jdbc.util.Configuration`:**

Fields (all `@Value`-injected, exposed via Lombok `@Getter`):
`userSetupMsg`, `userSetupSubject`, `passResetSubject`, `imageURL`, `systemImageURL`, `acceptURL`, `driverRequestSubject`, `cognitoAPIPort`, `cognitoAPIUsername`, `cognitoAPIPassword`

**Supporting class read — `com.journaldev.spring.jdbc.util.Util`:**

Contains `generateRadomName()` (UUID+timestamp) and `sendMail()`. `sendMail()` at line 66 contains hardcoded AWS SES SMTP credentials (see B26-1).

---

## Section-by-Section Findings

---

### Section 1 — Secrets and Configuration

**B26-1** — CRITICAL
**Section:** 1. Secrets and Configuration
**File:** `src/main/java/com/journaldev/spring/jdbc/util/Util.java:66`
**Description:** AWS SES SMTP credentials hardcoded in source. The SMTP username `AKIA**REDACTED**` is an AWS IAM access key ID, and the value `****REDACTED****` is the corresponding secret key, both committed to the repository in plain text. Any person with read access to the repository can authenticate to SES and send arbitrary email as the application's identity, or potentially enumerate other IAM permissions attached to this key.
**Evidence:**
```java
return new PasswordAuthentication("AKIA**REDACTED**", "****REDACTED****");
```

---

**B26-2** — HIGH
**Section:** 1. Secrets and Configuration
**File:** `environment.dev.properties:15-16`, `environment.prod.properties:15-16`, `environment.uat.properties:15-16`
**Description:** The Cognito API service account credentials (`cognitoAPIUsername` and `cognitoAPIPassword`) are hardcoded with identical values (`ciiadmin` / `ciiadmin`) across all three environment property files, all of which are tracked in git. These credentials are used at runtime by `CognitoService.authenticationRequest()` to authenticate to the internal Cognito proxy service. The value `ciiadmin` for both username and password is a trivially guessable, weak credential and represents a default/shared secret committed to the repository.
**Evidence:**
```
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```
(present verbatim in `environment.dev.properties`, `environment.prod.properties`, and `environment.uat.properties`)

---

**B26-3** — HIGH
**Section:** 1. Secrets and Configuration
**File:** `pom.xml:76-78`
**Description:** Production (UAT) database credentials are hardcoded in `pom.xml` in the `<uat>` Maven build profile. The RDS PostgreSQL connection string, username (`dev_admin`), and password (`C!1admin`) for the AWS RDS instance `forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com` are committed to the repository. The `uat` profile is also marked `<activeByDefault>true</activeByDefault>`, meaning these are the defaults for any developer who builds without specifying a profile.
**Evidence:**
```xml
<flyway.url>jdbc:postgresql://forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com:5432/postgres
</flyway.url>
<flyway.user>dev_admin</flyway.user>
<flyway.password>C!1admin</flyway.password>
```

---

**B26-4** — HIGH
**Section:** 1. Secrets and Configuration
**File:** `pom.xml:29-32`
**Description:** Local and dev database credentials are hardcoded in `pom.xml` build profiles. The `<local>` profile contains two sets of Flyway credentials committed in plain text, including a database password `gmtp-postgres` and `fleetiq360`/`fleetiq360` credentials for a PostgreSQL instance.
**Evidence:**
```xml
<flyway.password>gmtp-postgres</flyway.password>
...
<flyway.user>fleetiq360</flyway.user>
<flyway.password>fleetiq360</flyway.password>
```

---

**B26-5** — HIGH
**Section:** 1. Secrets and Configuration
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:113-117`
**Description:** OAuth2 client secrets are hardcoded in `spring-security.xml`, which is committed to the repository. Two OAuth2 clients are defined with their secrets in plain text: client `987654321` with secret `8752361E593A573E86CA558FFD39E`, and client `fleetiq360` with secret `rihah8eey4faibuengaixo6leiL1awii`. Any holder of these secrets can obtain OAuth2 tokens directly without user credentials, using the `client_credentials` or `password` grant types. The token `access-token-validity="0"` on client `987654321` means that token never expires.
**Evidence:**
```xml
<oauth:client client-id="987654321" authorized-grant-types="password,authorization_code,implicit"
              secret="8752361E593A573E86CA558FFD39E" authorities="ROLE_CLIENT" scope="read,write" access-token-validity="0"/>

<oauth:client client-id="fleetiq360" authorized-grant-types="password,authorization_code,refresh_token,implicit"
              secret="rihah8eey4faibuengaixo6leiL1awii" authorities="ROLE_DRIVER,ROLE_COMPANY_GROUP,ROLE_SYS_ADMIN" scope="read,write" access-token-validity="300" refresh-token-validity="300"/>
```

---

**B26-6** — MEDIUM
**Section:** 1. Secrets and Configuration
**File:** `.gitignore:6`
**Description:** The `.gitignore` only excludes `environment.local.properties`. The files `environment.dev.properties`, `environment.prod.properties`, and `environment.uat.properties` are tracked by git (confirmed via `git ls-files`). These files contain service account credentials (see B26-2). All environment-specific property files containing credentials should be gitignored and injected at deployment time.
**Evidence:**
```
# .gitignore contains only:
environment.local.properties
```
```
# git ls-files output includes:
environment.dev.properties
environment.prod.properties
environment.uat.properties
```

---

**B26-7** — MEDIUM
**Section:** 1. Secrets and Configuration
**File:** `pom.xml:44`
**Description:** The dev Azure database URL `jdbc:postgresql://forklift360.canadaeast.cloudapp.azure.com:5432/fleetiq360` is hardcoded in `pom.xml`. While the dev profile password `fleetiq360` is less sensitive than the UAT credentials, committing any infrastructure hostname and database name in source reveals topology. Additionally, the Azure Canada East hostname confirms the Azure infrastructure layout described in the audit context.
**Evidence:**
```xml
<flyway.url>jdbc:postgresql://forklift360.canadaeast.cloudapp.azure.com:5432/fleetiq360</flyway.url>
```

---

**B26-8** — LOW
**Section:** 1. Secrets and Configuration
**File:** `pom.xml:84-89`
**Description:** The Splunk artifact repository is referenced over plain HTTP (`http://splunk.jfrog.io/splunk/ext-releases-local`), not HTTPS. Dependencies fetched over HTTP are susceptible to man-in-the-middle substitution attacks (dependency confusion / poisoning). Maven does not verify artifact integrity when fetching over plain HTTP in older configurations.
**Evidence:**
```xml
<repository>
    <id>splunk-artifactory</id>
    <name>Splunk Releases</name>
    <url>http://splunk.jfrog.io/splunk/ext-releases-local</url>
</repository>
```

---

### Section 2 — Authentication and Authorization

**B26-9** — CRITICAL
**Section:** 2. Authentication and Authorization
**File:** `src/main/java/com/journaldev/spring/jdbc/service/CognitoService.java:30-106`
**Description:** `CognitoService` performs no JWT validation whatsoever. Despite the service being named `CognitoService` and described in the audit context as the "core authentication service", the class does not parse, verify, or validate any JWT token. It only makes HTTP calls to an internal Cognito proxy on `localhost:${cognitoAPIPort}` to obtain and forward tokens. There is no JWKS endpoint fetch, no signature verification, no issuer claim check, no audience claim check, and no expiry check performed in this class. The actual token validation is delegated to whatever the internal proxy does, and this delegation is entirely opaque. If the proxy is unavailable, `authenticationRequest()` silently returns an empty `AuthenticationResponse` object (no exception is re-thrown), potentially allowing the application to proceed with a null/empty access token.
**Evidence:**
```java
public AuthenticationResponse authenticationRequest() {
    AuthenticationRequest authenticationRequest = AuthenticationRequest.builder()
              .username(configuration.getCognitoAPIUsername())
              .password(configuration.getCognitoAPIPassword())
              .build();
    ...
    } catch(Exception e) {
        e.printStackTrace();
        log.error(method +"error:"+ e.getMessage());
    }
    return response; // returns empty AuthenticationResponse on failure
}
```

---

**B26-10** — CRITICAL
**Section:** 2. Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:113`
**Description:** OAuth2 client `987654321` is configured with `access-token-validity="0"`. In Spring Security OAuth2, a value of `0` means the access token **never expires**. Any token issued to this client is permanently valid and cannot be revoked through expiry. Combined with the client secret being committed to the repository (B26-5), an attacker who obtained a token (or the secret to mint one) would have permanent, irrevocable access until the token is manually invalidated in the token store.
**Evidence:**
```xml
<oauth:client client-id="987654321" authorized-grant-types="password,authorization_code,implicit"
              secret="8752361E593A573E86CA558FFD39E" authorities="ROLE_CLIENT" scope="read,write" access-token-validity="0"/>
```

---

**B26-11** — HIGH
**Section:** 2. Authentication and Authorization
**File:** `src/main/java/com/journaldev/spring/jdbc/service/CognitoService.java:48`
**Description:** The internal call from `getUser()` to the Cognito proxy appends the `username` parameter directly into the URL string using string concatenation with no sanitisation. If `username` contains special characters such as `&`, `=`, `?`, or encoded sequences, the constructed URL could include additional query parameters, redirect to a different path, or cause unexpected behaviour in the Cognito proxy. This is an HTTP request parameter injection risk on the internal service call.
**Evidence:**
```java
String baseUrl = "http://localhost:"+configuration.getCognitoAPIPort()+"/auth/user?username="+username+"&accessToken="+accessToken;
```

---

**B26-12** — HIGH
**Section:** 2. Authentication and Authorization
**File:** `src/main/java/com/journaldev/spring/jdbc/service/CognitoService.java:48,89`
**Description:** All calls from `CognitoService` to the internal Cognito proxy use plain HTTP (`http://localhost:...`). While `localhost` reduces network interception risk, credentials (username and password in `authenticationRequest()`) and access tokens (in `getUser()`) are transmitted in cleartext over this channel. If the proxy is on a different host, or if loopback traffic is intercepted by a local process (e.g. via a compromised dependency or sidecar), credentials and tokens would be exposed in plaintext.
**Evidence:**
```java
// getUser, line 48:
String baseUrl = "http://localhost:"+configuration.getCognitoAPIPort()+"/auth/user?username="+username+"&accessToken="+accessToken;

// authenticationRequest, line 89:
ResponseEntity<AuthenticationResponse> result = restTemplate.exchange(
    "http://localhost:"+configuration.getCognitoAPIPort()+"/auth", HttpMethod.POST, entity, AuthenticationResponse.class);
```

---

**B26-13** — HIGH
**Section:** 2. Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:74`
**Description:** The `authenticationManager` uses MD5 as the password hashing algorithm (`<password-encoder hash="md5"/>`). MD5 is a cryptographically broken hash function. It is not a password hash (it has no salting, no stretching, and is trivially reversible via rainbow tables). Any password hash stored in the database is practically equivalent to a plaintext password. This applies to the `userDetailsService` used for the application's own credential store.
**Evidence:**
```xml
<authentication-provider user-service-ref="userDetailsService">
    <password-encoder hash="md5"/>
</authentication-provider>
```

---

**B26-14** — HIGH
**Section:** 2. Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:13-14`
**Description:** Two OAuth endpoints are explicitly unprotected with `security="none"`: `/oauth/cache_approvals` and `/oauth/uncache_approvals`. The inline comment reads "Just for testing..." confirming these were added for development/testing and should not be present in production. Exposing approval cache management endpoints without authentication could allow an attacker to manipulate OAuth approval state.
**Evidence:**
```xml
<!-- Just for testing... -->
<http pattern="/oauth/cache_approvals" security="none" xmlns="http://www.springframework.org/schema/security" />
<http pattern="/oauth/uncache_approvals" security="none" xmlns="http://www.springframework.org/schema/security" />
```

---

**B26-15** — MEDIUM
**Section:** 2. Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:300`
**Description:** The Spring Security OAuth2 token store uses `JdbcTokenStore`, which persists tokens in the database. No token cleanup or token TTL enforcement at the store level is visible. Combined with the non-expiring client (B26-10), tokens may accumulate indefinitely. `refresh-token-validity="300"` for the `fleetiq360` client is only 5 minutes, which is unusually short and may cause UX issues, but the access token expiry of 300 seconds (5 minutes) for that client is reasonable.
**Evidence:**
```xml
<bean id="tokenStore" class="org.springframework.security.oauth2.provider.token.JdbcTokenStore">
    <constructor-arg ref="dataSource"/>
</bean>
```

---

### Section 3 — Input Validation and Injection

**B26-16** — MEDIUM
**Section:** 3. Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java:55-58`
**Description:** MIME type detection for uploaded files relies solely on `URLConnection.guessContentTypeFromStream()`, which reads only the first few bytes of the stream. If detection fails (throws `MimeTypeException` or `IOException`), the code silently falls back to `.jpg`. This means a malicious file upload that deliberately confuses the content-type detection (e.g. a polyglot file that starts with JPEG magic bytes but is actually a script or executable) will be stored with `.jpg` extension. There is no content-type allow-list validation (e.g. rejecting files whose detected type is not an image type). Tika is imported but only used for extension lookup, not deep content analysis.
**Evidence:**
```java
String contentType = URLConnection.guessContentTypeFromStream(inputStream);
MimeType imageType = MimeTypes.getDefaultMimeTypes().forName(contentType);
imageExt = imageType.getExtension();
...
} catch (MimeTypeException | IOException e) {
    log.warn("Unable to determine image file extension from image stream, use default .jpg extension");
}
```

---

**B26-17** — LOW
**Section:** 3. Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java:65-67`
**Description:** Path traversal risk is low but not zero. The `fileName` is constructed from a server-generated prefix (`imagePrefix`) and a UUID+timestamp value (`Util.generateRadomName()`), so a client cannot directly control the filename. However, the file extension is derived from user-supplied content (`imageExt`), which is taken from Tika's `MimeType.getExtension()` output after detecting the stream content type. If Tika returns an extension containing path separators (e.g. from a crafted MIME type), this could theoretically affect the resolved path. The use of `imageStorageLocation.resolve(fileName)` without a subsequent `normalize()` + `startsWith()` check means no explicit traversal guard is present.
**Evidence:**
```java
this.fileName = this.imagePrefix + Util.generateRadomName() + this.imageExt;
targetLocation = this.imageStorageLocation.resolve(fileName);
Files.copy(inputStream, targetLocation, StandardCopyOption.REPLACE_EXISTING);
```

---

**B26-18** — LOW
**Section:** 3. Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/service/AbstractFileStorageService.java:72`
**Description:** The exception message in the `FileStorageException` thrown from `saveImage()` includes the server-generated `fileName` value. This is not directly user-controlled (it is a UUID), but the concatenated string is returned/thrown and may propagate to the HTTP response depending on how the exception handler is configured. This is a minor information disclosure.
**Evidence:**
```java
throw new FileStorageException("Could not store file " + fileName + ". Please try again!", ex);
```

---

### Section 4 — Session and CSRF

**B26-19** — INFO
**Section:** 4. Session and CSRF
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:28`
**Description:** The `/rest/**` security block uses `create-session="never"`, which is appropriate for a stateless REST API using OAuth2 bearer tokens. CSRF is not a concern for stateless token-authenticated REST APIs, so the absence of explicit CSRF configuration here is not a finding.
**Evidence:**
```xml
<http pattern="/rest/**" create-session="never" ...>
```

---

**B26-20** — INFO
**Section:** 4. Session and CSRF
**File:** `src/main/webapp/WEB-INF/web.xml:38-46`
**Description:** Transport security (`CONFIDENTIAL`) is enforced at the servlet container level via a `<security-constraint>` with `<transport-guarantee>CONFIDENTIAL</transport-guarantee>` covering `/*`. This ensures all traffic is redirected to HTTPS by the container. However, there is no evidence of `Strict-Transport-Security`, `X-Frame-Options`, `X-Content-Type-Options`, or `Content-Security-Policy` headers being configured in the Spring layer or web.xml.
**Evidence:**
```xml
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Rest Application</web-resource-name>
        <url-pattern>/*</url-pattern>
    </web-resource-collection>
    <user-data-constraint>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>
</security-constraint>
```

---

### Section 5 — Data Exposure

**B26-21** — MEDIUM
**Section:** 5. Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/service/CognitoService.java:62,102`
**Description:** `CognitoService` uses `e.printStackTrace()` in both catch blocks. `printStackTrace()` writes to `System.err`, not the logging framework. In a production Tomcat deployment, `System.err` output may appear in the Tomcat `catalina.out` log and may include stack traces containing internal class names, hostnames, port numbers, and request details. This is a data exposure and operational security issue. The subsequent `log.error()` call only logs `e.getMessage()`, not the full trace — but `printStackTrace()` still fires unconditionally.
**Evidence:**
```java
} catch(Exception e) {
    e.printStackTrace();
    log.error(method+" error:"+ e.getMessage());
}
```
(same pattern at lines 60-64 and lines 99-103)

---

**B26-22** — MEDIUM
**Section:** 5. Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/service/BootstrapService.java:55`
**Description:** `BootstrapService.FlywayBean.migrate()` uses `System.out.println()` to emit a message when Flyway is disabled. `System.out.println` is not controlled by the logging framework; it bypasses log level configuration, log format, and log routing. In a containerised or cloud deployment, this output goes to the container's stdout and is not subject to filtering. While this specific message contains no sensitive data, the pattern establishes a precedent for bypassing the logging framework in this class.
**Evidence:**
```java
System.out.println("Flyway is disabled, database migration ignored...");
```

---

**B26-23** — LOW
**Section:** 5. Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/util/Util.java:81`
**Description:** The `sendMail()` method outputs SMTP exception details directly to `System.out` without using the logging framework: `System.out.println("Message Recipents Exception :" + e)`. The exception `e` is printed with its full `toString()` representation, which may include internal state. The method also silently swallows the `Transport.send()` exception at line 112-114 (`e.printStackTrace()` only), meaning mail delivery failures are not propagated to callers.
**Evidence:**
```java
} catch (Exception e) {
    System.out.println("Message Recipents Exception :" + e);
}
...
} catch (Exception e) {
    e.printStackTrace();
}
```

---

### Section 6 — Dependencies

**B26-24** — CRITICAL
**Section:** 6. Dependencies
**File:** `pom.xml:13`
**Description:** Spring Framework version `3.2.14.RELEASE` is severely end-of-life (EOL since December 2016). This version predates Spring 4, Spring 5, and Spring 6, and has numerous known CVEs including remote code execution vulnerabilities. Spring Security version `3.1.1.RELEASE` (pom.xml lines 231-237) is similarly EOL and predates all modern security hardening. The Spring Security OAuth2 version `1.0.0.RELEASE` (line 242) is the earliest release of that library.
**Evidence:**
```xml
<org.springframework-version>3.2.14.RELEASE</org.springframework-version>
...
<spring-security-web version="3.1.1.RELEASE">
<spring-security-config version="3.1.1.RELEASE">
<spring-security-oauth2 version="1.0.0.RELEASE">
```

---

**B26-25** — HIGH
**Section:** 6. Dependencies
**File:** `pom.xml:99-101`
**Description:** Jackson Databind version `2.6.7` is used. This version has multiple known critical deserialization CVEs (e.g. CVE-2017-7525, CVE-2019-14379, CVE-2019-14439, and others). Versions in the `2.6.x` series were end-of-life as of 2018. Deserialization gadget chains are possible if polymorphic typing is enabled (not confirmed in these three files, but the version alone is a high-severity finding).
**Evidence:**
```xml
<jackson.databind-version>2.6.7</jackson.databind-version>
...
<artifactId>jackson-databind</artifactId>
<version>${jackson.databind-version}</version>
```

---

**B26-26** — HIGH
**Section:** 6. Dependencies
**File:** `pom.xml:199-201`
**Description:** `commons-fileupload` version `1.3.1` is used. This version is affected by CVE-2016-3092 (Denial of Service via malicious multipart requests). This library handles file uploads from clients in a web application handling forklift management data, making this an exploitable attack surface. The vulnerability allows an attacker to trigger excessive resource consumption by sending a crafted multipart request.
**Evidence:**
```xml
<artifactId>commons-fileupload</artifactId>
<version>1.3.1</version>
```

---

**B26-27** — HIGH
**Section:** 6. Dependencies
**File:** `pom.xml:168-170`
**Description:** `commons-io` is declared as `org.apache.commons:commons-io:1.3.2`, which is not a valid Apache Commons IO artifact ID (the correct groupId is `commons-io:commons-io` or `org.apache.commons:commons-io` from version 2.x onwards). Version `1.3.2` of `org.apache.commons:commons-io` resolves to an extremely old, potentially unmaintained artefact. This dependency should be verified as correctly resolving from Maven Central.
**Evidence:**
```xml
<groupId>org.apache.commons</groupId>
<artifactId>commons-io</artifactId>
<version>1.3.2</version>
```

---

**B26-28** — MEDIUM
**Section:** 6. Dependencies
**File:** `pom.xml:246-248`
**Description:** `braintree-java` version `2.53.0` is a payment gateway library. This is a very old version (current major version is 3.x). Braintree SDKs have received security updates over time. Any CVEs in the Braintree SDK could expose payment processing to attack. The presence of a payment library in a forklift management system warrants scrutiny to confirm it is actually required.
**Evidence:**
```xml
<groupId>com.braintreepayments.gateway</groupId>
<artifactId>braintree-java</artifactId>
<version>2.53.0</version>
```

---

**B26-29** — MEDIUM
**Section:** 6. Dependencies
**File:** `pom.xml:334-337`
**Description:** The Flyway Maven plugin uses a PostgreSQL JDBC driver version `9.1-901.jdbc3`, which is the JDBC3 driver for PostgreSQL 9.1. This is a very old driver (PostgreSQL 9.1 EOL was 2016) and may have known vulnerabilities. The UAT database (`forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com`) is likely running a much newer PostgreSQL version, meaning the client and server versions are mismatched.
**Evidence:**
```xml
<groupId>postgresql</groupId>
<artifactId>postgresql</artifactId>
<version>9.1-901.jdbc3</version>
```

---

### Section 7 — Build and CI

**B26-30** — INFO
**Section:** 7. Build and CI
**File:** `pom.xml` (no `bitbucket-pipelines.yml` found)
**Description:** No `bitbucket-pipelines.yml` was found in the repository. It is not possible to verify whether tests are skipped in the deployment pipeline, whether secrets are injected via pipeline variables, or whether the pipeline deploys to production. This is an observation; the absence of the file may mean pipelines are configured in the Bitbucket UI or have not been committed.
**Evidence:** `git ls-files` output contains no `bitbucket-pipelines.yml`.

---

**B26-31** — LOW
**Section:** 7. Build and CI
**File:** `pom.xml:68-82`
**Description:** The `<uat>` Maven profile is configured with `<activeByDefault>true</activeByDefault>`. This means any developer running `mvn` without specifying `-P` will use the UAT profile, which includes credentials for the production-equivalent RDS instance (B26-3). A developer running `mvn flyway:migrate` without an explicit profile would run migrations against the UAT/production database.
**Evidence:**
```xml
<profile>
    <id>uat</id>
    <activation>
        <activeByDefault>true</activeByDefault>
    </activation>
```

---

## Summary Table

| ID | Severity | Section | Short Description |
|---|---|---|---|
| B26-1 | CRITICAL | 1. Secrets | AWS SES IAM key and secret hardcoded in Util.java |
| B26-2 | HIGH | 1. Secrets | Cognito API service account credentials committed to git (all envs) |
| B26-3 | HIGH | 1. Secrets | UAT/prod RDS credentials hardcoded in pom.xml |
| B26-4 | HIGH | 1. Secrets | Dev/local DB credentials hardcoded in pom.xml |
| B26-5 | HIGH | 1. Secrets | OAuth2 client secrets hardcoded in spring-security.xml |
| B26-6 | MEDIUM | 1. Secrets | environment.*.properties files not gitignored |
| B26-7 | MEDIUM | 1. Secrets | Azure infrastructure hostname committed to pom.xml |
| B26-8 | LOW | 1. Secrets | Maven dependency repo uses plain HTTP (not HTTPS) |
| B26-9 | CRITICAL | 2. Auth | CognitoService performs no JWT validation |
| B26-10 | CRITICAL | 2. Auth | OAuth2 client 987654321 has non-expiring access tokens |
| B26-11 | HIGH | 2. Auth | Username injected into internal HTTP URL without encoding |
| B26-12 | HIGH | 2. Auth | Credentials/tokens sent over plain HTTP to internal proxy |
| B26-13 | HIGH | 2. Auth | MD5 used as password encoder (cryptographically broken) |
| B26-14 | HIGH | 2. Auth | OAuth approval endpoints unprotected ("Just for testing") |
| B26-15 | MEDIUM | 2. Auth | JdbcTokenStore with no visible cleanup; non-expiring tokens accumulate |
| B26-16 | MEDIUM | 3. Injection | No MIME allow-list; polyglot file upload possible |
| B26-17 | LOW | 3. Injection | No path traversal guard on resolved file path |
| B26-18 | LOW | 3. Injection | FileStorageException message includes server-generated filename |
| B26-19 | INFO | 4. CSRF | Stateless REST sessions — CSRF not applicable |
| B26-20 | INFO | 4. CSRF | Transport guarantee set; security headers not confirmed |
| B26-21 | MEDIUM | 5. Data Exposure | e.printStackTrace() in CognitoService bypasses log framework |
| B26-22 | MEDIUM | 5. Data Exposure | System.out.println in BootstrapService bypasses log framework |
| B26-23 | LOW | 5. Data Exposure | System.out/e.printStackTrace in Util.sendMail |
| B26-24 | CRITICAL | 6. Dependencies | Spring 3.2.14 + Spring Security 3.1.1 — severely EOL |
| B26-25 | HIGH | 6. Dependencies | Jackson Databind 2.6.7 — multiple deserialization CVEs |
| B26-26 | HIGH | 6. Dependencies | commons-fileupload 1.3.1 — CVE-2016-3092 DoS |
| B26-27 | HIGH | 6. Dependencies | commons-io 1.3.2 — incorrect groupId/very old version |
| B26-28 | MEDIUM | 6. Dependencies | braintree-java 2.53.0 — old payment SDK version |
| B26-29 | MEDIUM | 6. Dependencies | PostgreSQL JDBC 9.1-901.jdbc3 — EOL driver |
| B26-30 | INFO | 7. Build/CI | No bitbucket-pipelines.yml found; pipeline cannot be reviewed |
| B26-31 | LOW | 7. Build/CI | UAT profile activeByDefault — developers may target prod DB |

**Totals:** 4 CRITICAL, 9 HIGH, 8 MEDIUM, 5 LOW, 3 INFO
