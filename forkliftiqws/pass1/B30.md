# Security Audit Report — Agent B30
**Date:** 2026-02-27
**Pass:** 1 (Security Review)
**Repo:** forkliftiqws (branch: master)
**Assigned files:**
- `src/main/java/com/journaldev/spring/jdbc/util/Configuration.java`
- `src/main/java/com/journaldev/spring/jdbc/util/DateUtil.java`
- `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java`

**Supporting files read (for context):**
- `src/main/java/com/journaldev/spring/jdbc/controller/RuntimeConfig.java`
- `src/main/java/com/journaldev/spring/jdbc/controller/ReportAPI.java`
- `src/main/java/com/journaldev/spring/jdbc/controller/ResumeController.java` (grep only)
- `environment.dev.properties`
- `environment.prod.properties`
- `environment.uat.properties`
- `src/main/resources/fleetiq360ws.properties`
- `pom.xml`
- `.gitignore`

---

## Reading Evidence

### 1. `com.journaldev.spring.jdbc.util.Configuration`

**Fully qualified class name:** `com.journaldev.spring.jdbc.util.Configuration`

**Interfaces implemented / classes extended:** None

**Annotations on class:**
- `@Component` (line 9)
- `@Getter` (Lombok, line 10)

**Fields:**

| Access    | Type   | Name                | Annotation                        | Line |
|-----------|--------|---------------------|-----------------------------------|------|
| private   | String | userSetupMsg        | `@Value("${userSetupMsg}")`       | 14   |
| private   | String | userSetupSubject    | `@Value("${userSetupSubject}")`   | 17   |
| private   | String | passResetSubject    | `@Value("${passResetSubject}")`   | 20   |
| private   | String | imageURL            | `@Value("${imageURL}")`           | 23   |
| private   | String | systemImageURL      | `@Value("${systemImageURL}")`     | 26   |
| private   | String | acceptURL           | `@Value("${acceptURL}")`          | 29   |
| private   | String | driverRequestSubject| `@Value("${driverRequestSubject}")`| 32  |
| private   | String | cognitoAPIPort      | `@Value("${cognitoAPIPort}")`     | 35   |
| private   | String | cognitoAPIUsername  | `@Value("${cognitoAPIUsername}")` | 38   |
| private   | String | cognitoAPIPassword  | `@Value("${cognitoAPIPassword}")` | 41   |

**Public methods (generated by Lombok `@Getter`):**
All fields produce public getter methods at compile time. No explicit public methods are declared in source. The `@Getter` annotation generates:
- `public String getUserSetupMsg()` — line 14 (generated)
- `public String getUserSetupSubject()` — line 17 (generated)
- `public String getPassResetSubject()` — line 20 (generated)
- `public String getImageURL()` — line 23 (generated)
- `public String getSystemImageURL()` — line 26 (generated)
- `public String getAcceptURL()` — line 29 (generated)
- `public String getDriverRequestSubject()` — line 32 (generated)
- `public String getCognitoAPIPort()` — line 35 (generated)
- `public String getCognitoAPIUsername()` — line 38 (generated)
- `public String getCognitoAPIPassword()` — line 41 (generated)

**Note:** Unused imports `@Element` and `@Root` (from `org.simpleframework.xml`) are present at lines 4–5 but not applied to this class.

---

### 2. `com.journaldev.spring.jdbc.util.DateUtil`

**Fully qualified class name:** `com.journaldev.spring.jdbc.util.DateUtil`

**Interfaces implemented / classes extended:** None

**Annotations on class:** None

**Fields:** None declared at class level

**Methods:**

| Visibility | Return type | Name                    | Parameters                              | Line |
|------------|-------------|-------------------------|-----------------------------------------|------|
| private static | Date    | parseDate               | (String dateString, String dateFormat)  | 11   |
| private static | String  | formatDate              | (Date date, String dateFormat)          | 25   |
| public static  | Date    | parseDateIso            | (String dateString)                     | 35   |
| public static  | Date    | parseDateTimeIso        | (String dateString)                     | 39   |
| public static  | Date    | parseDateTimeWithSlashes| (String oldDateString)                  | 43   |
| public static  | Date    | getStartDate            | (Date date, String frequency)           | 49   |
| public static  | String  | getCurrentDate          | ()                                      | 64   |
| public static  | String  | getYesterdayDateString  | ()                                      | 68   |
| public static  | String  | dateToString            | (Date date)                             | 74   |

**Annotations on methods:** None

**Exceptions thrown:** `parseDateIso`, `parseDateTimeIso`, `parseDateTimeWithSlashes` all declare `throws IllegalArgumentException`. `getStartDate` does not declare a checked exception.

---

### 3. `com.journaldev.spring.jdbc.util.HttpDownloadUtility`

**Fully qualified class name:** `com.journaldev.spring.jdbc.util.HttpDownloadUtility`

**Interfaces implemented / classes extended:** None

**Annotations on class:** None

**Fields:**

| Access           | Type   | Name          | Line |
|------------------|--------|---------------|------|
| private static final | int | BUFFER_SIZE | 18   |
| private static   | String | saveFilePath  | 19   |
| private static   | String | fileName      | 20   |

**Methods:**

| Visibility    | Return type | Name             | Parameters                                      | Line |
|---------------|-------------|------------------|-------------------------------------------------|------|
| public static | void        | downloadFile     | (String fileName, String fileURL, String saveDir)| 29  |
| public static | void        | sendPost         | (String fname, String input, String saveDir)    | 98   |
| public static | String      | getSaveFilePath  | ()                                              | 158  |
| public static | void        | setSaveFilePath  | (String saveFilePath)                           | 162  |
| public static | String      | getFileName      | ()                                              | 167  |
| public static | void        | setFileName      | (String fileName)                               | 172  |

**Annotations on class and methods:** None

**Imports used:**
- `java.net.HttpURLConnection`, `java.net.URL`
- `javax.net.ssl.HttpsURLConnection` (imported but never used)
- `com.journaldev.spring.jdbc.controller.RuntimeConfig`

---

## Checklist Review

### Section 1 — Secrets and Configuration

**`Configuration.java`:**
All credentials are loaded via `@Value` Spring property injection from `fleetiq360ws.properties`, which in turn sources values from environment-specific filter files (`environment.{env}.properties`). No credentials are hardcoded in `Configuration.java` itself.

However, the environment property files — `environment.dev.properties`, `environment.uat.properties`, and `environment.prod.properties` — are all committed to the repository and contain credentials in plaintext. These files are not listed in `.gitignore`.

`environment.dev.properties` (lines 15–16):
```
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```

`environment.uat.properties` (lines 15–16):
```
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```

`environment.prod.properties` (lines 15–16):
```
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```

**`pom.xml` — Flyway database credentials hardcoded:**

`pom.xml` local profile (lines 28–32):
```xml
<flyway.user>postgres</flyway.user>
<flyway.password>gmtp-postgres</flyway.password>
```
and (lines 30–32, second definition overrides first):
```xml
<flyway.user>fleetiq360</flyway.user>
<flyway.password>fleetiq360</flyway.password>
```

`pom.xml` uat profile (lines 75–76):
```xml
<flyway.user>dev_admin</flyway.user>
<flyway.password>C!1admin</flyway.password>
```

**`RuntimeConfig.java` — Multiple hardcoded secrets in source:**
(Discovered as a direct dependency of `HttpDownloadUtility`)

`src/main/java/com/journaldev/spring/jdbc/controller/RuntimeConfig.java` contains:
```java
public static String GCMKEY = "key=AIzaSyDDuQUYLcXkutyIxRToLAeBPHBQNLfayzs";    // line 14
public static String USERNAME = "ciclickatell";                                    // line 18
public static String PASSWORD = "OVLOaICXccaNUS";                                  // line 19
public static String API_ID = "3629505";                                            // line 21
```

**`HttpDownloadUtility.java` — Hardcoded API authentication token:**

`src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java` line 109:
```java
con.setRequestProperty("X-AUTH-TOKEN", "w6_zaejLjssvw02XqIiKdVmv7kP6nOHAw2Ve5mj-qug");
```

**`.gitignore` — Environment property files not excluded:**
`.gitignore` only excludes `environment.local.properties`. The files `environment.dev.properties`, `environment.uat.properties`, and `environment.prod.properties` are tracked in git and contain credentials.

---

**B30-1** — CRITICAL
**Section:** 1. Secrets and Configuration
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:109`
**Description:** A bearer/API authentication token is hardcoded as a string literal and committed to the repository. Any developer or CI system with read access to the repository has this credential. The token cannot be rotated without a source code change and new deployment.
**Evidence:**
```java
con.setRequestProperty("X-AUTH-TOKEN", "w6_zaejLjssvw02XqIiKdVmv7kP6nOHAw2Ve5mj-qug");
```

---

**B30-2** — CRITICAL
**Section:** 1. Secrets and Configuration
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/RuntimeConfig.java:14`
**Description:** A Google Cloud Messaging (GCM/FCM) server API key is hardcoded as a public static field in source code committed to the repository. This key grants the ability to send push notifications to all registered devices using this application's sender ID.
**Evidence:**
```java
public static String GCMKEY = "key=AIzaSyDDuQUYLcXkutyIxRToLAeBPHBQNLfayzs";
```

---

**B30-3** — HIGH
**Section:** 1. Secrets and Configuration
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/RuntimeConfig.java:18-19,21`
**Description:** Clickatell SMS gateway credentials — username, password, and API ID — are hardcoded as public static fields in source. These allow an attacker to send SMS messages billed to the application's Clickatell account.
**Evidence:**
```java
public static String USERNAME = "ciclickatell";
public static String PASSWORD = "OVLOaICXccaNUS";
public static String API_ID = "3629505";
```

---

**B30-4** — HIGH
**Section:** 1. Secrets and Configuration
**File:** `environment.dev.properties:15-16`, `environment.uat.properties:15-16`, `environment.prod.properties:15-16`
**Description:** Cognito API credentials (`cognitoAPIUsername` / `cognitoAPIPassword`) are committed in plaintext in all three environment property files. These files are tracked in git (not listed in `.gitignore`). The credentials are identical across all three environments (`ciiadmin`/`ciiadmin`), indicating no environment separation and a weak, shared credential.
**Evidence:**
```
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```
(repeated verbatim in dev, uat, and prod property files)

---

**B30-5** — HIGH
**Section:** 1. Secrets and Configuration
**File:** `pom.xml:29-32` (local profile), `pom.xml:75-76` (uat profile)
**Description:** Database credentials for Flyway migrations are hardcoded in `pom.xml` profiles and committed to the repository. The UAT profile contains the database password `C!1admin` for `dev_admin` on the production RDS instance (`forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com`). The local profile contains two conflicting sets of credentials (the second overrides the first). These are exposed to all repository readers.
**Evidence (local profile):**
```xml
<flyway.user>fleetiq360</flyway.user>
<flyway.password>fleetiq360</flyway.password>
```
**Evidence (uat profile):**
```xml
<flyway.url>jdbc:postgresql://forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com:5432/postgres</flyway.url>
<flyway.user>dev_admin</flyway.user>
<flyway.password>C!1admin</flyway.password>
```

---

**B30-6** — MEDIUM
**Section:** 1. Secrets and Configuration
**File:** `.gitignore:6`
**Description:** The `.gitignore` only excludes `environment.local.properties`. All other environment property files (`environment.dev.properties`, `environment.uat.properties`, `environment.prod.properties`) are tracked and committed to the repository. Credentials stored in these files are exposed in git history to all with repository access.
**Evidence:**
```
environment.local.properties
```
(This is the only environment properties entry. Dev, uat, and prod are absent.)

---

### Section 2 — Authentication and Authorization

**`Configuration.java`:** No controller or security logic. CLEAR for this file.

**`DateUtil.java`:** No controller or security logic. CLEAR for this file.

**`HttpDownloadUtility.java`:** No authentication logic. The `sendPost` method sends an outbound request with a hardcoded `X-AUTH-TOKEN` (covered under B30-1). There is no validation that the caller is authenticated before invoking these methods — authorization enforcement is expected to be in callers (controllers). The callers (`ResumeController`, via `ReportAPI`) are out of scope for this agent's assigned files. CLEAR for this file in isolation; the hardcoded token is reported under Section 1.

---

### Section 3 — Input Validation and Injection

#### SSRF — `HttpDownloadUtility.downloadFile` (HIGH PRIORITY)

The `downloadFile` method accepts a `fileURL` parameter as a plain `String`, constructs a `java.net.URL` from it with no validation, and immediately opens an HTTP connection:

```java
public static void downloadFile(String fileName, String fileURL, String saveDir) throws IOException {
    URL url = new URL(fileURL);
    HttpURLConnection httpConn = (HttpURLConnection) url.openConnection();
```

There is no:
- Scheme validation (only `http://` or `https://` should be allowed; `file://`, `ftp://`, etc. are not blocked)
- Host whitelist check
- Block on private/link-local IP ranges (e.g., `169.254.169.254` AWS metadata endpoint, `10.x.x.x`, `172.16.x.x`, `192.168.x.x`, `localhost`)
- DNS rebinding protection

If this method is called with a URL that originates from user-supplied input (whether directly from a request parameter, or indirectly through a database value that was originally user-supplied), it constitutes a full Server-Side Request Forgery (SSRF) vulnerability. An attacker could supply `http://169.254.169.254/latest/meta-data/iam/security-credentials/` to retrieve AWS instance credentials, or target internal services not exposed to the internet.

Grep of callers shows `downloadFile` is not directly called from any controller in the current codebase (only `sendPost` is called via `ReportAPI`). However, the method is `public static` and available to any future caller, and the absence of URL validation means any future caller introducing user input would immediately be vulnerable.

**B30-7** — HIGH
**Section:** 3. Input Validation and Injection (SSRF)
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:31-32`
**Description:** `downloadFile` constructs a `java.net.URL` directly from the `fileURL` parameter with no scheme validation, no host whitelist, and no block on private/link-local address ranges. The method is `public static` and its signature invites use with caller-supplied URLs. If any caller passes user-controlled input here, full SSRF results — including the ability to reach the AWS EC2 instance metadata service at `169.254.169.254`, internal databases, or other internal services.
**Evidence:**
```java
public static void downloadFile(String fileName, String fileURL, String saveDir)
        throws IOException {
    URL url = new URL(fileURL);
    HttpURLConnection httpConn = (HttpURLConnection) url.openConnection();
```

---

#### SSRF — `HttpDownloadUtility.sendPost`

`sendPost` constructs its URL by concatenating `RuntimeConfig.APIURL` (a hardcoded constant) with the `fname` parameter:

```java
String url = RuntimeConfig.APIURL + fname;
URL obj = new URL(url);
HttpURLConnection con = (HttpURLConnection) obj.openConnection();
```

`RuntimeConfig.APIURL` is hardcoded as `"http://ec2-52-5-205-104.compute-1.amazonaws.com/api/export/pdf/"`. The `fname` parameter is appended as a path segment. Callers pass report file names (from database query results, e.g., `report.getFile_name()`). If `fname` contains path traversal sequences or is attacker-controlled, it could modify the effective URL path. However, the base host is fixed to the hardcoded EC2 URL, so cross-host SSRF is not possible through this path alone. The risk is path manipulation within the same host.

Additionally, the base URL uses `http://` (plaintext), not `https://`, for what appears to be an internal PDF generation service. This exposes the POST body (which may contain report data) and the response (PDF content) to network interception on the path between the application server and the EC2 instance.

**B30-8** — MEDIUM
**Section:** 3. Input Validation and Injection (SSRF / plaintext transport)
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:100-103`
**Description:** `sendPost` constructs a URL by concatenating a hardcoded base URL with the `fname` parameter without sanitising `fname` for path traversal characters (e.g., `../`). The base transport is `http://` (not `https://`), exposing request body content and response PDF data to network interception. The imported `HttpsURLConnection` is never used.
**Evidence:**
```java
String url = RuntimeConfig.APIURL + fname;
URL obj = new URL(url);
//  HttpsURLConnection con = (HttpsURLConnection) obj.openConnection();  // commented out
    HttpURLConnection con = (HttpURLConnection) obj.openConnection();
```
`RuntimeConfig.APIURL = "http://ec2-52-5-205-104.compute-1.amazonaws.com/api/export/pdf/";`

---

#### Path Traversal — `downloadFile` save path construction

In `downloadFile`, the file name used to build the save path is sourced from either the HTTP `Content-Disposition` response header or derived from the URL itself. Neither source is under application control. A malicious server could return a `Content-Disposition` header containing `filename=../../etc/cron.d/malicious` or similar. The save path is then:

```java
saveFilePath = saveDir + File.separator + fileName;
FileOutputStream outputStream = new FileOutputStream(saveFilePath);
```

There is no canonicalization, no check that the resolved path stays within `saveDir`, and no sanitization of path traversal sequences (`../`, `..\\`, or URL-encoded variants). A malicious response server could write files to arbitrary locations accessible to the Tomcat process.

**B30-9** — HIGH
**Section:** 3. Input Validation and Injection (Path Traversal)
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:50-58,72-74`
**Description:** The filename used to construct the file write path is taken directly from the HTTP `Content-Disposition` response header (or from the URL path) with no path traversal sanitisation. A malicious response server can return `filename=../../etc/cron.d/backdoor` and cause the application to write attacker-controlled content to an arbitrary path writable by the Tomcat process user.
**Evidence:**
```java
// filename extracted from server-controlled Content-Disposition header:
fileName = disposition.substring(index + 10, disposition.length() - 1);
// or from the URL path (also server-controlled):
fileName = fileURL.substring(fileURL.lastIndexOf("/") + 1, fileURL.length());

// ... then used directly in file path construction:
saveFilePath = saveDir + File.separator + fileName;
FileOutputStream outputStream = new FileOutputStream(saveFilePath);
```

---

#### Path Traversal — `sendPost` save path construction

In `sendPost`, the filename is constructed from `fname` (the report name, caller-supplied) concatenated with a random suffix and the fixed file extension `.pdf`:

```java
fileName = fname + "-" + Util.generateRadomName();
saveFilePath = saveDir + fileName + RuntimeConfig.file_type;
FileOutputStream outputStream = new FileOutputStream(saveFilePath);
```

If `fname` contains path traversal sequences (e.g., `../../`), the random suffix and `.pdf` extension appended afterward do not neutralise the traversal of the directory prefix. The caller (`ResumeController`) supplies `report.getFile_name()` from a database value. If that database value was originally user-supplied without sanitization, path traversal is possible.

**B30-10** — MEDIUM
**Section:** 3. Input Validation and Injection (Path Traversal)
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:130-135`
**Description:** The `fname` parameter is concatenated directly into the file save path without sanitisation for path traversal characters. A database value containing `../../` in the report file name would traverse out of the intended save directory. The appended random string and `.pdf` extension do not prevent the traversal of the directory prefix.
**Evidence:**
```java
fileName = fname + "-" + Util.generateRadomName();
saveFilePath = saveDir + fileName + RuntimeConfig.file_type;
FileOutputStream outputStream = new FileOutputStream(saveFilePath);
```

---

#### Race Condition / State Corruption — Static mutable fields

`HttpDownloadUtility` uses `private static String saveFilePath` and `private static String fileName` as shared mutable state. In a multi-threaded servlet environment (standard for Tomcat), concurrent requests calling `sendPost` or `downloadFile` will race to read and write these static fields. A request may read the `saveFilePath` or `fileName` set by a concurrent request's operation. This can cause one user's report to be emailed/returned to another user. While primarily a data integrity and confidentiality issue rather than a direct injection vulnerability, it is a security-relevant defect.

**B30-11** — HIGH
**Section:** 3. Input Validation and Injection / 5. Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:19-20`
**Description:** `saveFilePath` and `fileName` are `private static` (class-level) mutable fields. In a multi-threaded Tomcat environment, concurrent report generation requests will race to write and then read these fields. One user can receive the file path (and therefore the PDF report data) generated for a concurrent user's request — a data confidentiality breach for sensitive forklift/operator telemetry reports.
**Evidence:**
```java
private static String saveFilePath = "";
private static String fileName = "";
```
Used in `sendPost` (lines 130-131):
```java
fileName = fname + "-" + Util.generateRadomName();
saveFilePath = saveDir + fileName + RuntimeConfig.file_type;
```
Retrieved by callers via public static getters:
```java
this.name = HttpDownloadUtility.getFileName();
return HttpDownloadUtility.getSaveFilePath();
```

---

#### Date Format Injection — `DateUtil`

`parseDate` is `private`. All public entry points (`parseDateIso`, `parseDateTimeIso`, `parseDateTimeWithSlashes`) pass hardcoded format string literals to `parseDate`. The `dateFormat` parameter of `parseDate` is never caller-controlled from outside the class. There is no date format string injection risk.

The error message in `parseDate` at line 21 includes the raw `dateString` value:
```java
throw new IllegalArgumentException("Invalid date time to parseDate : " + dateString, e);
```
If the `IllegalArgumentException` message is propagated to an HTTP response body (depends on exception handler configuration, out of scope for this file), it would reflect user input. This is a low-severity data reflection concern.

**B30-12** — LOW
**Section:** 3. Input Validation and Injection / 5. Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/util/DateUtil.java:21`
**Description:** The exception message in `parseDate` includes the raw user-supplied `dateString` value. If the calling controller propagates `IllegalArgumentException` messages to HTTP response bodies (e.g., via an unhandled exception mapper), user input is reflected in error responses. This is a potential information reflection vector. Date format string injection is not present — all format strings are hardcoded literals.
**Evidence:**
```java
throw new IllegalArgumentException("Invalid date time to parseDate : " + dateString, e);
```

---

#### SQL Injection — N/A for these files

No SQL construction in any of the three assigned files. CLEAR.

#### Command Injection — N/A for these files

No `Runtime.exec()` or `ProcessBuilder` in any assigned file. CLEAR.

#### XXE — N/A for these files

No XML parsing in any assigned file. CLEAR.

#### Deserialization — N/A for these files

No `ObjectInputStream` or Jackson polymorphic deserialization in any assigned file. CLEAR.

---

### Section 4 — Session and CSRF

No session management, CSRF configuration, CORS annotations, or cookie configuration in any of the three assigned files. CLEAR for these files.

---

### Section 5 — Data Exposure

**`HttpDownloadUtility` — Logging sensitive information to stdout:**

`downloadFile` and `sendPost` both write diagnostic information to `System.out.println` rather than a logging framework. This includes:
- File paths (`saveFilePath`)
- URLs being fetched (which may encode forklift/operator identifiers)
- POST request bodies (`input` — the report JSON payload)

```java
System.out.println("saveFilePath : " + saveFilePath);   // line 133
System.out.println("Post jason data : " + input);        // line 122
System.out.println("\nSending 'POST' request to URL : " + url);  // line 120
```

The POST body (`input`) is the JSON payload for PDF report generation and likely contains forklift IDs, operator data, or site data. Writing this to stdout in production means it appears in Tomcat's `catalina.out`, which is readable by any user with server access and may be shipped to log aggregation systems without appropriate access controls.

**B30-13** — MEDIUM
**Section:** 5. Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:120-122,133`
**Description:** Report request payloads (which may contain operator, forklift, or site identifiers), constructed file paths, and outbound API URLs are logged to `System.out` (Tomcat stdout / `catalina.out`) at what would be DEBUG-equivalent verbosity in a logging framework. In production this information should not be logged at all, or only at DEBUG level with appropriate access controls on log files.
**Evidence:**
```java
System.out.println("\nSending 'POST' request to URL : " + url);
System.out.println("Post jason data : " + input);
System.out.println("saveFilePath : " + saveFilePath);
```

---

**`HttpDownloadUtility` — Exception stack traces to stdout:**

Both `downloadFile` (line 86) and `sendPost` (line 147) catch `Exception` and call `e.printStackTrace()`, which writes a full Java stack trace to `System.err`. Stack traces expose class names, method names, line numbers, and the application's internal package structure (`com.journaldev.spring.jdbc.*`), which aids an attacker in targeting specific code paths.

**B30-14** — LOW
**Section:** 5. Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/util/HttpDownloadUtility.java:86,147`
**Description:** Exceptions are silently swallowed after printing a stack trace to stderr via `e.printStackTrace()`. Stack traces expose internal class structure and line numbers. The silent swallowing also means callers receive no indication that the file download failed, which can cause the application to operate on a missing or corrupt file without error propagation.
**Evidence:**
```java
} catch(Exception e) {
    e.printStackTrace();
}
```
(Appears in `downloadFile` at line 84-87 and `sendPost` at lines 145-148.)

---

### Section 6 — Dependencies

**Spring Framework 3.2.14.RELEASE** (pom.xml line 12): This release is end-of-life and has multiple known CVEs. Spring 3.2.x reached end-of-life in December 2016. Notable CVEs include CVE-2018-1270 (remote code execution via STOMP), CVE-2018-1271 (path traversal), CVE-2018-1272 (privilege escalation). This is flagged here as it is relevant to the overall security posture; the primary finding should be recorded by whichever agent reviews `pom.xml`.

**Spring Security 3.1.1.RELEASE** (pom.xml line 232-237): Severely outdated. 3.1.x is end-of-life. Multiple CVEs exist.

**Jackson Databind 2.6.7** (pom.xml line 100): Known CVEs include polymorphic deserialization gadget chains (CVE-2017-7525, CVE-2017-15095, CVE-2018-5968, and many others through the 2.x series up to 2.6.x).

**commons-fileupload 1.3.1** (pom.xml line 200): CVE-2016-1000031 (DiskFileItem deserialization). Upgrade to 1.3.3 or later required.

**commons-io 1.3.2** (pom.xml line 169): This appears to be `org.apache.commons:commons-io:1.3.2` which is outdated (note: Apache Commons IO uses a different versioning scheme from Apache Commons IO 1.x vs 2.x; 1.3.2 is a very old release predating the 2.x repackaging).

**aws-java-sdk 1.11.163** (pom.xml line 272): Released in 2017. This is significantly outdated; many security improvements have been made in subsequent releases.

**Splunk repository over HTTP** (pom.xml line 87):
```xml
<url>http://splunk.jfrog.io/splunk/ext-releases-local</url>
```
The Maven repository for Splunk artifacts is configured with an `http://` URL (not `https://`). This allows a man-in-the-middle attacker on the build network to substitute malicious JAR artifacts during the build process (dependency confusion / artifact poisoning).

**B30-15** — HIGH
**Section:** 6. Dependencies
**File:** `pom.xml:87`
**Description:** The Splunk Maven repository is configured with a plaintext `http://` URL. This allows a network-level attacker on the build path to inject malicious JAR files during dependency resolution (supply chain attack via artifact substitution). All Maven repository URLs should use `https://`.
**Evidence:**
```xml
<repository>
    <id>splunk-artifactory</id>
    <name>Splunk Releases</name>
    <url>http://splunk.jfrog.io/splunk/ext-releases-local</url>
</repository>
```

---

### Section 7 — Build and CI

No `bitbucket-pipelines.yml` found in the repository. CI/CD configuration is absent. This means there is no automated build verification, no automated test execution, and no deployment pipeline audit trail. CLEAR for the assigned files specifically; absence of pipelines should be flagged at the audit level.

---

## Summary of Findings

| ID     | Severity | Section | Description                                              |
|--------|----------|---------|----------------------------------------------------------|
| B30-1  | CRITICAL | 1       | Hardcoded X-AUTH-TOKEN bearer token in source code       |
| B30-2  | CRITICAL | 1       | Hardcoded GCM server API key in RuntimeConfig            |
| B30-3  | HIGH     | 1       | Hardcoded Clickatell SMS credentials in RuntimeConfig    |
| B30-4  | HIGH     | 1       | Cognito API credentials committed in env property files  |
| B30-5  | HIGH     | 1       | Database credentials (incl. prod RDS) committed in pom.xml|
| B30-6  | MEDIUM   | 1       | Environment property files not excluded by .gitignore    |
| B30-7  | HIGH     | 3       | SSRF: no URL validation in downloadFile                  |
| B30-8  | MEDIUM   | 3       | SSRF/plaintext: sendPost uses http://, fname unsanitised |
| B30-9  | HIGH     | 3       | Path traversal via server-controlled Content-Disposition  |
| B30-10 | MEDIUM   | 3       | Path traversal via unsanitised fname in sendPost          |
| B30-11 | HIGH     | 3/5     | Race condition on static fields causes cross-user data leak|
| B30-12 | LOW      | 3/5     | User input reflected in IllegalArgumentException message  |
| B30-13 | MEDIUM   | 5       | Report payloads and file paths logged to System.out      |
| B30-14 | LOW      | 5       | Stack traces printed to stderr; exceptions silently swallowed|
| B30-15 | HIGH     | 6       | Maven repo over http:// enables artifact substitution    |
