# Pass 1 Security Audit — Agent B13
**Date:** 2026-02-27
**Branch:** master
**Scope:** Model classes — Driver, DriverEmails, DriverEquipment

---

## Reading Evidence

### 1. `com.journaldev.spring.jdbc.model.Driver`

**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:**
- `@Data` (Lombok — generates getters, setters, toString, equals, hashCode)
- `@NoArgsConstructor` (Lombok — generates public no-arg constructor)
- `@EqualsAndHashCode(onlyExplicitlyIncluded = true)` (Lombok)

**Fields (all package-private via Lombok @Data; all lack Jackson annotations):**

| Access | Type | Name | Notes |
|--------|------|------|-------|
| private | `static final long` | `serialVersionUID` | -100229563698950401L |
| private | `Long` | `id` | DB primary key |
| private | `String` | `first_name` | PII |
| private | `String` | `last_name` | PII |
| private | `String` | `email` | PII — `@EqualsAndHashCode.Include` |
| private | `String` | `password` | CREDENTIAL — no `@JsonIgnore` |
| private | `String` | `phone` | PII |
| private | `String` | `licno` | PII — driver licence number |
| private | `String` | `expirydt` | Licence expiry date |
| private | `String` | `addr` | PII — physical address |
| private | `String` | `securityno` | SENSITIVE — likely security/SIN/employee number |
| private | `String` | `photo_url` | PII-adjacent — profile photo |
| private | `boolean` | `contactperson` | Role flag |
| private | `String` | `ranking` | Operational data |
| private | `Long` | `comp_id` | Organisation identifier |
| private | `boolean` | `driver_based` | Config flag |
| private | `String` | `date_format` | User preference |
| private | `Integer` | `max_session_length` | Config — session cap |
| private | `String` | `compliance_date` | Safety/regulatory data |
| private | `Integer` | `gps_frequency` | Telemetry config |
| private | `List<Driver>` | `drivers` | Nested driver list (contact person) |
| private | `List<DriverTraining>` | `arrDriverTrainings` | Training records |

**Public methods (generated by `@Data`):**
All getters and setters for every field listed above are generated at compile time by Lombok. No explicit public methods are declared in source. The `@Builder`-annotated constructor at line 47 is declared `private`.

**Jackson annotations:** None on any field or the class.

**Validation annotations:** None on any field.

---

### 2. `com.journaldev.spring.jdbc.model.DriverEmails`

**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverEmails.java`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:** None.

**Fields:**

| Access | Type | Name | Notes |
|--------|------|------|-------|
| private | `static final long` | `serialVersionUID` | 2730515601304224328L |
| private | `int` | `id` | DB primary key |
| private | `int` | `driver_id` | Foreign key — driver reference |
| private | `String` | `email_addr1` | PII |
| private | `String` | `email_addr2` | PII |
| private | `String` | `email_addr3` | PII |
| private | `String` | `email_addr4` | PII |

**Public methods (explicitly declared):**

| Return Type | Method | Parameters | Line |
|-------------|--------|------------|------|
| `int` | `getId()` | none | 20 |
| `void` | `setId(int id)` | `int id` | 23 |
| `int` | `getDriver_id()` | none | 26 |
| `void` | `setDriver_id(int driver_id)` | `int driver_id` | 29 |
| `String` | `getEmail_addr1()` | none | 32 |
| `void` | `setEmail_addr1(String email_addr1)` | `String email_addr1` | 35 |
| `String` | `getEmail_addr2()` | none | 38 |
| `void` | `setEmail_addr2(String email_addr2)` | `String email_addr2` | 41 |
| `String` | `getEmail_addr3()` | none | 44 |
| `void` | `setEmail_addr3(String email_addr3)` | `String email_addr3` | 47 |
| `String` | `getEmail_addr4()` | none | 50 |
| `void` | `setEmail_addr4(String email_addr4)` | `String email_addr4` | 53 |

**Jackson annotations:** None on any field or the class.

**Validation annotations:** None on any field.

---

### 3. `com.journaldev.spring.jdbc.model.DriverEquipment`

**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverEquipment.java`

**Interfaces implemented / classes extended:**
- `extends com.journaldev.spring.jdbc.model.Equipment` (which implements `java.io.Serializable`)

**Class-level annotations:**
- `@Data` (Lombok)
- `@NoArgsConstructor` (Lombok)
- `@EqualsAndHashCode(callSuper = false)` (Lombok)

**Fields declared in `DriverEquipment`:**

| Access | Type | Name | Notes |
|--------|------|------|-------|
| private | `static final long` | `serialVersionUID` | -2200458485098129108L |
| private | `Integer` | `hours` | Usage hours |
| private | `Boolean` | `trained` | Training status flag |

**Fields inherited from `Equipment` (all serialised via Jackson by default):**

| Access | Type | Name | Notes |
|--------|------|------|-------|
| private | `int` | `id` | DB PK |
| private | `String` | `name` | Equipment name |
| private | `int` | `type_id` | FK |
| private | `int` | `comp_id` | Organisation identifier |
| private | `boolean` | `active` | Status flag |
| private | `int` | `manu_id` | FK |
| private | `int` | `fuel_type_id` | FK |
| private | `int` | `attachment_id` | FK |
| private | `String` | `type` | Equipment type label |
| private | `String` | `manu` | Manufacturer |
| private | `String` | `fuel_type` | Fuel type label |
| private | `String` | `comp` | Company name |
| private | `String` | `serial_no` | Equipment serial number — asset identifier |
| private | `String` | `mac_address` | Hardware MAC address — network identifier |
| private | `String` | `url` | Equipment URL/endpoint |
| private | `long` | `impact_threshold` | Safety threshold config |
| private | `boolean` | `alert_enabled` | Alert config |
| private | `boolean` | `driver_based` | Config flag |

**Public methods (generated by `@Data` on DriverEquipment, plus inherited getters/setters from Equipment's `@Data`):**
All getters and setters for every field. No explicit public methods declared in `DriverEquipment` source. No explicit public methods declared in `Equipment` source other than the `@Builder` constructor (line 34, public).

**Jackson annotations:** None on any field or either class.

**Validation annotations:** None on any field.

---

## Checklist Review

### Section 1 — Secrets and Configuration

These are model POJO classes. No configuration files, no credentials, no database connections, no API keys, no hardcoded secrets.

**Result: N/A for these files.**

---

### Section 2 — Authentication and Authorization

These are model POJO classes. No security filter chain, no endpoint mappings, no `@PreAuthorize`, no `@Secured`, no IDOR-relevant logic.

**Result: N/A for these files.**

---

### Section 3 — Input Validation and Injection

**3a. Deserialization — `@JsonTypeInfo`**

None of the three classes use `@JsonTypeInfo`. No polymorphic deserialization annotations are present. No global Jackson default typing is configured within these files.

**Result: CLEAR** (no `@JsonTypeInfo` issue in scope files).

**3b. Input Validation Constraints**

All three classes are used as request/response model objects. None declare any Bean Validation constraints (`@NotNull`, `@Size`, `@Pattern`, `@Email`, `@Min`, `@Max`, etc.) on any field.

`Driver` accepts: `password`, `licno`, `securityno`, `email`, `phone`, `addr`, `gps_frequency`, `max_session_length` — all without constraints.

`DriverEmails` accepts four email address strings (`email_addr1` through `email_addr4`) without any `@Email` or `@NotNull` annotation.

`DriverEquipment` (via `Equipment`) accepts `mac_address`, `url`, `serial_no`, `impact_threshold` without constraints.

**Result: FINDING — see B13-4 and B13-5.**

---

### Section 4 — Session and CSRF

These are model POJO classes. No HTTP session handling, no CSRF configuration, no CORS configuration, no cookie setup.

**Result: N/A for these files.**

---

### Section 5 — Data Exposure

**5a. `password` field in `Driver` — no `@JsonIgnore`**

`Driver.password` (line 25) is a `String` with no `@JsonIgnore` annotation and no write-only Jackson configuration. Because `@Data` generates a public getter (`getPassword()`), Jackson will serialise this field into every JSON response that includes a `Driver` object. Any API response returning a `Driver` will leak the raw password (or its hash/token) to the client.

**Result: FINDING — see B13-1.**

**5b. `securityno` field in `Driver` — no `@JsonIgnore`**

`Driver.securityno` (line 30) is a `String` with no `@JsonIgnore`. The field name implies a government-issued security number (e.g., Social Insurance Number, Social Security Number, or a similar high-sensitivity identifier). It will be serialised into every JSON response containing a `Driver`.

**Result: FINDING — see B13-2.**

**5c. `licno` field in `Driver` — no `@JsonIgnore`**

`Driver.licno` (line 27) stores the driver's licence number — a regulated PII identifier. No `@JsonIgnore` is present. It is serialised in full in all API responses.

**Result: FINDING — see B13-3.**

**5d. All remaining PII fields — no write-only or selective suppression**

`first_name`, `last_name`, `email`, `phone`, `addr`, `expirydt`, `photo_url`, `compliance_date`, `ranking` — all are fully serialised in both request and response directions. No `@JsonProperty(access = JsonProperty.Access.WRITE_ONLY)` is used anywhere. While some of these fields are legitimately returned to authenticated callers, there is no per-field access control annotation layer, meaning a single `Driver` object is used uniformly across all API response contexts regardless of the caller's role or relationship to the operator.

**Result: INFO — see B13-6.**

**5e. `mac_address` in `Equipment` (inherited by `DriverEquipment`) — no `@JsonIgnore`**

`Equipment.mac_address` (Equipment.java line 14) is serialised into all `DriverEquipment` responses. A MAC address is a unique hardware identifier that reveals network topology and can be used to fingerprint or locate physical equipment. It should be suppressed from external-facing responses unless there is an explicit business requirement.

**Result: FINDING — see B13-7.**

**5f. `url` in `Equipment` (inherited by `DriverEquipment`) — no suppression**

`Equipment.url` (Equipment.java line 15) is serialised into all `DriverEquipment` responses. If this field holds an internal endpoint URL for the forklift telemetry device, it discloses internal infrastructure topology to API consumers.

**Result: FINDING — see B13-8.**

**5g. `comp_id` cross-tenant identifier — no scoping annotation**

`Driver.comp_id` (line 34) and `Equipment.comp_id` (Equipment.java line 4) are returned directly in API responses. While exposure of the organisation identifier alone is a moderate concern, the field's presence in the model with no suppression means callers know their `comp_id` and could use it in other requests to probe for IDOR vulnerabilities at the controller layer.

**Result: INFO — see B13-9.**

**5h. Logging — no `@ToString.Exclude`**

`Driver` uses Lombok `@Data` which generates `toString()` including every field. If a `Driver` object is ever passed to a logger (e.g., `log.debug("Driver: {}", driver)`), the generated `toString()` will emit `password`, `securityno`, `licno`, `email`, and all other PII fields into the log. No fields are excluded with `@ToString.Exclude`.

**Result: FINDING — see B13-10.**

**5i. Error responses — N/A for model files.**

---

### Section 6 — Dependencies

N/A — these are model POJO source files, not build configuration files.

---

### Section 7 — Build and CI

N/A — these are model POJO source files, not build or pipeline configuration files.

---

## Findings

---

**B13-1** — CRITICAL
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java:25`
**Description:** The `password` field has no `@JsonIgnore` annotation and no `@JsonProperty(access = WRITE_ONLY)` configuration. Lombok `@Data` generates a public `getPassword()` getter, causing Jackson to include the password value in every JSON API response that serialises a `Driver` object. This leaks credentials (plaintext or hashed) to any authenticated API caller who retrieves a driver record.
**Evidence:**
```java
private String password;
```
No corresponding `@JsonIgnore` annotation present on the field or the generated getter. No `@JsonProperty` write-only restriction.

---

**B13-2** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java:30`
**Description:** The `securityno` field — which by name indicates a government-issued identifier (e.g., SIN/SSN or equivalent) — carries no `@JsonIgnore` and is serialised in all API responses containing a `Driver`. Government-issued security numbers are the highest-sensitivity PII category and must never be returned in API responses unless there is an explicit, access-controlled need.
**Evidence:**
```java
private String securityno;
```

---

**B13-3** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java:27`
**Description:** The `licno` field stores the driver's licence number — a regulated PII identifier under most privacy legislation (PIPEDA, GDPR, etc.). No `@JsonIgnore` is present. The licence number is serialised into every API response returning a `Driver`. Access to this field should be suppressed by default and only exposed to roles with a legitimate operational need.
**Evidence:**
```java
private String licno;
```

---

**B13-4** — MEDIUM
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java:1`
**Description:** The `Driver` model class declares no Bean Validation constraints on any field. Fields used in API request bodies (`password`, `email`, `phone`, `licno`, `securityno`, `gps_frequency`, `max_session_length`, `addr`, etc.) have no `@NotNull`, `@Size`, `@Pattern`, `@Email`, `@Min`, or `@Max` annotations. If `@Valid` is used at the controller layer, it will pass through without performing any validation. Fields with numeric semantics (`gps_frequency`, `max_session_length`) have no range constraints, permitting negative or arbitrarily large values.
**Evidence:**
```java
private String email;      // no @Email, no @NotNull
private String phone;      // no @Pattern
private String licno;      // no @Size
private String securityno; // no @Size, no @Pattern
private Integer gps_frequency;     // no @Min / @Max
private Integer max_session_length; // no @Min / @Max
```

---

**B13-5** — MEDIUM
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverEmails.java:1`
**Description:** The `DriverEmails` model declares four email address fields (`email_addr1` through `email_addr4`) with no `@Email`, `@Size`, or `@Pattern` constraints. Malformed or excessively long values will pass through to the database layer without validation.
**Evidence:**
```java
private String email_addr1;
private String email_addr2;
private String email_addr3;
private String email_addr4;
```

---

**B13-6** — INFO
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java:1`
**Description:** The `Driver` model is used as both a request deserialisation target and a response serialisation source with no separation between write-only and read-only fields. All PII fields (`first_name`, `last_name`, `email`, `phone`, `addr`, `photo_url`, `compliance_date`, `expirydt`, `ranking`) are returned indiscriminately in all response contexts. There is no use of `@JsonProperty(access = WRITE_ONLY)` for input-only fields or response-specific DTOs. A two-model pattern (request DTO / response DTO) or field-level access annotations would reduce accidental exposure.
**Evidence:**
```java
// All fields exposed identically for read and write — no separation:
private String first_name;
private String last_name;
private String email;
private String phone;
private String addr;
```

---

**B13-7** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Equipment.java:14` (inherited by `DriverEquipment`)
**Description:** The `mac_address` field of `Equipment` is inherited by `DriverEquipment` and serialised into all `DriverEquipment` API responses with no `@JsonIgnore`. A hardware MAC address uniquely identifies a physical forklift's network interface and discloses equipment network topology to API consumers. This field should be suppressed in external API responses.
**Evidence:**
```java
private String mac_address;
```
Inherited by:
```java
public class DriverEquipment extends Equipment {
```

---

**B13-8** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Equipment.java:15` (inherited by `DriverEquipment`)
**Description:** The `url` field of `Equipment` is inherited by `DriverEquipment` and serialised into all `DriverEquipment` API responses with no `@JsonIgnore`. If this field contains an internal device endpoint, MQTT broker address, or telemetry service URL, its disclosure in API responses reveals internal infrastructure topology.
**Evidence:**
```java
private String url;
```

---

**B13-9** — INFO
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java:34`
**Description:** The `comp_id` (company/organisation identifier) is returned in all `Driver` API responses. While this is common in multi-tenant APIs, it informs callers of their exact `comp_id` value and creates a precondition for IDOR attacks at the controller layer if controller-level scoping is not enforced. This is an architectural observation to cross-reference against controller-layer findings.
**Evidence:**
```java
private Long comp_id;
```

---

**B13-10** — HIGH
**Section:** 5 — Data Exposure (Logging)
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java:1`
**Description:** Lombok `@Data` generates a `toString()` method that includes every field of the class, including `password`, `securityno`, `licno`, `email`, `phone`, and `addr`. No fields are annotated `@ToString.Exclude`. If any code path logs a `Driver` instance (e.g., `log.debug("Driver: {}", driver)` or as part of an exception message), all PII and credentials will be written to application logs in plain text. This is a systemic risk across the entire application wherever `Driver` objects are logged.
**Evidence:**
```java
@Data   // generates toString() including all fields below
@NoArgsConstructor
@EqualsAndHashCode(onlyExplicitlyIncluded = true)
public class Driver implements Serializable {
    private String password;    // will appear in toString()
    private String securityno;  // will appear in toString()
    private String licno;       // will appear in toString()
    private String email;       // will appear in toString()
    private String addr;        // will appear in toString()
    // ... all other fields
```
No `@ToString.Exclude` annotation is present on any field.

---

## Summary Table

| ID | Severity | Section | Description |
|----|----------|---------|-------------|
| B13-1 | CRITICAL | 5 — Data Exposure | `Driver.password` serialised in API responses — no `@JsonIgnore` |
| B13-2 | HIGH | 5 — Data Exposure | `Driver.securityno` (govt ID) serialised in API responses — no `@JsonIgnore` |
| B13-3 | HIGH | 5 — Data Exposure | `Driver.licno` (licence number) serialised in API responses — no `@JsonIgnore` |
| B13-4 | MEDIUM | 3 — Input Validation | No Bean Validation constraints on any `Driver` field |
| B13-5 | MEDIUM | 3 — Input Validation | No `@Email`/`@Size` constraints on `DriverEmails` email fields |
| B13-6 | INFO | 5 — Data Exposure | No request/response DTO separation; all fields bidirectional |
| B13-7 | MEDIUM | 5 — Data Exposure | `Equipment.mac_address` (hardware identifier) exposed in `DriverEquipment` responses |
| B13-8 | MEDIUM | 5 — Data Exposure | `Equipment.url` (internal endpoint) exposed in `DriverEquipment` responses |
| B13-9 | INFO | 5 — Data Exposure | `comp_id` returned in responses — IDOR precondition (verify at controller layer) |
| B13-10 | HIGH | 5 — Data Exposure (Logging) | Lombok `@Data` `toString()` includes `password`, `securityno`, PII — no `@ToString.Exclude` |
