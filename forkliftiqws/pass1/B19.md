# Pass 1 Security Review — Agent B19
**Date:** 2026-02-27
**Repo:** forkliftiqws (branch: master)
**Assigned files:**
- `src/main/java/com/journaldev/spring/jdbc/model/ImpactNotification.java`
- `src/main/java/com/journaldev/spring/jdbc/model/Incidents.java`
- `src/main/java/com/journaldev/spring/jdbc/model/Manufacturer.java`

---

## Reading Evidence

### 1. `ImpactNotification.java`

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.ImpactNotification`

**Class-level annotations:**
- `@Data` (Lombok — generates getters, setters, equals, hashCode, toString)
- `@NoArgsConstructor` (Lombok — generates no-arg constructor)

**Fields (all private):**

| Access | Type | Name |
|--------|------|------|
| private | String | driver_name |
| private | String | unit_name |
| private | String | manufacturer_name |
| private | String | company_name |
| private | String | impact_time |
| private | String | subscription_name |
| private | String | email |
| private | String | mobile |

**Public methods** (all generated by `@Data` at compile time, not explicitly declared, except the builder constructor):

| Return Type | Method/Constructor | Line |
|-------------|-------------------|------|
| — | `@Builder ImpactNotification(String driver_name, String unit_name, String manufacturer_name, String company_name, String impact_time, String subscription_name, String email, String mobile)` | 21 |
| (Lombok-generated getters/setters for all 8 fields) | — | — |

**Annotations on methods:**
- `@Builder` on the all-args constructor (line 20)

**Interfaces implemented / classes extended:** None.

---

### 2. `Incidents.java`

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.Incidents`

**Class-level annotations:** None.

**Interfaces implemented:** `java.io.Serializable`

**Fields:**

| Access | Type | Name |
|--------|------|------|
| private static final | long | serialVersionUID = -2471804810130016124L |
| private | int | id |
| private | byte[] | signature |
| private | byte[] | image |
| private | String | injury_type |
| private | String | witness |
| private | String | location |
| private | Boolean | injury |
| private | Boolean | near_miss |
| private | Boolean | incident |
| private | int | driver_id |
| private | int | unit_id |
| private | String | description |
| private | String | report_time |
| private | String | event_time |
| private | String | job_number |

**Public methods:**

| Return Type | Method | Line |
|-------------|--------|------|
| int | `getDriver_id()` | 24 |
| void | `setDriver_id(int driver_id)` | 27 |
| int | `getUnit_id()` | 30 |
| void | `setUnit_id(int unit_id)` | 33 |
| Boolean | `getIncident()` | 37 |
| void | `setIncident(Boolean incident)` | 40 |
| String | `getJob_number()` | 49 |
| void | `setJob_number(String job_number)` | 52 |
| Boolean | `getNear_miss()` | 55 |
| void | `setNear_miss(Boolean near_miss)` | 58 |
| String | `getWitness()` | 61 |
| void | `setWitness(String witness)` | 64 |
| int | `getId()` | 67 |
| void | `setId(int id)` | 70 |
| byte[] | `getSignature()` | 73 |
| void | `setSignature(byte[] signature)` | 76 |
| byte[] | `getImage()` | 79 |
| void | `setImage(byte[] image)` | 82 |
| String | `getInjury_type()` | 85 |
| void | `setInjury_type(String injury_type)` | 88 |
| String | `getLocation()` | 91 |
| void | `setLocation(String location)` | 94 |
| Boolean | `getInjury()` | 97 |
| void | `setInjury(Boolean injury)` | 100 |
| String | `getDescription()` | 103 |
| void | `setDescription(String description)` | 106 |
| String | `getReport_time()` | 109 |
| void | `setReport_time(String report_time)` | 112 |
| String | `getEvent_time()` | 115 |
| void | `setEvent_time(String event_time)` | 118 |

**Annotations on methods/fields:** None.

**Interfaces implemented / classes extended:** `java.io.Serializable`

---

### 3. `Manufacturer.java`

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.Manufacturer`

**Class-level annotations:** None.

**Interfaces implemented:** `java.io.Serializable`

**Fields:**

| Access | Type | Name |
|--------|------|------|
| private static final | long | serialVersionUID = 9130860210979786961L |
| private | int | id |
| private | String | name |

**Public methods:**

| Return Type | Method | Line |
|-------------|--------|------|
| int | `getId()` | 14 |
| void | `setId(int id)` | 17 |
| String | `getName()` | 20 |
| void | `setName(String name)` | 23 |

**Annotations on methods/fields:** None.

**Interfaces implemented / classes extended:** `java.io.Serializable`

---

## Checklist Review

### Section 1 — Secrets and Configuration

These are POJO model classes. No database connection strings, credentials, API keys, or configuration values are present in any of the three files.

**CLEAR** — No secrets or configuration in any of the three model files.

---

### Section 2 — Authentication and Authorization

These are model classes with no Spring MVC mappings, no security annotations, and no access-control logic. Authentication and authorization is the responsibility of controller/service layers not in scope here.

**N/A** — Model classes carry no auth logic.

---

### Section 3 — Input Validation and Injection / Deserialization

**Deserialization (`Incidents`, `Manufacturer`):**

Both `Incidents` and `Manufacturer` implement `java.io.Serializable` with explicit `serialVersionUID` values. Neither class defines a `readObject()` or `readResolve()` method, meaning deserialization behavior is the JVM default. If instances of these classes are ever deserialized from untrusted input (e.g., via a Java serialization endpoint, session store, or cache), all fields will be populated without validation. The `byte[]` fields `signature` and `image` in `Incidents` could carry arbitrarily large payloads with no size constraint at the model level.

No `@JsonTypeInfo` annotation with default typing (`defaultTyping`) is present on any of these classes, so Jackson polymorphic deserialization risk is not introduced at this layer.

**Input Validation (`ImpactNotification`):**

`ImpactNotification` carries contact-sensitive fields `email` and `mobile`. Neither field has any Bean Validation constraint (`@Email`, `@Pattern`, `@Size`, `@NotNull`). If this object is used as a `@RequestBody` in a controller, malformed or excessively long values for these fields will pass through to the notification dispatch layer without validation. The model uses Lombok `@Data` and has no custom validation hooks.

**B19-1** — MEDIUM
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/ImpactNotification.java:17-18`
**Description:** The `email` and `mobile` fields on `ImpactNotification` carry no Bean Validation constraints. If this model is bound directly from a request body (without a separate validated DTO), malformed email addresses or phone numbers — including excessively long strings — will pass through to the notification dispatch layer without rejection.
**Evidence:**
```java
private String email;
private String mobile;
```

**B19-2** — LOW
**Section:** 3 — Input Validation and Injection / Deserialization
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Incidents.java:5`
**Description:** `Incidents` implements `java.io.Serializable` with no custom `readObject()` guard. The class contains `byte[]` fields (`signature`, `image`) that could carry arbitrarily large payloads. If instances are ever deserialized from an untrusted or loosely controlled source (cache, message queue, remote session), there is no size or content validation at the model level.
**Evidence:**
```java
public class Incidents implements Serializable {
    private static final long serialVersionUID = -2471804810130016124L;
    private byte[] signature;
    private byte[] image;
```

---

### Section 4 — Session and CSRF

These are model classes. No session handling, CSRF configuration, cookie attributes, or CORS annotations are present.

**N/A** — Model classes contain no session or CSRF logic.

---

### Section 5 — Data Exposure

**ImpactNotification — contact data in push notification payload:**

`ImpactNotification` bundles `email` and `mobile` (phone number) alongside `driver_name`, `unit_name`, `manufacturer_name`, `company_name`, `impact_time`, and `subscription_name` into a single object. This object appears to represent the payload assembled for a push/email notification about a forklift impact event. The concern is that `email` and `mobile` are operator PII (contact identifiers). If this object is ever serialized to JSON and returned directly via a REST endpoint (rather than being consumed internally as a notification dispatch DTO), those contact details would be exposed to any caller who can trigger the endpoint. Even if used only internally, the object conflates notification routing data (email, mobile) with content data in a single serializable structure, making it harder to enforce that routing fields are never leaked outward.

**B19-3** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/ImpactNotification.java:17-18`
**Description:** `ImpactNotification` includes operator PII fields `email` and `mobile` directly in the notification model. If this model is ever serialized to a REST response (or logged), operator contact details are exposed. Notification routing fields (email address, mobile number) should be separated from the notification content payload so they cannot accidentally be included in API responses or audit logs.
**Evidence:**
```java
private String email;
private String mobile;
```

**Incidents — raw binary biometric/evidence data exposed with no exclusion annotation:**

`Incidents` exposes `byte[]` fields `signature` and `image` via public getters with no `@JsonIgnore` or equivalent exclusion. In a REST context, Jackson will serialize these fields as Base64-encoded strings. Depending on field size, this could represent:
- Large binary payloads returned to every API caller requesting incident records, regardless of whether they need the image/signature data.
- Biometric-adjacent data (handwritten signatures) being returned in list endpoints that may not intend to include raw binary.

There is no `@JsonIgnore` or `@JsonProperty(access = JsonProperty.Access.WRITE_ONLY)` on either field.

**B19-4** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Incidents.java:13-14`
**Description:** The `signature` and `image` fields are `byte[]` with public getters and no `@JsonIgnore` annotation. Jackson will serialize both as Base64 strings in any JSON response. Signature data is biometric-adjacent PII. These fields should be excluded from list/summary endpoint responses and only included when explicitly requested. Without `@JsonIgnore` or a separate DTO/projection, any endpoint returning `Incidents` objects will leak raw binary evidence data.
**Evidence:**
```java
private byte[] signature;
private byte[] image;
```

**Incidents — raw internal numeric IDs exposed in API surface:**

`driver_id` and `unit_id` are raw integer foreign-key IDs from the internal database schema. These are returned via public getters without masking or scoping. If `Incidents` is used directly as a REST response body, callers receive internal database identifiers that could be used to enumerate drivers or units via other endpoints (IDOR amplification).

**B19-5** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Incidents.java:21-22`
**Description:** Raw internal database foreign-key identifiers `driver_id` and `unit_id` are exposed via public getters with no masking. If returned in API responses, these sequential integer IDs enable enumeration of drivers and forklift units across the system, amplifying any IDOR vulnerability present in other endpoints.
**Evidence:**
```java
private int driver_id;
private int unit_id;
```

**Incidents — witness field is unstructured free-text PII:**

The `witness` field is a free-text String with no validation constraint or length limit at the model level. In a safety-incident context, this field likely contains the name (and potentially contact details) of a third-party witness — PII that is unstructured and unbounded.

**B19-6** — LOW
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Incidents.java:16`
**Description:** The `witness` field is an unbounded free-text String that likely contains third-party PII (witness names, potentially contact details). It is exposed via a public getter with no length constraint or `@JsonIgnore`. In incident list endpoints this PII will be included in every response row.
**Evidence:**
```java
private String witness;
```

**ImpactNotification — `driver_name` included in notification model:**

`driver_name` is operator PII included in the notification payload. Combined with `company_name`, `unit_name`, and `impact_time`, this data creates a linkable record (named individual + employer + asset + timestamp) inside a notification DTO. If this model is logged at INFO level (plausible given it is a notification dispatch object), operator identity is written to logs.

**B19-7** — LOW
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/ImpactNotification.java:11`
**Description:** `driver_name` (operator PII) is included in `ImpactNotification` alongside `company_name`, `unit_name`, and `impact_time`. If this object is logged (e.g., via Lombok `@Data`-generated `toString()`) at INFO or DEBUG level during notification dispatch, operator identity linked to a safety event will appear in production logs.
**Evidence:**
```java
private String driver_name;
// ...combined with:
private String company_name;
private String impact_time;
```

**Manufacturer — CLEAR:** Manufacturer exposes only `id` (internal integer) and `name` (manufacturer name). No PII. No sensitive internal data beyond the numeric ID, which is low-risk for a reference data table.

---

### Section 6 — Dependencies

**N/A** — Model class files; dependency analysis requires `pom.xml` review, out of scope for these files.

---

### Section 7 — Build and CI

**N/A** — Model class files; build and CI analysis requires `pom.xml` and pipeline configuration review, out of scope for these files.

---

## Summary of Findings

| ID | Severity | Section | File | Short Description |
|----|----------|---------|------|-------------------|
| B19-1 | MEDIUM | 3 — Input Validation | ImpactNotification.java:17-18 | No Bean Validation on `email` / `mobile` fields |
| B19-2 | LOW | 3 — Deserialization | Incidents.java:5 | Serializable with `byte[]` fields, no readObject guard |
| B19-3 | HIGH | 5 — Data Exposure | ImpactNotification.java:17-18 | Operator PII (email, mobile) in notification model, risk of API/log leakage |
| B19-4 | HIGH | 5 — Data Exposure | Incidents.java:13-14 | Binary signature and image fields have no @JsonIgnore; biometric-adjacent PII in all responses |
| B19-5 | MEDIUM | 5 — Data Exposure | Incidents.java:21-22 | Raw internal DB foreign-key IDs (driver_id, unit_id) exposed, enabling enumeration |
| B19-6 | LOW | 5 — Data Exposure | Incidents.java:16 | Unstructured witness PII field, no length constraint, no exclusion annotation |
| B19-7 | LOW | 5 — Data Exposure | ImpactNotification.java:11 | driver_name + company_name + impact_time linkable in logs via Lombok toString() |
