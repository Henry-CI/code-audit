# Pass 1 Security Review — Agent B27
**Date:** 2026-02-27
**Branch:** master
**Scope:** DriverService, DriverAlreadyExistException, DriverServiceException

---

## Section 1 — Reading Evidence

### 1.1 `com.journaldev.spring.jdbc.service.DriverAlreadyExistException`

**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverAlreadyExistException.java`

- **Fully qualified class name:** `com.journaldev.spring.jdbc.service.DriverAlreadyExistException`
- **Extends:** `DriverServiceException`
- **Implements:** (none beyond RuntimeException chain)
- **Annotations on class:** (none)
- **Fields:** (none declared)
- **Public methods:**

| Line | Return type | Name | Parameters | Annotations |
|------|-------------|------|------------|-------------|
| 5 | — (constructor) | `DriverAlreadyExistException` | `String message` | none |
| 9 | — (constructor) | `DriverAlreadyExistException` | `String message, Throwable cause` | none |

---

### 1.2 `com.journaldev.spring.jdbc.service.DriverServiceException`

**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverServiceException.java`

- **Fully qualified class name:** `com.journaldev.spring.jdbc.service.DriverServiceException`
- **Extends:** `RuntimeException`
- **Implements:** (none beyond RuntimeException chain)
- **Annotations on class:** (none)
- **Fields:** (none declared)
- **Public methods:**

| Line | Return type | Name | Parameters | Annotations |
|------|-------------|------|------------|-------------|
| 5 | — (constructor) | `DriverServiceException` | `String message` | none |
| 9 | — (constructor) | `DriverServiceException` | `String message, Throwable cause` | none |

---

### 1.3 `com.journaldev.spring.jdbc.service.DriverService`

**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java`

- **Fully qualified class name:** `com.journaldev.spring.jdbc.service.DriverService`
- **Extends:** (none)
- **Implements:** (none)
- **Annotations on class:** `@Slf4j`, `@Service`, `@Transactional`

**Fields:**

| Access modifier | Type | Name | Annotations |
|-----------------|------|------|-------------|
| `private static final` | `CharacterRule[]` | `PASSWORD_GEN_RULES` | none |
| `private static final` | `int` | `PASSWORD_LENGTH` | none |
| `private` | `UserDAO` | `userDAO` | `@Autowired` |
| `private` | `CompanyDAO` | `companyDAO` | `@Autowired` |
| `private` | `Configuration` | `configuration` | `@Autowired` |
| `private` | `DriverDAO` | `driverDAO` | `@Autowired` |

**Public methods:**

| Line | Return type | Name | Parameters | Annotations |
|------|-------------|------|------------|-------------|
| 52 | `Optional<Driver>` | `authenticate` | `String email, String password` | `@Deprecated` |
| 66 | `Driver` | `registerDriver` | `Driver driver` | none |
| 99 | `void` | `resetPassword` | `Driver driver` | none (throws `DriverServiceException`) |

**Private methods:**

| Line | Return type | Name | Parameters |
|------|-------------|------|------------|
| 119 | `String` | `generateRandomPassword` | (none) |

**Static imports:**
- `com.journaldev.spring.jdbc.model.Roles.RoleId.ROLE_COMPANY_GROUP`

---

## Section 2 — Checklist Review

### Section 1: Secrets and Configuration

**Finding B27-1 (below) — hardcoded credentials in pom.xml `local` profile.**

**Finding B27-2 (below) — hardcoded credentials in pom.xml `uat` profile.**

**Finding B27-3 (below) — hardcoded OAuth2 client secret in spring-security.xml.**

**Finding B27-4 (below) — hardcoded credentials committed in environment property files.**

**Finding B27-5 (below) — hardcoded HTTP repository URL (non-TLS) in pom.xml.**

**Finding B27-6 (below) — hardcoded Cognito API credentials in committed environment files.**

All other Section 1 items: covered in findings below.

---

### Section 2: Authentication and Authorization

**Finding B27-7 (below) — DriverService has no organisation-scoping: `registerDriver` and `resetPassword` accept any caller's `Driver` object without verifying the caller's organisation matches the driver's organisation.**

**Finding B27-8 (below) — `authenticate()` endpoint (`/rest/appuser/validate`) is marked `@Deprecated` but remains reachable and protected only by an OAuth bearer token with any of four valid roles, allowing any authenticated user of any organisation to validate any other driver's credentials.**

**Finding B27-9 (below) — `resetPassword` has no caller identity check: any authenticated bearer token holder can trigger a password reset for any email address in the database.**

**Finding B27-10 (below) — `access-token-validity="0"` on client `987654321` means that client's access tokens never expire.**

---

### Section 3: Input Validation and Injection

**Finding B27-11 (below) — `DriverService.resetPassword()` and `registerDriver()` pass `Driver` object fields (email, password, name) to DAO methods without any input validation layer (`@Valid`, size constraints, pattern constraints) at the service level.**

**Finding B27-12 (below) — passwords are stored using MD5 in DriverDAOImpl (confirmed by SQL `md5(?)` and `password-encoder hash="md5"` in spring-security.xml); DriverService calls `companyDAO.save(company, driverId, driver.getEmail(), driver.getPassword())` passing the cleartext password into a DAO that hashes it with MD5, which is a broken algorithm for password storage.**

No command injection, SSRF, XXE, path traversal, or Java deserialization patterns observed in the three assigned files. CLEAR for those sub-items within the scope of these files.

---

### Section 4: Session and CSRF

CSRF: The application uses OAuth2 bearer tokens with `create-session="never"`, which is the standard stateless API pattern. CSRF token protection is not applicable to stateless bearer-token APIs. CLEAR.

CORS: No `@CrossOrigin` annotations on `DriverService` or the exception classes. Not applicable to these three files specifically. CLEAR for assigned scope.

Security headers (X-Frame-Options, etc.): Not configured in `web.xml` or `spring-security.xml` — this is a broader application finding outside the three assigned files but noted for completeness. N/A for assigned files.

---

### Section 5: Data Exposure

**Finding B27-13 (below) — `DriverAlreadyExistException` message includes the driver's email address.**

**Finding B27-14 (below) — `DriverServiceException` in `authenticate()` includes the driver's email address in the message.**

**Finding B27-15 (below) — `DriverServiceException` in `resetPassword()` includes the driver's email address in the message.**

**Finding B27-16 (below) — `resetPassword()` logs the generated plaintext temporary password to the INFO log level before sending email.**

**Finding B27-17 (below) — `registerDriver()` and the `getLoginAuth()` caller log the full serialised `Driver` object via `gson.toJson(driverExample)` at INFO level, including `password` field.**

---

### Section 6: Dependencies

**Finding B27-18 (below) — Spring Framework 3.2.14.RELEASE is severely end-of-life.**

**Finding B27-19 (below) — Spring Security 3.1.1.RELEASE is severely end-of-life with known CVEs.**

**Finding B27-20 (below) — spring-security-oauth2 1.0.0.RELEASE is end-of-life.**

**Finding B27-21 (below) — jackson-databind 2.6.7 is affected by multiple high-severity CVEs.**

**Finding B27-22 (below) — commons-fileupload 1.3.1 is vulnerable to CVE-2016-1000031 (remote code execution via file upload).**

**Finding B27-23 (below) — Splunk repository fetched over HTTP (not HTTPS).**

---

### Section 7: Build and CI

No `bitbucket-pipelines.yml` found in the repository. CI pipeline existence cannot be verified; no evidence that tests are executed before deployment. N/A for pipeline-specific checks; noted as gap.

`pom.xml` has `-Xlint:all` configured with `showWarnings=true` and `showDeprecation=true`. CLEAR.

---

## Section 3 — Findings

---

**B27-1** — CRITICAL
**Section:** 1 — Secrets and Configuration
**File:** `pom.xml:29-30`
**Description:** Hardcoded PostgreSQL database credentials in the `local` Maven profile. Username `postgres` and password `gmtp-postgres` are committed to version control. Any developer or CI agent with repository read access has these credentials.
**Evidence:**
```xml
<flyway.user>postgres</flyway.user>
<flyway.password>gmtp-postgres</flyway.password>
```

---

**B27-2** — CRITICAL
**Section:** 1 — Secrets and Configuration
**File:** `pom.xml:76`
**Description:** Hardcoded PostgreSQL credentials in the `uat` Maven profile committed to version control. Username `dev_admin` and password `C!1admin` for the UAT RDS instance at `forkliftiq360.cmjwsurtk4tn.us-east-1.rds.amazonaws.com`.
**Evidence:**
```xml
<flyway.user>dev_admin</flyway.user>
<flyway.password>C!1admin</flyway.password>
```

---

**B27-3** — CRITICAL
**Section:** 1 — Secrets and Configuration
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:113-117`
**Description:** Two OAuth2 client secrets are hardcoded in the Spring Security XML configuration file, which is committed to version control. Any party with repository access can use these credentials to obtain bearer tokens and call all API endpoints.
**Evidence:**
```xml
<oauth:client client-id="987654321" ... secret="8752361E593A573E86CA558FFD39E" .../>
<oauth:client client-id="fleetiq360" ... secret="rihah8eey4faibuengaixo6leiL1awii" .../>
```

---

**B27-4** — CRITICAL
**Section:** 1 — Secrets and Configuration
**File:** `environment.dev.properties:15-16`, `environment.uat.properties:15-16`, `environment.prod.properties:15-16`
**Description:** The Cognito API username and password are hardcoded and committed to version control in all three environment property files. The same weak credential pair (`ciiadmin` / `ciiadmin`) is used across dev, UAT, and prod environments.
**Evidence:**
```
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```

---

**B27-5** — HIGH
**Section:** 1 — Secrets and Configuration
**File:** `pom.xml:88-89`
**Description:** The Splunk JFrog Artifactory repository is configured over plain HTTP (`http://splunk.jfrog.io/...`). Dependency artifacts fetched over HTTP are susceptible to man-in-the-middle attacks that could substitute a malicious JAR for a legitimate one. All Maven repository URLs must use HTTPS.
**Evidence:**
```xml
<url>http://splunk.jfrog.io/splunk/ext-releases-local</url>
```

---

**B27-6** — HIGH
**Section:** 1 — Secrets and Configuration
**File:** `environment.dev.properties:14-16`
**Description:** The Cognito API credentials in the committed property files are identical across dev, UAT, and prod (`ciiadmin`/`ciiadmin`), indicating no environment separation for this credential. Additionally the prod property file (`environment.prod.properties`) is tracked in git. Secret values should be injected at deployment time via environment variables or a secrets manager, not committed to source control.
**Evidence:**
```
cognitoAPIPort=9090
cognitoAPIUsername=ciiadmin
cognitoAPIPassword=ciiadmin
```
(Identical across all three committed files.)

---

**B27-7** — CRITICAL
**Section:** 2 — Authentication and Authorization
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:66-97`
**Description:** `registerDriver()` and `resetPassword()` perform no organisation-scoping. The caller supplies a `Driver` object with an arbitrary email address; the service does not extract the authenticated principal's organisation from the security context and does not verify that the email address being registered or reset belongs to the caller's organisation. A bearer token holder for organisation A can therefore register a driver under organisation B's company, or trigger a password reset for any email address known to exist in the system.
**Evidence:**
```java
public Driver registerDriver(Driver driver) {
    if (driverDAO.isDriverExist(driver.getEmail())) {
        throw new DriverAlreadyExistException("Driver already exist in database with : " + driver.getEmail());
    } else {
        int driverId = driverDAO.save(driver);
        // No check: does SecurityContextHolder.getContext().getAuthentication() belong to driver.getComp_id()?
        if (driver.isContactperson()) {
            ...
            int compId = companyDAO.save(company, driverId, driver.getEmail(), driver.getPassword());
        }
        ...
    }
}

public void resetPassword(Driver driver) throws DriverServiceException {
    // No check: is the caller authorised to reset this email address?
    driverDAO.updatePassword(driver.getEmail(), pass);
}
```

---

**B27-8** — HIGH
**Section:** 2 — Authentication and Authorization
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:52-64`
**Description:** The `authenticate()` method is marked `@Deprecated` but remains reachable via `POST /rest/appuser/validate` in `DriverController`. The Spring Security configuration grants any bearer token holder with roles `ROLE_DRIVER`, `ROLE_COMPANY_GROUP`, `ROLE_SYS_ADMIN`, or `ROLE_CLIENT` access to all `/rest/**` endpoints. There is no further role or organisation check inside `authenticate()`, so any authenticated user of any organisation can attempt to validate credentials for drivers in other organisations.
**Evidence:**
```java
@Deprecated
public Optional<Driver> authenticate(String email, String password) {
    Driver driver = driverDAO.findByEmailAndPassword(email, password).orElse(null);
    // No organisation scoping
    return Optional.ofNullable(driver);
}
```

---

**B27-9** — CRITICAL
**Section:** 2 — Authentication and Authorization
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:99-117`
**Description:** `resetPassword()` accepts any email address in the `Driver` request body and immediately generates and stores a new password and emails it, with no verification that: (a) the authenticated caller is the driver whose password is being reset, or (b) the driver belongs to the caller's organisation. This is an unauthenticated password reset primitive — any bearer token holder can reset any driver's password by supplying that driver's email address.
**Evidence:**
```java
public void resetPassword(Driver driver) throws DriverServiceException {
    log.debug("Start resetPassword for {}", driver.getEmail());
    try {
        String pass = generateRandomPassword();
        driverDAO.updatePassword(driver.getEmail(), pass);    // No identity or org check
        String msg = "Your ForkliftIQ360 Account Password is reset to " + pass;
        ...
        SendEmail.sendMail(configuration.getPassResetSubject(), msg, email);
    }
}
```

---

**B27-10** — HIGH
**Section:** 2 — Authentication and Authorization
**File:** `src/main/webapp/WEB-INF/spring/spring-security.xml:113`
**Description:** The OAuth2 client `987654321` is configured with `access-token-validity="0"`. In Spring Security OAuth2 1.x, a value of `0` means the token never expires. Access tokens issued to this client are permanently valid and cannot be invalidated without revoking the token from the token store. This dramatically increases the impact of any token compromise.
**Evidence:**
```xml
<oauth:client client-id="987654321" authorized-grant-types="password,authorization_code,implicit"
              secret="8752361E593A573E86CA558FFD39E" authorities="ROLE_CLIENT" scope="read,write"
              access-token-validity="0"/>
```

---

**B27-11** — HIGH
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:66-97`
**Description:** `registerDriver()` and `resetPassword()` perform no input validation on the `Driver` object's fields before passing them to DAO methods. There are no `@Valid` annotations, no length checks, and no pattern constraints on email, name, phone, or password fields at the service level. The `Driver` model class carries no JSR-303 constraint annotations (`@NotNull`, `@Size`, `@Email`, `@Pattern`). Excessively long strings, null fields, or malformed email addresses can reach the database layer, potentially causing unexpected behaviour or denial of service.
**Evidence:**
```java
public Driver registerDriver(Driver driver) {
    if (driverDAO.isDriverExist(driver.getEmail())) { // email unchecked
        ...
    } else {
        int driverId = driverDAO.save(driver);         // all fields passed unchecked
        ...
        int compId = companyDAO.save(company, driverId, driver.getEmail(), driver.getPassword()); // unchecked
    }
}
```

---

**B27-12** — HIGH
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/DAO/DriverDAOImpl.java:55`, `src/main/webapp/WEB-INF/spring/spring-security.xml:74`
**Description:** Passwords are stored using MD5 (`md5(?)` in SQL and `<password-encoder hash="md5"/>` in Spring Security configuration). MD5 is a broken cryptographic hash function; it is not a password hashing algorithm (no salt, no work factor). Operator password hashes are trivially reversible using precomputed rainbow tables. This is directly observable from the `DriverService.registerDriver()` call path: the plaintext password flows from the request body through `driverDAO.save()` where it is hashed with `md5(?)`. DriverService is the originating service for this call chain.
**Evidence (SQL in DriverDAOImpl.java:55):**
```java
sql = "insert into driver (id, first_name,last_name,email,password,...) values (?,?,?,?,md5(?),now(),true,?,?)";
```
**Evidence (spring-security.xml:74):**
```xml
<password-encoder hash="md5"/>
```

---

**B27-13** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:69`
**Description:** The `DriverAlreadyExistException` message includes the driver's email address verbatim. If this exception message is ever serialised into an API response (e.g., by a generic exception handler returning `e.getMessage()`), it leaks PII (the email address) and confirms to a caller that a specific email address is registered in the system — enabling account enumeration.
**Evidence:**
```java
throw new DriverAlreadyExistException("Driver already exist in database with : " + driver.getEmail());
```

---

**B27-14** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:59`
**Description:** The `DriverServiceException` thrown from `authenticate()` includes the driver's email address in the message. If propagated to a client or into a log aggregator accessible to non-privileged users, this constitutes PII exposure.
**Evidence:**
```java
throw new DriverServiceException("Unable to update last login time for the driver " + email, e);
```

---

**B27-15** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:115`
**Description:** The `DriverServiceException` thrown from `resetPassword()` includes the driver's email address in the message. Same risk as B27-14.
**Evidence:**
```java
throw new DriverServiceException("Unable to reset password for given driver email " + driver.getEmail(), e);
```

---

**B27-16** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/service/DriverService.java:110`
**Description:** `resetPassword()` logs the email address using string concatenation at INFO level (`log.info("Start Sending Email to " + email)`). More critically, the generated temporary plaintext password `pass` is embedded in the email body string `msg` at line 108 but that string is not logged directly — however, the pattern here is fragile. Any change that accidentally logs `msg` instead of `email` would expose a plaintext credential in the log stream. Additionally, the use of string concatenation rather than SLF4J parameterised logging (`{}`) prevents lazy evaluation and risks exposing the concatenated string in other logging contexts.
**Evidence:**
```java
String msg = "Your ForkliftIQ360 Account Password is reset to " + pass;
String email = driver.getEmail();
log.info("Start Sending Email to " + email);   // string concat, not parameterised
SendEmail.sendMail(configuration.getPassResetSubject(), msg, email);
log.info("Finish Sending Email to " + email);  // string concat, not parameterised
```

---

**B27-17** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/controller/DriverController.java:60`, `78`, `92`
**Description:** `DriverController` logs the full `Driver` object serialised as JSON via `gson.toJson(driver)` at INFO level for `getLoginAuth`, `registerDrivers`, and `resetPassword` endpoints. The `Driver` model contains a `password` field. Because `gson.toJson()` serialises all fields by default (no `@Expose` filtering, no exclusion strategy configured), the plaintext password supplied by the caller is written to the application log at INFO level. Note: this finding is in `DriverController` but is directly triggered by the `DriverService` methods under review, and the `Driver` model used is the same object passed into `DriverService`.
**Evidence:**
```java
log.info("Start getLoginAuth." + " : " + gson.toJson(driverExample));   // includes password field
log.info("Start registerDrivers."  + " : " + gson.toJson(driver));       // includes password field
log.info("ResetPassword:"  + " : " + gson.toJson(driver));               // includes password field
```
**Driver model field (Driver.java:25):**
```java
private String password;
```

---

**B27-18** — CRITICAL
**Section:** 6 — Dependencies
**File:** `pom.xml:12`
**Description:** Spring Framework 3.2.14.RELEASE reached end-of-life in December 2016. It is affected by numerous CVEs including CVE-2018-1270 (remote code execution via STOMP messaging), CVE-2018-1275, and CVE-2022-22965 (Spring4Shell, RCE). No security patches are available for this version.
**Evidence:**
```xml
<org.springframework-version>3.2.14.RELEASE</org.springframework-version>
```

---

**B27-19** — CRITICAL
**Section:** 6 — Dependencies
**File:** `pom.xml:230-237`
**Description:** Spring Security 3.1.1.RELEASE is severely end-of-life (EOL 2016) and is affected by multiple CVEs including CVE-2018-1199 (authentication bypass) and CVE-2014-3625 (path traversal). The version in use predates critical security fixes present in the 3.2.x and 4.x lines.
**Evidence:**
```xml
<groupId>org.springframework.security</groupId>
<artifactId>spring-security-web</artifactId>
<version>3.1.1.RELEASE</version>
...
<artifactId>spring-security-config</artifactId>
<version>3.1.1.RELEASE</version>
```

---

**B27-20** — HIGH
**Section:** 6 — Dependencies
**File:** `pom.xml:238-242`
**Description:** `spring-security-oauth2` version 1.0.0.RELEASE is the initial release of the library (circa 2012) and is end-of-life. It predates fixes for CVE-2019-3778 (open redirect in OAuth2 endpoint) and other vulnerabilities. The OAuth2 specification has also evolved considerably since this version.
**Evidence:**
```xml
<groupId>org.springframework.security.oauth</groupId>
<artifactId>spring-security-oauth2</artifactId>
<version>1.0.0.RELEASE</version>
```

---

**B27-21** — HIGH
**Section:** 6 — Dependencies
**File:** `pom.xml:98-101`
**Description:** `jackson-databind` 2.6.7 is affected by multiple high and critical CVEs including CVE-2017-7525, CVE-2017-17485, CVE-2018-5968, CVE-2019-14379, and others (polymorphic deserialization gadget chains). These allow remote code execution when default typing is enabled or when attacker-controlled JSON is deserialised.
**Evidence:**
```xml
<artifactId>jackson-databind</artifactId>
<version>2.6.7</version>
```

---

**B27-22** — CRITICAL
**Section:** 6 — Dependencies
**File:** `pom.xml:199-202`
**Description:** `commons-fileupload` 1.3.1 is affected by CVE-2016-1000031, a remote code execution vulnerability via a crafted `Content-Type` header during file upload. `DriverController.uploadProfile()` and `uploadProfileAPP()` use multipart file upload. This dependency is in `compile` scope and is directly exercised by controller endpoints in this application.
**Evidence:**
```xml
<groupId>commons-fileupload</groupId>
<artifactId>commons-fileupload</artifactId>
<version>1.3.1</version>
```

---

**B27-23** — MEDIUM
**Section:** 6 — Dependencies
**File:** `pom.xml:86-90`
**Description:** The Splunk JFrog Artifactory repository is declared using a plain HTTP URL. Maven fetches dependency artifacts and checksums over this insecure channel, making it possible for a network-positioned attacker to substitute a malicious artifact without detection (dependency confusion / MITM supply chain attack).
**Evidence:**
```xml
<repository>
    <id>splunk-artifactory</id>
    <name>Splunk Releases</name>
    <url>http://splunk.jfrog.io/splunk/ext-releases-local</url>
</repository>
```

---

## Summary Table

| ID | Severity | Section | Short description |
|----|----------|---------|-------------------|
| B27-1 | CRITICAL | 1 — Secrets | Hardcoded DB password in `local` pom.xml profile |
| B27-2 | CRITICAL | 1 — Secrets | Hardcoded UAT RDS credentials in pom.xml |
| B27-3 | CRITICAL | 1 — Secrets | Hardcoded OAuth2 client secrets in spring-security.xml |
| B27-4 | CRITICAL | 1 — Secrets | Cognito API credentials committed in all env property files |
| B27-5 | HIGH | 1 — Secrets | Splunk Artifactory repository URL is HTTP (non-TLS) |
| B27-6 | HIGH | 1 — Secrets | Identical weak Cognito credentials across all environments in tracked files |
| B27-7 | CRITICAL | 2 — AuthZ | No organisation scoping in `registerDriver()` or `resetPassword()` |
| B27-8 | HIGH | 2 — AuthZ | Deprecated `authenticate()` still reachable, no org scoping |
| B27-9 | CRITICAL | 2 — AuthZ | `resetPassword()` allows any bearer token holder to reset any driver's password |
| B27-10 | HIGH | 2 — AuthZ | OAuth2 client `987654321` has non-expiring access tokens (`validity="0"`) |
| B27-11 | HIGH | 3 — Injection | No input validation on `Driver` fields in service layer |
| B27-12 | HIGH | 3 — Injection | Passwords stored with MD5 (no salt, no work factor) |
| B27-13 | MEDIUM | 5 — Data Exposure | `DriverAlreadyExistException` includes driver email — account enumeration |
| B27-14 | MEDIUM | 5 — Data Exposure | `DriverServiceException` from `authenticate()` includes driver email |
| B27-15 | MEDIUM | 5 — Data Exposure | `DriverServiceException` from `resetPassword()` includes driver email |
| B27-16 | HIGH | 5 — Data Exposure | Fragile logging pattern adjacent to plaintext password in `resetPassword()` |
| B27-17 | HIGH | 5 — Data Exposure | Full `Driver` JSON (including `password` field) logged at INFO level in controller |
| B27-18 | CRITICAL | 6 — Dependencies | Spring Framework 3.2.14.RELEASE — EOL, multiple RCE CVEs |
| B27-19 | CRITICAL | 6 — Dependencies | Spring Security 3.1.1.RELEASE — EOL, authentication bypass CVEs |
| B27-20 | HIGH | 6 — Dependencies | spring-security-oauth2 1.0.0.RELEASE — EOL |
| B27-21 | HIGH | 6 — Dependencies | jackson-databind 2.6.7 — multiple RCE deserialization CVEs |
| B27-22 | CRITICAL | 6 — Dependencies | commons-fileupload 1.3.1 — CVE-2016-1000031 RCE via file upload |
| B27-23 | MEDIUM | 6 — Dependencies | Maven dependency repository served over HTTP |
