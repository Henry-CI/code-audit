# Pass 1 Security Review — Agent B14
**Date:** 2026-02-27
**Repo:** forkliftiqws (branch: master)
**Checklist:** PASS1-CHECKLIST-forkliftiq-spring.md
**Assigned files:**
- `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java`
- `src/main/java/com/journaldev/spring/jdbc/model/EmailLayout.java`
- `src/main/java/com/journaldev/spring/jdbc/model/Equipment.java`

---

## Reading Evidence

### DriverTraining.java

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.DriverTraining`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:**
- `@Data` (Lombok — generates getters, setters, equals, hashCode, toString for all fields)
- `@NoArgsConstructor` (Lombok — generates public no-arg constructor)

**Fields:**

| Access    | Type   | Name             |
|-----------|--------|------------------|
| private   | long   | serialVersionUID (static final) |
| private   | int    | id               |
| private   | int    | manufacture_id   |
| private   | int    | type_id          |
| private   | int    | fuel_type_id     |
| private   | String | training_date    |
| private   | String | expiration_date  |

**Public methods (generated by Lombok @Data):**

All getters/setters are generated by Lombok for every field listed above. No explicit public methods are declared in source. Lombok @Data also generates `equals()`, `hashCode()`, and `toString()` covering all fields.

**Explicit non-public methods:**

| Return | Name (line) | Annotations | Access |
|--------|-------------|-------------|--------|
| (constructor) | `DriverTraining(int, int, int, int, String, String)` (line 27) | `@Builder` | private |

**Unused import noted:**
- `import com.journaldev.spring.jdbc.model.Roles.RolesBuilder;` — imported but not used (line 6)
- `import java.util.Date;` — imported but not used (line 4)

---

### EmailLayout.java

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.EmailLayout`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:** None

**Fields:**

| Access  | Type   | Name             |
|---------|--------|------------------|
| private | long   | serialVersionUID (static final) |
| private | int    | id               |
| private | String | subject          |
| private | String | message          |
| private | String | type             |

**Public methods:**

| Return | Name (line) | Annotations |
|--------|-------------|-------------|
| int    | `getId()` (line 17) | None |
| void   | `setId(int id)` (line 20) | None |
| String | `getSubject()` (line 23) | None |
| void   | `setSubject(String subject)` (line 26) | None |
| String | `getMessage()` (line 29) | None |
| void   | `setMessage(String message)` (line 32) | None |
| String | `getType()` (line 35) | None |
| void   | `setType(String type)` (line 38) | None |

No constructor explicitly declared (uses implicit public no-arg constructor).

---

### Equipment.java

**Fully qualified class name:** `com.journaldev.spring.jdbc.model.Equipment`

**Interfaces implemented / classes extended:**
- `implements java.io.Serializable`

**Class-level annotations:**
- `@Data` (Lombok — generates getters, setters, equals, hashCode, toString for all fields)
- `@NoArgsConstructor` (Lombok — generates public no-arg constructor)

**Fields:**

| Access  | Type    | Name              |
|---------|---------|-------------------|
| private | long    | serialVersionUID (static final) |
| private | int     | id                |
| private | String  | name              |
| private | int     | type_id           |
| private | int     | comp_id           |
| private | boolean | active            |
| private | int     | manu_id           |
| private | int     | fuel_type_id      |
| private | int     | attachment_id     |
| private | String  | type              |
| private | String  | manu              |
| private | String  | fuel_type         |
| private | String  | comp              |
| private | String  | serial_no         |
| private | String  | mac_address       |
| private | String  | url               |
| private | long    | impact_threshold  |
| private | boolean | alert_enabled     |
| private | boolean | driver_based      |

**Public methods (generated by Lombok @Data):**

All getters/setters generated by Lombok for every field above. Lombok also generates `equals()`, `hashCode()`, and `toString()` covering all fields including `serial_no`, `mac_address`, and `url`.

**Explicit methods:**

| Return | Name (line) | Annotations | Access |
|--------|-------------|-------------|--------|
| (constructor) | `Equipment(int, String, int, int, boolean, int, int, int, String, String, String, String, String, String, String, long, boolean, boolean)` (line 34) | `@Builder` | public |

---

## Checklist Review

### Section 1 — Secrets and Configuration

N/A for these model files. No configuration, credentials, database URLs, API keys, or hardcoded secrets are present in any of the three files.

**Result: N/A**

---

### Section 2 — Authentication and Authorization

N/A for model classes. No Spring Security annotations, no endpoint mapping, no role checks.

**Result: N/A**

---

### Section 3 — Input Validation and Injection

**3a. Bean Validation constraints:**

None of the three model classes carry any JSR-303/JSR-380 Bean Validation annotations (`@NotNull`, `@NotBlank`, `@Size`, `@Pattern`, `@Min`, `@Max`, `@Email`, etc.) on any field.

- `DriverTraining`: `training_date` and `expiration_date` are plain `String` fields. No format constraint (e.g., `@Pattern`) enforces a valid date format. If these values are user-supplied and reach a DAO layer via these fields, no model-layer validation will catch malformed input.
- `EmailLayout`: `subject` and `message` are unbounded `String` fields with no `@Size` constraint. `message` in particular could carry arbitrarily large content with no limit enforced at the model level.
- `Equipment`: `serial_no`, `mac_address`, and `url` are plain `String` fields. No `@Pattern` or `@URL` constraint validates format. `url` in particular is a raw URL string with no whitelist validation at the model level (SSRF surface if used in outbound HTTP calls).

**Finding:** See B14-1, B14-2, B14-3.

**3b. Deserialization — @JsonTypeInfo / Jackson default typing:**

No `@JsonTypeInfo` annotation is present on any of the three classes. No Jackson polymorphic type annotations are used. No `ObjectInputStream.readObject()` call is present.

All three classes implement `java.io.Serializable` (see Section 3c below).

**Result:** No Jackson default typing issue found. CLEAR.

**3c. Java Serialization (`implements Serializable`):**

All three model classes implement `java.io.Serializable`. This is low risk in a Spring MVC REST context where JSON serialization (Jackson) is the transport mechanism, not Java object serialization. However, if these objects are ever placed in an HTTP session, cached via Java serialization, or passed over an RMI or JMX channel, the serialized form becomes an attack surface.

`DriverTraining` and `Equipment` use Lombok `@Builder` with `@Data`. The Lombok-generated `toString()` will include all fields (including sensitive ones — see Section 5).

**Finding:** See B14-4 (informational).

**3d. SQL injection, command injection, XXE, path traversal, SSRF:**

No SQL, file I/O, HTTP client calls, XML parsing, or command execution is present in these model files. These concerns apply to DAO/service/controller layers, not to these model classes directly.

**Result: N/A for these files.**

---

### Section 4 — Session and CSRF

N/A for model classes. No session handling, CORS configuration, or security headers are configured here.

**Result: N/A**

---

### Section 5 — Data Exposure

**5a. DriverTraining — training/certification PII in API responses:**

`DriverTraining` carries training certification records. While the fields themselves are primarily foreign-key IDs (`manufacture_id`, `type_id`, `fuel_type_id`) and date strings (`training_date`, `expiration_date`), the class has no `@JsonIgnore` or `@JsonProperty(access = JsonProperty.Access.READ_ONLY)` annotations. Because Lombok `@Data` generates public getters for every field, all fields — including the raw date strings and all FK IDs — will be serialized by Jackson into every API response that returns this object.

There is no `@JsonIgnoreProperties` on the class and no custom serializer. If the API response should exclude internal FK fields (`manufacture_id`, `type_id`, `fuel_type_id`) from client responses (since these are internal DB reference IDs, not meaningful to API consumers), there is no mechanism in place to do so.

**Finding:** See B14-5.

**5b. Equipment — serial number, MAC address, and URL exposure:**

`Equipment` carries `serial_no`, `mac_address`, and `url` fields. All three are exposed publicly by Lombok-generated getters and will appear in every Jackson-serialized API response. Specifically:

- `serial_no`: Equipment serial numbers are operationally sensitive identifiers. Exposing them in list endpoints (e.g., "get all equipment for a site") enables asset enumeration.
- `mac_address`: Hardware MAC addresses are network-layer identifiers. Exposing them in an API response is unnecessary for typical client consumption and reveals network infrastructure detail.
- `url`: This field appears to hold a device/telemetry endpoint URL. Exposing raw internal endpoint URLs to clients reveals internal network topology.

None of these fields carry `@JsonIgnore` or any access restriction.

**Finding:** See B14-6.

**5c. Equipment — Lombok toString() includes sensitive fields:**

Lombok `@Data` generates a `toString()` method that includes all fields. If an `Equipment` object is ever logged (e.g., `logger.debug("equipment: {}", equipment)`), the log line will contain `serial_no`, `mac_address`, and `url` in plaintext. The checklist explicitly calls out logging of forklift serial numbers and site data as a concern.

**Finding:** See B14-7.

**5d. EmailLayout — message field exposure:**

`EmailLayout.message` contains the body of system email messages. If email templates contain PII (e.g., operator names, site names, or alert details embedded in the template) and `EmailLayout` objects are returned in API responses without filtering, template content would be exposed. The field is unbounded and carries no content restriction.

**Finding:** See B14-8 (low/informational).

**5e. Error responses and exception handlers:**

Not present in these model files. N/A.

---

### Section 6 — Dependencies

N/A for model classes. No dependency declarations in these files.

**Result: N/A**

---

### Section 7 — Build and CI

N/A for model classes.

**Result: N/A**

---

## Findings

**B14-1** — MEDIUM
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java:23-24`
**Description:** The `training_date` and `expiration_date` fields are plain `String` with no Bean Validation constraint. There is no `@Pattern` annotation to enforce a valid date format (e.g., ISO 8601). If these strings are used in SQL queries or downstream date parsing without sanitization, malformed values will not be rejected at the model layer.
**Evidence:**
```java
private String training_date;
private String expiration_date;
```

---

**B14-2** — MEDIUM
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/EmailLayout.java:13-15`
**Description:** `subject` and `message` are unbounded `String` fields with no `@Size` constraint. An attacker supplying a request body that maps to this model can set arbitrarily large strings for either field. No maximum length is enforced at the model layer, creating a potential denial-of-service vector via oversized payloads and a risk of storing oversized content in the database.
**Evidence:**
```java
private String subject;
private String message;
private String type;
```

---

**B14-3** — MEDIUM
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Equipment.java:27-28`
**Description:** The `url` field is a plain `String` with no `@Pattern` or URL validation constraint. If this value is used to make outbound HTTP requests (telemetry endpoint, device URL), and the model is populated from a user-controlled request body, this is an SSRF surface. No whitelist or format constraint exists at the model layer to block attacker-controlled URLs such as internal network addresses (`http://169.254.169.254/`, `http://10.x.x.x/`).
**Evidence:**
```java
private String url;
```

---

**B14-4** — INFO
**Section:** 3 — Input Validation and Injection (Deserialization)
**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java:14`, `EmailLayout.java:5`, `Equipment.java:11`
**Description:** All three model classes implement `java.io.Serializable`. In a pure JSON/REST context this is low risk, but the presence of `Serializable` means these objects can be Java-serialized (e.g., into an HTTP session store or a distributed cache). If a Java deserialization channel is ever opened (session replication, JMX, RMI), these classes become part of the attack gadget surface. No `readObject()` override with validation logic is present in any class.
**Evidence:**
```java
public class DriverTraining implements Serializable { ... }
public class EmailLayout implements Serializable { ... }
public class Equipment implements Serializable { ... }
```

---

**B14-5** — MEDIUM
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java:12-35`
**Description:** `DriverTraining` carries training certification records. Lombok `@Data` generates public getters for all fields, including internal database foreign-key IDs (`manufacture_id`, `type_id`, `fuel_type_id`). No `@JsonIgnore` annotation suppresses any field from Jackson serialization. All fields — including internal FK IDs that have no meaning to API consumers — will appear in every API response that returns this object. There is no separation between the persistence model and the API response shape.
**Evidence:**
```java
@Data
@NoArgsConstructor
public class DriverTraining implements Serializable {
    private int id;
    private int manufacture_id;
    private int type_id;
    private int fuel_type_id;
    private String training_date;
    private String expiration_date;
    // No @JsonIgnore on any field
}
```

---

**B14-6** — HIGH
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Equipment.java:26-28`
**Description:** The `Equipment` model exposes `serial_no`, `mac_address`, and `url` via Lombok-generated public getters. No `@JsonIgnore` or access-restricted `@JsonProperty` annotation is applied to any of these fields. Consequently, all three values are included in every Jackson-serialized API response containing an `Equipment` object. `serial_no` enables equipment enumeration; `mac_address` discloses hardware network identifiers; `url` discloses internal device/telemetry endpoint addresses, revealing internal network topology. List endpoints that return multiple `Equipment` objects in a single response amplify this exposure.
**Evidence:**
```java
private String serial_no;
private String mac_address;
private String url;
// @Data generates public getSe rial_no(), getMac_address(), getUrl()
// No @JsonIgnore on any of these fields
```

---

**B14-7** — MEDIUM
**Section:** 5 — Data Exposure (Logging)
**File:** `src/main/java/com/journaldev/spring/jdbc/model/Equipment.java:9-10`
**Description:** Lombok `@Data` generates a `toString()` method that includes all fields of `Equipment`, including `serial_no`, `mac_address`, and `url`. If any `Equipment` instance is passed to a logger — even at DEBUG level — the resulting log line will contain hardware identifiers and internal endpoint URLs in plaintext. The checklist specifically flags logging of forklift serial numbers and site data as a concern. There is no `@ToString.Exclude` annotation on sensitive fields, and no custom `toString()` override suppressing them.
**Evidence:**
```java
@Data           // generates toString() including ALL fields
@NoArgsConstructor
public class Equipment implements Serializable {
    // ...
    private String serial_no;    // included in toString()
    private String mac_address;  // included in toString()
    private String url;          // included in toString()
    // No @ToString.Exclude on any field
}
```

---

**B14-8** — LOW
**Section:** 5 — Data Exposure
**File:** `src/main/java/com/journaldev/spring/jdbc/model/EmailLayout.java:14`
**Description:** The `message` field holds the body of system email templates. If email templates contain operator names, site-specific details, or safety alert content, returning `EmailLayout` objects in API responses without filtering exposes this content to any authenticated caller, regardless of whether the caller should have access to the template content. The field is an unbounded `String` with no content restriction or `@JsonIgnore`.
**Evidence:**
```java
private String message;

public String getMessage() {
    return message;
}
```

---

**B14-9** — INFO
**Section:** 3 — Input Validation and Injection
**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java:6-7`
**Description:** Two unused imports are present: `import com.journaldev.spring.jdbc.model.Roles.RolesBuilder;` and `import java.util.Date;`. Neither is referenced in the class body. The `Roles.RolesBuilder` import suggests a copy-paste from another model class, indicating the class may have been assembled without thorough review. This is a code quality issue rather than a direct vulnerability, but it reduces confidence in the thoroughness of the class's implementation.
**Evidence:**
```java
import java.util.Date;
import com.journaldev.spring.jdbc.model.Roles.RolesBuilder;
```

---

## Summary Table

| ID    | Severity | Section | File                  | Issue                                                      |
|-------|----------|---------|----------------------|-----------------------------------------------------------|
| B14-1 | MEDIUM   | 3       | DriverTraining.java  | No date format validation on training_date / expiration_date |
| B14-2 | MEDIUM   | 3       | EmailLayout.java     | No @Size constraint on subject / message fields            |
| B14-3 | MEDIUM   | 3       | Equipment.java       | url field lacks validation — SSRF surface                  |
| B14-4 | INFO     | 3       | All three files      | Serializable with no readObject() guard                    |
| B14-5 | MEDIUM   | 5       | DriverTraining.java  | All fields including FK IDs exposed in API responses       |
| B14-6 | HIGH     | 5       | Equipment.java       | serial_no, mac_address, url exposed in API responses       |
| B14-7 | MEDIUM   | 5       | Equipment.java       | Lombok toString() leaks serial_no, mac_address, url to logs |
| B14-8 | LOW      | 5       | EmailLayout.java     | Email template message body exposed without access control |
| B14-9 | INFO     | 3       | DriverTraining.java  | Unused imports suggest copy-paste, reduced review confidence |
