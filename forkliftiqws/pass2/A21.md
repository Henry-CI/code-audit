# A21 - Pass 2: Test Coverage Audit
**Agent:** A21
**Date:** 2026-02-27
**Scope:** Model classes - Reports, ResponseWrapper, Result

---

## Source Files Examined

| # | File |
|---|------|
| 1 | `src/main/java/com/journaldev/spring/jdbc/model/Reports.java` |
| 2 | `src/main/java/com/journaldev/spring/jdbc/model/ResponseWrapper.java` |
| 3 | `src/main/java/com/journaldev/spring/jdbc/model/Result.java` |

---

## Reading Evidence

### 1. Reports.java

**Class:** `Reports` (implements `Serializable`)
**Package:** `com.journaldev.spring.jdbc.model`
**Imports:** `java.io.Serializable`

**Constants/Fields:**
| Field | Type | Line |
|-------|------|------|
| `serialVersionUID` | `static final long` | 10 |
| `field` | `private String` | 12 |
| `object` | `private String` | 13 |
| `value` | `private String` | 14 |

**Methods:**
| Method | Signature | Line |
|--------|-----------|------|
| `getField` | `public String getField()` | 16 |
| `setField` | `public void setField(String field)` | 19 |
| `getObject` | `public String getObject()` | 22 |
| `setObject` | `public void setObject(String object)` | 25 |
| `getValue` | `public String getValue()` | 28 |
| `setValue` | `public void setValue(String value)` | 31 |

**No constructors defined** - relies on Java default no-arg constructor only.
**No `toString()`, `equals()`, or `hashCode()`** - Object defaults inherited.
**No annotations** - No Lombok, no Jackson, no validation.

---

### 2. ResponseWrapper.java

**Class:** `ResponseWrapper` (implements `Serializable`)
**Package:** `com.journaldev.spring.jdbc.model`
**Imports:** `java.io.Serializable`, `java.util.List`, `com.fasterxml.jackson.annotation.JsonInclude`, `lombok.Data`, `lombok.NoArgsConstructor`

**Annotations:**
- `@Data` (Lombok - generates getters, setters, `toString`, `equals`, `hashCode`)
- `@NoArgsConstructor` (Lombok - generates default constructor)
- `@JsonInclude(JsonInclude.Include.NON_NULL)` (Jackson - suppresses null fields in serialization)

**Constants/Fields:**
| Field | Type | Line |
|-------|------|------|
| `serialVersionUID` | `static final long` | 16 |
| `data` | `private Object` | 18 |
| `metadata` | `private Object` | 19 |
| `errors` | `private List<ErrorMessage>` | 20 |

**Lombok-generated methods (not written explicitly, but present at compile time):**
- `getData()` / `setData(Object data)`
- `getMetadata()` / `setMetadata(Object metadata)`
- `getErrors()` / `setErrors(List<ErrorMessage> errors)`
- `toString()`
- `equals(Object o)`
- `hashCode()`
- no-arg constructor

**Known subclass:** `AuthenticationResponse extends ResponseWrapper` (line 13 of AuthenticationResponse.java)
**Known usages in production:** Only through `AuthenticationResponse` subclass. No direct `new ResponseWrapper()` construction found anywhere in the main source tree.

---

### 3. Result.java

**Class:** `Result` (implements `Serializable`)
**Package:** `com.journaldev.spring.jdbc.model`
**Imports:** `java.io.Serializable`, `java.util.ArrayList`

**Constants/Fields:**
| Field | Type | Line |
|-------|------|------|
| `serialVersionUID` | `static final long` | 11 |
| `id` | `private int` | 13 |
| `comment` | `private String` | 14 |
| `start_time` | `private String` | 15 |
| `finish_time` | `private String` | 16 |
| `session_id` | `private int` | 17 |
| `arrAnswers` | `private ArrayList<Answers>` | 18 |

**Note:** `arrAnswers` is initialized inline: `= new ArrayList<Answers>()` at declaration (line 18).

**Methods:**
| Method | Signature | Line |
|--------|-----------|------|
| `getId` | `public int getId()` | 19 |
| `setId` | `public void setId(int id)` | 22 |
| `getComment` | `public String getComment()` | 26 |
| `setComment` | `public void setComment(String comment)` | 29 |
| `getStart_time` | `public String getStart_time()` | 32 |
| `setStart_time` | `public void setStart_time(String start_time)` | 35 |
| `getFinish_time` | `public String getFinish_time()` | 38 |
| `setFinish_time` | `public void setFinish_time(String finish_time)` | 41 |
| `getSession_id` | `public int getSession_id()` | 44 |
| `setSession_id` | `public void setSession_id(int session_id)` | 47 |
| `getArrAnswers` | `public ArrayList<Answers> getArrAnswers()` | 50 |
| `setArrAnswers` | `public void setArrAnswers(ArrayList<Answers> arrAnswers)` | 53 |

**No constructors defined** - relies on Java default no-arg constructor only.
**No `toString()`, `equals()`, or `hashCode()`** - Object defaults inherited.
**No annotations** - No Lombok, no Jackson, no validation.

**Known usages in production:**
- `SessionController.java` line 172: `saveResults(@RequestBody Result result)` - JSON deserialization target
- `SessionController.java` line 381: `Result result = offlineSession.getResults()`
- `OfflineSessions.java` line 12: field `private Result results`

---

## Test Coverage Search Results

**Search location:** `src/test/java/`
**Test files found:**
1. `PackageEntryTest.java` - tests `PackageEntry.compareTo()` only
2. `APKUpdaterServiceTest.java` - tests APK update service
3. `DateUtilTest.java` - tests `DateUtil` date parsing methods

**Grep results for `Reports`:** No matches in any test file.
**Grep results for `ResponseWrapper`:** No matches in any test file.
**Grep results for `Result` (model class):** No matches; the two hits in `DateUtilTest.java` are method name substrings (`parseDateIsoShouldReturnRightResult`, `parseDateTimeIsoShouldReturnRightResult`), not references to the `Result` model class.

**Conclusion:** All three classes have zero direct or indirect test coverage.

---

## Findings

### A21-1, Severity: HIGH
**Reports: No unit tests exist for any method**

`Reports` has six public methods (`getField`, `setField`, `getObject`, `setObject`, `getValue`, `setValue`) and zero test coverage. None of these methods appear in any test file under `src/test/java/`. The class is consumed by `ResumeController.getResumeDriver()`, which builds `Reports` instances from database query results and returns them in an HTTP response. The field-level behaviour (null acceptance, empty string behaviour, overwrite semantics) is completely unverified by automated tests.

---

### A21-2, Severity: HIGH
**Result: No unit tests exist for any method**

`Result` has twelve public methods covering six fields and zero test coverage. The class is the direct `@RequestBody` deserialization target for `SessionController.saveResults()`, making it the entry point for inbound JSON from mobile clients. The field `arrAnswers` is initialized to a non-null `ArrayList` at declaration, but there is no test verifying this default initialization, nor tests for any setter/getter, nor tests that verify correct round-trip serialization/deserialization behaviour.

---

### A21-3, Severity: HIGH
**ResponseWrapper: No unit tests exist**

`ResponseWrapper` is the base class for `AuthenticationResponse` and is the primary API envelope type used across the service. Despite being annotated with Lombok `@Data` and Jackson `@JsonInclude(NON_NULL)`, no tests exercise the Lombok-generated `equals`, `hashCode`, or `toString` implementations, and no tests verify that null fields are excluded from JSON output as declared by `@JsonInclude(NON_NULL)`. There are no tests for any of the three field accessors.

---

### A21-4, Severity: HIGH
**Result: `id` and `session_id` use primitive `int` with no validation - zero is indistinguishable from unset**

Both `id` (line 13) and `session_id` (line 17) are declared as primitive `int`. When `Result` is deserialized from JSON via `@RequestBody`, a missing `id` or `session_id` field in the JSON payload will silently default to `0`. This is indistinguishable from a legitimate ID of `0` or a deliberately zeroed field. There are no tests confirming the application correctly rejects or handles a `Result` where `id == 0` or `session_id == 0`, which are effectively invalid foreign-key references in the database schema.

---

### A21-5, Severity: MEDIUM
**Result: `start_time` and `finish_time` are untyped `String` fields with no format validation**

`start_time` (line 15) and `finish_time` (line 16) are stored as `String` rather than a temporal type. The application uses these field values to drive session logic in `SessionController` and in SQL `finish_time` comparisons in `ResumeController`. There are no tests verifying that out-of-format strings, null values, or empty strings are handled safely. Arbitrary strings accepted through `@RequestBody` deserialization could propagate to SQL queries and produce runtime errors or incorrect query results.

---

### A21-6, Severity: MEDIUM
**Reports: No `equals`, `hashCode`, or `toString` - object identity semantics are incorrect for a DTO**

`Reports` does not override `equals`, `hashCode`, or `toString`. Two `Reports` instances with identical field values are not equal under `==` or `.equals()` because `Object.equals()` uses reference identity. This is incorrect behaviour for a value-carrying DTO used in list comparisons. No test covers this gap. In contrast, `ResponseWrapper` correctly uses Lombok `@Data` to generate correct value-based equality.

---

### A21-7, Severity: MEDIUM
**Result: No `equals`, `hashCode`, or `toString` - same as Reports**

`Result` does not override `equals`, `hashCode`, or `toString`. As a `@RequestBody` deserialization target and as a field on `OfflineSessions`, incorrect reference-based equality could produce silent bugs when the application compares or deduplicates `Result` objects. No test covers this.

---

### A21-8, Severity: MEDIUM
**ResponseWrapper: `data` and `metadata` fields typed as raw `Object` - no type safety or serialization tests**

Both `data` (line 18) and `metadata` (line 19) are declared as `Object`. This means any type can be assigned to them, and Jackson will serialize whatever runtime type is present. There are no tests confirming that the correct concrete type is placed in each field at each call site, and no tests verifying that Jackson can correctly deserialize payloads back when the concrete type is polymorphic. The `@JsonInclude(NON_NULL)` annotation is also untested; a test should assert that a `ResponseWrapper` with null `data` and `metadata` serializes to JSON without those keys.

---

### A21-9, Severity: MEDIUM
**ResponseWrapper: Subclass `AuthenticationResponse` adds `@EqualsAndHashCode(callSuper=true)` but parent `ResponseWrapper.equals()` is Lombok-generated - no tests verify the inherited equality chain**

`AuthenticationResponse` uses `@EqualsAndHashCode(callSuper=true)`, meaning equality checks call `ResponseWrapper`'s Lombok-generated `equals()`. No test verifies that this chain behaves correctly when `data`, `metadata`, and `errors` are involved, or when the subclass fields differ between two instances that share the same parent-class field values.

---

### A21-10, Severity: LOW
**Reports: `object` field name shadows `java.lang.Object` conceptually and has no documentation**

The field named `object` (line 13) is a plain `String` but its name is a reserved-word homophone (`Object` in Java). The intent of this field - what kind of "object" it represents (unit name, equipment identifier, etc.) - is undocumented. Callers in `ResumeController` set it to unit names from the database. No test asserts that `getObject()` / `setObject()` preserve arbitrary string content correctly (including null, empty, or special characters).

---

### A21-11, Severity: LOW
**Result: `arrAnswers` field exposes `ArrayList` concrete type instead of `List` interface**

`arrAnswers` (line 18) is declared and exposed as `ArrayList<Answers>` in both the field declaration and the getter/setter signatures. Exposing a concrete collection type rather than the `List` interface constrains future refactoring and prevents substitution with other `List` implementations. No test exercises passing an alternative `List` implementation through `setArrAnswers`, because the setter accepts only `ArrayList`.

---

### A21-12, Severity: LOW
**All three classes: `serialVersionUID` values are present but Serializable correctness is untested**

`Reports` (serialVersionUID = -328199895252518312L, line 10), `ResponseWrapper` (serialVersionUID = 3136054157198689395L, line 16), and `Result` (serialVersionUID = -631947915399380621L, line 11) all implement `Serializable` with explicit `serialVersionUID` values. There are no round-trip serialization/deserialization tests to confirm that these classes can be correctly written to and read from a byte stream. If any field is added or changed and the `serialVersionUID` is not updated, silent deserialization failures or data corruption can occur in production.

---

## Summary Table

| Finding | Severity | Class(es) | Description |
|---------|----------|-----------|-------------|
| A21-1 | HIGH | Reports | Zero test coverage for all six methods |
| A21-2 | HIGH | Result | Zero test coverage for all twelve methods |
| A21-3 | HIGH | ResponseWrapper | Zero test coverage including Lombok-generated and Jackson behaviours |
| A21-4 | HIGH | Result | Primitive `int` for `id`/`session_id` - unset silently defaults to 0 |
| A21-5 | MEDIUM | Result | Untyped String for timestamp fields - no format or null validation |
| A21-6 | MEDIUM | Reports | Missing `equals`/`hashCode`/`toString` on a DTO |
| A21-7 | MEDIUM | Result | Missing `equals`/`hashCode`/`toString` on a DTO |
| A21-8 | MEDIUM | ResponseWrapper | Raw `Object` fields untested for type safety and serialization |
| A21-9 | MEDIUM | ResponseWrapper, AuthenticationResponse | Inherited equality chain across Lombok hierarchy untested |
| A21-10 | LOW | Reports | `object` field name ambiguous and undocumented |
| A21-11 | LOW | Result | `arrAnswers` exposes concrete `ArrayList` type, not `List` interface |
| A21-12 | LOW | Reports, ResponseWrapper, Result | `Serializable` correctness untested despite explicit `serialVersionUID` values |
