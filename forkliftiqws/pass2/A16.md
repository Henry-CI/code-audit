# Audit Report A16 - Pass 2: Test Coverage
**Date:** 2026-02-27
**Agent:** A16
**Scope:** GCM Model Classes (GCMDataPermission, GCMEntity, GCMResponse)

---

## Source Files Examined

1. `src/main/java/com/journaldev/spring/jdbc/model/GCMDataPermission.java`
2. `src/main/java/com/journaldev/spring/jdbc/model/GCMEntity.java`
3. `src/main/java/com/journaldev/spring/jdbc/model/GCMResponse.java`

### Supporting/Related Files Read

- `src/main/java/com/journaldev/spring/jdbc/model/GCMData.java` (parent class of GCMDataPermission)
- `src/main/java/com/journaldev/spring/jdbc/model/Permissions.java` (field type in GCMDataPermission)
- `src/main/java/com/journaldev/spring/jdbc/model/Results.java` (List element type in GCMResponse)
- `src/main/java/com/journaldev/spring/jdbc/controller/RuntimeConfig.java` (only non-model file referencing "GCM")

### Test Files in Project (complete list)

- `src/test/java/com/journaldev/spring/jdbc/model/PackageEntryTest.java`
- `src/test/java/com/journaldev/spring/jdbc/service/APKUpdaterServiceTest.java`
- `src/test/java/com/journaldev/spring/jdbc/util/DateUtilTest.java`

---

## Reading Evidence

### File 1: GCMDataPermission.java

**Class:** `GCMDataPermission`
**Package:** `com.journaldev.spring.jdbc.model`
**Superclass:** `GCMData` (which declares `protected String to` with `getTo()` / `setTo()`)
**Interfaces:** `java.io.Serializable`
**serialVersionUID:** `-6506991783027460200L` (line 10)

| Method | Line | Signature |
|--------|------|-----------|
| `getData` | 14 | `public Permissions getData()` |
| `setData` | 18 | `public void setData(Permissions data)` |

**Fields:**
| Name | Type | Line |
|------|------|------|
| `serialVersionUID` | `static final long` | 10 |
| `data` | `Permissions` | 12 |

**Inherited fields/methods (from GCMData):**
- `protected String to` (line 5 of GCMData.java)
- `getTo()` (line 7 of GCMData.java)
- `setTo(String)` (line 11 of GCMData.java)

**Types referenced:**
- `Permissions` (model class, same package)
- `GCMData` (parent, same package)
- `java.io.Serializable`

**Error/Exception paths:** None declared.
**Constants:** `serialVersionUID = -6506991783027460200L`

---

### File 2: GCMEntity.java

**Class:** `GCMEntity`
**Package:** `com.journaldev.spring.jdbc.model`
**Superclass:** `java.lang.Object` (implicit)
**Interfaces:** None

| Method | Line | Signature |
|--------|------|-----------|
| `getMsg_type` | 10 | `public String getMsg_type()` |
| `setMsg_type` | 14 | `public void setMsg_type(String msg_type)` |

**Fields:**
| Name | Type | Modifier | Line |
|------|------|----------|------|
| `msg_type` | `String` | `protected` | 8 |

**Types referenced:**
- `java.lang.String`

**Error/Exception paths:** None declared.
**Constants:** None.
**Notes:** `msg_type` uses the non-standard Java naming convention of snake_case. No `equals()`, `hashCode()`, or `toString()` overrides. No `Serializable` implementation despite being used in a GCM push-notification context where serialization is expected.

---

### File 3: GCMResponse.java

**Class:** `GCMResponse`
**Package:** `com.journaldev.spring.jdbc.model`
**Superclass:** `java.lang.Object` (implicit)
**Interfaces:** `java.io.Serializable`
**serialVersionUID:** `-4626028651245615847L` (line 10)

| Method | Line | Signature |
|--------|------|-----------|
| `getMulticast_id` | 17 | `public String getMulticast_id()` |
| `setMulticast_id` | 20 | `public void setMulticast_id(String multicast_id)` |
| `getSuccess` | 23 | `public String getSuccess()` |
| `setSuccess` | 26 | `public void setSuccess(String success)` |
| `getFailure` | 29 | `public String getFailure()` |
| `setFailure` | 32 | `public void setFailure(String failure)` |
| `getCanonical_ids` | 35 | `public String getCanonical_ids()` |
| `setCanonical_ids` | 38 | `public void setCanonical_ids(String canonical_ids)` |
| `getResults` | 41 | `public List<Results> getResults()` |
| `setResults` | 44 | `public void setResults(List<Results> results)` |

**Fields:**
| Name | Type | Line |
|------|------|------|
| `serialVersionUID` | `static final long` | 10 |
| `multicast_id` | `String` | 11 |
| `success` | `String` | 12 |
| `failure` | `String` | 13 |
| `canonical_ids` | `String` | 14 |
| `results` | `List<Results>` | 15 |

**Types referenced:**
- `java.io.Serializable`
- `java.util.List`
- `Results` (model class, same package)

**Error/Exception paths:** None declared.
**Constants:** `serialVersionUID = -4626028651245615847L`
**Notes:** `success`, `failure`, and `canonical_ids` are typed as `String` despite representing numeric counts in the GCM/FCM HTTP v1 API protocol (they should be `int` or `long`). No `equals()`, `hashCode()`, or `toString()` overrides.

---

## Test Coverage Search Results

Grep of `src/test/java` for each class name:

| Class Name | Matches in test tree |
|------------|----------------------|
| `GCMDataPermission` | 0 |
| `GCMEntity` | 0 |
| `GCMResponse` | 0 |

Grep of `src/main/java` for each class name (production usage):

| Class Name | References outside own file |
|------------|-----------------------------|
| `GCMDataPermission` | 0 |
| `GCMEntity` | 0 |
| `GCMResponse` | 0 |

All three classes are completely unreferenced by any other production source file and have zero test coverage.

---

## Findings

---

### A16-1, Severity: HIGH

**No test coverage for any method in GCMDataPermission**

All methods in `GCMDataPermission` have zero test coverage:
- `getData()` (line 14)
- `setData(Permissions)` (line 18)
- Inherited `getTo()` (GCMData line 7)
- Inherited `setTo(String)` (GCMData line 11)

No test file references `GCMDataPermission` anywhere in `src/test/java`. There is no validation that the `data` field round-trips correctly through `setData`/`getData`, that the inherited `to` field is accessible, or that the class serializes/deserializes correctly despite implementing `Serializable`.

---

### A16-2, Severity: HIGH

**No test coverage for any method in GCMEntity**

All methods in `GCMEntity` have zero test coverage:
- `getMsg_type()` (line 10)
- `setMsg_type(String)` (line 14)

No test file references `GCMEntity` anywhere in `src/test/java`.

---

### A16-3, Severity: HIGH

**No test coverage for any method in GCMResponse**

All ten methods in `GCMResponse` have zero test coverage:
- `getMulticast_id()` / `setMulticast_id(String)` (lines 17, 20)
- `getSuccess()` / `setSuccess(String)` (lines 23, 26)
- `getFailure()` / `setFailure(String)` (lines 29, 32)
- `getCanonical_ids()` / `setCanonical_ids(String)` (lines 35, 38)
- `getResults()` / `setResults(List<Results>)` (lines 41, 44)

No test file references `GCMResponse` anywhere in `src/test/java`.

---

### A16-4, Severity: HIGH

**All three classes are dead code - no production usages**

`GCMDataPermission`, `GCMEntity`, and `GCMResponse` are each referenced only by their own source file. No controller, service, DAO, or other class in `src/main/java` imports or instantiates any of them. The only GCM-related production reference in the codebase is `RuntimeConfig.GCMSERVER` and `RuntimeConfig.GCMKEY` (string constants pointing to the legacy GCM HTTP endpoint), but those constants are not linked to these model classes either. The classes represent a dead GCM push-notification integration that is neither called nor tested.

---

### A16-5, Severity: MEDIUM

**GCMResponse numeric fields are typed as String, causing silent type unsafety**

`GCMResponse.success` (line 12), `GCMResponse.failure` (line 13), and `GCMResponse.canonical_ids` (line 14) are all declared as `String`. The GCM/FCM API returns these fields as JSON integers. Using `String` means:
- JSON deserialization with strict mappers (e.g., Jackson in `DeserializationFeature.FAIL_ON_NULL_FOR_PRIMITIVES` mode) may silently mismap or throw at runtime.
- Callers cannot perform numeric comparisons (e.g., `failure > 0`) without manual parsing, which is untested and error-prone.

No tests exist to catch a deserialization failure with a live or mocked GCM response payload.

---

### A16-6, Severity: MEDIUM

**GCMEntity does not implement Serializable despite sibling GCM classes doing so**

`GCMEntity` (line 7) declares no `Serializable` interface, while `GCMDataPermission` (line 5) and `GCMResponse` (line 6) both do. GCM message wrappers are commonly serialized for queueing or caching. If `GCMEntity` is ever passed as a payload or stored in a session/cache, a `NotSerializableException` would be thrown at runtime with no compile-time warning. No test exercises `GCMEntity` in a serialization context.

---

### A16-7, Severity: MEDIUM

**Missing edge-case test: null data field in GCMDataPermission**

`GCMDataPermission.setData(null)` followed by `getData()` is never tested. Since `Permissions` is a complex Lombok-generated object with `@EqualsAndHashCode` and a private `@Builder` constructor, callers constructing a `GCMDataPermission` with a null `data` field and then passing it to a GCM serializer could produce a malformed outbound push-notification message silently. No null-guard or validation exists on `setData`.

---

### A16-8, Severity: MEDIUM

**Missing edge-case test: null or empty results list in GCMResponse**

`GCMResponse.getResults()` returns `List<Results>` with no null-check or empty-list contract. Callers iterating `gcmResponse.getResults()` without null-guarding will throw `NullPointerException` when the GCM server returns a response with no `results` array (e.g., on authentication failure). No test covers the case where `setResults(null)` or `setResults(Collections.emptyList())` is called before `getResults()` is consumed.

---

### A16-9, Severity: LOW

**GCMEntity uses non-standard snake_case field and method naming**

`GCMEntity.msg_type` (line 8) and its accessors `getMsg_type()` / `setMsg_type()` violate Java naming conventions (JLS 6.8). While this does not cause a runtime defect, it indicates the class was likely auto-generated or ported without review, and it prevents standard JavaBean tooling (e.g., Spring MVC model binding, Jackson property naming strategies) from interoperating with it without explicit configuration. No test verifies that JSON serialization/deserialization of `GCMEntity` produces the expected `msg_type` key.

---

### A16-10, Severity: LOW

**No equals(), hashCode(), or toString() overrides in GCMDataPermission, GCMEntity, or GCMResponse**

None of the three classes override `equals()`, `hashCode()`, or `toString()`. Since all are data-transfer objects used in push-notification payloads:
- Tests cannot use `assertEquals` on instances without custom comparators.
- Logging GCM responses will produce unhelpful `Object@hashcode` strings rather than field values, hindering diagnostics.
- Collections-based deduplication (e.g., storing responses in a `Set`) will use identity equality, producing logically incorrect behavior.

`Permissions.java` (the field type in `GCMDataPermission`) correctly uses Lombok `@Data` and `@EqualsAndHashCode`, making the inconsistency within the same package more notable.

---

### A16-11, Severity: LOW

**serialVersionUID values were likely auto-generated and not intentionally assigned**

`GCMDataPermission.serialVersionUID = -6506991783027460200L` (line 10) and `GCMResponse.serialVersionUID = -4626028651245615847L` (line 10) bear the hallmarks of IDE-generated negative long literals. No test verifies that previously serialized instances of either class can be deserialized after a field change, meaning any future field addition or removal is a latent `InvalidClassException` risk that will only surface in production.

---

### A16-12, Severity: INFO

**Hardcoded legacy GCM endpoint in RuntimeConfig**

`RuntimeConfig.GCMSERVER = "https://gcm-http.googleapis.com/gcm/send"` (RuntimeConfig.java line 13) references the legacy Google Cloud Messaging HTTP API, which was shut down by Google in June 2024. The model classes in scope (`GCMDataPermission`, `GCMEntity`, `GCMResponse`) are the data transfer objects that would have been used with this endpoint. Their dead-code status (finding A16-4) is consistent with the endpoint having been decommissioned. No test validates integration with any replacement (FCM HTTP v1 API) or confirms the push-notification pathway has been formally retired.

---

## Summary Table

| Finding | Severity | Class(es) Affected | Description |
|---------|----------|--------------------|-------------|
| A16-1 | HIGH | GCMDataPermission | Zero test coverage for all methods |
| A16-2 | HIGH | GCMEntity | Zero test coverage for all methods |
| A16-3 | HIGH | GCMResponse | Zero test coverage for all methods |
| A16-4 | HIGH | All three | Dead code - no production usages |
| A16-5 | MEDIUM | GCMResponse | Numeric fields typed as String |
| A16-6 | MEDIUM | GCMEntity | Missing Serializable interface |
| A16-7 | MEDIUM | GCMDataPermission | No null-guard or test for null data field |
| A16-8 | MEDIUM | GCMResponse | No null/empty guard or test for results list |
| A16-9 | LOW | GCMEntity | Non-standard snake_case naming on field and accessors |
| A16-10 | LOW | All three | No equals/hashCode/toString overrides |
| A16-11 | LOW | GCMDataPermission, GCMResponse | Auto-generated serialVersionUID, no deserialization regression tests |
| A16-12 | INFO | RuntimeConfig (context) | Hardcoded legacy GCM endpoint, decommissioned June 2024 |
