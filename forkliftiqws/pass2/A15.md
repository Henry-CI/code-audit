# Audit Report A15 - Pass 2: Test Coverage
**Date:** 2026-02-27
**Agent:** A15
**Scope:** Model classes - FormDtl, FuelType, GCMData
**Working Directory:** C:\Projects\cig-audit\repos\forkliftiqws

---

## Reading Evidence

### 1. FormDtl.java
**File:** `src/main/java/com/journaldev/spring/jdbc/model/FormDtl.java`
**Class:** `FormDtl implements Serializable`

**Fields:**
| Field | Type | Line |
|---|---|---|
| `serialVersionUID` | `private static final long` | 10 |
| `id` | `private int` | 11 |
| `input_type` | `private String` | 12 |
| `input_label` | `private String` | 13 |
| `input_value` | `private String` | 14 |
| `input_image` | `private String` | 15 |
| `input_order` | `private int` | 16 |
| `expected_answer` | `private String` | 17 |

**Methods:**
| Method | Signature | Line |
|---|---|---|
| `getId` | `public int getId()` | 20 |
| `getInput_type` | `public String getInput_type()` | 23 |
| `setInput_type` | `public void setInput_type(String input_type)` | 26 |
| `getInput_value` | `public String getInput_value()` | 29 |
| `setInput_value` | `public void setInput_value(String input_value)` | 32 |
| `setId` | `public void setId(int id)` | 35 |
| `getInput_label` | `public String getInput_label()` | 38 |
| `setInput_label` | `public void setInput_label(String input_label)` | 41 |
| `getInput_image` | `public String getInput_image()` | 44 |
| `setInput_image` | `public void setInput_image(String input_image)` | 47 |
| `getInput_order` | `public int getInput_order()` | 50 |
| `setInput_order` | `public void setInput_order(int input_order)` | 53 |
| `getExpected_answer` | `public String getExpected_answer()` | 56 |
| `setExpected_answer` | `public void setExpected_answer(String expected_answer)` | 59 |

**Interfaces implemented:** `java.io.Serializable`
**Types/Constants:**
- `serialVersionUID = 1718755713311858420L`
- No custom error types, no enums, no constants

**No-arg constructor:** Implicit Java default (not declared explicitly)
**`equals`/`hashCode`/`toString`:** Not overridden

**Callers in production code:**
- `SessionController.java` line 138: populates `FormDtl` list via `BeanPropertyRowMapper<FormDtl>` from JDBC query
- `SessionController.java` line 154: populates `FormDtl` list via `BeanPropertyRowMapper<FormDtl>` from JDBC search query

---

### 2. FuelType.java
**File:** `src/main/java/com/journaldev/spring/jdbc/model/FuelType.java`
**Class:** `FuelType implements Serializable`

**Fields:**
| Field | Type | Line |
|---|---|---|
| `serialVersionUID` | `private static final long` | 10 |
| `id` | `private int` | 12 |
| `name` | `private String` | 13 |

**Methods:**
| Method | Signature | Line |
|---|---|---|
| `getId` | `public int getId()` | 16 |
| `setId` | `public void setId(int id)` | 19 |
| `getName` | `public String getName()` | 22 |
| `setName` | `public void setName(String name)` | 25 |

**Interfaces implemented:** `java.io.Serializable`
**Types/Constants:**
- `serialVersionUID = 8705969780919933138L`
- No custom error types, no enums, no constants

**No-arg constructor:** Implicit Java default (not declared explicitly)
**`equals`/`hashCode`/`toString`:** Not overridden

**Callers in production code:**
- `EquipmentController.java` line 105: return type `List<FuelType>` from `getFuelTypeList` REST endpoint
- `EquipmentController.java` line 110/113/116: populated via `BeanPropertyRowMapper<FuelType>` from JDBC queries

---

### 3. GCMData.java
**File:** `src/main/java/com/journaldev/spring/jdbc/model/GCMData.java`
**Class:** `GCMData` (no interface, no `Serializable`)

**Fields:**
| Field | Type | Line |
|---|---|---|
| `to` | `protected String` | 5 |

**Methods:**
| Method | Signature | Line |
|---|---|---|
| `getTo` | `public String getTo()` | 7 |
| `setTo` | `public void setTo(String to)` | 11 |

**Interfaces implemented:** None
**Superclass:** `Object` (implicit)
**Subclasses found:** `GCMDataPermission extends GCMData implements Serializable`
**Types/Constants:** None

**No-arg constructor:** Implicit Java default (not declared explicitly)
**`equals`/`hashCode`/`toString`:** Not overridden

**Callers in production code:**
- `GCMDataPermission.java` line 5: extends `GCMData`
- No direct instantiation of `GCMData` found in non-model production code; used indirectly via `GCMDataPermission`

---

## Test Suite Inventory

Three test files exist under `src/test/java/`:

| Test File | Covers |
|---|---|
| `com/journaldev/spring/jdbc/model/PackageEntryTest.java` | `PackageEntry.compareTo()` only |
| `com/journaldev/spring/jdbc/service/APKUpdaterServiceTest.java` | All `@Test` methods commented out; effectively empty |
| `com/journaldev/spring/jdbc/util/DateUtilTest.java` | `DateUtil.parseDateIso()` and `DateUtil.parseDateTimeIso()` |

**Result of grep for `FormDtl`, `FuelType`, `GCMData` in `src/test/java/`:** No matches found in any test file.

---

## Findings

### A15-1 - Severity: CRITICAL
**Class:** `FormDtl`
**Finding:** Zero test coverage - no unit tests exist for `FormDtl` in any form. The class has 14 methods (7 getters, 7 setters) and is a data-transfer object used directly by JDBC `BeanPropertyRowMapper` in two production endpoints (`getForm`, `searchForm` in `SessionController`). No test verifies correct field binding, default field values, or round-trip setter/getter behavior.

**Evidence:** Grep of `src/test/java` for `FormDtl` returns no matches.

---

### A15-2 - Severity: CRITICAL
**Class:** `FuelType`
**Finding:** Zero test coverage - no unit tests exist for `FuelType`. The class is the return type of the `getFuelTypeList` REST endpoint in `EquipmentController` and is populated by JDBC `BeanPropertyRowMapper`. No test verifies field binding, default field values, or getter/setter round-trip.

**Evidence:** Grep of `src/test/java` for `FuelType` returns no matches.

---

### A15-3 - Severity: CRITICAL
**Class:** `GCMData`
**Finding:** Zero test coverage - no unit tests exist for `GCMData`. The class is the supertype of `GCMDataPermission`, which is used for GCM (Google Cloud Messaging) push notification payloads. Neither `GCMData` nor `GCMDataPermission` appears in any test file. No test verifies the inherited `to` field getter/setter, nor any subclass-specific behavior.

**Evidence:** Grep of `src/test/java` for `GCMData` returns no matches.

---

### A15-4 - Severity: HIGH
**Class:** `FormDtl`
**Finding:** Missing `equals()`, `hashCode()`, and `toString()` overrides. `FormDtl` implements `Serializable` and is used as a data model in collections (`List<FormDtl>`). Without `equals` and `hashCode`, value-based equality comparisons (e.g., de-duplication, `contains` checks on lists or sets) will fall back to identity comparison (`Object` default), producing incorrect results. Without `toString`, debugging and logging produce uninformative output. No tests exist to detect this gap.

---

### A15-5 - Severity: HIGH
**Class:** `FuelType`
**Finding:** Missing `equals()`, `hashCode()`, and `toString()` overrides. Same issue as A15-4. `FuelType` implements `Serializable` and is returned as a `List<FuelType>` from a REST endpoint. Absence of value-based equality means that tests or callers comparing `FuelType` objects by value will silently use identity comparison. No tests exist to surface this.

---

### A15-6 - Severity: HIGH
**Class:** `GCMData`
**Finding:** `GCMData` does not implement `Serializable`, while its subclass `GCMDataPermission` does declare `implements Serializable`. Under Java serialization rules, for `GCMDataPermission` to serialize correctly, the superclass (`GCMData`) must either implement `Serializable` or have a public/protected no-arg constructor accessible at deserialization time. The implicit default constructor is accessible, so deserialization will not throw immediately, but the inherited `to` field will not be serialized/deserialized as part of the standard stream - it will be set by calling the no-arg constructor of `GCMData` during deserialization, resulting in `to` silently being `null` after a serialize/deserialize round-trip. No test covers this behavior.

---

### A15-7 - Severity: HIGH
**Class:** `FormDtl`
**Finding:** The `input_order` field (line 16) is of type `int` (primitive). No test verifies behavior when `BeanPropertyRowMapper` maps a database `NULL` value for this column; `BeanPropertyRowMapper` will throw a `NullPointerException` or a type conversion exception when attempting to unbox a SQL `NULL` into a primitive `int`. The `id` field on line 11 has the same risk. The `expected_answer` field is nullable (`String`) with no documented contract. None of these boundary conditions are tested.

---

### A15-8 - Severity: HIGH
**Class:** `FuelType`
**Finding:** Same primitive `int` null-mapping risk as A15-7. The `id` field (line 12) is `private int`. If the database returns `NULL` for `id` or `name`, `BeanPropertyRowMapper` will fail with a `NullPointerException` on unboxing. No test exercises this path.

---

### A15-9 - Severity: MEDIUM
**Class:** `FormDtl`
**Finding:** No constructor other than the implicit default is provided. No test verifies that all fields default to expected zero/null values (`id = 0`, `input_order = 0`, all Strings `null`). These defaults are relied upon implicitly by `BeanPropertyRowMapper` when columns are absent from the result set. Absence of constructor tests means partial-column queries are untested.

---

### A15-10 - Severity: MEDIUM
**Class:** `GCMData`
**Finding:** The `to` field (line 5) is declared `protected` rather than `private`. This exposes the field directly to all subclasses and classes in the same package without going through the accessor methods, violating encapsulation. No test enforces that subclasses use the accessor, meaning future subclasses may bypass validation that could be added to `setTo`. This is a design risk with no test guard.

---

### A15-11 - Severity: MEDIUM
**Class:** `GCMData`
**Finding:** No validation is performed in `setTo(String to)` (line 11). The `to` field is a GCM registration token or topic string sent to an external Google push notification endpoint. If `null` or an empty string is set and then serialized into a push notification request body, the GCM API call will fail at runtime with a remote service error. No test verifies rejection of `null` or blank values for `to`.

---

### A15-12 - Severity: MEDIUM
**Class:** `FormDtl`
**Finding:** The `serialVersionUID` value (`1718755713311858420L`, line 10) appears to be auto-generated rather than intentionally assigned. If the class fields are ever reordered or new fields added without updating `serialVersionUID`, deserialization of previously serialized instances (e.g., from session storage or caches) will fail with `InvalidClassException`. No test covers serialization round-trip for `FormDtl`.

---

### A15-13 - Severity: MEDIUM
**Class:** `FuelType`
**Finding:** Same `serialVersionUID` concern as A15-12 (`8705969780919933138L`, line 10). No serialization round-trip test exists.

---

### A15-14 - Severity: LOW
**Class:** `FormDtl`
**Finding:** The naming convention for fields and methods uses `snake_case` (e.g., `input_type`, `getInput_type`, `setInput_type`) rather than the Java standard `camelCase` (e.g., `inputType`, `getInputType`). While functionally correct, this deviates from Java naming conventions and may cause issues with frameworks expecting standard JavaBean property naming (e.g., Jackson JSON serialization, which by default derives JSON key names from getter names, producing keys like `input_type` rather than `inputType`). No test verifies JSON serialization output format.

---

### A15-15 - Severity: LOW
**Class:** `FormDtl`, `FuelType`, `GCMData`
**Finding:** The overall test suite is critically sparse - only 3 test files exist for the entire application, covering only `PackageEntry`, `DateUtil`, and a fully commented-out `APKUpdaterService` test. Model classes have 0% test coverage. There is no integration test, no mock-based controller test, and no serialization test for any of the three audited classes.

---

## Summary Table

| ID | Class | Severity | Description |
|---|---|---|---|
| A15-1 | FormDtl | CRITICAL | Zero test coverage for all 14 methods |
| A15-2 | FuelType | CRITICAL | Zero test coverage for all 4 methods |
| A15-3 | GCMData | CRITICAL | Zero test coverage; supertype of serializable GCMDataPermission |
| A15-4 | FormDtl | HIGH | Missing equals/hashCode/toString overrides |
| A15-5 | FuelType | HIGH | Missing equals/hashCode/toString overrides |
| A15-6 | GCMData | HIGH | Does not implement Serializable; `to` field lost on subclass deserialization |
| A15-7 | FormDtl | HIGH | Primitive `int` fields (`id`, `input_order`) throw on SQL NULL via BeanPropertyRowMapper |
| A15-8 | FuelType | HIGH | Primitive `int` field (`id`) throws on SQL NULL via BeanPropertyRowMapper |
| A15-9 | FormDtl | MEDIUM | No test verifies default field values from implicit default constructor |
| A15-10 | GCMData | MEDIUM | `to` field is `protected` (not `private`), bypassing encapsulation |
| A15-11 | GCMData | MEDIUM | `setTo()` accepts null/blank with no validation; causes GCM API failure |
| A15-12 | FormDtl | MEDIUM | Auto-generated serialVersionUID; no serialization round-trip test |
| A15-13 | FuelType | MEDIUM | Auto-generated serialVersionUID; no serialization round-trip test |
| A15-14 | FormDtl | LOW | Non-standard snake_case field/method naming may break JSON serialization |
| A15-15 | All | LOW | Application-wide test suite is critically sparse (3 files, 2 effective) |
