# Audit Report A18 - Pass 2: Test Coverage
**Date:** 2026-02-27
**Agent:** A18
**Scope:** Model classes ImpactList, ImpactNotification, Incidents
**Working Directory:** C:\Projects\cig-audit\repos\forkliftiqws

---

## Test Infrastructure Summary

Three test files exist under `src/test/java/`:

| Test File | Tests Active |
|---|---|
| `model/PackageEntryTest.java` | 1 active (compareTo) |
| `service/APKUpdaterServiceTest.java` | 0 active (all tests commented out) |
| `util/DateUtilTest.java` | 6 active (DateUtil parsing) |

None of the three test files reference `ImpactList`, `ImpactNotification`, or `Incidents` directly or indirectly.

---

## Reading Evidence

### 1. ImpactList.java

**File:** `src/main/java/com/journaldev/spring/jdbc/model/ImpactList.java`

**Class:** `ImpactList implements Serializable`

| Element | Type | Line |
|---|---|---|
| `serialVersionUID` | `static final long` constant | 13 |
| `impactList` | field `List<Impact>`, default-initialised to `new ArrayList<Impact>()` | 16 |
| `getImpactList()` | method, returns `List<Impact>` | 19 |
| `setImpactList(List<Impact>)` | method, void | 23 |

**Imports:** `java.io.Serializable`, `java.util.ArrayList`, `java.util.List`

**Lombok:** None used.

**Implemented interfaces:** `Serializable`

**Consumers in main source:**
- `ImpactController.java:152` — used as `@RequestBody` parameter in `saveImpactData()`
- `ImpactController.java:157` — `impactList.getImpactList().forEach(...)` iterates the list

---

### 2. ImpactNotification.java

**File:** `src/main/java/com/journaldev/spring/jdbc/model/ImpactNotification.java`

**Class:** `ImpactNotification` (no `Serializable`)

| Element | Type | Line |
|---|---|---|
| `driver_name` | field `String` | 11 |
| `unit_name` | field `String` | 12 |
| `manufacturer_name` | field `String` | 13 |
| `company_name` | field `String` | 14 |
| `impact_time` | field `String` | 15 |
| `subscription_name` | field `String` | 16 |
| `email` | field `String` | 17 |
| `mobile` | field `String` | 18 |
| `ImpactNotification()` | no-arg constructor (via `@NoArgsConstructor`) | Lombok |
| `ImpactNotification(String,String,String,String,String,String,String,String)` | `@Builder` all-args constructor | 21 |
| Lombok `@Data` generated: `getDriver_name()`, `setDriver_name()`, `getUnit_name()`, `setUnit_name()`, `getManufacturer_name()`, `setManufacturer_name()`, `getCompany_name()`, `setCompany_name()`, `getImpact_time()`, `setImpact_time()`, `getSubscription_name()`, `setSubscription_name()`, `getEmail()`, `setEmail()`, `getMobile()`, `setMobile()`, `equals()`, `hashCode()`, `toString()` | Lombok-generated | N/A |

**Imports:** `lombok.Builder`, `lombok.Data`, `lombok.NoArgsConstructor`

**Annotations:** `@Data`, `@NoArgsConstructor`, `@Builder` (on explicit constructor)

**Consumers in main source:**
- `ImpactDAO.java:65` — instantiated via `BeanPropertyRowMapper<>(ImpactNotification.class)` for JDBC result mapping; requires no-arg constructor and matching setters
- `ImpactDAO.java:64` — used in `sendImpactNotification()` method

---

### 3. Incidents.java

**File:** `src/main/java/com/journaldev/spring/jdbc/model/Incidents.java`

**Class:** `Incidents implements Serializable`

| Element | Type | Line |
|---|---|---|
| `serialVersionUID` | `static final long` constant | 10 |
| `id` | field `int` | 12 |
| `signature` | field `byte[]` | 13 |
| `image` | field `byte[]` | 14 |
| `injury_type` | field `String` | 15 |
| `witness` | field `String` | 16 |
| `location` | field `String` | 17 |
| `injury` | field `Boolean` (boxed) | 18 |
| `near_miss` | field `Boolean` (boxed) | 19 |
| `incident` | field `Boolean` (boxed) | 20 |
| `driver_id` | field `int` | 21 |
| `unit_id` | field `int` | 22 |
| `description` | field `String` | 43 |
| `report_time` | field `String` | 44 |
| `event_time` | field `String` | 45 |
| `job_number` | field `String` | 46 |
| `getDriver_id()` | method, returns `int` | 24 |
| `setDriver_id(int)` | method, void | 27 |
| `getUnit_id()` | method, returns `int` | 30 |
| `setUnit_id(int)` | method, void | 33 |
| `getIncident()` | method, returns `Boolean` | 37 |
| `setIncident(Boolean)` | method, void | 40 |
| `getJob_number()` | method, returns `String` | 49 |
| `setJob_number(String)` | method, void | 52 |
| `getNear_miss()` | method, returns `Boolean` | 55 |
| `setNear_miss(Boolean)` | method, void | 58 |
| `getWitness()` | method, returns `String` | 61 |
| `setWitness(String)` | method, void | 64 |
| `getId()` | method, returns `int` | 67 |
| `setId(int)` | method, void | 70 |
| `getSignature()` | method, returns `byte[]` | 73 |
| `setSignature(byte[])` | method, void | 76 |
| `getImage()` | method, returns `byte[]` | 79 |
| `setImage(byte[])` | method, void | 82 |
| `getInjury_type()` | method, returns `String` | 85 |
| `setInjury_type(String)` | method, void | 88 |
| `getLocation()` | method, returns `String` | 91 |
| `setLocation(String)` | method, void | 94 |
| `getInjury()` | method, returns `Boolean` | 97 |
| `setInjury(Boolean)` | method, void | 100 |
| `getDescription()` | method, returns `String` | 103 |
| `setDescription(String)` | method, void | 106 |
| `getReport_time()` | method, returns `String` | 109 |
| `setReport_time(String)` | method, void | 112 |
| `getEvent_time()` | method, returns `String` | 115 |
| `setEvent_time(String)` | method, void | 118 |

**Lombok:** None used. All accessors are hand-written.

**No-arg constructor:** Absent — class has no explicit constructor and no Lombok annotation, so only the compiler-generated default no-arg constructor exists.

**Consumers in main source:**
- `ImpactController.java:59` — used as `@RequestBody` and return type in `saveIncident()`
- `ImpactController.java:70` — returned as `ResponseEntity<Incidents>`

---

## Findings

### A18-1 — Severity: CRITICAL
**No tests exist for any of the three model classes.**

`ImpactList`, `ImpactNotification`, and `Incidents` have zero test coverage — no direct unit tests and no indirect coverage via any of the three active test files. The test suite contains only tests for `PackageEntry`, `DateUtil`, and (all commented-out) `APKUpdaterService`. These model classes are used in HTTP endpoints and DAO layers that process real production traffic (impact events, incident reports, email/SMS notifications), making the absence of test coverage a critical quality risk.

**Affected files:**
- `src/main/java/com/journaldev/spring/jdbc/model/ImpactList.java`
- `src/main/java/com/journaldev/spring/jdbc/model/ImpactNotification.java`
- `src/main/java/com/journaldev/spring/jdbc/model/Incidents.java`

---

### A18-2 — Severity: HIGH
**ImpactList: null-list and empty-list edge cases are untested.**

The field `impactList` is default-initialised to a new `ArrayList` (line 16), but `setImpactList(null)` is never guarded — setting `null` then calling `getImpactList().forEach(...)` in `ImpactController.java:157` would throw a `NullPointerException` at runtime. There is no test verifying the default-initialised state, no test for `setImpactList(null)`, and no test for an empty list being submitted as a request body.

**Affected method:** `setImpactList(List<Impact>)` — line 23

---

### A18-3 — Severity: HIGH
**ImpactNotification: @Builder and @NoArgsConstructor co-existence with BeanPropertyRowMapper is untested and structurally fragile.**

`ImpactNotification` uses `@NoArgsConstructor` (required by `BeanPropertyRowMapper` for JDBC result mapping) alongside an explicit `@Builder`-annotated all-args constructor (line 21). The field names follow the `snake_case` convention (e.g., `driver_name`, `unit_name`) which must align exactly with the SQL column aliases returned by `QUERY_FOR_IMPACT_NOTIFICATIONS` for `BeanPropertyRowMapper` to bind correctly. There are no tests that:
- instantiate `ImpactNotification` via the no-arg constructor and exercise setters
- verify the builder produces a correctly populated object
- verify `equals()` / `hashCode()` / `toString()` behaviour generated by `@Data`

A mismatch between SQL column names and field names would silently produce objects with null fields and cause notification emails/SMS to send blank content.

**Affected methods:** All Lombok-generated accessors, `ImpactNotification(...)` builder constructor — lines 7–31

---

### A18-4 — Severity: HIGH
**Incidents: No constructor, no Lombok — default state after construction is entirely untested.**

`Incidents` has no explicit constructor and no Lombok annotations. The compiler supplies a no-arg constructor that leaves all fields at their zero/null defaults: `id=0`, `driver_id=0`, `unit_id=0`, `signature=null`, `image=null`, `injury=null`, `near_miss=null`, `incident=null`. No test verifies that a freshly constructed `Incidents` object has safe/expected defaults before setter calls are made, nor that the object round-trips correctly through JSON deserialization in `saveIncident()`.

**Affected class:** `Incidents` — lines 5–122

---

### A18-5 — Severity: HIGH
**Incidents: Three Boolean fields use boxed type — null state is untested.**

`injury` (line 18), `near_miss` (line 19), and `incident` (line 20) are declared as `Boolean` (boxed), not `boolean` (primitive). This means each can hold `null` in addition to `true`/`false`. The controller at `ImpactController.java:59` accepts the object via `@RequestBody`; if the JSON payload omits any of these three flags, they will be `null`. No test covers:
- `getInjury()` returning `null`
- `getNear_miss()` returning `null`
- `getIncident()` returning `null`
- Any downstream code that auto-unboxes these values (which would throw `NullPointerException`)

**Affected methods:** `getInjury()` line 97, `getNear_miss()` line 55, `getIncident()` line 37

---

### A18-6 — Severity: MEDIUM
**Incidents: byte[] fields for signature and image have no boundary or null tests.**

`signature` (line 13) and `image` (line 14) are `byte[]` fields with no size constraints enforced at the model layer. No tests verify:
- behaviour when `null` is set and then retrieved
- behaviour when a zero-length array is set
- that very large byte arrays (e.g., high-resolution images) are handled without memory issues at the model layer

These fields are accepted from HTTP request bodies, creating a potential for unchecked large-payload acceptance.

**Affected methods:** `getSignature()` line 73, `setSignature(byte[])` line 76, `getImage()` line 79, `setImage(byte[])` line 82

---

### A18-7 — Severity: MEDIUM
**ImpactList: Serializable contract is untested.**

`ImpactList` implements `Serializable` with an explicit `serialVersionUID = 3101512981283324426L` (line 13). There are no tests verifying that the class can be serialized to a byte stream and deserialized back to an equivalent object. If the class is used in any session storage, caching layer, or distributed messaging context, a future field addition without updating `serialVersionUID` would cause silent deserialization failures. The same concern applies to `Incidents` which also implements `Serializable` (serialVersionUID = -2471804810130016124L, line 10).

**Affected classes:** `ImpactList` line 13, `Incidents` line 10

---

### A18-8 — Severity: MEDIUM
**Incidents: No equals(), hashCode(), or toString() — deduplication and logging are untested and unreliable.**

`Incidents` has no `equals()`, `hashCode()`, or `toString()` override and no Lombok `@Data`. This means:
- Two `Incidents` objects with identical field values are not equal by value (`==` identity only)
- Any `Set<Incidents>` or `Map<Incidents, ...>` collection will not deduplicate as expected
- Logging `incident.toString()` produces an unhelpful identity string (e.g., `com.journaldev.spring.jdbc.model.Incidents@1a2b3c`) rather than field values

There are no tests exposing this behaviour.

**Affected class:** `Incidents` — entire class

---

### A18-9 — Severity: LOW
**ImpactNotification: Missing Serializable implementation.**

`ImpactNotification` does not implement `Serializable`, unlike `ImpactList` and `Incidents`. If `ImpactNotification` objects are ever placed in an HTTP session, cached, or passed through a serialization boundary (e.g., Spring's session scope, a messaging queue), a `NotSerializableException` would be thrown at runtime. No test exists to catch this absence. This is inconsistent with the other model classes in the same package.

**Affected class:** `ImpactNotification` — line 9

---

### A18-10 — Severity: LOW
**Incidents: Field declaration order is non-sequential — description, report_time, event_time, job_number are declared mid-class (lines 43–46).**

The fields `description`, `report_time`, `event_time`, and `job_number` are declared after the getter/setter methods for other fields (lines 43–46), interspersed with method definitions. While this is not a runtime defect, it indicates the class was grown organically without refactoring, increases the chance of a developer overlooking fields when writing code or tests, and makes it harder to enumerate the full field set. No test exercises the complete field population of an `Incidents` object with all 16 fields set simultaneously to verify no fields were omitted.

**Affected class:** `Incidents` — lines 43–46

---

## Coverage Summary

| Class | Methods Declared | Methods with Any Test Coverage | Coverage % |
|---|---|---|---|
| `ImpactList` | 2 (getImpactList, setImpactList) | 0 | 0% |
| `ImpactNotification` | ~19 (8 Lombok getter/setter pairs + builder ctor + no-arg ctor + equals/hashCode/toString) | 0 | 0% |
| `Incidents` | 26 (13 getter/setter pairs, hand-written) | 0 | 0% |

**Total active test methods covering these three classes:** 0 out of 3 test files, 0 out of 7 active test methods in the suite.
