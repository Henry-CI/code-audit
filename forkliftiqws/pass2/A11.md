# Audit Report A11 - Pass 2: Test Coverage
**Date:** 2026-02-27
**Agent:** A11
**Scope:** model layer - AuthenticationRequest, AuthenticationResponse, Charts

---

## Source Files Audited

| # | File | Lines |
|---|------|-------|
| 1 | `src/main/java/com/journaldev/spring/jdbc/model/AuthenticationRequest.java` | 30 |
| 2 | `src/main/java/com/journaldev/spring/jdbc/model/AuthenticationResponse.java` | 28 |
| 3 | `src/main/java/com/journaldev/spring/jdbc/model/Charts.java` | 51 |

---

## Reading Evidence

### 1. AuthenticationRequest.java

**Class:** `AuthenticationRequest implements Serializable`
**Package:** `com.journaldev.spring.jdbc.model`
**Annotations:** `@Data`, `@NoArgsConstructor`

**Constants / Static Fields:**
- `serialVersionUID = 152396558777730489L` (line 16) - `private static final long`

**Fields:**
- `username` : `String` (line 17)
- `password` : `String` (line 18)
- `newPassword` : `String` (line 19)
- `accessToken` : `String` (line 20)

**Methods (explicit - declared in source):**
- `AuthenticationRequest(String username, String password, String newPassword, String accessToken)` - private `@Builder` constructor (line 23-28)

**Methods (Lombok-generated - implicit):**
- `AuthenticationRequest()` - no-arg constructor via `@NoArgsConstructor`
- `getUsername()` - via `@Data`
- `setUsername(String)` - via `@Data`
- `getPassword()` - via `@Data`
- `setPassword(String)` - via `@Data`
- `getNewPassword()` - via `@Data`
- `setNewPassword(String)` - via `@Data`
- `getAccessToken()` - via `@Data`
- `setAccessToken(String)` - via `@Data`
- `equals(Object)` - via `@Data`
- `hashCode()` - via `@Data`
- `toString()` - via `@Data`
- `builder()` - via `@Builder` on private constructor (line 22)

**Implemented Interfaces:** `java.io.Serializable`

**Notable Design Issues:**
- `@Builder` is placed on the private constructor (line 22-23), not on the class. This generates a builder scoped to produce instances via the private constructor, which is an unusual pattern. The `@NoArgsConstructor` and `@Data` combination provides public no-arg construction and setters while builder access is also possible. The `@Builder` annotation on a private constructor rather than the class is atypical and may indicate a design inconsistency.
- `password` field is included in Lombok-generated `toString()` output, which is a security concern (plaintext credential exposure in logs).

---

### 2. AuthenticationResponse.java

**Class:** `AuthenticationResponse extends ResponseWrapper`
**Package:** `com.journaldev.spring.jdbc.model`
**Annotations:** `@Data`, `@EqualsAndHashCode(callSuper=true)`, `@NoArgsConstructor`, `@JsonInclude(JsonInclude.Include.NON_NULL)`

**Constants / Static Fields:**
- `serialVersionUID = 408336884318011949L` (line 17) - `private static final long`

**Fields (declared in AuthenticationResponse):**
- `accessToken` : `String` (line 18)
- `sessionToken` : `String` (line 19)
- `expiresIn` : `String` (line 20)
- `actualDate` : `String` (line 21)
- `expirationDate` : `String` (line 22)
- `userData` : `UserResponse` (line 23)
- `username` : `String` (line 24)
- `message` : `String` (line 25)

**Fields inherited from ResponseWrapper:**
- `data` : `Object`
- `metadata` : `Object`
- `errors` : `List<ErrorMessage>`

**Methods (Lombok-generated - implicit):**
- `AuthenticationResponse()` - no-arg constructor via `@NoArgsConstructor`
- `getAccessToken()` - via `@Data`
- `setAccessToken(String)` - via `@Data`
- `getSessionToken()` - via `@Data`
- `setSessionToken(String)` - via `@Data`
- `getExpiresIn()` - via `@Data`
- `setExpiresIn(String)` - via `@Data`
- `getActualDate()` - via `@Data`
- `setActualDate(String)` - via `@Data`
- `getExpirationDate()` - via `@Data`
- `setExpirationDate(String)` - via `@Data`
- `getUserData()` - via `@Data`
- `setUserData(UserResponse)` - via `@Data`
- `getUsername()` - via `@Data`
- `setUsername(String)` - via `@Data`
- `getMessage()` - via `@Data`
- `setMessage(String)` - via `@Data`
- `equals(Object)` - via `@Data` + `@EqualsAndHashCode(callSuper=true)` (includes superclass fields)
- `hashCode()` - via `@Data` + `@EqualsAndHashCode(callSuper=true)`
- `toString()` - via `@Data`
- `getData()`, `setData(Object)` - inherited from `ResponseWrapper` via Lombok
- `getMetadata()`, `setMetadata(Object)` - inherited from `ResponseWrapper` via Lombok
- `getErrors()`, `setErrors(List<ErrorMessage>)` - inherited from `ResponseWrapper` via Lombok

**Implemented Interfaces:** `java.io.Serializable` (via `ResponseWrapper`)

**Notable Design Issues:**
- All date/time fields (`expiresIn`, `actualDate`, `expirationDate`) are typed as `String` rather than a temporal type (`Instant`, `LocalDateTime`, `Date`). No format constraint or validation is expressed.
- `accessToken` is included in Lombok-generated `toString()`, posing a credential/token exposure risk in logs.
- The class carries both an `accessToken` (its own) and inherits `data`/`metadata`/`errors` from `ResponseWrapper`, resulting in a mixed-purpose response object that merges authentication credentials with a generic API wrapper structure.

---

### 3. Charts.java

**Class:** `Charts implements Serializable`
**Package:** `com.journaldev.spring.jdbc.model`
**Annotations:** none

**Constants / Static Fields:**
- `serialVersionUID = -2487058812368828477L` (line 14) - `private static final long`

**Fields:**
- `unit_id` : `int` (line 16) - primitive, no null safety needed
- `unit` : `String` (line 17)
- `total` : `BigDecimal` (line 18)
- `usageList` : `List<Usage>` (line 19) - initialized to `new ArrayList<Usage>()` at declaration

**Methods (explicit - all hand-written, no Lombok):**
- `getUnit()` : `String` (line 21-23)
- `setUnit(String unit)` : `void` (line 24-26)
- `getTotal()` : `BigDecimal` (line 27-29)
- `setTotal(BigDecimal total)` : `void` (line 30-32)
- `getUsageList()` : `List<Usage>` (line 33-35)
- `setUsageList(List<Usage> usageList)` : `void` (line 36-38)
- `addUsageList(Usage usage)` : `void` (line 40-42) - mutates the internal list
- `getUnit_id()` : `int` (line 43-45)
- `setUnit_id(int unit_id)` : `void` (line 46-48)

**No `equals()`, `hashCode()`, or `toString()` methods declared or generated.**

**Notable Design Issues:**
- `unit_id` uses a non-Java-convention snake_case name (should be `unitId`). Getter/setter are named `getUnit_id()` / `setUnit_id()` accordingly, which violates JavaBean conventions and will cause issues with `BeanPropertyRowMapper` unless the column name exactly matches `unit_id`.
- `addUsageList(Usage usage)` name is misleading (semantically it adds a single `Usage` item, not a list).
- `setUsageList(List<Usage> usageList)` allows the internal list to be replaced with a `null` reference, after which `addUsageList` would throw `NullPointerException`.
- No `equals()` or `hashCode()` implementation means two `Charts` instances with identical data are not considered equal, which can cause incorrect behavior in collection operations or test assertions.
- `total` field typed as `BigDecimal` can be `null`; arithmetic operations in callers will throw `NullPointerException` without null guards.

---

## Test Coverage Summary

**Test directory:** `src/test/java/`

**Existing test files found:**
- `com/journaldev/spring/jdbc/model/PackageEntryTest.java` - tests `PackageEntry.compareTo()`
- `com/journaldev/spring/jdbc/service/APKUpdaterServiceTest.java` - all meaningful tests commented out
- `com/journaldev/spring/jdbc/util/DateUtilTest.java` - tests `DateUtil` date parsing

**Coverage for audited classes:**

| Class | Direct Tests | Indirect Tests | Coverage |
|-------|-------------|----------------|----------|
| `AuthenticationRequest` | None | None | 0% |
| `AuthenticationResponse` | None | None | 0% |
| `Charts` | None | None | 0% |

No test file references `AuthenticationRequest`, `AuthenticationResponse`, or `Charts` by name anywhere under `src/test/`.

---

## Findings

---

### A11-1, Severity: HIGH
**Class:** `AuthenticationRequest`
**Issue:** Zero test coverage - no unit tests exist for any aspect of this class.

`AuthenticationRequest` has 0% test coverage. No test exercises construction via `@NoArgsConstructor`, the `@Builder`-backed private constructor, or any Lombok-generated accessor, `equals`, `hashCode`, or `toString` method. The class is used in `CognitoService` (line 72-85) as the payload sent to an authentication endpoint. Because no test validates the object graph produced by the builder or the no-arg constructor path followed by setters, regressions in field mapping or builder behavior will go undetected.

**Untested paths:**
- Builder construction with all four fields populated
- Builder construction with partial fields (null fields)
- No-arg construction followed by individual setters
- `equals()` / `hashCode()` contract (reflexive, symmetric, transitive, null-safe)
- `toString()` output (also a security concern - see A11-5)
- Serialization round-trip (`Serializable` contract)

---

### A11-2, Severity: HIGH
**Class:** `AuthenticationResponse`
**Issue:** Zero test coverage - no unit tests exist for any aspect of this class.

`AuthenticationResponse` has 0% test coverage. It is the deserialized response from the Cognito authentication service (used in `CognitoService` lines 86-89) and is the primary data carrier for authentication state including `accessToken`, `sessionToken`, and `userData`. No test validates field access, JSON deserialization behavior (including `@JsonInclude(NON_NULL)` suppression), or the `@EqualsAndHashCode(callSuper=true)` contract that encompasses parent class fields.

**Untested paths:**
- No-arg construction and individual field setters
- JSON serialization: null fields are suppressed by `@JsonInclude(NON_NULL)` - no test confirms which fields appear/disappear
- JSON deserialization: no test confirms field mapping survives round-trip
- `equals()` with `callSuper=true`: inherited `ResponseWrapper` fields (`data`, `metadata`, `errors`) participate in equality - no test validates this
- `hashCode()` consistency with `equals()`
- `toString()` output
- Serialization round-trip
- All-null state (all optional fields absent)
- Partial population (only token fields set, `userData` null)

---

### A11-3, Severity: HIGH
**Class:** `Charts`
**Issue:** Zero test coverage - no unit tests exist for any aspect of this class.

`Charts` has 0% test coverage. It is used as a `BeanPropertyRowMapper` target in `ResumeController` (lines 124-225) and as the primary data structure for equipment usage charts. The class contains a hand-written mutating method (`addUsageList`) not generated by Lombok, making it more prone to behavioral bugs that automated tests would catch.

**Untested paths:**
- `addUsageList(Usage)` - the sole non-trivial mutating method
- `addUsageList(null)` - calling with a null `Usage` reference
- `setUsageList(null)` followed by `addUsageList()` - expected to throw `NullPointerException`
- `getUsageList()` returns the same live list instance (aliasing risk)
- `setTotal(null)` followed by any BigDecimal arithmetic by caller
- `getUnit_id()` / `setUnit_id()` with boundary int values (0, `Integer.MIN_VALUE`, `Integer.MAX_VALUE`)
- Default state: `usageList` initialized to empty `ArrayList`, `total` is null, `unit_id` is 0
- `BeanPropertyRowMapper` compatibility: snake_case field `unit_id` with getter `getUnit_id()` - this violates JavaBean conventions and may silently fail to map the column at runtime

---

### A11-4, Severity: MEDIUM
**Class:** `Charts`
**Issue:** `setUsageList(null)` followed by `addUsageList()` causes NullPointerException with no guard or documented contract.

`usageList` is initialized to a non-null `ArrayList` at field declaration (line 19). However, `setUsageList(List<Usage> usageList)` (line 36-38) unconditionally replaces it with whatever is passed, including `null`. A subsequent call to `addUsageList(Usage)` (line 41: `this.usageList.add(usage)`) will throw `NullPointerException`. There is no null guard, no `@NonNull` annotation, no documented contract, and no test covering this error path.

**Error path untested:** `setUsageList(null)` -> `addUsageList(anyUsage)` -> `NullPointerException` at line 41.

---

### A11-5, Severity: MEDIUM
**Class:** `AuthenticationRequest`
**Issue:** `password` field included in Lombok `@Data`-generated `toString()` output - sensitive credential leaked to logs.

Lombok's `@Data` annotation generates a `toString()` method that includes all fields, including `password` (line 18). Any logging of an `AuthenticationRequest` object (e.g., via a logger, exception message, or debug output) will expose the plaintext password. No test verifies or documents this behavior, and no `@ToString.Exclude` annotation is present on the `password` field.

---

### A11-6, Severity: MEDIUM
**Class:** `AuthenticationResponse`
**Issue:** `accessToken` and `sessionToken` fields included in Lombok `@Data`-generated `toString()` output - security tokens leaked to logs.

Same pattern as A11-5. `@Data` generates `toString()` including `accessToken` (line 18) and `sessionToken` (line 19). Logging an `AuthenticationResponse` object exposes live authentication tokens. No `@ToString.Exclude` is applied, and no test validates or documents this behavior.

---

### A11-7, Severity: MEDIUM
**Class:** `AuthenticationRequest`
**Issue:** `@Builder` placed on private constructor alongside `@NoArgsConstructor` and `@Data` creates an inconsistent access model with no test coverage of constructor behavior.

`@Builder` is on the private constructor (line 22-23) rather than the class. This means `AuthenticationRequest.builder()` works (delegating to the private all-args constructor) and the public no-arg constructor also exists (via `@NoArgsConstructor`), but the two construction paths are not symmetrically documented or tested. Specifically, there is no test confirming that the builder path produces an object equivalent (via `equals()`) to the setter path, or that null fields are handled consistently between the two approaches.

---

### A11-8, Severity: MEDIUM
**Class:** `Charts`
**Issue:** Non-JavaBean field name `unit_id` with snake_case getter `getUnit_id()` violates conventions and may silently break `BeanPropertyRowMapper` column mapping.

`ResumeController` uses `new BeanPropertyRowMapper<>(Charts.class)` and `new BeanPropertyRowMapper<Charts>(Charts.class)` (lines 136, 180, 222) to map query results into `Charts` objects. Spring's `BeanPropertyRowMapper` converts column names to camelCase property names for lookup. A column named `unit_id` in the database would be mapped to the property `unitId`, not `unit_id`. The getter `getUnit_id()` does not match the expected `getUnitId()`, so `unit_id` may silently map to 0 (the primitive default) in all rows. No test covers this mapping behavior.

---

### A11-9, Severity: LOW
**Class:** `Charts`
**Issue:** `addUsageList` method name is semantically misleading - it adds a single `Usage` item, not a list.

The method `addUsageList(Usage usage)` (line 40-42) adds a single `Usage` instance to the internal list. Its name implies adding multiple items or an entire list. The method should be named `addUsage(Usage usage)` to accurately describe its behavior. No test exists to document intended behavior or guard against a future rename/refactor.

---

### A11-10, Severity: LOW
**Class:** `AuthenticationResponse`
**Issue:** All date/time fields typed as `String` with no format validation or constraint - invalid date strings are not caught at the model layer.

The fields `expiresIn` (line 20), `actualDate` (line 21), and `expirationDate` (line 22) are all typed as `String`. No format annotation (e.g., `@JsonFormat`, `@Pattern`), no temporal type (`Instant`, `LocalDateTime`), and no validation annotation (`@NotNull`, `@Pattern`) is applied. A caller or deserializer can set any arbitrary string. No test verifies that date-like strings are correctly round-tripped or that invalid values are rejected.

---

### A11-11, Severity: LOW
**Class:** `Charts`
**Issue:** No `equals()`, `hashCode()`, or `toString()` - class is not usable in sets, as map keys, or in assertion-friendly comparisons.

`Charts` is a plain class with no Lombok annotations and no hand-written `equals()`, `hashCode()`, or `toString()`. Two `Charts` instances with identical field values are not equal by `equals()` (reference equality only). This means collection deduplication (`Set<Charts>`) and map keying are broken, and test assertions comparing two `Charts` instances by value would incorrectly fail. No test exposes or documents this limitation.

---

## Summary Table

| Finding | Class | Severity | Description |
|---------|-------|----------|-------------|
| A11-1 | `AuthenticationRequest` | HIGH | Zero test coverage |
| A11-2 | `AuthenticationResponse` | HIGH | Zero test coverage |
| A11-3 | `Charts` | HIGH | Zero test coverage |
| A11-4 | `Charts` | MEDIUM | `setUsageList(null)` + `addUsageList()` = unguarded NPE |
| A11-5 | `AuthenticationRequest` | MEDIUM | `password` exposed in `toString()` |
| A11-6 | `AuthenticationResponse` | MEDIUM | `accessToken`/`sessionToken` exposed in `toString()` |
| A11-7 | `AuthenticationRequest` | MEDIUM | `@Builder` on private constructor - inconsistent construction paths untested |
| A11-8 | `Charts` | MEDIUM | `unit_id` snake_case violates JavaBean convention, may break `BeanPropertyRowMapper` |
| A11-9 | `Charts` | LOW | `addUsageList` misleading method name |
| A11-10 | `AuthenticationResponse` | LOW | Date fields typed `String` with no format constraint |
| A11-11 | `Charts` | LOW | No `equals()`/`hashCode()`/`toString()` on hand-written POJO |
