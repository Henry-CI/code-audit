# Audit Report A12 - Pass 2: Test Coverage
**Agent:** A12
**Pass:** 2 (Test Coverage)
**Date:** 2026-02-27
**Scope:** Model classes: Company, Driver, DriverEmails

---

## Reading Evidence

### File 1: Company.java
**Path:** `src/main/java/com/journaldev/spring/jdbc/model/Company.java`
**Class:** `Company implements Serializable`
**Lombok Annotations:** `@Data`, `@NoArgsConstructor`, `@Builder` (on private constructor)

**Constants:**
- `serialVersionUID = 8023991868841881837L` (line 18)

**Fields:**
| Field | Type | Line |
|---|---|---|
| `id` | `Long` | 20 |
| `name` | `String` | 21 |
| `email` | `String` | 22 |
| `password` | `String` | 23 |
| `arrRoles` | `List<Roles>` | 24 |
| `permission` | `Permissions` | 25 |
| `timezone` | `Integer` | 26 |
| `dateFormat` | `String` | 27 |
| `maxSessionLength` | `Integer` | 28 |
| `contactDriver` | `Driver` | 30 |

**Methods (Lombok-generated via `@Data`):**
- `getId()` / `setId(Long)`
- `getName()` / `setName(String)`
- `getEmail()` / `setEmail(String)`
- `getPassword()` / `setPassword(String)`
- `getArrRoles()` / `setArrRoles(List<Roles>)`
- `getPermission()` / `setPermission(Permissions)`
- `getTimezone()` / `setTimezone(Integer)`
- `getDateFormat()` / `setDateFormat(String)`
- `getMaxSessionLength()` / `setMaxSessionLength(Integer)`
- `getContactDriver()` / `setContactDriver(Driver)`
- `equals(Object)` / `hashCode()` / `toString()`

**Methods (Explicit):**
- `Company()` — no-arg constructor (line 12, via `@NoArgsConstructor`) — no body logic
- `Company(Long, String, String, String, Integer, String, Integer, List<Roles>, Permissions, Driver)` — private `@Builder` constructor (lines 33–50)

**Logic Branches in `@Builder` constructor:**
- Line 44–49: `if (this.contactDriver != null)` — overrides `name`, `email`, `password` from the `contactDriver` Driver object
  - True branch: `this.name = contactDriver.getFirst_name() + " " + contactDriver.getLast_name()` (line 46)
  - True branch: `this.email = contactDriver.getEmail()` (line 47)
  - True branch: `this.password = contactDriver.getPassword()` (line 48)
  - False branch (implicit): `name`, `email`, `password` remain as passed to the builder

**Types Referenced:** `Roles`, `Permissions`, `Driver`, `Serializable`, `List`

---

### File 2: Driver.java
**Path:** `src/main/java/com/journaldev/spring/jdbc/model/Driver.java`
**Class:** `Driver implements Serializable`
**Lombok Annotations:** `@Data`, `@NoArgsConstructor`, `@EqualsAndHashCode(onlyExplicitlyIncluded = true)`, `@Builder` (on private constructor)

**Constants:**
- `serialVersionUID = -100229563698950401L` (line 16)

**Fields:**
| Field | Type | Line |
|---|---|---|
| `id` | `Long` | 18 |
| `first_name` | `String` | 19 |
| `last_name` | `String` | 20 |
| `email` | `String` | 23 (`@EqualsAndHashCode.Include`) |
| `password` | `String` | 25 |
| `phone` | `String` | 26 |
| `licno` | `String` | 27 |
| `expirydt` | `String` | 28 |
| `addr` | `String` | 29 |
| `securityno` | `String` | 30 |
| `photo_url` | `String` | 31 |
| `contactperson` | `boolean` | 32 |
| `ranking` | `String` | 33 |
| `comp_id` | `Long` | 34 |
| `driver_based` | `boolean` | 35 |
| `date_format` | `String` | 36 |
| `max_session_length` | `Integer` | 37 |
| `compliance_date` | `String` | 38 |
| `gps_frequency` | `Integer` | 39 |
| `drivers` | `List<Driver>` | 41 |
| `arrDriverTrainings` | `List<DriverTraining>` | 43 |

**Methods (Lombok-generated via `@Data`):**
- Getters and setters for all 20 fields listed above
- `equals(Object)` — restricted to `email` field only (via `@EqualsAndHashCode.Include`)
- `hashCode()` — restricted to `email` field only
- `toString()`

**Methods (Explicit):**
- `Driver()` — no-arg constructor (line 13, via `@NoArgsConstructor`) — no body logic
- `Driver(Long, String, String, String, String, String, String, String, String, String, String, boolean, String, Long, boolean, String, Integer, String, List<DriverTraining>, Integer)` — private `@Builder` constructor (lines 47–86) — pure field assignment, no branches

**Types Referenced:** `DriverTraining`, `Serializable`, `List`

---

### File 3: DriverEmails.java
**Path:** `src/main/java/com/journaldev/spring/jdbc/model/DriverEmails.java`
**Class:** `DriverEmails implements Serializable`
**Annotations:** None (plain POJO)

**Constants:**
- `serialVersionUID = 2730515601304224328L` (line 10)

**Fields:**
| Field | Type | Line |
|---|---|---|
| `id` | `int` | 12 |
| `driver_id` | `int` | 13 |
| `email_addr1` | `String` | 14 |
| `email_addr2` | `String` | 15 |
| `email_addr3` | `String` | 16 |
| `email_addr4` | `String` | 17 |

**Methods (All explicit, hand-written):**
| Method | Line |
|---|---|
| `getId()` | 20 |
| `setId(int id)` | 23 |
| `getDriver_id()` | 26 |
| `setDriver_id(int driver_id)` | 29 |
| `getEmail_addr1()` | 32 |
| `setEmail_addr1(String email_addr1)` | 35 |
| `getEmail_addr2()` | 38 |
| `setEmail_addr2(String email_addr2)` | 41 |
| `getEmail_addr3()` | 44 |
| `setEmail_addr3(String email_addr3)` | 47 |
| `getEmail_addr4()` | 50 |
| `setEmail_addr4(String email_addr4)` | 53 |

**No `equals()`, `hashCode()`, or `toString()` overrides present.**

**Types Referenced:** `Serializable`

---

## Test Coverage Search Results

**Test directory:** `src/test/java/com/journaldev/spring/jdbc/`

**Test files found:**
| File | Covers |
|---|---|
| `model/PackageEntryTest.java` | `PackageEntry` only |
| `service/APKUpdaterServiceTest.java` | `APKUpdaterService` only (all `@Test` methods commented out) |
| `util/DateUtilTest.java` | `DateUtil` only |

**Search results for `Company` in test sources:** 0 matches
**Search results for `Driver` in test sources:** 0 matches
**Search results for `DriverEmails` in test sources:** 0 matches

**Conclusion:** None of the three model classes under audit have any direct or indirect test coverage anywhere in the test suite.

---

## Findings

---

### A12-1 — Severity: CRITICAL
**Class:** `Company`, `Driver`, `DriverEmails`
**Finding:** Zero test coverage for all three model classes
**Detail:** The entire test suite (`PackageEntryTest`, `APKUpdaterServiceTest`, `DateUtilTest`) contains no references whatsoever to `Company`, `Driver`, or `DriverEmails`. No unit tests, no integration tests, no indirect coverage through service or controller tests was found. These model classes carry business-critical data including credentials (`password`), PII (`email`, `securityno`, `licno`, `photo_url`), and session control (`maxSessionLength`, `max_session_length`, `gps_frequency`). Zero test coverage across all three classes constitutes a critical gap.

---

### A12-2 — Severity: HIGH
**Class:** `Company`
**Method:** `@Builder` constructor (lines 33–50)
**Finding:** The `contactDriver != null` branch is completely untested
**Detail:** Lines 44–49 implement a conditional override: when `contactDriver` is non-null, the builder silently replaces the `name`, `email`, and `password` fields with values sourced from the `Driver` object. This is the only non-trivial branch logic across all three files. It has material security implications — a caller who passes both explicit `email`/`password` arguments and a `contactDriver` will silently have those values overwritten without warning. Neither the `contactDriver != null` (true) path nor the `contactDriver == null` (false) path is covered by any test.

---

### A12-3 — Severity: HIGH
**Class:** `Company`
**Method:** `@Builder` constructor (lines 33–50)
**Finding:** No test for `contactDriver` with null `first_name` or `last_name`
**Detail:** Line 46 performs string concatenation: `contactDriver.getFirst_name() + " " + contactDriver.getLast_name()`. If either `first_name` or `last_name` is `null`, Java's `String` concatenation will produce the literal string `"null"` (e.g., `"null Smith"` or `"John null"`). There is no null-guard, no validation, and no test covering this path. The result is silently incorrect data stored in `name` without any exception being raised.

---

### A12-4 — Severity: HIGH
**Class:** `Driver`
**Finding:** `equals()` / `hashCode()` contract restricted to `email` only — not tested
**Detail:** `@EqualsAndHashCode(onlyExplicitlyIncluded = true)` with `@EqualsAndHashCode.Include` on `email` (line 22–23) means two `Driver` objects with the same `email` but different `id`, `comp_id`, `first_name`, etc. are considered equal. This is a deliberate but narrow identity contract. No test verifies: (a) that two drivers with the same email are equal, (b) that two drivers with the same `id` but different emails are not equal, (c) that a `Driver` with a `null` email behaves correctly in equals/hashCode, or (d) that the contract holds when `Driver` objects are used in `Set` or `Map` collections.

---

### A12-5 — Severity: HIGH
**Class:** `DriverEmails`
**Finding:** No `equals()`, `hashCode()`, or `toString()` — class is not Lombok-managed and has no tests
**Detail:** Unlike `Company` and `Driver`, `DriverEmails` is a plain hand-written POJO with no Lombok annotations. It has no `equals()` or `hashCode()` override, meaning identity comparison falls back to `Object` reference equality. If `DriverEmails` instances are ever compared for equality, placed in a `Set`, or used as `Map` keys, the behaviour will be incorrect. No test verifies the getter/setter round-trip, the absence of `equals`/`hashCode`, or any serialization behaviour.

---

### A12-6 — Severity: MEDIUM
**Class:** `Company`
**Finding:** Builder allows construction with `null` password stored in model
**Detail:** The `@Builder` constructor accepts `password` as a plain `String` with no validation. If `contactDriver` is null, the explicitly supplied `password` (which may itself be null) is stored directly. If `contactDriver` is non-null, `contactDriver.getPassword()` (which may also be null) replaces it. There is no test verifying that a null password is rejected, logged, or handled in any way, and no test verifying that the password field populated from `contactDriver` matches expectations.

---

### A12-7 — Severity: MEDIUM
**Class:** `Driver`
**Finding:** `drivers` field (self-referential list) has no tested semantics
**Detail:** Line 41 declares `private List<Driver> drivers` with the comment "List of company drivers when this driver's contactperson is true". This field is not populated by the `@Builder` constructor (it is absent from the builder parameter list), meaning it can only be set via the Lombok-generated `setDrivers(List<Driver>)`. There is no test verifying: (a) that the field is `null` by default after construction via the builder, (b) the interaction between `contactperson == true` and a populated `drivers` list, or (c) what happens when `contactperson == false` but `drivers` is non-empty.

---

### A12-8 — Severity: MEDIUM
**Class:** `DriverEmails`
**Finding:** No serialization round-trip test
**Detail:** `DriverEmails` implements `Serializable` with an explicit `serialVersionUID`. Unlike `Company` and `Driver`, it has no Lombok `@Data` or builder infrastructure, making it entirely dependent on its hand-written accessors. There is no test that serializes and deserializes a `DriverEmails` instance to verify that the `serialVersionUID` is stable and that the object is faithfully reconstructed, particularly for the four nullable `String` email address fields.

---

### A12-9 — Severity: MEDIUM
**Class:** `Company`, `Driver`
**Finding:** No serialization round-trip test for Lombok-managed Serializable classes
**Detail:** Both `Company` (serialVersionUID `8023991868841881837L`) and `Driver` (serialVersionUID `-100229563698950401L`) implement `Serializable`. Lombok's code generation (getters, setters, constructors, equals, hashCode, toString) is compile-time, but the serialized form depends on the actual field layout. No test verifies serialization/deserialization round-trips for either class, which is relevant given that these objects may be stored in sessions or transmitted across service boundaries.

---

### A12-10 — Severity: LOW
**Class:** `Company`
**Finding:** `@Singular` annotation on `arrRoles` builder parameter creates an immutable list — not tested
**Detail:** The `@Builder` constructor parameter `@Singular List<Roles> arrRoles` (line 33) causes Lombok to generate a builder that accumulates roles one at a time and produces an unmodifiable list. There is no test verifying that: (a) a `Company` built with no roles has an empty (not null) list, (b) roles added via the builder are actually accessible via `getArrRoles()`, or (c) attempting to mutate the list post-construction throws `UnsupportedOperationException`.

---

### A12-11 — Severity: LOW
**Class:** `Driver`
**Finding:** `@Singular` annotation on `arrDriverTrainings` builder parameter — not tested
**Detail:** The `@Builder` constructor parameter `@Singular List<DriverTraining> arrDriverTrainings` (line 65) has the same Lombok `@Singular` behaviour as `arrRoles` in `Company`. There is no test verifying the empty-list default or immutability of the produced list.

---

### A12-12 — Severity: LOW
**Class:** `Driver`
**Finding:** `primitive boolean` fields `contactperson` and `driver_based` default to `false` — no-arg constructor behaviour untested
**Detail:** The `@NoArgsConstructor` generates a no-arg constructor that initialises primitive `boolean` fields `contactperson` (line 32) and `driver_based` (line 35) to `false` by Java default. No test verifies the post-construction default state of a `new Driver()`, including that `id`, `comp_id`, `gps_frequency`, and `max_session_length` are `null` while the two primitives are `false`.

---

### A12-13 — Severity: INFO
**Class:** `DriverEmails`
**Finding:** Non-Lombok POJO inconsistency with other model classes
**Detail:** `Company` and `Driver` both use Lombok annotations (`@Data`, `@Builder`, `@NoArgsConstructor`) for consistency and reduced boilerplate. `DriverEmails` is a hand-written POJO with manually coded accessors and no builder. This inconsistency is not a defect in itself, but it increases the risk of missing methods, copy-paste errors in accessors, and drift from the pattern used elsewhere in the model layer. No test exists to guard against such regressions.

---

## Summary Table

| Finding | Class | Severity | Category |
|---|---|---|---|
| A12-1 | Company, Driver, DriverEmails | CRITICAL | Zero test coverage |
| A12-2 | Company | HIGH | Untested branch: contactDriver override |
| A12-3 | Company | HIGH | Untested null name concatenation |
| A12-4 | Driver | HIGH | Untested equals/hashCode email-only contract |
| A12-5 | DriverEmails | HIGH | Missing equals/hashCode, no tests |
| A12-6 | Company | MEDIUM | Null password stored without validation |
| A12-7 | Driver | MEDIUM | Untested self-referential drivers list semantics |
| A12-8 | DriverEmails | MEDIUM | No serialization round-trip test |
| A12-9 | Company, Driver | MEDIUM | No serialization round-trip test |
| A12-10 | Company | LOW | @Singular arrRoles immutability untested |
| A12-11 | Driver | LOW | @Singular arrDriverTrainings immutability untested |
| A12-12 | Driver | LOW | No-arg constructor defaults untested |
| A12-13 | DriverEmails | INFO | Non-Lombok inconsistency, no regression guard |
