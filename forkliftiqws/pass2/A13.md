# Audit Report A13 - Pass 2: Test Coverage
**Date:** 2026-02-27
**Agent:** A13
**Scope:** Model classes - DriverEquipment, DriverTraining, EmailLayout

---

## Reading Evidence

### File 1: DriverEquipment.java
**Path:** `src/main/java/com/journaldev/spring/jdbc/model/DriverEquipment.java`

| Item | Detail | Line |
|------|--------|------|
| Class | `DriverEquipment extends Equipment` | 10 |
| Annotation | `@Data` (Lombok - generates getters, setters, toString, equals, hashCode) | 7 |
| Annotation | `@NoArgsConstructor` (Lombok - generates no-arg constructor) | 8 |
| Annotation | `@EqualsAndHashCode(callSuper = false)` (Lombok - does NOT include superclass fields) | 9 |
| Constant | `serialVersionUID = -2200458485098129108L` | 11 |
| Field | `private Integer hours` | 13 |
| Field | `private Boolean trained` | 14 |
| Superclass | `Equipment` (18 fields: id, name, type_id, comp_id, active, manu_id, fuel_type_id, attachment_id, type, manu, fuel_type, comp, serial_no, mac_address, url, impact_threshold, alert_enabled, driver_based) | - |

**Lombok-generated methods (not written explicitly, generated at compile time):**

| Generated Method | Source |
|-----------------|--------|
| `getHours()` | `@Data` |
| `setHours(Integer hours)` | `@Data` |
| `getTrained()` | `@Data` |
| `setTrained(Boolean trained)` | `@Data` |
| `toString()` | `@Data` |
| `equals(Object o)` | `@Data` + `@EqualsAndHashCode(callSuper=false)` |
| `hashCode()` | `@Data` + `@EqualsAndHashCode(callSuper=false)` |
| `DriverEquipment()` (no-arg) | `@NoArgsConstructor` |

**All inherited getters/setters from Equipment via `@Data` on Equipment:**
getId, setId, getName, setName, getType_id, setType_id, getComp_id, setComp_id, isActive, setActive, getManu_id, setManu_id, getFuel_type_id, setFuel_type_id, getAttachment_id, setAttachment_id, getType, setType, getManu, setManu, getFuel_type, setFuel_type, getComp, setComp, getSerial_no, setSerial_no, getMac_address, setMac_address, getUrl, setUrl, getImpact_threshold, setImpact_threshold, isAlert_enabled, setAlert_enabled, isDriver_based, setDriver_based

**Types referenced:**
- `Integer` (hours field - boxed, nullable)
- `Boolean` (trained field - boxed, nullable)
- `Equipment` (superclass)
- `java.io.Serializable` (via Equipment)

**Production usage:**
- `EquipmentDAOImpl.getEquipmentByUser()` populates via `BeanPropertyRowMapper<>(DriverEquipment.class)`
- `EquipmentController.getEquipmentByUser()` returns `List<DriverEquipment>`

---

### File 2: DriverTraining.java
**Path:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java`

| Item | Detail | Line |
|------|--------|------|
| Class | `DriverTraining implements Serializable` | 14 |
| Annotation | `@Data` (Lombok) | 12 |
| Annotation | `@NoArgsConstructor` (Lombok) | 13 |
| Constant | `serialVersionUID = 3211228421130022712L` | 17 |
| Field | `private int id` | 19 |
| Field | `private int manufacture_id` | 20 |
| Field | `private int type_id` | 21 |
| Field | `private int fuel_type_id` | 22 |
| Field | `private String training_date` | 23 |
| Field | `private String expiration_date` | 24 |
| Constructor | `@Builder private DriverTraining(int, int, int, int, String, String)` | 27-35 |
| Import (unused) | `com.journaldev.spring.jdbc.model.Roles.RolesBuilder` | 6 |
| Import (unused) | `java.util.Date` | 4 |

**Lombok-generated methods:**

| Generated Method | Source |
|-----------------|--------|
| `getId()` | `@Data` |
| `setId(int id)` | `@Data` |
| `getManufacture_id()` | `@Data` |
| `setManufacture_id(int manufacture_id)` | `@Data` |
| `getType_id()` | `@Data` |
| `setType_id(int type_id)` | `@Data` |
| `getFuel_type_id()` | `@Data` |
| `setFuel_type_id(int fuel_type_id)` | `@Data` |
| `getTraining_date()` | `@Data` |
| `setTraining_date(String training_date)` | `@Data` |
| `getExpiration_date()` | `@Data` |
| `setExpiration_date(String expiration_date)` | `@Data` |
| `toString()` | `@Data` |
| `equals(Object o)` | `@Data` |
| `hashCode()` | `@Data` |
| `DriverTraining()` (no-arg) | `@NoArgsConstructor` |
| `DriverTraining.builder()` | `@Builder` (private constructor) |

**Types referenced:**
- `java.io.Serializable`
- `java.util.Date` (imported but unused)
- `com.journaldev.spring.jdbc.model.Roles.RolesBuilder` (imported but unused)
- `lombok.Builder`
- `lombok.Data`
- `lombok.NoArgsConstructor`

**Production usage:**
- `DriverDAOImpl.findAllTraining()` populates via `BeanPropertyRowMapper<>(DriverTraining.class)`
- `Driver` model holds `List<DriverTraining> arrDriverTrainings`
- `DriverController` assigns training list to driver at line 68

---

### File 3: EmailLayout.java
**Path:** `src/main/java/com/journaldev/spring/jdbc/model/EmailLayout.java`

| Item | Detail | Line |
|------|--------|------|
| Class | `EmailLayout implements Serializable` | 5 |
| Constant | `serialVersionUID = 7681377636404716362L` | 10 |
| Field | `private int id` | 12 |
| Field | `private String subject` | 13 |
| Field | `private String message` | 14 |
| Field | `private String type` | 15 |
| Method | `getId()` returns `int` | 17-19 |
| Method | `setId(int id)` | 20-22 |
| Method | `getSubject()` returns `String` | 23-25 |
| Method | `setSubject(String subject)` | 26-28 |
| Method | `getMessage()` returns `String` | 29-31 |
| Method | `setMessage(String message)` | 32-34 |
| Method | `getType()` returns `String` | 35-37 |
| Method | `setType(String type)` | 38-40 |

**No constructor defined** - relies on Java default no-arg constructor only.
**No `toString()`, `equals()`, or `hashCode()` defined.**
**No `@Builder` or Lombok annotations.**

**Types referenced:**
- `java.io.Serializable`
- `int` (id - primitive, cannot be null)
- `String` (subject, message, type - nullable)

**Production usage:**
- `EmailLayoutDAO.getEmailLayoutByType(String type)` instantiates `new EmailLayout()` and returns it (method body is a stub - no SQL executed, fields not populated)

---

## Test Coverage Summary

**Test files found:** 3 (PackageEntryTest.java, APKUpdaterServiceTest.java, DateUtilTest.java)

| Class | Direct test file | Indirect reference in tests |
|-------|-----------------|----------------------------|
| `DriverEquipment` | None | None |
| `DriverTraining` | None | None |
| `EmailLayout` | None | None |

All three classes have **zero test coverage** - they are not referenced in any test file directly or indirectly.

Note: `APKUpdaterServiceTest` contains its only two `@Test` methods commented out, making its effective test count zero.

---

## Findings

---

### A13-1, Severity: HIGH
**Class:** `DriverEquipment`
**Issue:** Complete absence of test coverage

No test exists for `DriverEquipment` in the entire test suite. The class is a data transfer object used by `BeanPropertyRowMapper` via JDBC, meaning all property binding happens reflectively at runtime. There is no test verifying that:
- Field names match database column aliases in `QUERY_DRIVER_EQUIPMENT` (`hours`, `trained` columns must exist in the view `v_driver_units`)
- The no-arg constructor works correctly for reflective instantiation
- Getters and setters for `hours` and `trained` function as expected

**Evidence:** Zero matches for `DriverEquipment` in `src/test/`.

---

### A13-2, Severity: HIGH
**Class:** `DriverTraining`
**Issue:** Complete absence of test coverage

No test exists for `DriverTraining`. It is used by `BeanPropertyRowMapper<>(DriverTraining.class)` in `DriverDAOImpl.findAllTraining()`. There is no test verifying:
- Field names match database column names (`manufacture_id`, `type_id`, `fuel_type_id`, `training_date`, `expiration_date`)
- The no-arg constructor works for reflective JDBC mapping
- Builder construction produces a correctly populated object

**Evidence:** Zero matches for `DriverTraining` in `src/test/`.

---

### A13-3, Severity: HIGH
**Class:** `EmailLayout`
**Issue:** Complete absence of test coverage

No test exists for `EmailLayout`. Furthermore, `EmailLayoutDAO.getEmailLayoutByType()` is a stub that always returns an empty, uninitialized `EmailLayout` with all fields at their defaults (`id=0`, `subject=null`, `message=null`, `type=null`). There is no test catching this silent data loss.

**Evidence:** Zero matches for `EmailLayout` in `src/test/`.

---

### A13-4, Severity: HIGH
**Class:** `EmailLayout` / `EmailLayoutDAO`
**Issue:** `getEmailLayoutByType()` is an unimplemented stub - no SQL executed

`EmailLayoutDAO.getEmailLayoutByType(String type)` instantiates an `EmailLayout` object and returns it immediately without executing any query, setting any fields, or using the `type` parameter at all. Any caller receives an object with `id=0`, `subject=null`, `message=null`, and `type=null`. This is a silent data integrity failure. There is no test that would detect this.

**File:** `src/main/java/com/journaldev/spring/jdbc/DAO/EmailLayoutDAO.java` lines 21-28

---

### A13-5, Severity: MEDIUM
**Class:** `DriverEquipment`
**Issue:** `@EqualsAndHashCode(callSuper = false)` silently excludes all 18 inherited `Equipment` fields from equality comparison

`DriverEquipment` uses `@EqualsAndHashCode(callSuper = false)`. This means two `DriverEquipment` objects with completely different `Equipment` parent fields (e.g., different `id`, `name`, `mac_address`) but the same `hours` and `trained` values will be considered equal. This is almost certainly incorrect for an equipment entity and could cause silent deduplication bugs in collections. No test exists to detect this behavior.

**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverEquipment.java` line 9

---

### A13-6, Severity: MEDIUM
**Class:** `DriverEquipment`
**Issue:** `hours` and `trained` fields use boxed types (`Integer`, `Boolean`) with no null-safety tests

Both `hours` (Integer) and `trained` (Boolean) are nullable boxed types. No test validates behavior when:
- `hours` is `null` (e.g., equipment with no logged hours from DB)
- `trained` is `null` (tri-state: true/false/unknown - but the column may be NOT NULL in the DB)
- Callers use `getTrained()` without null-checking before unboxing to `boolean`

A `NullPointerException` would occur if any caller auto-unboxes `getTrained()` when the DB returns NULL.

---

### A13-7, Severity: MEDIUM
**Class:** `DriverTraining`
**Issue:** Dates stored as `String` - no format validation, no parsing tests

`training_date` and `expiration_date` are declared as `String`, not `java.util.Date` or `LocalDate`. The imported `java.util.Date` on line 4 is unused, suggesting a refactoring was abandoned. There is no validation that date strings conform to any expected format, no test for invalid date strings, no test for null dates, and no test for expired training detection logic.

---

### A13-8, Severity: MEDIUM
**Class:** `DriverTraining`
**Issue:** `@Builder` constructor is `private` - public builder access relies on Lombok-generated static `builder()` method which is untested

The `@Builder`-annotated constructor at line 27 is `private`. Lombok generates a public static `DriverTraining.builder()` method. No test verifies that the builder correctly wires all six fields, or that omitting required fields results in meaningful defaults (`0` for int fields, `null` for Strings). In production, `BeanPropertyRowMapper` uses the no-arg constructor and setters, bypassing the builder entirely, making the builder dead code in the current production path.

---

### A13-9, Severity: MEDIUM
**Class:** `EmailLayout`
**Issue:** No `equals()`, `hashCode()`, or `toString()` implementations

`EmailLayout` has no Lombok annotations and no hand-written `equals()`, `hashCode()`, or `toString()`. It inherits `Object` defaults. This means:
- Two `EmailLayout` instances with identical field values are not considered equal (`==` reference comparison)
- Logging the object produces the default `ClassName@hexHash` output, making debugging difficult
- Use in `Set` or as a `Map` key would be incorrect

No test validates identity/equality semantics.

---

### A13-10, Severity: LOW
**Class:** `DriverTraining`
**Issue:** Unused import `com.journaldev.spring.jdbc.model.Roles.RolesBuilder`

Line 6 imports `Roles.RolesBuilder` which is not used anywhere in `DriverTraining`. This is dead code that introduces a coupling dependency to `Roles` with no benefit. No test would catch a compilation failure if `Roles` or its inner `RolesBuilder` were renamed or removed.

**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java` line 6

---

### A13-11, Severity: LOW
**Class:** `DriverTraining`
**Issue:** Unused import `java.util.Date`

Line 4 imports `java.util.Date` which is never referenced in the class body. This is a leftover from an incomplete refactoring where date fields were likely intended to be typed as `Date` rather than `String`.

**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java` line 4

---

### A13-12, Severity: LOW
**Class:** `DriverTraining`
**Issue:** Inline Javadoc comment misplaced on class declaration line

The Javadoc block `/**` begins on the same line as the class declaration (`public class DriverTraining implements Serializable {/**`) at line 14. This is a formatting defect that may cause IDE and documentation tool misinterpretation. The `serialVersionUID` comment it introduces is never closed before the field declaration on line 17, making it technically a block comment wrapping the `serialVersionUID` declaration rather than a class-level Javadoc.

**File:** `src/main/java/com/journaldev/spring/jdbc/model/DriverTraining.java` line 14

---

### A13-13, Severity: INFO
**Global:** All three classes
**Issue:** No integration tests for JDBC row mapping

All three model classes are populated via `BeanPropertyRowMapper` at runtime. The field-to-column name mappings (which use underscores, e.g., `manufacture_id`, `fuel_type_id`, `training_date`) are only validated at runtime when an actual database connection is present. The test suite contains no Spring integration tests or in-memory DB tests (e.g., H2) that would catch column name mismatches or missing columns before deployment.

---

## Summary Table

| Finding | Class | Severity | Category |
|---------|-------|----------|----------|
| A13-1 | DriverEquipment | HIGH | No test coverage |
| A13-2 | DriverTraining | HIGH | No test coverage |
| A13-3 | EmailLayout | HIGH | No test coverage |
| A13-4 | EmailLayout / EmailLayoutDAO | HIGH | Unimplemented stub method |
| A13-5 | DriverEquipment | MEDIUM | Incorrect equals/hashCode semantics |
| A13-6 | DriverEquipment | MEDIUM | Null safety - boxed types |
| A13-7 | DriverTraining | MEDIUM | Date fields as unvalidated String |
| A13-8 | DriverTraining | MEDIUM | Private builder - dead code in production path |
| A13-9 | EmailLayout | MEDIUM | Missing equals/hashCode/toString |
| A13-10 | DriverTraining | LOW | Unused import RolesBuilder |
| A13-11 | DriverTraining | LOW | Unused import java.util.Date |
| A13-12 | DriverTraining | LOW | Misplaced inline Javadoc on class declaration |
| A13-13 | All | INFO | No JDBC integration tests |
