# Pass 2 Test-Coverage Audit
**Audit run:** 2026-02-26-01
**Agent ID:** A61
**Files audited:**
- `src/main/java/com/bean/UserCompRelBean.java`
- `src/main/java/com/bean/XmlBean.java`

---

## 1. Reading-Evidence Blocks

### 1.1 `UserCompRelBean`

**File:** `src/main/java/com/bean/UserCompRelBean.java`
**Package:** `com.bean`
**Class:** `UserCompRelBean implements Serializable`
**Annotations on class:** `@Data`, `@NoArgsConstructor`

| Element | Kind | Line(s) |
|---------|------|---------|
| `serialVersionUID` | static final field (long) | 14 |
| `comp_id` | field (String, init null) | 16 |
| `email` | field (String, init null) | 17 |
| `timezone` | field (String, init null) | 18 |
| `user_id` | field (String, init null) | 19 |
| `UserCompRelBean()` | no-arg constructor (Lombok `@NoArgsConstructor`) | generated |
| `UserCompRelBean(String comp_id, String email, String timezone, String user_id)` | `@Builder` all-args constructor | 22–27 |
| `getComp_id()` | getter (Lombok `@Data`) | generated |
| `setComp_id(String)` | setter (Lombok `@Data`) | generated |
| `getEmail()` | getter (Lombok `@Data`) | generated |
| `setEmail(String)` | setter (Lombok `@Data`) | generated |
| `getTimezone()` | getter (Lombok `@Data`) | generated |
| `setTimezone(String)` | setter (Lombok `@Data`) | generated |
| `getUser_id()` | getter (Lombok `@Data`) | generated |
| `setUser_id(String)` | setter (Lombok `@Data`) | generated |
| `equals(Object)` | Lombok `@Data` generated | generated |
| `hashCode()` | Lombok `@Data` generated | generated |
| `toString()` | Lombok `@Data` generated | generated |
| `UserCompRelBean.builder()` | Lombok `@Builder` static factory | generated |

**Builder inner class** (generated by `@Builder` on constructor):
- `UserCompRelBeanBuilder.comp_id(String)`
- `UserCompRelBeanBuilder.email(String)`
- `UserCompRelBeanBuilder.timezone(String)`
- `UserCompRelBeanBuilder.user_id(String)`
- `UserCompRelBeanBuilder.build()`

---

### 1.2 `XmlBean`

**File:** `src/main/java/com/bean/XmlBean.java`
**Package:** `com.bean`
**Class:** `XmlBean` (plain POJO, no annotations)

| Element | Kind | Line(s) |
|---------|------|---------|
| `id` | field (String, init null) | 4 |
| `name` | field (String, init null) | 5 |
| `getId()` | getter, returns `id` | 6–8 |
| `setId(String id)` | setter, assigns `this.id = id` | 9–11 |
| `getName()` | getter, returns `name` | 12–14 |
| `setName(String name)` | setter, assigns `this.name = name` | 15–17 |

No explicit constructor; Java default no-arg constructor is the only constructor.
No `equals`, `hashCode`, or `toString` overrides.

---

## 2. Test-Directory Grep Results

**Test files found:**
```
src/test/java/com/calibration/UnitCalibrationImpactFilterTest.java
src/test/java/com/calibration/UnitCalibrationTest.java
src/test/java/com/calibration/UnitCalibratorTest.java
src/test/java/com/util/ImpactUtilTest.java
```

**Grep for `UserCompRelBean` in test directory:** No matches found.
**Grep for `XmlBean` in test directory:** No matches found.

Neither class is referenced in any test file in the entire test source tree.

---

## 3. Production Usage Context

### 3.1 `UserCompRelBean` usage in production code

| File | Usage |
|------|-------|
| `com/dao/DriverDAO.java` (lines 920, 925, 932, 937) | Built via `UserCompRelBean.builder()` from `ResultSet` rows in `getExpiredTrainigsComp()` and `getExpiringTrainigsComp()` |
| `com/dao/TrainingDAO.java` (lines 79–156) | Iterated; `getComp_id()`, `getUser_id()`, `getEmail()`, `getTimezone()` all called in alert-sending logic |

### 3.2 `XmlBean` usage in production code

| File | Usage |
|------|-------|
| `com/dao/UnitDAO.java` (lines 610–678) | Instantiated via `new XmlBean()`, `setId()` / `setName()` called; returned in `ArrayList<XmlBean>` from `getType()` and `getPower()` |
| `com/dao/QuestionDAO.java` (lines 311–341) | Instantiated via `new XmlBean()`, `setId()` / `setName()` called in `getQuestionContentById()` |
| `com/action/GetAjaxAction.java` (line 28) | Consumed as `ArrayList<XmlBean>` |
| `com/util/Util.java` (line 28) | Imported |
| `html-jsp/getAjax.jsp` (lines 3, 17) | `XmlBean` cast from list and fields read in JSP |

---

## 4. Coverage Gaps and Findings

---

### A61-1 | Severity: CRITICAL | `UserCompRelBean` — zero test coverage (no test class exists)

No test class for `UserCompRelBean` exists anywhere in the test source tree. Every method, constructor, builder, and generated Lombok member is completely untested. The class is a core data-transfer object used in production alert-dispatch logic in `TrainingDAO` and populated from the database in `DriverDAO`. A defect in field mapping or builder construction would silently corrupt alert recipients, companies, or timezone branching in production.

**Uncovered elements:**
- `@Builder` constructor `UserCompRelBean(String, String, String, String)` — no test verifies fields are assigned correctly
- No-arg constructor (Lombok `@NoArgsConstructor`) — never exercised
- `getComp_id()` / `setComp_id(String)` — untested
- `getEmail()` / `setEmail(String)` — untested
- `getTimezone()` / `setTimezone(String)` — untested
- `getUser_id()` / `setUser_id(String)` — untested
- `equals()` / `hashCode()` / `toString()` — untested
- Builder fluent API (`builder().comp_id().email().timezone().user_id().build()`) — untested

---

### A61-2 | Severity: CRITICAL | `XmlBean` — zero test coverage (no test class exists)

No test class for `XmlBean` exists anywhere in the test source tree. All six elements of the class (two fields, two getters, two setters, plus the implicit default constructor) are completely untested. `XmlBean` is a shared DTO used across three DAOs (`UnitDAO`, `QuestionDAO`) and exposed directly to JSP rendering via `getAjax.jsp`. A defect in getter/setter parity or field initialisation would silently propagate incorrect data to UI responses.

**Uncovered elements:**
- Default constructor — never exercised in a test
- `getId()` — untested
- `setId(String)` — untested
- `getName()` — untested
- `setName(String)` — untested
- Round-trip field assignment (`setId` then `getId`, `setName` then `getName`) — untested
- Initial null-state of fields — untested

---

### A61-3 | Severity: HIGH | `UserCompRelBean` — builder field-order correctness untested

The `@Builder` constructor at lines 22–27 maps positional arguments `(comp_id, email, timezone, user_id)` to the corresponding fields. There is no test asserting that `UserCompRelBean.builder().comp_id("C1").email("e@x.com").timezone("US/Eastern").user_id("U1").build()` produces an object where `getComp_id()` returns `"C1"`, not `"U1"` or another transposition. Argument transposition bugs in builders are a known silent failure mode.

---

### A61-4 | Severity: HIGH | `XmlBean` — no `equals`/`hashCode` contract defined or tested

`XmlBean` relies on Java object identity for equality (no `equals`/`hashCode` override). There is no test documenting or enforcing this contract. If consuming code ever places `XmlBean` instances into a `Set` or uses them as `Map` keys, the identity-equality semantic will produce incorrect de-duplication. The absence of tests means this design decision is undocumented and unguarded.

---

### A61-5 | Severity: HIGH | `UserCompRelBean` — `timezone` null-safety logic untested at bean level

`TrainingDAO` calls `UserCompRelBean.getTimezone().contains("US/")` and `.contains("Canada/")` directly on the value returned by the getter (lines 86, 130). If `timezone` is null (it is initialised to `null` and can remain null if not set via builder or setter), a `NullPointerException` will be thrown at runtime. No test exists at the bean level to verify null-safe behaviour or to document the expectation that `timezone` is non-null when the getter is called.

---

### A61-6 | Severity: MEDIUM | `UserCompRelBean` — no-arg constructor leaves all fields null; not tested

Lombok `@NoArgsConstructor` produces a constructor that leaves all four fields at their declared default of `null`. No test verifies this initial state. Consumers that instantiate `UserCompRelBean` with the no-arg constructor and then call getters without setting fields first will receive `null` without any warning. The interaction between `@NoArgsConstructor` and `@Builder` (both present) is also untested.

---

### A61-7 | Severity: MEDIUM | `XmlBean` — initial field state (null) not asserted in any test

Both `id` and `name` are initialised to `null` (lines 4–5). No test verifies that a newly constructed `XmlBean` returns `null` from `getId()` and `getName()`. Consumers in `UnitDAO` and `QuestionDAO` call `setId` / `setName` before reading, so the risk is lower, but the contract is unverified.

---

### A61-8 | Severity: MEDIUM | `UserCompRelBean` — Lombok `@Data` `toString()` not tested; contains PII fields

`@Data` generates a `toString()` that will include `email` and `user_id`. There is no test that verifies the format, nor any test that catches accidental logging of PII via `toString()`. While this is partly a design concern, the absence of tests means the surface is completely invisible to regression detection.

---

### A61-9 | Severity: LOW | `XmlBean` — no serialisation or `Serializable` implementation

`XmlBean` does not implement `Serializable`, yet it is placed into `ArrayList` containers that are stored in the JSP session scope via Struts (implied by `getAjax.jsp` usage). If session persistence or clustering is ever enabled, serialisation failures will occur at runtime. No test exists to catch this.

---

### A61-10 | Severity: LOW | `UserCompRelBean` — `serialVersionUID` value not validated by any test

`serialVersionUID = 3266139143986440056L` (line 14) is declared but never exercised by a serialisation round-trip test. If fields are added or removed and the UID is not updated, silent deserialisation corruption can occur in environments that cache serialised beans (e.g., HTTP session replication).

---

### A61-11 | Severity: INFO | Neither bean class has integration-level tests covering DAO construction paths

`DriverDAO.getExpiredTrainigsComp()` and `getExpiringTrainigsComp()` construct `UserCompRelBean` instances from `ResultSet` column mappings. `UnitDAO.getType()`, `getPower()`, and `QuestionDAO.getQuestionContentById()` construct `XmlBean` instances similarly. No integration or DAO-layer test validates that the column-to-field mapping is correct for either bean. This is out of scope for unit tests on the bean itself but is noted as a related gap.

---

## 5. Summary Table

| Finding | Severity | Class | Description |
|---------|----------|-------|-------------|
| A61-1 | CRITICAL | `UserCompRelBean` | Zero test coverage — no test class exists |
| A61-2 | CRITICAL | `XmlBean` | Zero test coverage — no test class exists |
| A61-3 | HIGH | `UserCompRelBean` | Builder field-order correctness untested |
| A61-4 | HIGH | `XmlBean` | No `equals`/`hashCode` contract defined or tested |
| A61-5 | HIGH | `UserCompRelBean` | `timezone` null-safety not tested; NPE risk in `TrainingDAO` |
| A61-6 | MEDIUM | `UserCompRelBean` | No-arg constructor null-field state not tested |
| A61-7 | MEDIUM | `XmlBean` | Initial null field state not asserted |
| A61-8 | MEDIUM | `UserCompRelBean` | Lombok `toString()` exposes PII fields; not tested |
| A61-9 | LOW | `XmlBean` | Not `Serializable`; session-scope usage may fail under clustering |
| A61-10 | LOW | `UserCompRelBean` | `serialVersionUID` not validated by a serialisation round-trip test |
| A61-11 | INFO | Both | DAO-layer column-to-field mapping untested at integration level |

**Total findings: 11** (2 CRITICAL, 3 HIGH, 3 MEDIUM, 2 LOW, 1 INFO)

---

*End of report — Agent A61, Pass 2, Audit 2026-02-26-01*
