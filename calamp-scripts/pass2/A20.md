# Pass 2 Test Coverage — Agent A20

**Files:**
- `CALAMP APPS/LMUToolbox_V41/ConfigParams.xml`
- `CALAMP APPS/LMUToolbox_V41/PEG List.xml`
- `CALAMP APPS/LMUToolbox_V41/VBUS.xml`

**Branch:** main (confirmed: `git -C ... rev-parse --abbrev-ref HEAD` = `main`)
**Date:** 2026-02-27

---

## Reading Evidence

### FILE: `CALAMP APPS/LMUToolbox_V41/ConfigParams.xml`

**Format and structure:**
SpreadsheetML (Office XML, Excel-compatible). Single worksheet named `ConfigParams`. Columns (left to right): Name, ID-Dec, ID-Hex, 8-bit Max Index, 32-bit Max Index, Linux Max Index, Param Value Type, Notes/Usage, LMDecoder. All parameter IDs appear in the `ID-Dec` column as `<Data ss:Type="Number">`. A format key row documents the value encoding convention: `U=UnsignedDecimal, S=SignedDecimal, M=Masked, A=ASCII; |=Delimiter; IP=IPAddress, ST=String`.

**Approximate entry count:**
Table declares `ExpandedRowCount="2106"`. Subtracting header/title rows (~10), approximately **2095 parameter entries**. Total numeric data cells: 1,258 (some rows share merged or formula cells).

**Author:** Kevin Scully. **Last saved:** 2020-10-31. **Excel internal version:** 40.00.

**Register 3331 documented:**
YES. Entry at line 8876:
- Name: `VBUS_TYPE2_DTCFILTER_TXT`
- Description: `DTC Filter Text`
- Type: `8-char null term` / `8A|ST`
- This is a VBUS Type-2 DTC (Diagnostic Trouble Code) filter text string — an 8-character ASCII filter pattern used to match or suppress specific DTC codes reported via vehicle bus.
- All CSV production scripts set this to `2A2A2A2A2A00` = `*****` (null-terminated). The wildcard value effectively disables DTC filtering (match everything / accept all DTCs). The field is NOT an opaque or secret value — it is a fully documented string parameter.

**Register 2309 documented:**
YES. Entry at line 6878:
- Name: `PAP_PWORD_STRING`
- Description: `<PPP-PAP Auth Password string>`
- Type: `16-char null term` / `16A|ST`
- This is the PPP PAP (Password Authentication Protocol) password for cellular data authentication. All production CSV scripts set this to `4B6F726531323300` = `Kore123`. This is a plaintext carrier authentication credential stored in the script and the device.

**Register 2319 documented:**
YES. Entry at line 7148:
- Name: `URL_INBOUND`
- Description: `<Inbound Server URL string>`
- Type: `64-char null term` / `64A|ST`
- Used across all production scripts to configure the server IP or hostname.

**Any schema or version reference:**
No DTD, no XSD, no `schemaLocation` attribute. The file is a raw SpreadsheetML document. The `<Version>40.00</Version>` element is an Excel workbook format version, not a toolbox semantic version. No explicit `LMUToolbox V41` version string appears inside the file itself. The folder name `LMUToolbox_V41` is the only version reference.

---

### FILE: `CALAMP APPS/LMUToolbox_V41/PEG List.xml`

**Format and structure:**
SpreadsheetML, four worksheets:
- `Triggers` — 117 rows (PEG trigger codes and definitions)
- `Conditions` — 329 rows (PEG condition codes)
- `Actions` — 207 rows (PEG action codes)
- `Acc Types` — 283 rows (accelerometer/accessory type definitions)

Columns include: Code (numeric), Short Name (symbolic), Definition (human-readable), and platform compatibility flags for LMU-4100, LMU-1xxx, STM32, STM8S, LMU32.

**Approximate entry count:** ~120 triggers, ~329 conditions, ~207 actions, ~283 accessory types. Comprehensive coverage of the PEG event system.

**Author:** Kevin Scully. **Created:** 2008-09-18. **Last saved:** 2020-10-31.

**Register 3331, 2309, 2319 documented:** Not applicable — PEG List.xml covers PEG event codes, not configuration parameter register IDs.

**Any schema or version reference:** No DTD or XSD. Same SpreadsheetML format without validation schema.

---

### FILE: `CALAMP APPS/LMUToolbox_V41/VBUS.xml`

**Format and structure:**
SpreadsheetML, single worksheet named `ConfigParams` (note: the tab is named `ConfigParams` despite the file being named VBUS.xml). The table has `ExpandedRowCount="9858"` with 14 columns: PGN, Name, LEN, Type, Pos, LEN, SPN, Name, Notes, Range, ?, Mult, Offset, UOM2. This is a J1939 / vehicle bus parameter definition reference containing PGN (Parameter Group Numbers) and SPN (Suspect Parameter Numbers) for OBD/CAN bus data interpretation.

**Approximate entry count:** 9,858 rows (declared), approximately 9,800+ vehicle bus signal definitions.

**Last printed:** 2016-12-16. **Last saved:** 2020-10-31.

**Register 3331, 2309, 2319 documented:** Not applicable — VBUS.xml is a J1939 PGN/SPN reference, not an LMU configuration register map.

**Any schema or version reference:** No DTD or XSD. No version string inside the file. The internal date of 2016-12-16 (last printed) predates the 2020-10-31 save date by 4 years, suggesting the VBUS data was not revised between 2016 and 2020.

---

## Coverage Analysis

### Is register 3331 documented in ConfigParams.xml?

YES — fully documented. Register 3331 (`VBUS_TYPE2_DTCFILTER_TXT`) is an 8-character ASCII DTC filter string. The value `*****` (hex `2A2A2A2A2A00`) set in all production scripts is a wildcard that disables DTC filtering. The earlier assumption that this was unknown or secret was incorrect — ConfigParams.xml provides a clear definition. However, the practical intent of setting `*****` universally (rather than a meaningful filter) is not documented in the scripts themselves, creating a maintenance ambiguity: reviewers reading the raw CSV cannot determine whether this is intentional configuration or a placeholder left from a template.

### Is register 2309 documented? Is it a carrier auth field?

YES — documented as `PAP_PWORD_STRING`, the PPP-PAP authentication password used when the LMU establishes a cellular data connection. The value `Kore123` stored across 21 of 31 CSV scripts (68%) is a plaintext credential. The UK scripts (161.31, 161.32) and the Demo Script (61.142) do not set register 2309, indicating those carriers or networks do not require PAP authentication (or use no-auth APNs).

**Critical concern:** `Kore123` is a cleartext carrier credential stored in version-controlled LMU configuration scripts. Any repository access exposes this credential. If the Kore carrier account is shared across customers, a credential compromise could affect all connected devices.

### Does ConfigParams.xml cover all parameter IDs used in the CSV scripts?

YES — all 17 parameter IDs audited are present in ConfigParams.xml:

| Register | Name (ConfigParams) | Description |
|----------|--------------------|-----------------------------|
| 265 | TPARAM_TIMER_TIMEOUT | Timer trigger timeout (seconds) |
| 266 | TPARAM_ACC_THRESHOLD | Accelerometer threshold |
| 768 | INBND_ADDRLIST_ADDR | Inbound server address list |
| 769 | INBND_ADDRLIST_PORT | Inbound server port list |
| 1024 | CFG_SREG | Configuration status register |
| 2306 | GPRS_CONTEXT_STRING | GPRS APN context string |
| 2308 | PAP_USER_STRING | PPP-PAP auth username |
| 2309 | PAP_PWORD_STRING | PPP-PAP auth password |
| 2311 | MAINT_REMOTE_PORT | Maintenance server remote port |
| 2314 | PPP_USER_STRING | PPP username |
| 2315 | PPP_PWORD_STRING | PPP password |
| 2316 | DIAL_STRING | Dial string |
| 2318 | PRL_DIAL_STRING | CDMA PRL update dial string |
| 2319 | URL_INBOUND | Inbound server URL |
| 2320 | URL_MAINT | Maintenance server URL |
| 2322 | MAINT_INTERVAL | Maintenance interval |
| 3331 | VBUS_TYPE2_DTCFILTER_TXT | VBUS Type-2 DTC filter text |

Coverage is 100% for the parameters surveyed.

### Is there a schema file or DTD validating the XML structure?

NO. None of the three files contains a DOCTYPE declaration, XSD `schemaLocation`, or any reference to an external schema. The files are unvalidated SpreadsheetML. There is no automated way to detect if an entry is malformed, truncated, or has columns in the wrong order without manually opening the file in Excel.

### Is there any changelog or versioning for the toolbox files?

NO. The folder name `LMUToolbox_V41` implies version 41, but:
- There is no changelog, release notes, or diff history within the XML files.
- The only internal date metadata is the `<LastSaved>` field.
- There is no previous-version folder (e.g., `LMUToolbox_V40`) to compare against.
- No git history tracks changes to these files separately from the repository commit log.
- The `<Version>40.00</Version>` in all three files is the Microsoft Office XML format version, not the LMU Toolbox semantic version.

### Is LMUToolbox_V41 the current version? Does it match LMUMgr_8.9.10.7.zip?

The relationship between `LMUToolbox_V41` and `LMUMgr_8.9.10.7` is not documented anywhere in the repository. These appear to be separate versioning tracks (toolbox data files vs. LMU Manager software), and no mapping table exists. It cannot be confirmed whether V41 is compatible with or current for LMU Manager 8.9.10.7. If LMU Manager 8.9.10.7 supports parameter IDs beyond what V41 documents, any newer parameters used in scripts would not be covered by the reference files.

### Is VBUS.xml actually referenced by any CSV script?

NO. A full-text search of all CSV scripts finds no reference to VBUS.xml, and no CSV script uses a VBUS parameter register ID that would trace back to the J1939 PGN/SPN entries in VBUS.xml. VBUS.xml appears to be a reference document for manual interpretation of vehicle bus data, not directly consumed by any script or automated tooling in this repository. Its presence in the toolbox folder alongside the other files suggests it is used by LMU Manager software directly (to decode incoming vehicle bus messages), not by the configuration scripts.

### Is PEG List.xml's event set sufficient for the events configured in the CSV scripts?

The CSV scripts configure PEG events via packed binary values in registers 768 (PEG event word) and 769 (PEG port/channel word), not via symbolic names. PEG List.xml documents the full trigger, condition, action, and accessory-type code set for cross-reference. The 4-worksheet structure (Triggers, Conditions, Actions, Acc Types) appears comprehensive for the LMU platform. However, because the CSV scripts store PEG configurations as opaque hex values (e.g., `768,0,6704EB0F`), there is no automated cross-check to verify that the packed codes in use are valid entries within PEG List.xml. A human must manually decode the hex, extract trigger/condition/action nibbles, and look them up in PEG List.xml. No tooling exists in this repository to do that.

---

## Findings

**A20-1** — MEDIUM: Plaintext carrier credential (`Kore123`) stored in version-controlled scripts and undocumented in toolbox reference

**Description:** Register 2309 (`PAP_PWORD_STRING`) is set to `Kore123` (hex `4B6F726531323300`) in 21 of 31 CSV scripts. ConfigParams.xml correctly identifies this as a PPP-PAP authentication password. The credential is stored in plaintext in the repository. Any user with repository read access obtains this carrier authentication credential. The toolbox reference documents the field purpose but provides no guidance on credential management, rotation policy, or the risk of committing credentials to source control.

**Fix:** Remove the literal credential from all CSV scripts and replace with a placeholder token (e.g., `<<PAP_PASSWORD>>`). Inject the actual value at deployment time using a secrets manager or a deployment script that substitutes the token. Document the credential storage policy in the repository README. Audit whether `Kore123` is a shared credential across multiple customers and, if so, coordinate a rotation.

---

**A20-2** — LOW: Register 3331 (`VBUS_TYPE2_DTCFILTER_TXT`) set to wildcard `*****` in all scripts without operational justification

**Description:** ConfigParams.xml documents register 3331 as an 8-character DTC filter text string. All 27 CSV scripts that include this register set it to `*****` (match-all wildcard). While technically valid, this universal wildcard setting means no DTC filtering is applied on any deployment. There is no comment or documentation in any script explaining whether this is intentional (accepting all DTCs for forwarding to the platform) or an unreviewed template default. If the platform is expected to filter or suppress certain DTCs, this setting would silently pass all codes through.

**Fix:** Add a comment field or naming convention in the script file name or a companion README per script set explaining the intended DTC filter policy. If `*****` is the correct production value for all deployments, document this explicitly. If specific customers require DTC filtering, create per-customer variants with appropriate filter strings and verify the values against VBUS.xml.

---

**A20-3** — LOW: No schema validation for toolbox XML files; structural errors cannot be detected automatically

**Description:** None of the three toolbox XML files (ConfigParams.xml, PEG List.xml, VBUS.xml) contains a DTD, XSD schema reference, or any other machine-readable validation contract. The files are raw SpreadsheetML, and their correctness depends entirely on manual Excel review. If a row is missing a column, has a transposed ID, or contains a typo in a parameter name, no automated check will flag it. This is a reference-data integrity gap: the toolbox is the authoritative source for parameter definitions used to interpret and validate CSV scripts, but the toolbox itself has no validation layer.

**Fix:** Define an XSD schema for the SpreadsheetML structure (or export the ConfigParams sheet to a structured format such as JSON or CSV) and add a CI lint step that validates all toolbox files against the schema on each commit. At minimum, a script that extracts all ID-Dec values and checks for duplicates or gaps would catch the most common authoring errors.

---

**A20-4** — LOW: No changelog or version lineage for toolbox files; compatibility with LMUMgr_8.9.10.7 is unverifiable

**Description:** The folder is named `LMUToolbox_V41` but the internal XML files carry no version string, release date, or change log. The co-located `LMUMgr_8.9.10.7.zip` uses an entirely different versioning scheme, and no document in the repository maps toolbox versions to LMU Manager versions. If newer firmware or LMU Manager releases introduced new parameter IDs not present in V41, scripts using those IDs would have no reference documentation. The last-saved date of 2020-10-31 means the toolbox is at least 5 years old relative to this audit date (2026-02-27), while CSV scripts continue to be added to the repository.

**Fix:** Maintain a `CHANGELOG.md` within the `LMUToolbox_V41` folder that records which firmware and LMU Manager versions this toolbox revision covers. When upgrading to a new toolbox version, create a new versioned folder (e.g., `LMUToolbox_V42`) and update all scripts to reference the correct toolbox version. Document the compatibility matrix in the repository README.

---

**A20-5** — INFO: VBUS.xml is unreferenced by any CSV script; its presence is potentially misleading

**Description:** VBUS.xml (280,908 lines, ~9,858 J1939 PGN/SPN definitions) is included in the toolbox folder but is not referenced by any CSV configuration script in the repository. It is a vehicle bus signal reference used by LMU Manager to decode incoming CAN/J1939 data messages, not a configuration input. Its last-printed date of 2016-12-16 suggests it has not been actively used in the past decade. A developer unfamiliar with the LMU platform might assume this file is involved in script configuration and waste time cross-referencing it.

**Fix:** Add a short `README.txt` to the `LMUToolbox_V41` folder explaining the role of each file: ConfigParams.xml (parameter register reference), PEG List.xml (PEG event code reference), VBUS.xml (J1939 vehicle bus signal decoder reference, not used for script authoring). Clarify whether the current version of VBUS.xml is still accurate or whether a newer J1939 signal definition set exists.

---

**A20-6** — INFO: PEG event configurations in CSV scripts are opaque hex values with no automated cross-reference to PEG List.xml

**Description:** Registers 768 and 769 carry packed binary PEG event configurations (e.g., `768,0,6704EB0F`). PEG List.xml provides the full trigger/condition/action code lookup table, but no tooling in this repository decodes the hex values in the scripts and validates them against the PEG List. A misconfigured PEG event (invalid trigger code, unsupported action) would not be detected at script authoring time and would only surface as unexpected device behaviour in the field.

**Fix:** Write a validation utility (Python or JavaScript) that reads each CSV script, extracts all 768/769 values, unpacks the PEG fields, and cross-references each code against PEG List.xml to confirm it is a valid, platform-supported entry. Integrate this check into any pre-deployment review process.
