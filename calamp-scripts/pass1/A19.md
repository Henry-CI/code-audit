# Pass 1 Security — Agent A19

**Files:**
- `Aus Script/Komatsu_AU/69.002 RD Komatsu Monogoto Final.csv`
- `Demo Script/61.142 Demo Rayven datamono.csv`

**Branch:** main (confirmed — `git rev-parse --abbrev-ref HEAD` returned `main`)
**Date:** 2026-02-27

---

## Reading Evidence

### FILE: `Aus Script/Komatsu_AU/69.002 RD Komatsu Monogoto Final.csv`

**Row count:** 1231 data rows (plus 1 header row = 1232 lines total)

**All decoded server endpoints (IPs, hostnames, ports):**
- Register 2319,0: `35322E3136342E3234312E31373900` → `52.164.241.179` (primary server — Azure-range IP)
- Register 2320: not present in file (no secondary server configured)
- Register 2311: not present in file (server port register absent; default port used)
- Register 2312,0: `0x0011` = decimal 17 (this is not register 2311; purpose uncertain — not the standard server port register)

**All decoded APN names:**
- Register 2306,0: `646174612E6D6F6E6F00` → `data.mono`
- Register 2306,1: `646174612E6D6F6E6F00` → `data.mono`

**APN username (decoded):**
- Register 2314: not present — blank/not set

**APN password (decoded):**
- Register 2315: not present — blank/not set

**Register 2309 value (decoded):**
- Register 2309,0: `4B6F726531323300` → `Kore123`

**Register 3331 value (decoded):**
- Register 3331,0: `2A2A2A2A2A00` → `*****`

**Other credential-like values:**
- Register 2308,0: `4B6F726500` → `Kore` (operator/carrier name)
- Register 2318,0: `2A323238393900` → `*22899` (looks like a USSD/dial string, not a password)
- Register 2178,0: `3C45413E3C53303E3C3D2A3E3C54313E00` → `<EA><S0><=*><T1>` (appears to be a modem AT-command or control string, not a credential)

---

### FILE: `Demo Script/61.142 Demo Rayven datamono.csv`

**Row count:** 1231 data rows (plus 1 header row = 1232 lines total)

**All decoded server endpoints (IPs, hostnames, ports):**
- Register 2319,0: `35322E3136342E3234312E31373900` → `52.164.241.179` (primary server — identical to Komatsu file)
- Register 2320: not present (no secondary server configured)
- Register 2311: not present (server port register absent; default port used)
- Register 2312,0: `0x0011` = decimal 17 (same as Komatsu file)

**All decoded APN names:**
- Register 2306,0: `646174612E6D6F6E6F00` → `data.mono`
- Register 2306,1: `646174612E6D6F6E6F00` → `data.mono`

**APN username (decoded):**
- Register 2314: not present — blank/not set

**APN password (decoded):**
- Register 2315: not present — blank/not set

**Register 2309 value (decoded):**
- Register 2309,0: `4B6F726531323300` → `Kore123`

**Register 3331 value (decoded):**
- Register 3331,0: `2A2A2A2A2A00` → `*****`

**Other credential-like values:**
- Register 2308,0: `4B6F726500` → `Kore` (operator/carrier name)
- Register 2318,0: `2A323238393900` → `*22899` (USSD/dial string)
- Register 2178,0: `3C45413E3C53303E3C3D2A3E3C54313E00` → `<EA><S0><=*><T1>` (modem control string)

---

**Notable differences between the two files:**

The two files are nearly identical in their security-relevant parameters. The only differences observed across the full files are:

1. Register 769,0 (a timing/interval register, not security-sensitive): Komatsu = `0x05DC` (1500); Demo = `0x05DF` (1503).
2. Register 1024,1 (device configuration byte): Komatsu = `0x45`; Demo = `0x3D`.
3. Register 1024,23 (device configuration byte): Komatsu = `0x02`; Demo = `0x8E`.

All security-sensitive registers (2306, 2308, 2309, 2318, 2319, 3331, and the absent 2314/2315/2311/2320) are identical between the two files. The demo script uses the same production credentials, APN, and server endpoint as the Komatsu production script.

---

## Findings

### Finding A19-1

**A19-1** — HIGH: Credential-like value `Kore123` committed in plaintext (register 2309)

**Description:** Register 2309,0 in both files decodes to `Kore123`. Per the audit brief, this register is described as "credential-like" and the value `Kore123` has been flagged as HIGH severity when present. The value appears to be a SIM/network credential or PIN associated with the Kore wireless carrier. It is committed in plaintext in git history and is present in both the production Komatsu script and the Demo script. Anyone with read access to this repository can recover the value by decoding the hex string.

**Fix:** Rotate the `Kore123` credential immediately with the Kore carrier. After rotation, remove the plaintext value from the repository by rewriting git history (e.g., `git filter-repo` or BFG Repo Cleaner) and force-pushing to all remotes. Going forward, device configuration scripts containing credentials should not be stored in version control, or the credential fields should be populated at provisioning time from a secrets manager rather than baked into committed CSV files.

---

### Finding A19-2

**A19-2** — HIGH: Production server IP `52.164.241.179` committed in plaintext (register 2319) — present in Demo script

**Description:** Register 2319,0 in both files decodes to the IP address `52.164.241.179`. This is a routable public IP (Azure address range) representing the primary data collection server. This IP is committed in plaintext to git. Of particular concern, the Demo script (`61.142 Demo Rayven datamono.csv`) uses the identical production server IP rather than a separate demo or staging endpoint. If the demo script is deployed on demonstration or test devices, those devices will transmit to the production server, potentially polluting production data or exposing the server to additional attack surface. Additionally, the server IP being publicly visible in git allows attackers to identify the target infrastructure.

**Fix:** (1) Ensure the demo script points to a dedicated demo/staging server rather than the production IP. (2) Consider replacing hardcoded IPs with resolvable hostnames backed by DNS so the server can be changed without updating all device scripts. (3) If the IP must remain in config files, treat the repository as sensitive and restrict access accordingly.

---

### Finding A19-3

**A19-3** — MEDIUM: APN name `data.mono` committed in plaintext (register 2306) — same in Demo and production scripts

**Description:** Register 2306 in both files decodes to `data.mono`, which is the APN (Access Point Name) for the Monogoto IoT SIM carrier. This is committed in plaintext in git. While APN names are often considered semi-public configuration details rather than secrets, the combination of APN name, carrier credential (`Kore123` in register 2309), and carrier name (`Kore` in register 2308) together constitutes a set of network access parameters that could allow an attacker to provision their own SIM on the same carrier/APN with the same credentials, or to understand the cellular network path the device uses. No APN username (2314) or APN password (2315) are set, which reduces the risk somewhat, but the absence of APN-level authentication means the APN is open to any SIM that can reach it.

**Fix:** Confirm with the Monogoto/Kore carrier whether the `data.mono` APN requires authentication. If APN-level username/password authentication can be enabled, enable it and store those credentials securely (not in git). If the APN is intentionally open, document that decision explicitly.

---

### Finding A19-4

**A19-4** — MEDIUM: Demo script uses identical production credentials and server as the production Komatsu script

**Description:** The Demo script (`61.142 Demo Rayven datamono.csv`) is effectively a copy of the production Komatsu script from a security perspective. All security-sensitive registers are identical: the same APN (`data.mono`), the same carrier credential (`Kore123`), the same server IP (`52.164.241.179`), and the same masked register 3331 value (`*****`). Demo scripts are higher-risk artefacts because they are shared more widely (with prospects, integrators, or at events) and may be deployed on devices that are less physically controlled. Using production credentials in a demo script means that any compromise of the demo configuration directly exposes the production infrastructure.

**Fix:** Create a dedicated demo configuration that uses a sandboxed/isolated server endpoint, demo-specific SIM credentials, and does not share any parameters with production deployments. Treat the demo script as a separate security boundary.

---

### Finding A19-5

**A19-5** — LOW: Register 3331 value `*****` (five asterisks) present in both files — purpose undocumented

**Description:** Register 3331,0 in both files decodes to `*****` (five ASCII asterisk characters, hex `2A2A2A2A2A`). The audit brief notes this register is "Unknown (seen as '*****' in other files)". The masking-style value (five asterisks) is a common obfuscation placeholder that suggests this field may contain a credential or PIN that has been replaced with a visual mask in the configuration tooling output, rather than a genuine cleared value. If the device firmware interprets `*****` as a literal credential, any device using these scripts would share the same five-asterisk value, which is trivially guessable.

**Fix:** Investigate what register 3331 controls in the CalAmp LMU firmware documentation. If it is a credential or authentication field, determine whether `*****` is a literal value being sent to the device or whether it is a placeholder that the provisioning tool replaces at programming time. If it is a literal credential, it should be rotated to a non-default, non-guessable value before deployment.

---

### Finding A19-6

**A19-6** — INFO: No APN username or password configured (registers 2314, 2315 absent)

**Description:** Registers 2314 (APN username) and 2315 (APN password) are not present in either file. This means APN-level PAP/CHAP authentication is not configured. The APN `data.mono` is accessed without credentials. This is consistent with some IoT carrier APNs that rely on SIM-based authentication rather than username/password, but it means there is no secondary authentication layer on the APN connection.

**Fix:** Confirm with the Monogoto/Kore carrier that SIM-based authentication (IMSI/ICCID locking) is enforced on the `data.mono` APN so that unauthorised SIMs cannot access it. If SIM locking is not enforced, consider enabling APN authentication.

---

### Checklist Items with No Issues

Checklist item 7 (Secondary server hostname/IP): No secondary server (register 2320) is configured in either file. No issues found.

Checklist item 8 (Server port in non-standard range): Register 2311 is absent in both files. Register 2312,0 = `0x0011` = 17 decimal, which is likely an unrelated operational parameter, not a server port. No abnormal port configuration found.

Checklist item 9 (Hardcoded private/RFC1918 IP addresses): The server IP `52.164.241.179` is a public routable address, not an RFC1918 private address. No private IP addresses are hardcoded. No issues found.
