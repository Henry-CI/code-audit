# Pass 1 Security — Agent A02

**Files:**
- `8bit Script/50.131-RHM-8bit-LMU1220-POD-10minSleep6hr-Input1POS-PwrMonEvt-PEG0MotionEvtAcc4Dist500Thes10 (1).csv`
- `8bit Script/50.131-RHM-8bit-LMU1220-POD-10minSleep6hr-Input1POS-PwrMonEvt-PEG0MotionEvtAcc4Dist500Thes10.csv`

**Branch:** main (confirmed)
**Date:** 2026-02-27

---

## Reading Evidence

### FILE 1: `8bit Script/50.131-RHM-8bit-LMU1220-POD-10minSleep6hr-Input1POS-PwrMonEvt-PEG0MotionEvtAcc4Dist500Thes10 (1).csv`

**Format:** Three-column CSV with headers `parameter_id, parameter_index, parameter_value`. Each row sets a single register/index on the CalAmp LMU1220 device. Values are hexadecimal. String-type parameters are encoded as null-terminated hex byte strings. 328 data rows (329 lines including header).

**Parameters defined (register IDs present):**
257, 258, 259, 260, 262, 263, 264, 265, 266, 267, 268, 270, 271, 272, 275, 291, 512 (indices 0–121), 769, 770, 771, 772, 773, 774, 1024 (indices 1–63), 1025, 1027, 1028, 1029, 1030, 1031, 1032, 1033, 1034, 1035, 1037, 1280, 1283, 1536, 1537, 1538, 1539, 1540, 2306, 2307, 2311, 2312, 2313, 2314, 2315, 2316, 2318, 2319, 2320, 2322, 2327

**Server endpoints (IPs, hostnames, ports):**

| Register | Index | Hex Value | Decoded Value | Role |
|----------|-------|-----------|---------------|------|
| 2319 | 0 | `6E6172686D2E747261636B696E672D696E74656C6C6967656E63652E636F6D00` | `narhm.tracking-intelligence.com` | Primary server hostname |
| 2320 | 0 | `6D61696E742E76656869636C652D6C6F636174696F6E2E636F6D00` | `maint.vehicle-location.com` | Secondary/maintenance server hostname |
| 2311 | 0 | `5014` | Port **20500** (decimal) | Server port |
| 769 | 0 | `2AF8` | Port **11000** (decimal) | Additional port reference |
| 769 | 1–3 | `5014` | Port **20500** (decimal) | Additional port reference |

**APN names:**

| Register | Index | Hex Value | Decoded Value |
|----------|-------|-----------|---------------|
| 2306 | 0 | `6461746136343130303300` | `data641003` |
| 2306 | 1 | `6461746136343130303300` | `data641003` |

**APN credentials (username / password):**

| Register | Index | Hex Value | Decoded Value | Role |
|----------|-------|-----------|---------------|------|
| 2314 | 0 | `64756D6D7900` | `dummy` | APN username (index 0) |
| 2314 | 1 | `64756D6D7900` | `dummy` | APN username (index 1) |
| 2315 | 0 | `64756D6D7900` | `dummy` | APN password (index 0) |
| 2315 | 1 | `64756D6D7900` | `dummy` | APN password (index 1) |

**Dial string / USSD codes:**

| Register | Index | Hex Value | Decoded Value | Role |
|----------|-------|-----------|---------------|------|
| 2316 | 0 | `2A39392A2A2A312300` | `*99***1#` | PPP dial string (standard GSM data) |
| 2316 | 1 | `2A39392A2A2A312300` | `*99***1#` | PPP dial string |
| 2318 | 0 | `2A323238393900` | `*22899` | Activation/OTA dial string |

**Other notable values:**

| Register | Index | Value | Note |
|----------|-------|-------|------|
| 2322 | 0 | `00015180` = 86400 | Heartbeat/keepalive interval (seconds) — 24 hours |
| 2307 | 0 | `00` | PAP/CHAP auth mode = 0 (none) |
| 2313 | 0 | `0000` | Connection type flags |
| 2312 | 0 | `0011` = 17 decimal | Protocol/mode selector |
| 2327 | 0–3 | `FF` | Bitmask fields, all bits set |

---

### FILE 2: `8bit Script/50.131-RHM-8bit-LMU1220-POD-10minSleep6hr-Input1POS-PwrMonEvt-PEG0MotionEvtAcc4Dist500Thes10.csv`

**Format:** Identical structure — three-column CSV, same headers. 328 data rows (329 lines including header).

**Parameters defined:** Identical register set to File 1.

**Server endpoints:** Identical to File 1 — `narhm.tracking-intelligence.com` (port 20500) and `maint.vehicle-location.com`.

**APN names:** Identical — `data641003` on both indices.

**APN credentials:** Identical — `dummy` / `dummy` on both indices.

**Other credential-like values:** Identical.

**Differences from File 1:** None. A byte-for-byte comparison of both files shows every `parameter_id`, `parameter_index`, and `parameter_value` field is identical across all 328 data rows. The two files are exact duplicates and differ only in their filenames (the copy bears a ` (1)` suffix).

---

## Security Review

### Checklist Item 1 (Secrets/Credentials): APN credentials present in plaintext (hex-encoded)

**A02-1** — MEDIUM: APN credentials stored in configuration files as hex-encoded plaintext

**Description:** Registers 2314 (APN username) and 2315 (APN password) are set to the value `dummy` on both APN indices (0 and 1). These are stored as hex-encoded null-terminated strings (`64756D6D7900`) and are trivially decoded. While `dummy` is a placeholder/default rather than a real credential, the mechanism stores whatever username/password is configured in plaintext hex within the CSV. If a carrier-specific APN username and password were ever populated here, those credentials would be exposed in clear text in the configuration file committed to the repository. The current value of `dummy` may also indicate the APN is intentionally unauthenticated (register 2307 = `00` confirms auth mode is "none"), but the field pattern represents a latent secret exposure risk.

**Fix:** Document that registers 2314 and 2315 must never contain real credentials in repository-tracked files. If real APN credentials are required for any deployment, they should be injected at provisioning time via a secrets management process and must not be committed to source control. Consider adding a pre-commit hook or repository scan rule to detect non-placeholder values in these registers.

---

### Checklist Item 2 (AWS/Infrastructure): Hardcoded server hostnames expose infrastructure

**A02-2** — MEDIUM: Production and maintenance server hostnames hardcoded in committed configuration files

**Description:** Two server hostnames are hardcoded in cleartext (hex-encoded) in every script:

- Register 2319, index 0: `narhm.tracking-intelligence.com` — the primary reporting endpoint
- Register 2320, index 0: `maint.vehicle-location.com` — the maintenance/secondary endpoint

Both hostnames are fully qualified domain names that directly identify the infrastructure that GPS tracking devices call home to. Combined with the port (`20500`, in register 2311), an adversary can determine the exact host and port that all devices using this script will beacon to. This information is now permanently in git history. If these hostnames correspond to customer-facing or production infrastructure, their presence in a public or semi-public repository could assist in targeted denial-of-service, traffic interception, or reconnaissance.

The port `20500` (decimal) — `0x5014` — is a non-standard high port. There is no TLS or encryption indicated in the protocol flags visible in register 2312 (`0011` = 17 decimal), which suggests devices communicate to these endpoints over an unencrypted UDP or TCP transport.

**Fix:** Evaluate whether these hostname and port values constitute sensitive infrastructure identifiers. If so, consider parameterizing them (storing environment-specific values outside the versioned CSV). At minimum, access logs for `narhm.tracking-intelligence.com` and `maint.vehicle-location.com` should be reviewed to detect any unauthorized probing that may result from repository exposure.

---

### Checklist Item 3 (Network/Transport): No transport-layer encryption indicated

**A02-3** — LOW: No evidence of TLS or encrypted transport to server endpoints

**Description:** The protocol selector (register 2312, value `0011` = 17) and connection flags (register 2313, value `0000`) do not indicate TLS-secured transport. The CalAmp LMU PEG protocol used on these devices typically operates over unencrypted UDP or TCP. GPS position reports, event messages, and device status data are therefore likely transmitted in cleartext over cellular. An attacker with access to the carrier network or a rogue cell tower could intercept or spoof device communications.

**Fix:** Where possible, configure the device to use the CalAmp LMU encrypted transport mode or a VPN tunnel. Consult CalAmp LMU1220 documentation for any TLS-capable PEG protocol variant. If unencrypted transport is a known and accepted limitation of the hardware platform, document this as an accepted risk.

---

### Checklist Item 4 (Duplicate files — Version Control concern):

**A02-4** — INFO: Two committed files are byte-for-byte identical

**Description:** Both assigned files — `...10 (1).csv` and `...10.csv` — are exact duplicates with identical content in every row. The `(1)` suffix is a Windows Explorer pattern indicating the second file was created by copying the first. Both files are tracked in git, meaning the repository stores two copies of the same configuration with no meaningful distinction. This is a version-control hygiene issue: it creates ambiguity about which file is authoritative, may cause operators to apply the wrong version to a device, and doubles the exposure surface for any sensitive values within.

**Fix:** Determine which file is the intended authoritative copy and remove the duplicate. If there is a legitimate reason for two copies (e.g., different deployment targets), the filenames should reflect the distinction explicitly rather than relying on the `(1)` copy suffix.

---

### Checklist Item 5 (Input Validation): Not applicable to static CSV configuration files.

### Checklist Item 6 (Dependency/Platform): Not applicable to static CSV configuration files.

---

## Summary

| ID | Severity | Title |
|----|----------|-------|
| A02-1 | MEDIUM | APN credential fields stored as hex-encoded plaintext in repository |
| A02-2 | MEDIUM | Production/maintenance server hostnames hardcoded in committed config |
| A02-3 | LOW | No transport-layer encryption indicated for server communication |
| A02-4 | INFO | Two committed files are byte-for-byte duplicates |
